var rH=Object.defineProperty;var nH=(t,e,r)=>e in t?rH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var _o=(t,e,r)=>(nH(t,typeof e!="symbol"?e+"":e,r),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var ln=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ze(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function iH(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){if(this instanceof n){var i=[null];i.push.apply(i,arguments);var a=Function.bind.apply(e,i);return new a}return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var g3={exports:{}},_0={},y3={exports:{}},He={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ng=Symbol.for("react.element"),aH=Symbol.for("react.portal"),sH=Symbol.for("react.fragment"),oH=Symbol.for("react.strict_mode"),uH=Symbol.for("react.profiler"),lH=Symbol.for("react.provider"),cH=Symbol.for("react.context"),hH=Symbol.for("react.forward_ref"),dH=Symbol.for("react.suspense"),fH=Symbol.for("react.memo"),pH=Symbol.for("react.lazy"),O$=Symbol.iterator;function mH(t){return t===null||typeof t!="object"?null:(t=O$&&t[O$]||t["@@iterator"],typeof t=="function"?t:null)}var v3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b3=Object.assign,w3={};function sd(t,e,r){this.props=t,this.context=e,this.refs=w3,this.updater=r||v3}sd.prototype.isReactComponent={};sd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};sd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function _3(){}_3.prototype=sd.prototype;function IA(t,e,r){this.props=t,this.context=e,this.refs=w3,this.updater=r||v3}var $A=IA.prototype=new _3;$A.constructor=IA;b3($A,sd.prototype);$A.isPureReactComponent=!0;var S$=Array.isArray,x3=Object.prototype.hasOwnProperty,jA={current:null},O3={key:!0,ref:!0,__self:!0,__source:!0};function S3(t,e,r){var n,i={},a=null,s=null;if(e!=null)for(n in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(a=""+e.key),e)x3.call(e,n)&&!O3.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var u=Array(o),l=0;l<o;l++)u[l]=arguments[l+2];i.children=u}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:ng,type:t,key:a,ref:s,props:i,_owner:jA.current}}function gH(t,e){return{$$typeof:ng,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function RA(t){return typeof t=="object"&&t!==null&&t.$$typeof===ng}function yH(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var P$=/\/+/g;function D1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?yH(""+t.key):e.toString(36)}function Xy(t,e,r,n,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case ng:case aH:s=!0}}if(s)return s=t,i=i(s),t=n===""?"."+D1(s,0):n,S$(i)?(r="",t!=null&&(r=t.replace(P$,"$&/")+"/"),Xy(i,e,r,"",function(l){return l})):i!=null&&(RA(i)&&(i=gH(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(P$,"$&/")+"/")+t)),e.push(i)),1;if(s=0,n=n===""?".":n+":",S$(t))for(var o=0;o<t.length;o++){a=t[o];var u=n+D1(a,o);s+=Xy(a,e,r,u,i)}else if(u=mH(t),typeof u=="function")for(t=u.call(t),o=0;!(a=t.next()).done;)a=a.value,u=n+D1(a,o++),s+=Xy(a,e,r,u,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Yg(t,e,r){if(t==null)return t;var n=[],i=0;return Xy(t,n,"","",function(a){return e.call(r,a,i++)}),n}function vH(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var In={current:null},Qy={transition:null},bH={ReactCurrentDispatcher:In,ReactCurrentBatchConfig:Qy,ReactCurrentOwner:jA};He.Children={map:Yg,forEach:function(t,e,r){Yg(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Yg(t,function(){e++}),e},toArray:function(t){return Yg(t,function(e){return e})||[]},only:function(t){if(!RA(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};He.Component=sd;He.Fragment=sH;He.Profiler=uH;He.PureComponent=IA;He.StrictMode=oH;He.Suspense=dH;He.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bH;He.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=b3({},t.props),i=t.key,a=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,s=jA.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(u in e)x3.call(e,u)&&!O3.hasOwnProperty(u)&&(n[u]=e[u]===void 0&&o!==void 0?o[u]:e[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){o=Array(u);for(var l=0;l<u;l++)o[l]=arguments[l+2];n.children=o}return{$$typeof:ng,type:t.type,key:i,ref:a,props:n,_owner:s}};He.createContext=function(t){return t={$$typeof:cH,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:lH,_context:t},t.Consumer=t};He.createElement=S3;He.createFactory=function(t){var e=S3.bind(null,t);return e.type=t,e};He.createRef=function(){return{current:null}};He.forwardRef=function(t){return{$$typeof:hH,render:t}};He.isValidElement=RA;He.lazy=function(t){return{$$typeof:pH,_payload:{_status:-1,_result:t},_init:vH}};He.memo=function(t,e){return{$$typeof:fH,type:t,compare:e===void 0?null:e}};He.startTransition=function(t){var e=Qy.transition;Qy.transition={};try{t()}finally{Qy.transition=e}};He.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};He.useCallback=function(t,e){return In.current.useCallback(t,e)};He.useContext=function(t){return In.current.useContext(t)};He.useDebugValue=function(){};He.useDeferredValue=function(t){return In.current.useDeferredValue(t)};He.useEffect=function(t,e){return In.current.useEffect(t,e)};He.useId=function(){return In.current.useId()};He.useImperativeHandle=function(t,e,r){return In.current.useImperativeHandle(t,e,r)};He.useInsertionEffect=function(t,e){return In.current.useInsertionEffect(t,e)};He.useLayoutEffect=function(t,e){return In.current.useLayoutEffect(t,e)};He.useMemo=function(t,e){return In.current.useMemo(t,e)};He.useReducer=function(t,e,r){return In.current.useReducer(t,e,r)};He.useRef=function(t){return In.current.useRef(t)};He.useState=function(t){return In.current.useState(t)};He.useSyncExternalStore=function(t,e,r){return In.current.useSyncExternalStore(t,e,r)};He.useTransition=function(){return In.current.useTransition()};He.version="18.2.0";y3.exports=He;var I=y3.exports;const $=Ze(I);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wH=I,_H=Symbol.for("react.element"),xH=Symbol.for("react.fragment"),OH=Object.prototype.hasOwnProperty,SH=wH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,PH={key:!0,ref:!0,__self:!0,__source:!0};function P3(t,e,r){var n,i={},a=null,s=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(s=e.ref);for(n in e)OH.call(e,n)&&!PH.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:_H,type:t,key:a,ref:s,props:i,_owner:SH.current}}_0.Fragment=xH;_0.jsx=P3;_0.jsxs=P3;g3.exports=_0;var NA=g3.exports;const fs=NA.Fragment,A=NA.jsx,Q=NA.jsxs;var ZO={},E3={exports:{}},gi={},A3={exports:{}},T3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(M,V){var G=M.length;M.push(V);e:for(;0<G;){var re=G-1>>>1,K=M[re];if(0<i(K,V))M[re]=V,M[G]=K,G=re;else break e}}function r(M){return M.length===0?null:M[0]}function n(M){if(M.length===0)return null;var V=M[0],G=M.pop();if(G!==V){M[0]=G;e:for(var re=0,K=M.length,J=K>>>1;re<J;){var ie=2*(re+1)-1,oe=M[ie],S=ie+1,E=M[S];if(0>i(oe,G))S<K&&0>i(E,oe)?(M[re]=E,M[S]=G,re=S):(M[re]=oe,M[ie]=G,re=ie);else if(S<K&&0>i(E,G))M[re]=E,M[S]=G,re=S;else break e}}return V}function i(M,V){var G=M.sortIndex-V.sortIndex;return G!==0?G:M.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();t.unstable_now=function(){return s.now()-o}}var u=[],l=[],c=1,h=null,d=3,f=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(M){for(var V=r(l);V!==null;){if(V.callback===null)n(l);else if(V.startTime<=M)n(l),V.sortIndex=V.expirationTime,e(u,V);else break;V=r(l)}}function w(M){if(m=!1,b(M),!p)if(r(u)!==null)p=!0,D(_);else{var V=r(l);V!==null&&q(w,V.startTime-M)}}function _(M,V){p=!1,m&&(m=!1,v(x),x=-1),f=!0;var G=d;try{for(b(V),h=r(u);h!==null&&(!(h.expirationTime>V)||M&&!R());){var re=h.callback;if(typeof re=="function"){h.callback=null,d=h.priorityLevel;var K=re(h.expirationTime<=V);V=t.unstable_now(),typeof K=="function"?h.callback=K:h===r(u)&&n(u),b(V)}else n(u);h=r(u)}if(h!==null)var J=!0;else{var ie=r(l);ie!==null&&q(w,ie.startTime-V),J=!1}return J}finally{h=null,d=G,f=!1}}var O=!1,P=null,x=-1,j=5,k=-1;function R(){return!(t.unstable_now()-k<j)}function F(){if(P!==null){var M=t.unstable_now();k=M;var V=!0;try{V=P(!0,M)}finally{V?z():(O=!1,P=null)}}else O=!1}var z;if(typeof y=="function")z=function(){y(F)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,L=N.port2;N.port1.onmessage=F,z=function(){L.postMessage(null)}}else z=function(){g(F,0)};function D(M){P=M,O||(O=!0,z())}function q(M,V){x=g(function(){M(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(M){M.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,D(_))},t.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<M?Math.floor(1e3/M):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(M){switch(d){case 1:case 2:case 3:var V=3;break;default:V=d}var G=d;d=V;try{return M()}finally{d=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(M,V){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var G=d;d=M;try{return V()}finally{d=G}},t.unstable_scheduleCallback=function(M,V,G){var re=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?re+G:re):G=re,M){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=G+K,M={id:c++,callback:V,priorityLevel:M,startTime:G,expirationTime:K,sortIndex:-1},G>re?(M.sortIndex=G,e(l,M),r(u)===null&&M===r(l)&&(m?(v(x),x=-1):m=!0,q(w,G-re))):(M.sortIndex=K,e(u,M),p||f||(p=!0,D(_))),M},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(M){var V=d;return function(){var G=d;d=V;try{return M.apply(this,arguments)}finally{d=G}}}})(T3);A3.exports=T3;var EH=A3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k3=I,pi=EH;function he(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var C3=new Set,vp={};function Fl(t,e){mh(t,e),mh(t+"Capture",e)}function mh(t,e){for(vp[t]=e,t=0;t<e.length;t++)C3.add(e[t])}var Gs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),XO=Object.prototype.hasOwnProperty,AH=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,E$={},A$={};function TH(t){return XO.call(A$,t)?!0:XO.call(E$,t)?!1:AH.test(t)?A$[t]=!0:(E$[t]=!0,!1)}function kH(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function CH(t,e,r,n){if(e===null||typeof e>"u"||kH(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function $n(t,e,r,n,i,a,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=s}var Xr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Xr[t]=new $n(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Xr[e]=new $n(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Xr[t]=new $n(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Xr[t]=new $n(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Xr[t]=new $n(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Xr[t]=new $n(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Xr[t]=new $n(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Xr[t]=new $n(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Xr[t]=new $n(t,5,!1,t.toLowerCase(),null,!1,!1)});var MA=/[\-:]([a-z])/g;function DA(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(MA,DA);Xr[e]=new $n(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(MA,DA);Xr[e]=new $n(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(MA,DA);Xr[e]=new $n(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Xr[t]=new $n(t,1,!1,t.toLowerCase(),null,!1,!1)});Xr.xlinkHref=new $n("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Xr[t]=new $n(t,1,!1,t.toLowerCase(),null,!0,!0)});function LA(t,e,r,n){var i=Xr.hasOwnProperty(e)?Xr[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(CH(e,r,i,n)&&(r=null),n||i===null?TH(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var uo=k3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Jg=Symbol.for("react.element"),Ec=Symbol.for("react.portal"),Ac=Symbol.for("react.fragment"),FA=Symbol.for("react.strict_mode"),QO=Symbol.for("react.profiler"),I3=Symbol.for("react.provider"),$3=Symbol.for("react.context"),UA=Symbol.for("react.forward_ref"),eS=Symbol.for("react.suspense"),tS=Symbol.for("react.suspense_list"),zA=Symbol.for("react.memo"),Co=Symbol.for("react.lazy"),j3=Symbol.for("react.offscreen"),T$=Symbol.iterator;function tf(t){return t===null||typeof t!="object"?null:(t=T$&&t[T$]||t["@@iterator"],typeof t=="function"?t:null)}var Ht=Object.assign,L1;function kf(t){if(L1===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);L1=e&&e[1]||""}return`
`+L1+t}var F1=!1;function U1(t,e){if(!t||F1)return"";F1=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var n=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){n=l}t.call(e.prototype)}else{try{throw Error()}catch(l){n=l}t()}}catch(l){if(l&&n&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),a=n.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var u=`
`+i[s].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=s&&0<=o);break}}}finally{F1=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?kf(t):""}function IH(t){switch(t.tag){case 5:return kf(t.type);case 16:return kf("Lazy");case 13:return kf("Suspense");case 19:return kf("SuspenseList");case 0:case 2:case 15:return t=U1(t.type,!1),t;case 11:return t=U1(t.type.render,!1),t;case 1:return t=U1(t.type,!0),t;default:return""}}function rS(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ac:return"Fragment";case Ec:return"Portal";case QO:return"Profiler";case FA:return"StrictMode";case eS:return"Suspense";case tS:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case $3:return(t.displayName||"Context")+".Consumer";case I3:return(t._context.displayName||"Context")+".Provider";case UA:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case zA:return e=t.displayName||null,e!==null?e:rS(t.type)||"Memo";case Co:e=t._payload,t=t._init;try{return rS(t(e))}catch{}}return null}function $H(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rS(e);case 8:return e===FA?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function lu(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function R3(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function jH(t){var e=R3(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,a.call(this,s)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Zg(t){t._valueTracker||(t._valueTracker=jH(t))}function N3(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=R3(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Av(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function nS(t,e){var r=e.checked;return Ht({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function k$(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=lu(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function M3(t,e){e=e.checked,e!=null&&LA(t,"checked",e,!1)}function iS(t,e){M3(t,e);var r=lu(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?aS(t,e.type,r):e.hasOwnProperty("defaultValue")&&aS(t,e.type,lu(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function C$(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function aS(t,e,r){(e!=="number"||Av(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Cf=Array.isArray;function Jc(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+lu(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function sS(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(he(91));return Ht({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function I$(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(he(92));if(Cf(r)){if(1<r.length)throw Error(he(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:lu(r)}}function D3(t,e){var r=lu(e.value),n=lu(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function $$(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function L3(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oS(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?L3(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Xg,F3=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Xg=Xg||document.createElement("div"),Xg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Xg.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function bp(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Gf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},RH=["Webkit","ms","Moz","O"];Object.keys(Gf).forEach(function(t){RH.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Gf[e]=Gf[t]})});function U3(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Gf.hasOwnProperty(t)&&Gf[t]?(""+e).trim():e+"px"}function z3(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=U3(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var NH=Ht({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uS(t,e){if(e){if(NH[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(he(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(he(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(he(61))}if(e.style!=null&&typeof e.style!="object")throw Error(he(62))}}function lS(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cS=null;function BA(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var hS=null,Zc=null,Xc=null;function j$(t){if(t=sg(t)){if(typeof hS!="function")throw Error(he(280));var e=t.stateNode;e&&(e=E0(e),hS(t.stateNode,t.type,e))}}function B3(t){Zc?Xc?Xc.push(t):Xc=[t]:Zc=t}function q3(){if(Zc){var t=Zc,e=Xc;if(Xc=Zc=null,j$(t),e)for(t=0;t<e.length;t++)j$(e[t])}}function K3(t,e){return t(e)}function V3(){}var z1=!1;function H3(t,e,r){if(z1)return t(e,r);z1=!0;try{return K3(t,e,r)}finally{z1=!1,(Zc!==null||Xc!==null)&&(V3(),q3())}}function wp(t,e){var r=t.stateNode;if(r===null)return null;var n=E0(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(he(231,e,typeof r));return r}var dS=!1;if(Gs)try{var rf={};Object.defineProperty(rf,"passive",{get:function(){dS=!0}}),window.addEventListener("test",rf,rf),window.removeEventListener("test",rf,rf)}catch{dS=!1}function MH(t,e,r,n,i,a,s,o,u){var l=Array.prototype.slice.call(arguments,3);try{e.apply(r,l)}catch(c){this.onError(c)}}var Yf=!1,Tv=null,kv=!1,fS=null,DH={onError:function(t){Yf=!0,Tv=t}};function LH(t,e,r,n,i,a,s,o,u){Yf=!1,Tv=null,MH.apply(DH,arguments)}function FH(t,e,r,n,i,a,s,o,u){if(LH.apply(this,arguments),Yf){if(Yf){var l=Tv;Yf=!1,Tv=null}else throw Error(he(198));kv||(kv=!0,fS=l)}}function Ul(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function W3(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function R$(t){if(Ul(t)!==t)throw Error(he(188))}function UH(t){var e=t.alternate;if(!e){if(e=Ul(t),e===null)throw Error(he(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return R$(i),t;if(a===n)return R$(i),e;a=a.sibling}throw Error(he(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s)throw Error(he(189))}}if(r.alternate!==n)throw Error(he(190))}if(r.tag!==3)throw Error(he(188));return r.stateNode.current===r?t:e}function G3(t){return t=UH(t),t!==null?Y3(t):null}function Y3(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Y3(t);if(e!==null)return e;t=t.sibling}return null}var J3=pi.unstable_scheduleCallback,N$=pi.unstable_cancelCallback,zH=pi.unstable_shouldYield,BH=pi.unstable_requestPaint,er=pi.unstable_now,qH=pi.unstable_getCurrentPriorityLevel,qA=pi.unstable_ImmediatePriority,Z3=pi.unstable_UserBlockingPriority,Cv=pi.unstable_NormalPriority,KH=pi.unstable_LowPriority,X3=pi.unstable_IdlePriority,x0=null,Qa=null;function VH(t){if(Qa&&typeof Qa.onCommitFiberRoot=="function")try{Qa.onCommitFiberRoot(x0,t,void 0,(t.current.flags&128)===128)}catch{}}var va=Math.clz32?Math.clz32:GH,HH=Math.log,WH=Math.LN2;function GH(t){return t>>>=0,t===0?32:31-(HH(t)/WH|0)|0}var Qg=64,ey=4194304;function If(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Iv(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,a=t.pingedLanes,s=r&268435455;if(s!==0){var o=s&~i;o!==0?n=If(o):(a&=s,a!==0&&(n=If(a)))}else s=r&~i,s!==0?n=If(s):a!==0&&(n=If(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-va(e),i=1<<r,n|=t[r],e&=~i;return n}function YH(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function JH(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var s=31-va(a),o=1<<s,u=i[s];u===-1?(!(o&r)||o&n)&&(i[s]=YH(o,e)):u<=e&&(t.expiredLanes|=o),a&=~o}}function pS(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Q3(){var t=Qg;return Qg<<=1,!(Qg&4194240)&&(Qg=64),t}function B1(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function ig(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-va(e),t[e]=r}function ZH(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-va(r),a=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~a}}function KA(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-va(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var dt=0;function e5(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var t5,VA,r5,n5,i5,mS=!1,ty=[],Yo=null,Jo=null,Zo=null,_p=new Map,xp=new Map,Mo=[],XH="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function M$(t,e){switch(t){case"focusin":case"focusout":Yo=null;break;case"dragenter":case"dragleave":Jo=null;break;case"mouseover":case"mouseout":Zo=null;break;case"pointerover":case"pointerout":_p.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":xp.delete(e.pointerId)}}function nf(t,e,r,n,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},e!==null&&(e=sg(e),e!==null&&VA(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function QH(t,e,r,n,i){switch(e){case"focusin":return Yo=nf(Yo,t,e,r,n,i),!0;case"dragenter":return Jo=nf(Jo,t,e,r,n,i),!0;case"mouseover":return Zo=nf(Zo,t,e,r,n,i),!0;case"pointerover":var a=i.pointerId;return _p.set(a,nf(_p.get(a)||null,t,e,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,xp.set(a,nf(xp.get(a)||null,t,e,r,n,i)),!0}return!1}function a5(t){var e=Ju(t.target);if(e!==null){var r=Ul(e);if(r!==null){if(e=r.tag,e===13){if(e=W3(r),e!==null){t.blockedOn=e,i5(t.priority,function(){r5(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ev(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=gS(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);cS=n,r.target.dispatchEvent(n),cS=null}else return e=sg(r),e!==null&&VA(e),t.blockedOn=r,!1;e.shift()}return!0}function D$(t,e,r){ev(t)&&r.delete(e)}function eW(){mS=!1,Yo!==null&&ev(Yo)&&(Yo=null),Jo!==null&&ev(Jo)&&(Jo=null),Zo!==null&&ev(Zo)&&(Zo=null),_p.forEach(D$),xp.forEach(D$)}function af(t,e){t.blockedOn===e&&(t.blockedOn=null,mS||(mS=!0,pi.unstable_scheduleCallback(pi.unstable_NormalPriority,eW)))}function Op(t){function e(i){return af(i,t)}if(0<ty.length){af(ty[0],t);for(var r=1;r<ty.length;r++){var n=ty[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Yo!==null&&af(Yo,t),Jo!==null&&af(Jo,t),Zo!==null&&af(Zo,t),_p.forEach(e),xp.forEach(e),r=0;r<Mo.length;r++)n=Mo[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Mo.length&&(r=Mo[0],r.blockedOn===null);)a5(r),r.blockedOn===null&&Mo.shift()}var Qc=uo.ReactCurrentBatchConfig,$v=!0;function tW(t,e,r,n){var i=dt,a=Qc.transition;Qc.transition=null;try{dt=1,HA(t,e,r,n)}finally{dt=i,Qc.transition=a}}function rW(t,e,r,n){var i=dt,a=Qc.transition;Qc.transition=null;try{dt=4,HA(t,e,r,n)}finally{dt=i,Qc.transition=a}}function HA(t,e,r,n){if($v){var i=gS(t,e,r,n);if(i===null)X1(t,e,n,jv,r),M$(t,n);else if(QH(i,t,e,r,n))n.stopPropagation();else if(M$(t,n),e&4&&-1<XH.indexOf(t)){for(;i!==null;){var a=sg(i);if(a!==null&&t5(a),a=gS(t,e,r,n),a===null&&X1(t,e,n,jv,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else X1(t,e,n,null,r)}}var jv=null;function gS(t,e,r,n){if(jv=null,t=BA(n),t=Ju(t),t!==null)if(e=Ul(t),e===null)t=null;else if(r=e.tag,r===13){if(t=W3(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return jv=t,null}function s5(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qH()){case qA:return 1;case Z3:return 4;case Cv:case KH:return 16;case X3:return 536870912;default:return 16}default:return 16}}var Bo=null,WA=null,tv=null;function o5(){if(tv)return tv;var t,e=WA,r=e.length,n,i="value"in Bo?Bo.value:Bo.textContent,a=i.length;for(t=0;t<r&&e[t]===i[t];t++);var s=r-t;for(n=1;n<=s&&e[r-n]===i[a-n];n++);return tv=i.slice(t,1<n?1-n:void 0)}function rv(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ry(){return!0}function L$(){return!1}function yi(t){function e(r,n,i,a,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?ry:L$,this.isPropagationStopped=L$,this}return Ht(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ry)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ry)},persist:function(){},isPersistent:ry}),e}var od={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},GA=yi(od),ag=Ht({},od,{view:0,detail:0}),nW=yi(ag),q1,K1,sf,O0=Ht({},ag,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:YA,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==sf&&(sf&&t.type==="mousemove"?(q1=t.screenX-sf.screenX,K1=t.screenY-sf.screenY):K1=q1=0,sf=t),q1)},movementY:function(t){return"movementY"in t?t.movementY:K1}}),F$=yi(O0),iW=Ht({},O0,{dataTransfer:0}),aW=yi(iW),sW=Ht({},ag,{relatedTarget:0}),V1=yi(sW),oW=Ht({},od,{animationName:0,elapsedTime:0,pseudoElement:0}),uW=yi(oW),lW=Ht({},od,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),cW=yi(lW),hW=Ht({},od,{data:0}),U$=yi(hW),dW={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mW(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=pW[t])?!!e[t]:!1}function YA(){return mW}var gW=Ht({},ag,{key:function(t){if(t.key){var e=dW[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=rv(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?fW[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:YA,charCode:function(t){return t.type==="keypress"?rv(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?rv(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),yW=yi(gW),vW=Ht({},O0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),z$=yi(vW),bW=Ht({},ag,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:YA}),wW=yi(bW),_W=Ht({},od,{propertyName:0,elapsedTime:0,pseudoElement:0}),xW=yi(_W),OW=Ht({},O0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),SW=yi(OW),PW=[9,13,27,32],JA=Gs&&"CompositionEvent"in window,Jf=null;Gs&&"documentMode"in document&&(Jf=document.documentMode);var EW=Gs&&"TextEvent"in window&&!Jf,u5=Gs&&(!JA||Jf&&8<Jf&&11>=Jf),B$=String.fromCharCode(32),q$=!1;function l5(t,e){switch(t){case"keyup":return PW.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function c5(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Tc=!1;function AW(t,e){switch(t){case"compositionend":return c5(e);case"keypress":return e.which!==32?null:(q$=!0,B$);case"textInput":return t=e.data,t===B$&&q$?null:t;default:return null}}function TW(t,e){if(Tc)return t==="compositionend"||!JA&&l5(t,e)?(t=o5(),tv=WA=Bo=null,Tc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return u5&&e.locale!=="ko"?null:e.data;default:return null}}var kW={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function K$(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!kW[t.type]:e==="textarea"}function h5(t,e,r,n){B3(n),e=Rv(e,"onChange"),0<e.length&&(r=new GA("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Zf=null,Sp=null;function CW(t){x5(t,0)}function S0(t){var e=Ic(t);if(N3(e))return t}function IW(t,e){if(t==="change")return e}var d5=!1;if(Gs){var H1;if(Gs){var W1="oninput"in document;if(!W1){var V$=document.createElement("div");V$.setAttribute("oninput","return;"),W1=typeof V$.oninput=="function"}H1=W1}else H1=!1;d5=H1&&(!document.documentMode||9<document.documentMode)}function H$(){Zf&&(Zf.detachEvent("onpropertychange",f5),Sp=Zf=null)}function f5(t){if(t.propertyName==="value"&&S0(Sp)){var e=[];h5(e,Sp,t,BA(t)),H3(CW,e)}}function $W(t,e,r){t==="focusin"?(H$(),Zf=e,Sp=r,Zf.attachEvent("onpropertychange",f5)):t==="focusout"&&H$()}function jW(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return S0(Sp)}function RW(t,e){if(t==="click")return S0(e)}function NW(t,e){if(t==="input"||t==="change")return S0(e)}function MW(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Oa=typeof Object.is=="function"?Object.is:MW;function Pp(t,e){if(Oa(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!XO.call(e,i)||!Oa(t[i],e[i]))return!1}return!0}function W$(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function G$(t,e){var r=W$(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=W$(r)}}function p5(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?p5(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function m5(){for(var t=window,e=Av();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Av(t.document)}return e}function ZA(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function DW(t){var e=m5(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&p5(r.ownerDocument.documentElement,r)){if(n!==null&&ZA(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!t.extend&&a>n&&(i=n,n=a,a=i),i=G$(r,a);var s=G$(r,n);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var LW=Gs&&"documentMode"in document&&11>=document.documentMode,kc=null,yS=null,Xf=null,vS=!1;function Y$(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;vS||kc==null||kc!==Av(n)||(n=kc,"selectionStart"in n&&ZA(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Xf&&Pp(Xf,n)||(Xf=n,n=Rv(yS,"onSelect"),0<n.length&&(e=new GA("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=kc)))}function ny(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Cc={animationend:ny("Animation","AnimationEnd"),animationiteration:ny("Animation","AnimationIteration"),animationstart:ny("Animation","AnimationStart"),transitionend:ny("Transition","TransitionEnd")},G1={},g5={};Gs&&(g5=document.createElement("div").style,"AnimationEvent"in window||(delete Cc.animationend.animation,delete Cc.animationiteration.animation,delete Cc.animationstart.animation),"TransitionEvent"in window||delete Cc.transitionend.transition);function P0(t){if(G1[t])return G1[t];if(!Cc[t])return t;var e=Cc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in g5)return G1[t]=e[r];return t}var y5=P0("animationend"),v5=P0("animationiteration"),b5=P0("animationstart"),w5=P0("transitionend"),_5=new Map,J$="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vu(t,e){_5.set(t,e),Fl(e,[t])}for(var Y1=0;Y1<J$.length;Y1++){var J1=J$[Y1],FW=J1.toLowerCase(),UW=J1[0].toUpperCase()+J1.slice(1);vu(FW,"on"+UW)}vu(y5,"onAnimationEnd");vu(v5,"onAnimationIteration");vu(b5,"onAnimationStart");vu("dblclick","onDoubleClick");vu("focusin","onFocus");vu("focusout","onBlur");vu(w5,"onTransitionEnd");mh("onMouseEnter",["mouseout","mouseover"]);mh("onMouseLeave",["mouseout","mouseover"]);mh("onPointerEnter",["pointerout","pointerover"]);mh("onPointerLeave",["pointerout","pointerover"]);Fl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $f="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zW=new Set("cancel close invalid load scroll toggle".split(" ").concat($f));function Z$(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,FH(n,e,void 0,t),t.currentTarget=null}function x5(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var s=n.length-1;0<=s;s--){var o=n[s],u=o.instance,l=o.currentTarget;if(o=o.listener,u!==a&&i.isPropagationStopped())break e;Z$(i,o,l),a=u}else for(s=0;s<n.length;s++){if(o=n[s],u=o.instance,l=o.currentTarget,o=o.listener,u!==a&&i.isPropagationStopped())break e;Z$(i,o,l),a=u}}}if(kv)throw t=fS,kv=!1,fS=null,t}function kt(t,e){var r=e[OS];r===void 0&&(r=e[OS]=new Set);var n=t+"__bubble";r.has(n)||(O5(e,t,2,!1),r.add(n))}function Z1(t,e,r){var n=0;e&&(n|=4),O5(r,t,n,e)}var iy="_reactListening"+Math.random().toString(36).slice(2);function Ep(t){if(!t[iy]){t[iy]=!0,C3.forEach(function(r){r!=="selectionchange"&&(zW.has(r)||Z1(r,!1,t),Z1(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[iy]||(e[iy]=!0,Z1("selectionchange",!1,e))}}function O5(t,e,r,n){switch(s5(e)){case 1:var i=tW;break;case 4:i=rW;break;default:i=HA}r=i.bind(null,e,r,t),i=void 0,!dS||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function X1(t,e,r,n,i){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var u=s.tag;if((u===3||u===4)&&(u=s.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;s=s.return}for(;o!==null;){if(s=Ju(o),s===null)return;if(u=s.tag,u===5||u===6){n=a=s;continue e}o=o.parentNode}}n=n.return}H3(function(){var l=a,c=BA(r),h=[];e:{var d=_5.get(t);if(d!==void 0){var f=GA,p=t;switch(t){case"keypress":if(rv(r)===0)break e;case"keydown":case"keyup":f=yW;break;case"focusin":p="focus",f=V1;break;case"focusout":p="blur",f=V1;break;case"beforeblur":case"afterblur":f=V1;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=F$;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=aW;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=wW;break;case y5:case v5:case b5:f=uW;break;case w5:f=xW;break;case"scroll":f=nW;break;case"wheel":f=SW;break;case"copy":case"cut":case"paste":f=cW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=z$}var m=(e&4)!==0,g=!m&&t==="scroll",v=m?d!==null?d+"Capture":null:d;m=[];for(var y=l,b;y!==null;){b=y;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=wp(y,v),w!=null&&m.push(Ap(y,w,b)))),g)break;y=y.return}0<m.length&&(d=new f(d,p,null,r,c),h.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&r!==cS&&(p=r.relatedTarget||r.fromElement)&&(Ju(p)||p[Ys]))break e;if((f||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=r.relatedTarget||r.toElement,f=l,p=p?Ju(p):null,p!==null&&(g=Ul(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=l),f!==p)){if(m=F$,w="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(m=z$,w="onPointerLeave",v="onPointerEnter",y="pointer"),g=f==null?d:Ic(f),b=p==null?d:Ic(p),d=new m(w,y+"leave",f,r,c),d.target=g,d.relatedTarget=b,w=null,Ju(c)===l&&(m=new m(v,y+"enter",p,r,c),m.target=b,m.relatedTarget=g,w=m),g=w,f&&p)t:{for(m=f,v=p,y=0,b=m;b;b=rc(b))y++;for(b=0,w=v;w;w=rc(w))b++;for(;0<y-b;)m=rc(m),y--;for(;0<b-y;)v=rc(v),b--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=rc(m),v=rc(v)}m=null}else m=null;f!==null&&X$(h,d,f,m,!1),p!==null&&g!==null&&X$(h,g,p,m,!0)}}e:{if(d=l?Ic(l):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var _=IW;else if(K$(d))if(d5)_=NW;else{_=jW;var O=$W}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(_=RW);if(_&&(_=_(t,l))){h5(h,_,r,c);break e}O&&O(t,d,l),t==="focusout"&&(O=d._wrapperState)&&O.controlled&&d.type==="number"&&aS(d,"number",d.value)}switch(O=l?Ic(l):window,t){case"focusin":(K$(O)||O.contentEditable==="true")&&(kc=O,yS=l,Xf=null);break;case"focusout":Xf=yS=kc=null;break;case"mousedown":vS=!0;break;case"contextmenu":case"mouseup":case"dragend":vS=!1,Y$(h,r,c);break;case"selectionchange":if(LW)break;case"keydown":case"keyup":Y$(h,r,c)}var P;if(JA)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Tc?l5(t,r)&&(x="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(x="onCompositionStart");x&&(u5&&r.locale!=="ko"&&(Tc||x!=="onCompositionStart"?x==="onCompositionEnd"&&Tc&&(P=o5()):(Bo=c,WA="value"in Bo?Bo.value:Bo.textContent,Tc=!0)),O=Rv(l,x),0<O.length&&(x=new U$(x,t,null,r,c),h.push({event:x,listeners:O}),P?x.data=P:(P=c5(r),P!==null&&(x.data=P)))),(P=EW?AW(t,r):TW(t,r))&&(l=Rv(l,"onBeforeInput"),0<l.length&&(c=new U$("onBeforeInput","beforeinput",null,r,c),h.push({event:c,listeners:l}),c.data=P))}x5(h,e)})}function Ap(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Rv(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=wp(t,r),a!=null&&n.unshift(Ap(t,a,i)),a=wp(t,e),a!=null&&n.push(Ap(t,a,i))),t=t.return}return n}function rc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function X$(t,e,r,n,i){for(var a=e._reactName,s=[];r!==null&&r!==n;){var o=r,u=o.alternate,l=o.stateNode;if(u!==null&&u===n)break;o.tag===5&&l!==null&&(o=l,i?(u=wp(r,a),u!=null&&s.unshift(Ap(r,u,o))):i||(u=wp(r,a),u!=null&&s.push(Ap(r,u,o)))),r=r.return}s.length!==0&&t.push({event:e,listeners:s})}var BW=/\r\n?/g,qW=/\u0000|\uFFFD/g;function Q$(t){return(typeof t=="string"?t:""+t).replace(BW,`
`).replace(qW,"")}function ay(t,e,r){if(e=Q$(e),Q$(t)!==e&&r)throw Error(he(425))}function Nv(){}var bS=null,wS=null;function _S(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var xS=typeof setTimeout=="function"?setTimeout:void 0,KW=typeof clearTimeout=="function"?clearTimeout:void 0,ej=typeof Promise=="function"?Promise:void 0,VW=typeof queueMicrotask=="function"?queueMicrotask:typeof ej<"u"?function(t){return ej.resolve(null).then(t).catch(HW)}:xS;function HW(t){setTimeout(function(){throw t})}function Q1(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Op(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Op(e)}function Xo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function tj(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var ud=Math.random().toString(36).slice(2),qa="__reactFiber$"+ud,Tp="__reactProps$"+ud,Ys="__reactContainer$"+ud,OS="__reactEvents$"+ud,WW="__reactListeners$"+ud,GW="__reactHandles$"+ud;function Ju(t){var e=t[qa];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ys]||r[qa]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=tj(t);t!==null;){if(r=t[qa])return r;t=tj(t)}return e}t=r,r=t.parentNode}return null}function sg(t){return t=t[qa]||t[Ys],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ic(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(he(33))}function E0(t){return t[Tp]||null}var SS=[],$c=-1;function bu(t){return{current:t}}function $t(t){0>$c||(t.current=SS[$c],SS[$c]=null,$c--)}function At(t,e){$c++,SS[$c]=t.current,t.current=e}var cu={},dn=bu(cu),Kn=bu(!1),bl=cu;function gh(t,e){var r=t.type.contextTypes;if(!r)return cu;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Vn(t){return t=t.childContextTypes,t!=null}function Mv(){$t(Kn),$t(dn)}function rj(t,e,r){if(dn.current!==cu)throw Error(he(168));At(dn,e),At(Kn,r)}function S5(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(he(108,$H(t)||"Unknown",i));return Ht({},r,n)}function Dv(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||cu,bl=dn.current,At(dn,t),At(Kn,Kn.current),!0}function nj(t,e,r){var n=t.stateNode;if(!n)throw Error(he(169));r?(t=S5(t,e,bl),n.__reactInternalMemoizedMergedChildContext=t,$t(Kn),$t(dn),At(dn,t)):$t(Kn),At(Kn,r)}var Rs=null,A0=!1,ex=!1;function P5(t){Rs===null?Rs=[t]:Rs.push(t)}function YW(t){A0=!0,P5(t)}function wu(){if(!ex&&Rs!==null){ex=!0;var t=0,e=dt;try{var r=Rs;for(dt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Rs=null,A0=!1}catch(i){throw Rs!==null&&(Rs=Rs.slice(t+1)),J3(qA,wu),i}finally{dt=e,ex=!1}}return null}var jc=[],Rc=0,Lv=null,Fv=0,ki=[],Ci=0,wl=null,Ms=1,Ds="";function Mu(t,e){jc[Rc++]=Fv,jc[Rc++]=Lv,Lv=t,Fv=e}function E5(t,e,r){ki[Ci++]=Ms,ki[Ci++]=Ds,ki[Ci++]=wl,wl=t;var n=Ms;t=Ds;var i=32-va(n)-1;n&=~(1<<i),r+=1;var a=32-va(e)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Ms=1<<32-va(e)+i|r<<i|n,Ds=a+t}else Ms=1<<a|r<<i|n,Ds=t}function XA(t){t.return!==null&&(Mu(t,1),E5(t,1,0))}function QA(t){for(;t===Lv;)Lv=jc[--Rc],jc[Rc]=null,Fv=jc[--Rc],jc[Rc]=null;for(;t===wl;)wl=ki[--Ci],ki[Ci]=null,Ds=ki[--Ci],ki[Ci]=null,Ms=ki[--Ci],ki[Ci]=null}var hi=null,li=null,Mt=!1,ha=null;function A5(t,e){var r=Ni(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function ij(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,hi=t,li=Xo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,hi=t,li=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=wl!==null?{id:Ms,overflow:Ds}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Ni(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,hi=t,li=null,!0):!1;default:return!1}}function PS(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ES(t){if(Mt){var e=li;if(e){var r=e;if(!ij(t,e)){if(PS(t))throw Error(he(418));e=Xo(r.nextSibling);var n=hi;e&&ij(t,e)?A5(n,r):(t.flags=t.flags&-4097|2,Mt=!1,hi=t)}}else{if(PS(t))throw Error(he(418));t.flags=t.flags&-4097|2,Mt=!1,hi=t}}}function aj(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;hi=t}function sy(t){if(t!==hi)return!1;if(!Mt)return aj(t),Mt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!_S(t.type,t.memoizedProps)),e&&(e=li)){if(PS(t))throw T5(),Error(he(418));for(;e;)A5(t,e),e=Xo(e.nextSibling)}if(aj(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(he(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){li=Xo(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}li=null}}else li=hi?Xo(t.stateNode.nextSibling):null;return!0}function T5(){for(var t=li;t;)t=Xo(t.nextSibling)}function yh(){li=hi=null,Mt=!1}function eT(t){ha===null?ha=[t]:ha.push(t)}var JW=uo.ReactCurrentBatchConfig;function aa(t,e){if(t&&t.defaultProps){e=Ht({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}var Uv=bu(null),zv=null,Nc=null,tT=null;function rT(){tT=Nc=zv=null}function nT(t){var e=Uv.current;$t(Uv),t._currentValue=e}function AS(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function eh(t,e){zv=t,tT=Nc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(zn=!0),t.firstContext=null)}function zi(t){var e=t._currentValue;if(tT!==t)if(t={context:t,memoizedValue:e,next:null},Nc===null){if(zv===null)throw Error(he(308));Nc=t,zv.dependencies={lanes:0,firstContext:t}}else Nc=Nc.next=t;return e}var Zu=null;function iT(t){Zu===null?Zu=[t]:Zu.push(t)}function k5(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,iT(e)):(r.next=i.next,i.next=r),e.interleaved=r,Js(t,n)}function Js(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Io=!1;function aT(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function C5(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Qo(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,et&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Js(t,r)}return i=n.interleaved,i===null?(e.next=e,iT(n)):(e.next=i.next,i.next=e),n.interleaved=e,Js(t,r)}function nv(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,KA(t,r)}}function sj(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=s:a=a.next=s,r=r.next}while(r!==null);a===null?i=a=e:a=a.next=e}else i=a=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Bv(t,e,r,n){var i=t.updateQueue;Io=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var u=o,l=u.next;u.next=null,s===null?a=l:s.next=l,s=u;var c=t.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==s&&(o===null?c.firstBaseUpdate=l:o.next=l,c.lastBaseUpdate=u))}if(a!==null){var h=i.baseState;s=0,c=l=u=null,o=a;do{var d=o.lane,f=o.eventTime;if((n&d)===d){c!==null&&(c=c.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=t,m=o;switch(d=e,f=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,d=typeof p=="function"?p.call(f,h,d):p,d==null)break e;h=Ht({},h,d);break e;case 2:Io=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(l=c=f,u=h):c=c.next=f,s|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(1);if(c===null&&(u=h),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);xl|=s,t.lanes=s,t.memoizedState=h}}function oj(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(he(191,i));i.call(n)}}}var I5=new k3.Component().refs;function TS(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Ht({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var T0={isMounted:function(t){return(t=t._reactInternals)?Ul(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Tn(),i=tu(t),a=qs(n,i);a.payload=e,r!=null&&(a.callback=r),e=Qo(t,a,i),e!==null&&(ba(e,t,i,n),nv(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Tn(),i=tu(t),a=qs(n,i);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=Qo(t,a,i),e!==null&&(ba(e,t,i,n),nv(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Tn(),n=tu(t),i=qs(r,n);i.tag=2,e!=null&&(i.callback=e),e=Qo(t,i,n),e!==null&&(ba(e,t,n,r),nv(e,t,n))}};function uj(t,e,r,n,i,a,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,s):e.prototype&&e.prototype.isPureReactComponent?!Pp(r,n)||!Pp(i,a):!0}function $5(t,e,r){var n=!1,i=cu,a=e.contextType;return typeof a=="object"&&a!==null?a=zi(a):(i=Vn(e)?bl:dn.current,n=e.contextTypes,a=(n=n!=null)?gh(t,i):cu),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=T0,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function lj(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&T0.enqueueReplaceState(e,e.state,null)}function kS(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs=I5,aT(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=zi(a):(a=Vn(e)?bl:dn.current,i.context=gh(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(TS(t,e,a,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&T0.enqueueReplaceState(i,i.state,null),Bv(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function of(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(he(309));var n=r.stateNode}if(!n)throw Error(he(147,t));var i=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(s){var o=i.refs;o===I5&&(o=i.refs={}),s===null?delete o[a]:o[a]=s},e._stringRef=a,e)}if(typeof t!="string")throw Error(he(284));if(!r._owner)throw Error(he(290,t))}return t}function oy(t,e){throw t=Object.prototype.toString.call(e),Error(he(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function cj(t){var e=t._init;return e(t._payload)}function j5(t){function e(v,y){if(t){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function i(v,y){return v=ru(v,y),v.index=0,v.sibling=null,v}function a(v,y,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function s(v){return t&&v.alternate===null&&(v.flags|=2),v}function o(v,y,b,w){return y===null||y.tag!==6?(y=ox(b,v.mode,w),y.return=v,y):(y=i(y,b),y.return=v,y)}function u(v,y,b,w){var _=b.type;return _===Ac?c(v,y,b.props.children,w,b.key):y!==null&&(y.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Co&&cj(_)===y.type)?(w=i(y,b.props),w.ref=of(v,y,b),w.return=v,w):(w=lv(b.type,b.key,b.props,null,v.mode,w),w.ref=of(v,y,b),w.return=v,w)}function l(v,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=ux(b,v.mode,w),y.return=v,y):(y=i(y,b.children||[]),y.return=v,y)}function c(v,y,b,w,_){return y===null||y.tag!==7?(y=cl(b,v.mode,w,_),y.return=v,y):(y=i(y,b),y.return=v,y)}function h(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=ox(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Jg:return b=lv(y.type,y.key,y.props,null,v.mode,b),b.ref=of(v,null,y),b.return=v,b;case Ec:return y=ux(y,v.mode,b),y.return=v,y;case Co:var w=y._init;return h(v,w(y._payload),b)}if(Cf(y)||tf(y))return y=cl(y,v.mode,b,null),y.return=v,y;oy(v,y)}return null}function d(v,y,b,w){var _=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return _!==null?null:o(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Jg:return b.key===_?u(v,y,b,w):null;case Ec:return b.key===_?l(v,y,b,w):null;case Co:return _=b._init,d(v,y,_(b._payload),w)}if(Cf(b)||tf(b))return _!==null?null:c(v,y,b,w,null);oy(v,b)}return null}function f(v,y,b,w,_){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,o(y,v,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Jg:return v=v.get(w.key===null?b:w.key)||null,u(y,v,w,_);case Ec:return v=v.get(w.key===null?b:w.key)||null,l(y,v,w,_);case Co:var O=w._init;return f(v,y,b,O(w._payload),_)}if(Cf(w)||tf(w))return v=v.get(b)||null,c(y,v,w,_,null);oy(y,w)}return null}function p(v,y,b,w){for(var _=null,O=null,P=y,x=y=0,j=null;P!==null&&x<b.length;x++){P.index>x?(j=P,P=null):j=P.sibling;var k=d(v,P,b[x],w);if(k===null){P===null&&(P=j);break}t&&P&&k.alternate===null&&e(v,P),y=a(k,y,x),O===null?_=k:O.sibling=k,O=k,P=j}if(x===b.length)return r(v,P),Mt&&Mu(v,x),_;if(P===null){for(;x<b.length;x++)P=h(v,b[x],w),P!==null&&(y=a(P,y,x),O===null?_=P:O.sibling=P,O=P);return Mt&&Mu(v,x),_}for(P=n(v,P);x<b.length;x++)j=f(P,v,x,b[x],w),j!==null&&(t&&j.alternate!==null&&P.delete(j.key===null?x:j.key),y=a(j,y,x),O===null?_=j:O.sibling=j,O=j);return t&&P.forEach(function(R){return e(v,R)}),Mt&&Mu(v,x),_}function m(v,y,b,w){var _=tf(b);if(typeof _!="function")throw Error(he(150));if(b=_.call(b),b==null)throw Error(he(151));for(var O=_=null,P=y,x=y=0,j=null,k=b.next();P!==null&&!k.done;x++,k=b.next()){P.index>x?(j=P,P=null):j=P.sibling;var R=d(v,P,k.value,w);if(R===null){P===null&&(P=j);break}t&&P&&R.alternate===null&&e(v,P),y=a(R,y,x),O===null?_=R:O.sibling=R,O=R,P=j}if(k.done)return r(v,P),Mt&&Mu(v,x),_;if(P===null){for(;!k.done;x++,k=b.next())k=h(v,k.value,w),k!==null&&(y=a(k,y,x),O===null?_=k:O.sibling=k,O=k);return Mt&&Mu(v,x),_}for(P=n(v,P);!k.done;x++,k=b.next())k=f(P,v,x,k.value,w),k!==null&&(t&&k.alternate!==null&&P.delete(k.key===null?x:k.key),y=a(k,y,x),O===null?_=k:O.sibling=k,O=k);return t&&P.forEach(function(F){return e(v,F)}),Mt&&Mu(v,x),_}function g(v,y,b,w){if(typeof b=="object"&&b!==null&&b.type===Ac&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Jg:e:{for(var _=b.key,O=y;O!==null;){if(O.key===_){if(_=b.type,_===Ac){if(O.tag===7){r(v,O.sibling),y=i(O,b.props.children),y.return=v,v=y;break e}}else if(O.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Co&&cj(_)===O.type){r(v,O.sibling),y=i(O,b.props),y.ref=of(v,O,b),y.return=v,v=y;break e}r(v,O);break}else e(v,O);O=O.sibling}b.type===Ac?(y=cl(b.props.children,v.mode,w,b.key),y.return=v,v=y):(w=lv(b.type,b.key,b.props,null,v.mode,w),w.ref=of(v,y,b),w.return=v,v=w)}return s(v);case Ec:e:{for(O=b.key;y!==null;){if(y.key===O)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=i(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else e(v,y);y=y.sibling}y=ux(b,v.mode,w),y.return=v,v=y}return s(v);case Co:return O=b._init,g(v,y,O(b._payload),w)}if(Cf(b))return p(v,y,b,w);if(tf(b))return m(v,y,b,w);oy(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=i(y,b),y.return=v,v=y):(r(v,y),y=ox(b,v.mode,w),y.return=v,v=y),s(v)):r(v,y)}return g}var vh=j5(!0),R5=j5(!1),og={},es=bu(og),kp=bu(og),Cp=bu(og);function Xu(t){if(t===og)throw Error(he(174));return t}function sT(t,e){switch(At(Cp,e),At(kp,t),At(es,og),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:oS(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=oS(e,t)}$t(es),At(es,e)}function bh(){$t(es),$t(kp),$t(Cp)}function N5(t){Xu(Cp.current);var e=Xu(es.current),r=oS(e,t.type);e!==r&&(At(kp,t),At(es,r))}function oT(t){kp.current===t&&($t(es),$t(kp))}var zt=bu(0);function qv(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var tx=[];function uT(){for(var t=0;t<tx.length;t++)tx[t]._workInProgressVersionPrimary=null;tx.length=0}var iv=uo.ReactCurrentDispatcher,rx=uo.ReactCurrentBatchConfig,_l=0,Kt=null,fr=null,kr=null,Kv=!1,Qf=!1,Ip=0,ZW=0;function en(){throw Error(he(321))}function lT(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Oa(t[r],e[r]))return!1;return!0}function cT(t,e,r,n,i,a){if(_l=a,Kt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,iv.current=t===null||t.memoizedState===null?tG:rG,t=r(n,i),Qf){a=0;do{if(Qf=!1,Ip=0,25<=a)throw Error(he(301));a+=1,kr=fr=null,e.updateQueue=null,iv.current=nG,t=r(n,i)}while(Qf)}if(iv.current=Vv,e=fr!==null&&fr.next!==null,_l=0,kr=fr=Kt=null,Kv=!1,e)throw Error(he(300));return t}function hT(){var t=Ip!==0;return Ip=0,t}function Da(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kr===null?Kt.memoizedState=kr=t:kr=kr.next=t,kr}function Bi(){if(fr===null){var t=Kt.alternate;t=t!==null?t.memoizedState:null}else t=fr.next;var e=kr===null?Kt.memoizedState:kr.next;if(e!==null)kr=e,fr=t;else{if(t===null)throw Error(he(310));fr=t,t={memoizedState:fr.memoizedState,baseState:fr.baseState,baseQueue:fr.baseQueue,queue:fr.queue,next:null},kr===null?Kt.memoizedState=kr=t:kr=kr.next=t}return kr}function $p(t,e){return typeof e=="function"?e(t):e}function nx(t){var e=Bi(),r=e.queue;if(r===null)throw Error(he(311));r.lastRenderedReducer=t;var n=fr,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var o=s=null,u=null,l=a;do{var c=l.lane;if((_l&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:t(n,l.action);else{var h={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(o=u=h,s=n):u=u.next=h,Kt.lanes|=c,xl|=c}l=l.next}while(l!==null&&l!==a);u===null?s=n:u.next=o,Oa(n,e.memoizedState)||(zn=!0),e.memoizedState=n,e.baseState=s,e.baseQueue=u,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do a=i.lane,Kt.lanes|=a,xl|=a,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function ix(t){var e=Bi(),r=e.queue;if(r===null)throw Error(he(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,a=e.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do a=t(a,s.action),s=s.next;while(s!==i);Oa(a,e.memoizedState)||(zn=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function M5(){}function D5(t,e){var r=Kt,n=Bi(),i=e(),a=!Oa(n.memoizedState,i);if(a&&(n.memoizedState=i,zn=!0),n=n.queue,dT(U5.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||kr!==null&&kr.memoizedState.tag&1){if(r.flags|=2048,jp(9,F5.bind(null,r,n,i,e),void 0,null),Rr===null)throw Error(he(349));_l&30||L5(r,e,i)}return i}function L5(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Kt.updateQueue,e===null?(e={lastEffect:null,stores:null},Kt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function F5(t,e,r,n){e.value=r,e.getSnapshot=n,z5(e)&&B5(t)}function U5(t,e,r){return r(function(){z5(e)&&B5(t)})}function z5(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Oa(t,r)}catch{return!0}}function B5(t){var e=Js(t,1);e!==null&&ba(e,t,1,-1)}function hj(t){var e=Da();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$p,lastRenderedState:t},e.queue=t,t=t.dispatch=eG.bind(null,Kt,t),[e.memoizedState,t]}function jp(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Kt.updateQueue,e===null?(e={lastEffect:null,stores:null},Kt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function q5(){return Bi().memoizedState}function av(t,e,r,n){var i=Da();Kt.flags|=t,i.memoizedState=jp(1|e,r,void 0,n===void 0?null:n)}function k0(t,e,r,n){var i=Bi();n=n===void 0?null:n;var a=void 0;if(fr!==null){var s=fr.memoizedState;if(a=s.destroy,n!==null&&lT(n,s.deps)){i.memoizedState=jp(e,r,a,n);return}}Kt.flags|=t,i.memoizedState=jp(1|e,r,a,n)}function dj(t,e){return av(8390656,8,t,e)}function dT(t,e){return k0(2048,8,t,e)}function K5(t,e){return k0(4,2,t,e)}function V5(t,e){return k0(4,4,t,e)}function H5(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function W5(t,e,r){return r=r!=null?r.concat([t]):null,k0(4,4,H5.bind(null,e,t),r)}function fT(){}function G5(t,e){var r=Bi();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&lT(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Y5(t,e){var r=Bi();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&lT(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function J5(t,e,r){return _l&21?(Oa(r,e)||(r=Q3(),Kt.lanes|=r,xl|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,zn=!0),t.memoizedState=r)}function XW(t,e){var r=dt;dt=r!==0&&4>r?r:4,t(!0);var n=rx.transition;rx.transition={};try{t(!1),e()}finally{dt=r,rx.transition=n}}function Z5(){return Bi().memoizedState}function QW(t,e,r){var n=tu(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},X5(t))Q5(e,r);else if(r=k5(t,e,r,n),r!==null){var i=Tn();ba(r,t,n,i),e4(r,e,n)}}function eG(t,e,r){var n=tu(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(X5(t))Q5(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var s=e.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,Oa(o,s)){var u=e.interleaved;u===null?(i.next=i,iT(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}r=k5(t,e,i,n),r!==null&&(i=Tn(),ba(r,t,n,i),e4(r,e,n))}}function X5(t){var e=t.alternate;return t===Kt||e!==null&&e===Kt}function Q5(t,e){Qf=Kv=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function e4(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,KA(t,r)}}var Vv={readContext:zi,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useInsertionEffect:en,useLayoutEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useMutableSource:en,useSyncExternalStore:en,useId:en,unstable_isNewReconciler:!1},tG={readContext:zi,useCallback:function(t,e){return Da().memoizedState=[t,e===void 0?null:e],t},useContext:zi,useEffect:dj,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,av(4194308,4,H5.bind(null,e,t),r)},useLayoutEffect:function(t,e){return av(4194308,4,t,e)},useInsertionEffect:function(t,e){return av(4,2,t,e)},useMemo:function(t,e){var r=Da();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Da();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=QW.bind(null,Kt,t),[n.memoizedState,t]},useRef:function(t){var e=Da();return t={current:t},e.memoizedState=t},useState:hj,useDebugValue:fT,useDeferredValue:function(t){return Da().memoizedState=t},useTransition:function(){var t=hj(!1),e=t[0];return t=XW.bind(null,t[1]),Da().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Kt,i=Da();if(Mt){if(r===void 0)throw Error(he(407));r=r()}else{if(r=e(),Rr===null)throw Error(he(349));_l&30||L5(n,e,r)}i.memoizedState=r;var a={value:r,getSnapshot:e};return i.queue=a,dj(U5.bind(null,n,a,t),[t]),n.flags|=2048,jp(9,F5.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=Da(),e=Rr.identifierPrefix;if(Mt){var r=Ds,n=Ms;r=(n&~(1<<32-va(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Ip++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=ZW++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},rG={readContext:zi,useCallback:G5,useContext:zi,useEffect:dT,useImperativeHandle:W5,useInsertionEffect:K5,useLayoutEffect:V5,useMemo:Y5,useReducer:nx,useRef:q5,useState:function(){return nx($p)},useDebugValue:fT,useDeferredValue:function(t){var e=Bi();return J5(e,fr.memoizedState,t)},useTransition:function(){var t=nx($p)[0],e=Bi().memoizedState;return[t,e]},useMutableSource:M5,useSyncExternalStore:D5,useId:Z5,unstable_isNewReconciler:!1},nG={readContext:zi,useCallback:G5,useContext:zi,useEffect:dT,useImperativeHandle:W5,useInsertionEffect:K5,useLayoutEffect:V5,useMemo:Y5,useReducer:ix,useRef:q5,useState:function(){return ix($p)},useDebugValue:fT,useDeferredValue:function(t){var e=Bi();return fr===null?e.memoizedState=t:J5(e,fr.memoizedState,t)},useTransition:function(){var t=ix($p)[0],e=Bi().memoizedState;return[t,e]},useMutableSource:M5,useSyncExternalStore:D5,useId:Z5,unstable_isNewReconciler:!1};function wh(t,e){try{var r="",n=e;do r+=IH(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function ax(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function CS(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var iG=typeof WeakMap=="function"?WeakMap:Map;function t4(t,e,r){r=qs(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Wv||(Wv=!0,US=n),CS(t,e)},r}function r4(t,e,r){r=qs(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){CS(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){CS(t,e),typeof n!="function"&&(eu===null?eu=new Set([this]):eu.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),r}function fj(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new iG;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=vG.bind(null,t,e,r),e.then(t,t))}function pj(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function mj(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=qs(-1,1),e.tag=2,Qo(r,e,1))),r.lanes|=1),t)}var aG=uo.ReactCurrentOwner,zn=!1;function wn(t,e,r,n){e.child=t===null?R5(e,null,r,n):vh(e,t.child,r,n)}function gj(t,e,r,n,i){r=r.render;var a=e.ref;return eh(e,i),n=cT(t,e,r,n,a,i),r=hT(),t!==null&&!zn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Zs(t,e,i)):(Mt&&r&&XA(e),e.flags|=1,wn(t,e,n,i),e.child)}function yj(t,e,r,n,i){if(t===null){var a=r.type;return typeof a=="function"&&!_T(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,n4(t,e,a,n,i)):(t=lv(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var s=a.memoizedProps;if(r=r.compare,r=r!==null?r:Pp,r(s,n)&&t.ref===e.ref)return Zs(t,e,i)}return e.flags|=1,t=ru(a,n),t.ref=e.ref,t.return=e,e.child=t}function n4(t,e,r,n,i){if(t!==null){var a=t.memoizedProps;if(Pp(a,n)&&t.ref===e.ref)if(zn=!1,e.pendingProps=n=a,(t.lanes&i)!==0)t.flags&131072&&(zn=!0);else return e.lanes=t.lanes,Zs(t,e,i)}return IS(t,e,r,n,i)}function i4(t,e,r){var n=e.pendingProps,i=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},At(Dc,ai),ai|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,At(Dc,ai),ai|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,At(Dc,ai),ai|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,At(Dc,ai),ai|=n;return wn(t,e,i,r),e.child}function a4(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function IS(t,e,r,n,i){var a=Vn(r)?bl:dn.current;return a=gh(e,a),eh(e,i),r=cT(t,e,r,n,a,i),n=hT(),t!==null&&!zn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Zs(t,e,i)):(Mt&&n&&XA(e),e.flags|=1,wn(t,e,r,i),e.child)}function vj(t,e,r,n,i){if(Vn(r)){var a=!0;Dv(e)}else a=!1;if(eh(e,i),e.stateNode===null)sv(t,e),$5(e,r,n),kS(e,r,n,i),n=!0;else if(t===null){var s=e.stateNode,o=e.memoizedProps;s.props=o;var u=s.context,l=r.contextType;typeof l=="object"&&l!==null?l=zi(l):(l=Vn(r)?bl:dn.current,l=gh(e,l));var c=r.getDerivedStateFromProps,h=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||u!==l)&&lj(e,s,n,l),Io=!1;var d=e.memoizedState;s.state=d,Bv(e,n,s,i),u=e.memoizedState,o!==n||d!==u||Kn.current||Io?(typeof c=="function"&&(TS(e,r,c,n),u=e.memoizedState),(o=Io||uj(e,r,o,n,d,u,l))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=u),s.props=n,s.state=u,s.context=l,n=o):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{s=e.stateNode,C5(t,e),o=e.memoizedProps,l=e.type===e.elementType?o:aa(e.type,o),s.props=l,h=e.pendingProps,d=s.context,u=r.contextType,typeof u=="object"&&u!==null?u=zi(u):(u=Vn(r)?bl:dn.current,u=gh(e,u));var f=r.getDerivedStateFromProps;(c=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==h||d!==u)&&lj(e,s,n,u),Io=!1,d=e.memoizedState,s.state=d,Bv(e,n,s,i);var p=e.memoizedState;o!==h||d!==p||Kn.current||Io?(typeof f=="function"&&(TS(e,r,f,n),p=e.memoizedState),(l=Io||uj(e,r,l,n,d,p,u)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,p,u),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,p,u)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=p),s.props=n,s.state=p,s.context=u,n=l):(typeof s.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return $S(t,e,r,n,a,i)}function $S(t,e,r,n,i,a){a4(t,e);var s=(e.flags&128)!==0;if(!n&&!s)return i&&nj(e,r,!1),Zs(t,e,a);n=e.stateNode,aG.current=e;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&s?(e.child=vh(e,t.child,null,a),e.child=vh(e,null,o,a)):wn(t,e,o,a),e.memoizedState=n.state,i&&nj(e,r,!0),e.child}function s4(t){var e=t.stateNode;e.pendingContext?rj(t,e.pendingContext,e.pendingContext!==e.context):e.context&&rj(t,e.context,!1),sT(t,e.containerInfo)}function bj(t,e,r,n,i){return yh(),eT(i),e.flags|=256,wn(t,e,r,n),e.child}var jS={dehydrated:null,treeContext:null,retryLane:0};function RS(t){return{baseLanes:t,cachePool:null,transitions:null}}function o4(t,e,r){var n=e.pendingProps,i=zt.current,a=!1,s=(e.flags&128)!==0,o;if((o=s)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),At(zt,i&1),t===null)return ES(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=n.children,t=n.fallback,a?(n=e.mode,a=e.child,s={mode:"hidden",children:s},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=$0(s,n,0,null),t=cl(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=RS(r),e.memoizedState=jS,t):pT(e,s));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return sG(t,e,s,n,o,i,r);if(a){a=n.fallback,s=e.mode,i=t.child,o=i.sibling;var u={mode:"hidden",children:n.children};return!(s&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=u,e.deletions=null):(n=ru(i,u),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=ru(o,a):(a=cl(a,s,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,s=t.child.memoizedState,s=s===null?RS(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=t.childLanes&~r,e.memoizedState=jS,n}return a=t.child,t=a.sibling,n=ru(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function pT(t,e){return e=$0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function uy(t,e,r,n){return n!==null&&eT(n),vh(e,t.child,null,r),t=pT(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function sG(t,e,r,n,i,a,s){if(r)return e.flags&256?(e.flags&=-257,n=ax(Error(he(422))),uy(t,e,s,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,i=e.mode,n=$0({mode:"visible",children:n.children},i,0,null),a=cl(a,i,s,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&vh(e,t.child,null,s),e.child.memoizedState=RS(s),e.memoizedState=jS,a);if(!(e.mode&1))return uy(t,e,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(he(419)),n=ax(a,n,void 0),uy(t,e,s,n)}if(o=(s&t.childLanes)!==0,zn||o){if(n=Rr,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Js(t,i),ba(n,t,i,-1))}return wT(),n=ax(Error(he(421))),uy(t,e,s,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=bG.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,li=Xo(i.nextSibling),hi=e,Mt=!0,ha=null,t!==null&&(ki[Ci++]=Ms,ki[Ci++]=Ds,ki[Ci++]=wl,Ms=t.id,Ds=t.overflow,wl=e),e=pT(e,n.children),e.flags|=4096,e)}function wj(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),AS(t.return,e,r)}function sx(t,e,r,n,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function u4(t,e,r){var n=e.pendingProps,i=n.revealOrder,a=n.tail;if(wn(t,e,n.children,r),n=zt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&wj(t,r,e);else if(t.tag===19)wj(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(At(zt,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&qv(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),sx(e,!1,i,r,a);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&qv(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}sx(e,!0,r,null,a);break;case"together":sx(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function sv(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Zs(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),xl|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(he(153));if(e.child!==null){for(t=e.child,r=ru(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=ru(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function oG(t,e,r){switch(e.tag){case 3:s4(e),yh();break;case 5:N5(e);break;case 1:Vn(e.type)&&Dv(e);break;case 4:sT(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;At(Uv,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(At(zt,zt.current&1),e.flags|=128,null):r&e.child.childLanes?o4(t,e,r):(At(zt,zt.current&1),t=Zs(t,e,r),t!==null?t.sibling:null);At(zt,zt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return u4(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),At(zt,zt.current),n)break;return null;case 22:case 23:return e.lanes=0,i4(t,e,r)}return Zs(t,e,r)}var l4,NS,c4,h4;l4=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};NS=function(){};c4=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Xu(es.current);var a=null;switch(r){case"input":i=nS(t,i),n=nS(t,n),a=[];break;case"select":i=Ht({},i,{value:void 0}),n=Ht({},n,{value:void 0}),a=[];break;case"textarea":i=sS(t,i),n=sS(t,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Nv)}uS(r,n);var s;r=null;for(l in i)if(!n.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var o=i[l];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(vp.hasOwnProperty(l)?a||(a=[]):(a=a||[]).push(l,null));for(l in n){var u=n[l];if(o=i!=null?i[l]:void 0,n.hasOwnProperty(l)&&u!==o&&(u!=null||o!=null))if(l==="style")if(o){for(s in o)!o.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in u)u.hasOwnProperty(s)&&o[s]!==u[s]&&(r||(r={}),r[s]=u[s])}else r||(a||(a=[]),a.push(l,r)),r=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(a=a||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(a=a||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(vp.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&kt("scroll",t),a||o===u||(a=[])):(a=a||[]).push(l,u))}r&&(a=a||[]).push("style",r);var l=a;(e.updateQueue=l)&&(e.flags|=4)}};h4=function(t,e,r,n){r!==n&&(e.flags|=4)};function uf(t,e){if(!Mt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function tn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function uG(t,e,r){var n=e.pendingProps;switch(QA(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(e),null;case 1:return Vn(e.type)&&Mv(),tn(e),null;case 3:return n=e.stateNode,bh(),$t(Kn),$t(dn),uT(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(sy(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ha!==null&&(qS(ha),ha=null))),NS(t,e),tn(e),null;case 5:oT(e);var i=Xu(Cp.current);if(r=e.type,t!==null&&e.stateNode!=null)c4(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(he(166));return tn(e),null}if(t=Xu(es.current),sy(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[qa]=e,n[Tp]=a,t=(e.mode&1)!==0,r){case"dialog":kt("cancel",n),kt("close",n);break;case"iframe":case"object":case"embed":kt("load",n);break;case"video":case"audio":for(i=0;i<$f.length;i++)kt($f[i],n);break;case"source":kt("error",n);break;case"img":case"image":case"link":kt("error",n),kt("load",n);break;case"details":kt("toggle",n);break;case"input":k$(n,a),kt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},kt("invalid",n);break;case"textarea":I$(n,a),kt("invalid",n)}uS(r,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&ay(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&ay(n.textContent,o,t),i=["children",""+o]):vp.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&kt("scroll",n)}switch(r){case"input":Zg(n),C$(n,a,!0);break;case"textarea":Zg(n),$$(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Nv)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=L3(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=s.createElement(r,{is:n.is}):(t=s.createElement(r),r==="select"&&(s=t,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):t=s.createElementNS(t,r),t[qa]=e,t[Tp]=n,l4(t,e,!1,!1),e.stateNode=t;e:{switch(s=lS(r,n),r){case"dialog":kt("cancel",t),kt("close",t),i=n;break;case"iframe":case"object":case"embed":kt("load",t),i=n;break;case"video":case"audio":for(i=0;i<$f.length;i++)kt($f[i],t);i=n;break;case"source":kt("error",t),i=n;break;case"img":case"image":case"link":kt("error",t),kt("load",t),i=n;break;case"details":kt("toggle",t),i=n;break;case"input":k$(t,n),i=nS(t,n),kt("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Ht({},n,{value:void 0}),kt("invalid",t);break;case"textarea":I$(t,n),i=sS(t,n),kt("invalid",t);break;default:i=n}uS(r,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var u=o[a];a==="style"?z3(t,u):a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&F3(t,u)):a==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&bp(t,u):typeof u=="number"&&bp(t,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(vp.hasOwnProperty(a)?u!=null&&a==="onScroll"&&kt("scroll",t):u!=null&&LA(t,a,u,s))}switch(r){case"input":Zg(t),C$(t,n,!1);break;case"textarea":Zg(t),$$(t);break;case"option":n.value!=null&&t.setAttribute("value",""+lu(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?Jc(t,!!n.multiple,a,!1):n.defaultValue!=null&&Jc(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Nv)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return tn(e),null;case 6:if(t&&e.stateNode!=null)h4(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(he(166));if(r=Xu(Cp.current),Xu(es.current),sy(e)){if(n=e.stateNode,r=e.memoizedProps,n[qa]=e,(a=n.nodeValue!==r)&&(t=hi,t!==null))switch(t.tag){case 3:ay(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ay(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[qa]=e,e.stateNode=n}return tn(e),null;case 13:if($t(zt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Mt&&li!==null&&e.mode&1&&!(e.flags&128))T5(),yh(),e.flags|=98560,a=!1;else if(a=sy(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(he(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(he(317));a[qa]=e}else yh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;tn(e),a=!1}else ha!==null&&(qS(ha),ha=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||zt.current&1?yr===0&&(yr=3):wT())),e.updateQueue!==null&&(e.flags|=4),tn(e),null);case 4:return bh(),NS(t,e),t===null&&Ep(e.stateNode.containerInfo),tn(e),null;case 10:return nT(e.type._context),tn(e),null;case 17:return Vn(e.type)&&Mv(),tn(e),null;case 19:if($t(zt),a=e.memoizedState,a===null)return tn(e),null;if(n=(e.flags&128)!==0,s=a.rendering,s===null)if(n)uf(a,!1);else{if(yr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=qv(t),s!==null){for(e.flags|=128,uf(a,!1),n=s.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,t=s.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return At(zt,zt.current&1|2),e.child}t=t.sibling}a.tail!==null&&er()>_h&&(e.flags|=128,n=!0,uf(a,!1),e.lanes=4194304)}else{if(!n)if(t=qv(s),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),uf(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!Mt)return tn(e),null}else 2*er()-a.renderingStartTime>_h&&r!==1073741824&&(e.flags|=128,n=!0,uf(a,!1),e.lanes=4194304);a.isBackwards?(s.sibling=e.child,e.child=s):(r=a.last,r!==null?r.sibling=s:e.child=s,a.last=s)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=er(),e.sibling=null,r=zt.current,At(zt,n?r&1|2:r&1),e):(tn(e),null);case 22:case 23:return bT(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?ai&1073741824&&(tn(e),e.subtreeFlags&6&&(e.flags|=8192)):tn(e),null;case 24:return null;case 25:return null}throw Error(he(156,e.tag))}function lG(t,e){switch(QA(e),e.tag){case 1:return Vn(e.type)&&Mv(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return bh(),$t(Kn),$t(dn),uT(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return oT(e),null;case 13:if($t(zt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(he(340));yh()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return $t(zt),null;case 4:return bh(),null;case 10:return nT(e.type._context),null;case 22:case 23:return bT(),null;case 24:return null;default:return null}}var ly=!1,sn=!1,cG=typeof WeakSet=="function"?WeakSet:Set,we=null;function Mc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Gt(t,e,n)}else r.current=null}function MS(t,e,r){try{r()}catch(n){Gt(t,e,n)}}var _j=!1;function hG(t,e){if(bS=$v,t=m5(),ZA(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var s=0,o=-1,u=-1,l=0,c=0,h=t,d=null;t:for(;;){for(var f;h!==r||i!==0&&h.nodeType!==3||(o=s+i),h!==a||n!==0&&h.nodeType!==3||(u=s+n),h.nodeType===3&&(s+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===t)break t;if(d===r&&++l===i&&(o=s),d===a&&++c===n&&(u=s),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}r=o===-1||u===-1?null:{start:o,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(wS={focusedElem:t,selectionRange:r},$v=!1,we=e;we!==null;)if(e=we,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,we=t;else for(;we!==null;){e=we;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:aa(e.type,m),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(he(163))}}catch(w){Gt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,we=t;break}we=e.return}return p=_j,_j=!1,p}function ep(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&MS(e,r,a)}i=i.next}while(i!==n)}}function C0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function DS(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function d4(t){var e=t.alternate;e!==null&&(t.alternate=null,d4(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[qa],delete e[Tp],delete e[OS],delete e[WW],delete e[GW])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function f4(t){return t.tag===5||t.tag===3||t.tag===4}function xj(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||f4(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function LS(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Nv));else if(n!==4&&(t=t.child,t!==null))for(LS(t,e,r),t=t.sibling;t!==null;)LS(t,e,r),t=t.sibling}function FS(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(FS(t,e,r),t=t.sibling;t!==null;)FS(t,e,r),t=t.sibling}var Hr=null,oa=!1;function xo(t,e,r){for(r=r.child;r!==null;)p4(t,e,r),r=r.sibling}function p4(t,e,r){if(Qa&&typeof Qa.onCommitFiberUnmount=="function")try{Qa.onCommitFiberUnmount(x0,r)}catch{}switch(r.tag){case 5:sn||Mc(r,e);case 6:var n=Hr,i=oa;Hr=null,xo(t,e,r),Hr=n,oa=i,Hr!==null&&(oa?(t=Hr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Hr.removeChild(r.stateNode));break;case 18:Hr!==null&&(oa?(t=Hr,r=r.stateNode,t.nodeType===8?Q1(t.parentNode,r):t.nodeType===1&&Q1(t,r),Op(t)):Q1(Hr,r.stateNode));break;case 4:n=Hr,i=oa,Hr=r.stateNode.containerInfo,oa=!0,xo(t,e,r),Hr=n,oa=i;break;case 0:case 11:case 14:case 15:if(!sn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&MS(r,e,s),i=i.next}while(i!==n)}xo(t,e,r);break;case 1:if(!sn&&(Mc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Gt(r,e,o)}xo(t,e,r);break;case 21:xo(t,e,r);break;case 22:r.mode&1?(sn=(n=sn)||r.memoizedState!==null,xo(t,e,r),sn=n):xo(t,e,r);break;default:xo(t,e,r)}}function Oj(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new cG),e.forEach(function(n){var i=wG.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Gi(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=t,s=e,o=s;e:for(;o!==null;){switch(o.tag){case 5:Hr=o.stateNode,oa=!1;break e;case 3:Hr=o.stateNode.containerInfo,oa=!0;break e;case 4:Hr=o.stateNode.containerInfo,oa=!0;break e}o=o.return}if(Hr===null)throw Error(he(160));p4(a,s,i),Hr=null,oa=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(l){Gt(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)m4(e,t),e=e.sibling}function m4(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Gi(e,t),Ra(t),n&4){try{ep(3,t,t.return),C0(3,t)}catch(m){Gt(t,t.return,m)}try{ep(5,t,t.return)}catch(m){Gt(t,t.return,m)}}break;case 1:Gi(e,t),Ra(t),n&512&&r!==null&&Mc(r,r.return);break;case 5:if(Gi(e,t),Ra(t),n&512&&r!==null&&Mc(r,r.return),t.flags&32){var i=t.stateNode;try{bp(i,"")}catch(m){Gt(t,t.return,m)}}if(n&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,s=r!==null?r.memoizedProps:a,o=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&M3(i,a),lS(o,s);var l=lS(o,a);for(s=0;s<u.length;s+=2){var c=u[s],h=u[s+1];c==="style"?z3(i,h):c==="dangerouslySetInnerHTML"?F3(i,h):c==="children"?bp(i,h):LA(i,c,h,l)}switch(o){case"input":iS(i,a);break;case"textarea":D3(i,a);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var f=a.value;f!=null?Jc(i,!!a.multiple,f,!1):d!==!!a.multiple&&(a.defaultValue!=null?Jc(i,!!a.multiple,a.defaultValue,!0):Jc(i,!!a.multiple,a.multiple?[]:"",!1))}i[Tp]=a}catch(m){Gt(t,t.return,m)}}break;case 6:if(Gi(e,t),Ra(t),n&4){if(t.stateNode===null)throw Error(he(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(m){Gt(t,t.return,m)}}break;case 3:if(Gi(e,t),Ra(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Op(e.containerInfo)}catch(m){Gt(t,t.return,m)}break;case 4:Gi(e,t),Ra(t);break;case 13:Gi(e,t),Ra(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(yT=er())),n&4&&Oj(t);break;case 22:if(c=r!==null&&r.memoizedState!==null,t.mode&1?(sn=(l=sn)||c,Gi(e,t),sn=l):Gi(e,t),Ra(t),n&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!c&&t.mode&1)for(we=t,c=t.child;c!==null;){for(h=we=c;we!==null;){switch(d=we,f=d.child,d.tag){case 0:case 11:case 14:case 15:ep(4,d,d.return);break;case 1:Mc(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Gt(n,r,m)}}break;case 5:Mc(d,d.return);break;case 22:if(d.memoizedState!==null){Pj(h);continue}}f!==null?(f.return=d,we=f):Pj(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,l?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=h.stateNode,u=h.memoizedProps.style,s=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=U3("display",s))}catch(m){Gt(t,t.return,m)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(m){Gt(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Gi(e,t),Ra(t),n&4&&Oj(t);break;case 21:break;default:Gi(e,t),Ra(t)}}function Ra(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(f4(r)){var n=r;break e}r=r.return}throw Error(he(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(bp(i,""),n.flags&=-33);var a=xj(t);FS(t,a,i);break;case 3:case 4:var s=n.stateNode.containerInfo,o=xj(t);LS(t,o,s);break;default:throw Error(he(161))}}catch(u){Gt(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function dG(t,e,r){we=t,g4(t)}function g4(t,e,r){for(var n=(t.mode&1)!==0;we!==null;){var i=we,a=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||ly;if(!s){var o=i.alternate,u=o!==null&&o.memoizedState!==null||sn;o=ly;var l=sn;if(ly=s,(sn=u)&&!l)for(we=i;we!==null;)s=we,u=s.child,s.tag===22&&s.memoizedState!==null?Ej(i):u!==null?(u.return=s,we=u):Ej(i);for(;a!==null;)we=a,g4(a),a=a.sibling;we=i,ly=o,sn=l}Sj(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,we=a):Sj(t)}}function Sj(t){for(;we!==null;){var e=we;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:sn||C0(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!sn)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:aa(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&oj(e,a,n);break;case 3:var s=e.updateQueue;if(s!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}oj(e,s,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Op(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(he(163))}sn||e.flags&512&&DS(e)}catch(d){Gt(e,e.return,d)}}if(e===t){we=null;break}if(r=e.sibling,r!==null){r.return=e.return,we=r;break}we=e.return}}function Pj(t){for(;we!==null;){var e=we;if(e===t){we=null;break}var r=e.sibling;if(r!==null){r.return=e.return,we=r;break}we=e.return}}function Ej(t){for(;we!==null;){var e=we;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{C0(4,e)}catch(u){Gt(e,r,u)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(u){Gt(e,i,u)}}var a=e.return;try{DS(e)}catch(u){Gt(e,a,u)}break;case 5:var s=e.return;try{DS(e)}catch(u){Gt(e,s,u)}}}catch(u){Gt(e,e.return,u)}if(e===t){we=null;break}var o=e.sibling;if(o!==null){o.return=e.return,we=o;break}we=e.return}}var fG=Math.ceil,Hv=uo.ReactCurrentDispatcher,mT=uo.ReactCurrentOwner,Li=uo.ReactCurrentBatchConfig,et=0,Rr=null,ur=null,Yr=0,ai=0,Dc=bu(0),yr=0,Rp=null,xl=0,I0=0,gT=0,tp=null,Fn=null,yT=0,_h=1/0,$s=null,Wv=!1,US=null,eu=null,cy=!1,qo=null,Gv=0,rp=0,zS=null,ov=-1,uv=0;function Tn(){return et&6?er():ov!==-1?ov:ov=er()}function tu(t){return t.mode&1?et&2&&Yr!==0?Yr&-Yr:JW.transition!==null?(uv===0&&(uv=Q3()),uv):(t=dt,t!==0||(t=window.event,t=t===void 0?16:s5(t.type)),t):1}function ba(t,e,r,n){if(50<rp)throw rp=0,zS=null,Error(he(185));ig(t,r,n),(!(et&2)||t!==Rr)&&(t===Rr&&(!(et&2)&&(I0|=r),yr===4&&Do(t,Yr)),Hn(t,n),r===1&&et===0&&!(e.mode&1)&&(_h=er()+500,A0&&wu()))}function Hn(t,e){var r=t.callbackNode;JH(t,e);var n=Iv(t,t===Rr?Yr:0);if(n===0)r!==null&&N$(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&N$(r),e===1)t.tag===0?YW(Aj.bind(null,t)):P5(Aj.bind(null,t)),VW(function(){!(et&6)&&wu()}),r=null;else{switch(e5(n)){case 1:r=qA;break;case 4:r=Z3;break;case 16:r=Cv;break;case 536870912:r=X3;break;default:r=Cv}r=S4(r,y4.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function y4(t,e){if(ov=-1,uv=0,et&6)throw Error(he(327));var r=t.callbackNode;if(th()&&t.callbackNode!==r)return null;var n=Iv(t,t===Rr?Yr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Yv(t,n);else{e=n;var i=et;et|=2;var a=b4();(Rr!==t||Yr!==e)&&($s=null,_h=er()+500,ll(t,e));do try{gG();break}catch(o){v4(t,o)}while(1);rT(),Hv.current=a,et=i,ur!==null?e=0:(Rr=null,Yr=0,e=yr)}if(e!==0){if(e===2&&(i=pS(t),i!==0&&(n=i,e=BS(t,i))),e===1)throw r=Rp,ll(t,0),Do(t,n),Hn(t,er()),r;if(e===6)Do(t,n);else{if(i=t.current.alternate,!(n&30)&&!pG(i)&&(e=Yv(t,n),e===2&&(a=pS(t),a!==0&&(n=a,e=BS(t,a))),e===1))throw r=Rp,ll(t,0),Do(t,n),Hn(t,er()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(he(345));case 2:Du(t,Fn,$s);break;case 3:if(Do(t,n),(n&130023424)===n&&(e=yT+500-er(),10<e)){if(Iv(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Tn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=xS(Du.bind(null,t,Fn,$s),e);break}Du(t,Fn,$s);break;case 4:if(Do(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var s=31-va(n);a=1<<s,s=e[s],s>i&&(i=s),n&=~a}if(n=i,n=er()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*fG(n/1960))-n,10<n){t.timeoutHandle=xS(Du.bind(null,t,Fn,$s),n);break}Du(t,Fn,$s);break;case 5:Du(t,Fn,$s);break;default:throw Error(he(329))}}}return Hn(t,er()),t.callbackNode===r?y4.bind(null,t):null}function BS(t,e){var r=tp;return t.current.memoizedState.isDehydrated&&(ll(t,e).flags|=256),t=Yv(t,e),t!==2&&(e=Fn,Fn=r,e!==null&&qS(e)),t}function qS(t){Fn===null?Fn=t:Fn.push.apply(Fn,t)}function pG(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Oa(a(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Do(t,e){for(e&=~gT,e&=~I0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-va(e),n=1<<r;t[r]=-1,e&=~n}}function Aj(t){if(et&6)throw Error(he(327));th();var e=Iv(t,0);if(!(e&1))return Hn(t,er()),null;var r=Yv(t,e);if(t.tag!==0&&r===2){var n=pS(t);n!==0&&(e=n,r=BS(t,n))}if(r===1)throw r=Rp,ll(t,0),Do(t,e),Hn(t,er()),r;if(r===6)throw Error(he(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Du(t,Fn,$s),Hn(t,er()),null}function vT(t,e){var r=et;et|=1;try{return t(e)}finally{et=r,et===0&&(_h=er()+500,A0&&wu())}}function Ol(t){qo!==null&&qo.tag===0&&!(et&6)&&th();var e=et;et|=1;var r=Li.transition,n=dt;try{if(Li.transition=null,dt=1,t)return t()}finally{dt=n,Li.transition=r,et=e,!(et&6)&&wu()}}function bT(){ai=Dc.current,$t(Dc)}function ll(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,KW(r)),ur!==null)for(r=ur.return;r!==null;){var n=r;switch(QA(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Mv();break;case 3:bh(),$t(Kn),$t(dn),uT();break;case 5:oT(n);break;case 4:bh();break;case 13:$t(zt);break;case 19:$t(zt);break;case 10:nT(n.type._context);break;case 22:case 23:bT()}r=r.return}if(Rr=t,ur=t=ru(t.current,null),Yr=ai=e,yr=0,Rp=null,gT=I0=xl=0,Fn=tp=null,Zu!==null){for(e=0;e<Zu.length;e++)if(r=Zu[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var s=a.next;a.next=i,n.next=s}r.pending=n}Zu=null}return t}function v4(t,e){do{var r=ur;try{if(rT(),iv.current=Vv,Kv){for(var n=Kt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Kv=!1}if(_l=0,kr=fr=Kt=null,Qf=!1,Ip=0,mT.current=null,r===null||r.return===null){yr=1,Rp=e,ur=null;break}e:{var a=t,s=r.return,o=r,u=e;if(e=Yr,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=o,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=pj(s);if(f!==null){f.flags&=-257,mj(f,s,o,a,e),f.mode&1&&fj(a,l,e),e=f,u=l;var p=e.updateQueue;if(p===null){var m=new Set;m.add(u),e.updateQueue=m}else p.add(u);break e}else{if(!(e&1)){fj(a,l,e),wT();break e}u=Error(he(426))}}else if(Mt&&o.mode&1){var g=pj(s);if(g!==null){!(g.flags&65536)&&(g.flags|=256),mj(g,s,o,a,e),eT(wh(u,o));break e}}a=u=wh(u,o),yr!==4&&(yr=2),tp===null?tp=[a]:tp.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var v=t4(a,u,e);sj(a,v);break e;case 1:o=u;var y=a.type,b=a.stateNode;if(!(a.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(eu===null||!eu.has(b)))){a.flags|=65536,e&=-e,a.lanes|=e;var w=r4(a,o,e);sj(a,w);break e}}a=a.return}while(a!==null)}_4(r)}catch(_){e=_,ur===r&&r!==null&&(ur=r=r.return);continue}break}while(1)}function b4(){var t=Hv.current;return Hv.current=Vv,t===null?Vv:t}function wT(){(yr===0||yr===3||yr===2)&&(yr=4),Rr===null||!(xl&268435455)&&!(I0&268435455)||Do(Rr,Yr)}function Yv(t,e){var r=et;et|=2;var n=b4();(Rr!==t||Yr!==e)&&($s=null,ll(t,e));do try{mG();break}catch(i){v4(t,i)}while(1);if(rT(),et=r,Hv.current=n,ur!==null)throw Error(he(261));return Rr=null,Yr=0,yr}function mG(){for(;ur!==null;)w4(ur)}function gG(){for(;ur!==null&&!zH();)w4(ur)}function w4(t){var e=O4(t.alternate,t,ai);t.memoizedProps=t.pendingProps,e===null?_4(t):ur=e,mT.current=null}function _4(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=lG(r,e),r!==null){r.flags&=32767,ur=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{yr=6,ur=null;return}}else if(r=uG(r,e,ai),r!==null){ur=r;return}if(e=e.sibling,e!==null){ur=e;return}ur=e=t}while(e!==null);yr===0&&(yr=5)}function Du(t,e,r){var n=dt,i=Li.transition;try{Li.transition=null,dt=1,yG(t,e,r,n)}finally{Li.transition=i,dt=n}return null}function yG(t,e,r,n){do th();while(qo!==null);if(et&6)throw Error(he(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(he(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(ZH(t,a),t===Rr&&(ur=Rr=null,Yr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||cy||(cy=!0,S4(Cv,function(){return th(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Li.transition,Li.transition=null;var s=dt;dt=1;var o=et;et|=4,mT.current=null,hG(t,r),m4(r,t),DW(wS),$v=!!bS,wS=bS=null,t.current=r,dG(r),BH(),et=o,dt=s,Li.transition=a}else t.current=r;if(cy&&(cy=!1,qo=t,Gv=i),a=t.pendingLanes,a===0&&(eu=null),VH(r.stateNode),Hn(t,er()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Wv)throw Wv=!1,t=US,US=null,t;return Gv&1&&t.tag!==0&&th(),a=t.pendingLanes,a&1?t===zS?rp++:(rp=0,zS=t):rp=0,wu(),null}function th(){if(qo!==null){var t=e5(Gv),e=Li.transition,r=dt;try{if(Li.transition=null,dt=16>t?16:t,qo===null)var n=!1;else{if(t=qo,qo=null,Gv=0,et&6)throw Error(he(331));var i=et;for(et|=4,we=t.current;we!==null;){var a=we,s=a.child;if(we.flags&16){var o=a.deletions;if(o!==null){for(var u=0;u<o.length;u++){var l=o[u];for(we=l;we!==null;){var c=we;switch(c.tag){case 0:case 11:case 15:ep(8,c,a)}var h=c.child;if(h!==null)h.return=c,we=h;else for(;we!==null;){c=we;var d=c.sibling,f=c.return;if(d4(c),c===l){we=null;break}if(d!==null){d.return=f,we=d;break}we=f}}}var p=a.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}we=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,we=s;else e:for(;we!==null;){if(a=we,a.flags&2048)switch(a.tag){case 0:case 11:case 15:ep(9,a,a.return)}var v=a.sibling;if(v!==null){v.return=a.return,we=v;break e}we=a.return}}var y=t.current;for(we=y;we!==null;){s=we;var b=s.child;if(s.subtreeFlags&2064&&b!==null)b.return=s,we=b;else e:for(s=y;we!==null;){if(o=we,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:C0(9,o)}}catch(_){Gt(o,o.return,_)}if(o===s){we=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,we=w;break e}we=o.return}}if(et=i,wu(),Qa&&typeof Qa.onPostCommitFiberRoot=="function")try{Qa.onPostCommitFiberRoot(x0,t)}catch{}n=!0}return n}finally{dt=r,Li.transition=e}}return!1}function Tj(t,e,r){e=wh(r,e),e=t4(t,e,1),t=Qo(t,e,1),e=Tn(),t!==null&&(ig(t,1,e),Hn(t,e))}function Gt(t,e,r){if(t.tag===3)Tj(t,t,r);else for(;e!==null;){if(e.tag===3){Tj(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(eu===null||!eu.has(n))){t=wh(r,t),t=r4(e,t,1),e=Qo(e,t,1),t=Tn(),e!==null&&(ig(e,1,t),Hn(e,t));break}}e=e.return}}function vG(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Tn(),t.pingedLanes|=t.suspendedLanes&r,Rr===t&&(Yr&r)===r&&(yr===4||yr===3&&(Yr&130023424)===Yr&&500>er()-yT?ll(t,0):gT|=r),Hn(t,e)}function x4(t,e){e===0&&(t.mode&1?(e=ey,ey<<=1,!(ey&130023424)&&(ey=4194304)):e=1);var r=Tn();t=Js(t,e),t!==null&&(ig(t,e,r),Hn(t,r))}function bG(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),x4(t,r)}function wG(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(he(314))}n!==null&&n.delete(e),x4(t,r)}var O4;O4=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Kn.current)zn=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return zn=!1,oG(t,e,r);zn=!!(t.flags&131072)}else zn=!1,Mt&&e.flags&1048576&&E5(e,Fv,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;sv(t,e),t=e.pendingProps;var i=gh(e,dn.current);eh(e,r),i=cT(null,e,n,t,i,r);var a=hT();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Vn(n)?(a=!0,Dv(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,aT(e),i.updater=T0,e.stateNode=i,i._reactInternals=e,kS(e,n,t,r),e=$S(null,e,n,!0,a,r)):(e.tag=0,Mt&&a&&XA(e),wn(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(sv(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=xG(n),t=aa(n,t),i){case 0:e=IS(null,e,n,t,r);break e;case 1:e=vj(null,e,n,t,r);break e;case 11:e=gj(null,e,n,t,r);break e;case 14:e=yj(null,e,n,aa(n.type,t),r);break e}throw Error(he(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:aa(n,i),IS(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:aa(n,i),vj(t,e,n,i,r);case 3:e:{if(s4(e),t===null)throw Error(he(387));n=e.pendingProps,a=e.memoizedState,i=a.element,C5(t,e),Bv(e,n,null,r);var s=e.memoizedState;if(n=s.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=wh(Error(he(423)),e),e=bj(t,e,n,r,i);break e}else if(n!==i){i=wh(Error(he(424)),e),e=bj(t,e,n,r,i);break e}else for(li=Xo(e.stateNode.containerInfo.firstChild),hi=e,Mt=!0,ha=null,r=R5(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(yh(),n===i){e=Zs(t,e,r);break e}wn(t,e,n,r)}e=e.child}return e;case 5:return N5(e),t===null&&ES(e),n=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,s=i.children,_S(n,i)?s=null:a!==null&&_S(n,a)&&(e.flags|=32),a4(t,e),wn(t,e,s,r),e.child;case 6:return t===null&&ES(e),null;case 13:return o4(t,e,r);case 4:return sT(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=vh(e,null,n,r):wn(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:aa(n,i),gj(t,e,n,i,r);case 7:return wn(t,e,e.pendingProps,r),e.child;case 8:return wn(t,e,e.pendingProps.children,r),e.child;case 12:return wn(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,a=e.memoizedProps,s=i.value,At(Uv,n._currentValue),n._currentValue=s,a!==null)if(Oa(a.value,s)){if(a.children===i.children&&!Kn.current){e=Zs(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var u=o.firstContext;u!==null;){if(u.context===n){if(a.tag===1){u=qs(-1,r&-r),u.tag=2;var l=a.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}a.lanes|=r,u=a.alternate,u!==null&&(u.lanes|=r),AS(a.return,r,e),o.lanes|=r;break}u=u.next}}else if(a.tag===10)s=a.type===e.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(he(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),AS(s,r,e),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===e){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}wn(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,eh(e,r),i=zi(i),n=n(i),e.flags|=1,wn(t,e,n,r),e.child;case 14:return n=e.type,i=aa(n,e.pendingProps),i=aa(n.type,i),yj(t,e,n,i,r);case 15:return n4(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:aa(n,i),sv(t,e),e.tag=1,Vn(n)?(t=!0,Dv(e)):t=!1,eh(e,r),$5(e,n,i),kS(e,n,i,r),$S(null,e,n,!0,t,r);case 19:return u4(t,e,r);case 22:return i4(t,e,r)}throw Error(he(156,e.tag))};function S4(t,e){return J3(t,e)}function _G(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ni(t,e,r,n){return new _G(t,e,r,n)}function _T(t){return t=t.prototype,!(!t||!t.isReactComponent)}function xG(t){if(typeof t=="function")return _T(t)?1:0;if(t!=null){if(t=t.$$typeof,t===UA)return 11;if(t===zA)return 14}return 2}function ru(t,e){var r=t.alternate;return r===null?(r=Ni(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function lv(t,e,r,n,i,a){var s=2;if(n=t,typeof t=="function")_T(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case Ac:return cl(r.children,i,a,e);case FA:s=8,i|=8;break;case QO:return t=Ni(12,r,e,i|2),t.elementType=QO,t.lanes=a,t;case eS:return t=Ni(13,r,e,i),t.elementType=eS,t.lanes=a,t;case tS:return t=Ni(19,r,e,i),t.elementType=tS,t.lanes=a,t;case j3:return $0(r,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case I3:s=10;break e;case $3:s=9;break e;case UA:s=11;break e;case zA:s=14;break e;case Co:s=16,n=null;break e}throw Error(he(130,t==null?t:typeof t,""))}return e=Ni(s,r,e,i),e.elementType=t,e.type=n,e.lanes=a,e}function cl(t,e,r,n){return t=Ni(7,t,n,e),t.lanes=r,t}function $0(t,e,r,n){return t=Ni(22,t,n,e),t.elementType=j3,t.lanes=r,t.stateNode={isHidden:!1},t}function ox(t,e,r){return t=Ni(6,t,null,e),t.lanes=r,t}function ux(t,e,r){return e=Ni(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function OG(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=B1(0),this.expirationTimes=B1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=B1(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function xT(t,e,r,n,i,a,s,o,u){return t=new OG(t,e,r,o,u),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Ni(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},aT(a),t}function SG(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ec,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function P4(t){if(!t)return cu;t=t._reactInternals;e:{if(Ul(t)!==t||t.tag!==1)throw Error(he(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Vn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(he(171))}if(t.tag===1){var r=t.type;if(Vn(r))return S5(t,r,e)}return e}function E4(t,e,r,n,i,a,s,o,u){return t=xT(r,n,!0,t,i,a,s,o,u),t.context=P4(null),r=t.current,n=Tn(),i=tu(r),a=qs(n,i),a.callback=e??null,Qo(r,a,i),t.current.lanes=i,ig(t,i,n),Hn(t,n),t}function j0(t,e,r,n){var i=e.current,a=Tn(),s=tu(i);return r=P4(r),e.context===null?e.context=r:e.pendingContext=r,e=qs(a,s),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Qo(i,e,s),t!==null&&(ba(t,i,s,a),nv(t,i,s)),s}function Jv(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function kj(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function OT(t,e){kj(t,e),(t=t.alternate)&&kj(t,e)}function PG(){return null}var A4=typeof reportError=="function"?reportError:function(t){console.error(t)};function ST(t){this._internalRoot=t}R0.prototype.render=ST.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(he(409));j0(t,e,null,null)};R0.prototype.unmount=ST.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ol(function(){j0(null,t,null,null)}),e[Ys]=null}};function R0(t){this._internalRoot=t}R0.prototype.unstable_scheduleHydration=function(t){if(t){var e=n5();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Mo.length&&e!==0&&e<Mo[r].priority;r++);Mo.splice(r,0,t),r===0&&a5(t)}};function PT(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function N0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Cj(){}function EG(t,e,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var l=Jv(s);a.call(l)}}var s=E4(e,n,t,0,null,!1,!1,"",Cj);return t._reactRootContainer=s,t[Ys]=s.current,Ep(t.nodeType===8?t.parentNode:t),Ol(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var l=Jv(u);o.call(l)}}var u=xT(t,0,!1,null,null,!1,!1,"",Cj);return t._reactRootContainer=u,t[Ys]=u.current,Ep(t.nodeType===8?t.parentNode:t),Ol(function(){j0(e,u,r,n)}),u}function M0(t,e,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var u=Jv(s);o.call(u)}}j0(e,s,t,i)}else s=EG(r,e,t,i,n);return Jv(s)}t5=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=If(e.pendingLanes);r!==0&&(KA(e,r|1),Hn(e,er()),!(et&6)&&(_h=er()+500,wu()))}break;case 13:Ol(function(){var n=Js(t,1);if(n!==null){var i=Tn();ba(n,t,1,i)}}),OT(t,1)}};VA=function(t){if(t.tag===13){var e=Js(t,134217728);if(e!==null){var r=Tn();ba(e,t,134217728,r)}OT(t,134217728)}};r5=function(t){if(t.tag===13){var e=tu(t),r=Js(t,e);if(r!==null){var n=Tn();ba(r,t,e,n)}OT(t,e)}};n5=function(){return dt};i5=function(t,e){var r=dt;try{return dt=t,e()}finally{dt=r}};hS=function(t,e,r){switch(e){case"input":if(iS(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=E0(n);if(!i)throw Error(he(90));N3(n),iS(n,i)}}}break;case"textarea":D3(t,r);break;case"select":e=r.value,e!=null&&Jc(t,!!r.multiple,e,!1)}};K3=vT;V3=Ol;var AG={usingClientEntryPoint:!1,Events:[sg,Ic,E0,B3,q3,vT]},lf={findFiberByHostInstance:Ju,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},TG={bundleType:lf.bundleType,version:lf.version,rendererPackageName:lf.rendererPackageName,rendererConfig:lf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:uo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=G3(t),t===null?null:t.stateNode},findFiberByHostInstance:lf.findFiberByHostInstance||PG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hy.isDisabled&&hy.supportsFiber)try{x0=hy.inject(TG),Qa=hy}catch{}}gi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AG;gi.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!PT(e))throw Error(he(200));return SG(t,e,null,r)};gi.createRoot=function(t,e){if(!PT(t))throw Error(he(299));var r=!1,n="",i=A4;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=xT(t,1,!1,null,null,r,!1,n,i),t[Ys]=e.current,Ep(t.nodeType===8?t.parentNode:t),new ST(e)};gi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(he(188)):(t=Object.keys(t).join(","),Error(he(268,t)));return t=G3(e),t=t===null?null:t.stateNode,t};gi.flushSync=function(t){return Ol(t)};gi.hydrate=function(t,e,r){if(!N0(e))throw Error(he(200));return M0(null,t,e,!0,r)};gi.hydrateRoot=function(t,e,r){if(!PT(t))throw Error(he(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",s=A4;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),e=E4(e,null,t,1,r??null,i,!1,a,s),t[Ys]=e.current,Ep(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new R0(e)};gi.render=function(t,e,r){if(!N0(e))throw Error(he(200));return M0(null,t,e,!1,r)};gi.unmountComponentAtNode=function(t){if(!N0(t))throw Error(he(40));return t._reactRootContainer?(Ol(function(){M0(null,null,t,!1,function(){t._reactRootContainer=null,t[Ys]=null})}),!0):!1};gi.unstable_batchedUpdates=vT;gi.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!N0(r))throw Error(he(200));if(t==null||t._reactInternals===void 0)throw Error(he(38));return M0(t,e,r,!1,n)};gi.version="18.2.0-next-9e3b772b8-20220608";function T4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(T4)}catch(t){console.error(t)}}T4(),E3.exports=gi;var ET=E3.exports,Ij=ET;ZO.createRoot=Ij.createRoot,ZO.hydrateRoot=Ij.hydrateRoot;/**
 * @remix-run/router v1.6.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Np(){return Np=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Np.apply(this,arguments)}var Ko;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ko||(Ko={}));const $j="popstate";function kG(t){t===void 0&&(t={});function e(n,i){let{pathname:a,search:s,hash:o}=n.location;return KS("",{pathname:a,search:s,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Zv(i)}return IG(e,r,null,t)}function nr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function AT(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function CG(){return Math.random().toString(36).substr(2,8)}function jj(t,e){return{usr:t.state,key:t.key,idx:e}}function KS(t,e,r,n){return r===void 0&&(r=null),Np({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ld(e):e,{state:r,key:e&&e.key||n||CG()})}function Zv(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ld(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function IG(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:a=!1}=n,s=i.history,o=Ko.Pop,u=null,l=c();l==null&&(l=0,s.replaceState(Np({},s.state,{idx:l}),""));function c(){return(s.state||{idx:null}).idx}function h(){o=Ko.Pop;let g=c(),v=g==null?null:g-l;l=g,u&&u({action:o,location:m.location,delta:v})}function d(g,v){o=Ko.Push;let y=KS(m.location,g,v);r&&r(y,g),l=c()+1;let b=jj(y,l),w=m.createHref(y);try{s.pushState(b,"",w)}catch{i.location.assign(w)}a&&u&&u({action:o,location:m.location,delta:1})}function f(g,v){o=Ko.Replace;let y=KS(m.location,g,v);r&&r(y,g),l=c();let b=jj(y,l),w=m.createHref(y);s.replaceState(b,"",w),a&&u&&u({action:o,location:m.location,delta:0})}function p(g){let v=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof g=="string"?g:Zv(g);return nr(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let m={get action(){return o},get location(){return t(i,s)},listen(g){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener($j,h),u=g,()=>{i.removeEventListener($j,h),u=null}},createHref(g){return e(i,g)},createURL:p,encodeLocation(g){let v=p(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:d,replace:f,go(g){return s.go(g)}};return m}var Rj;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Rj||(Rj={}));function $G(t,e,r){r===void 0&&(r="/");let n=typeof e=="string"?ld(e):e,i=TT(n.pathname||"/",r);if(i==null)return null;let a=k4(t);jG(a);let s=null;for(let o=0;s==null&&o<a.length;++o)s=BG(a[o],VG(i));return s}function k4(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(a,s,o)=>{let u={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:s,route:a};u.relativePath.startsWith("/")&&(nr(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let l=nu([n,u.relativePath]),c=r.concat(u);a.children&&a.children.length>0&&(nr(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),k4(a.children,e,c,l)),!(a.path==null&&!a.index)&&e.push({path:l,score:UG(l,a.index),routesMeta:c})};return t.forEach((a,s)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))i(a,s);else for(let u of C4(a.path))i(a,s,u)}),e}function C4(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let s=C4(n.join("/")),o=[];return o.push(...s.map(u=>u===""?a:[a,u].join("/"))),i&&o.push(...s),o.map(u=>t.startsWith("/")&&u===""?"/":u)}function jG(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:zG(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const RG=/^:\w+$/,NG=3,MG=2,DG=1,LG=10,FG=-2,Nj=t=>t==="*";function UG(t,e){let r=t.split("/"),n=r.length;return r.some(Nj)&&(n+=FG),e&&(n+=MG),r.filter(i=>!Nj(i)).reduce((i,a)=>i+(RG.test(a)?NG:a===""?DG:LG),n)}function zG(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function BG(t,e){let{routesMeta:r}=t,n={},i="/",a=[];for(let s=0;s<r.length;++s){let o=r[s],u=s===r.length-1,l=i==="/"?e:e.slice(i.length)||"/",c=qG({path:o.relativePath,caseSensitive:o.caseSensitive,end:u},l);if(!c)return null;Object.assign(n,c.params);let h=o.route;a.push({params:n,pathname:nu([i,c.pathname]),pathnameBase:YG(nu([i,c.pathnameBase])),route:h}),c.pathnameBase!=="/"&&(i=nu([i,c.pathnameBase]))}return a}function qG(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=KG(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let a=i[0],s=a.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((l,c,h)=>{if(c==="*"){let d=o[h]||"";s=a.slice(0,a.length-d.length).replace(/(.)\/+$/,"$1")}return l[c]=HG(o[h]||"",c),l},{}),pathname:a,pathnameBase:s,pattern:t}}function KG(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),AT(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(s,o)=>(n.push(o),"/([^\\/]+)"));return t.endsWith("*")?(n.push("*"),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function VG(t){try{return decodeURI(t)}catch(e){return AT(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function HG(t,e){try{return decodeURIComponent(t)}catch(r){return AT(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),t}}function TT(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function WG(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?ld(t):t;return{pathname:r?r.startsWith("/")?r:GG(r,e):e,search:JG(n),hash:ZG(i)}}function GG(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function lx(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function kT(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function CT(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=ld(t):(i=Np({},t),nr(!i.pathname||!i.pathname.includes("?"),lx("?","pathname","search",i)),nr(!i.pathname||!i.pathname.includes("#"),lx("#","pathname","hash",i)),nr(!i.search||!i.search.includes("#"),lx("#","search","hash",i)));let a=t===""||i.pathname==="",s=a?"/":i.pathname,o;if(n||s==null)o=r;else{let h=e.length-1;if(s.startsWith("..")){let d=s.split("/");for(;d[0]==="..";)d.shift(),h-=1;i.pathname=d.join("/")}o=h>=0?e[h]:"/"}let u=WG(i,o),l=s&&s!=="/"&&s.endsWith("/"),c=(a||s===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(l||c)&&(u.pathname+="/"),u}const nu=t=>t.join("/").replace(/\/\/+/g,"/"),YG=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),JG=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,ZG=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function XG(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const I4=["post","put","patch","delete"];new Set(I4);const QG=["get",...I4];new Set(QG);/**
 * React Router v6.11.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xv(){return Xv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Xv.apply(this,arguments)}const $4=I.createContext(null),j4=I.createContext(null),zl=I.createContext(null),D0=I.createContext(null),ps=I.createContext({outlet:null,matches:[],isDataRoute:!1}),R4=I.createContext(null);function eY(t,e){let{relative:r}=e===void 0?{}:e;cd()||nr(!1);let{basename:n,navigator:i}=I.useContext(zl),{hash:a,pathname:s,search:o}=IT(t,{relative:r}),u=s;return n!=="/"&&(u=s==="/"?n:nu([n,s])),i.createHref({pathname:u,search:o,hash:a})}function cd(){return I.useContext(D0)!=null}function Bl(){return cd()||nr(!1),I.useContext(D0).location}function N4(t){I.useContext(zl).static||I.useLayoutEffect(t)}function Ta(){let{isDataRoute:t}=I.useContext(ps);return t?gY():tY()}function tY(){cd()||nr(!1);let{basename:t,navigator:e}=I.useContext(zl),{matches:r}=I.useContext(ps),{pathname:n}=Bl(),i=JSON.stringify(kT(r).map(o=>o.pathnameBase)),a=I.useRef(!1);return N4(()=>{a.current=!0}),I.useCallback(function(o,u){if(u===void 0&&(u={}),!a.current)return;if(typeof o=="number"){e.go(o);return}let l=CT(o,JSON.parse(i),n,u.relative==="path");t!=="/"&&(l.pathname=l.pathname==="/"?t:nu([t,l.pathname])),(u.replace?e.replace:e.push)(l,u.state,u)},[t,e,i,n])}const rY=I.createContext(null);function nY(t){let e=I.useContext(ps).outlet;return e&&I.createElement(rY.Provider,{value:t},e)}function iY(){let{matches:t}=I.useContext(ps),e=t[t.length-1];return e?e.params:{}}function IT(t,e){let{relative:r}=e===void 0?{}:e,{matches:n}=I.useContext(ps),{pathname:i}=Bl(),a=JSON.stringify(kT(n).map(s=>s.pathnameBase));return I.useMemo(()=>CT(t,JSON.parse(a),i,r==="path"),[t,a,i,r])}function aY(t,e){return sY(t,e)}function sY(t,e,r){cd()||nr(!1);let{navigator:n}=I.useContext(zl),{matches:i}=I.useContext(ps),a=i[i.length-1],s=a?a.params:{};a&&a.pathname;let o=a?a.pathnameBase:"/";a&&a.route;let u=Bl(),l;if(e){var c;let m=typeof e=="string"?ld(e):e;o==="/"||(c=m.pathname)!=null&&c.startsWith(o)||nr(!1),l=m}else l=u;let h=l.pathname||"/",d=o==="/"?h:h.slice(o.length)||"/",f=$G(t,{pathname:d}),p=hY(f&&f.map(m=>Object.assign({},m,{params:Object.assign({},s,m.params),pathname:nu([o,n.encodeLocation?n.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?o:nu([o,n.encodeLocation?n.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),i,r);return e&&p?I.createElement(D0.Provider,{value:{location:Xv({pathname:"/",search:"",hash:"",state:null,key:"default"},l),navigationType:Ko.Pop}},p):p}function oY(){let t=mY(),e=XG(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},a=null;return I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},e),r?I.createElement("pre",{style:i},r):null,a)}const uY=I.createElement(oY,null);class lY extends I.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error?I.createElement(ps.Provider,{value:this.props.routeContext},I.createElement(R4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function cY(t){let{routeContext:e,match:r,children:n}=t,i=I.useContext($4);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),I.createElement(ps.Provider,{value:e},n)}function hY(t,e,r){var n;if(e===void 0&&(e=[]),r===void 0&&(r=null),t==null){var i;if((i=r)!=null&&i.errors)t=r.matches;else return null}let a=t,s=(n=r)==null?void 0:n.errors;if(s!=null){let o=a.findIndex(u=>u.route.id&&(s==null?void 0:s[u.route.id]));o>=0||nr(!1),a=a.slice(0,Math.min(a.length,o+1))}return a.reduceRight((o,u,l)=>{let c=u.route.id?s==null?void 0:s[u.route.id]:null,h=null;r&&(h=u.route.errorElement||uY);let d=e.concat(a.slice(0,l+1)),f=()=>{let p;return c?p=h:u.route.Component?p=I.createElement(u.route.Component,null):u.route.element?p=u.route.element:p=o,I.createElement(cY,{match:u,routeContext:{outlet:o,matches:d,isDataRoute:r!=null},children:p})};return r&&(u.route.ErrorBoundary||u.route.errorElement||l===0)?I.createElement(lY,{location:r.location,revalidation:r.revalidation,component:h,error:c,children:f(),routeContext:{outlet:null,matches:d,isDataRoute:!0}}):f()},null)}var VS;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(VS||(VS={}));var Mp;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(Mp||(Mp={}));function dY(t){let e=I.useContext($4);return e||nr(!1),e}function fY(t){let e=I.useContext(j4);return e||nr(!1),e}function pY(t){let e=I.useContext(ps);return e||nr(!1),e}function M4(t){let e=pY(),r=e.matches[e.matches.length-1];return r.route.id||nr(!1),r.route.id}function mY(){var t;let e=I.useContext(R4),r=fY(Mp.UseRouteError),n=M4(Mp.UseRouteError);return e||((t=r.errors)==null?void 0:t[n])}function gY(){let{router:t}=dY(VS.UseNavigateStable),e=M4(Mp.UseNavigateStable),r=I.useRef(!1);return N4(()=>{r.current=!0}),I.useCallback(function(i,a){a===void 0&&(a={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Xv({fromRouteId:e},a)))},[t,e])}function yY(t){let{to:e,replace:r,state:n,relative:i}=t;cd()||nr(!1);let{matches:a}=I.useContext(ps),{pathname:s}=Bl(),o=Ta(),u=CT(e,kT(a).map(c=>c.pathnameBase),s,i==="path"),l=JSON.stringify(u);return I.useEffect(()=>o(JSON.parse(l),{replace:r,state:n,relative:i}),[o,l,i,r,n]),null}function vY(t){return nY(t.context)}function Mn(t){nr(!1)}function bY(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Ko.Pop,navigator:a,static:s=!1}=t;cd()&&nr(!1);let o=e.replace(/^\/*/,"/"),u=I.useMemo(()=>({basename:o,navigator:a,static:s}),[o,a,s]);typeof n=="string"&&(n=ld(n));let{pathname:l="/",search:c="",hash:h="",state:d=null,key:f="default"}=n,p=I.useMemo(()=>{let m=TT(l,o);return m==null?null:{location:{pathname:m,search:c,hash:h,state:d,key:f},navigationType:i}},[o,l,c,h,d,f,i]);return p==null?null:I.createElement(zl.Provider,{value:u},I.createElement(D0.Provider,{children:r,value:p}))}function wY(t){let{children:e,location:r}=t;return aY(HS(e),r)}var Mj;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(Mj||(Mj={}));new Promise(()=>{});function HS(t,e){e===void 0&&(e=[]);let r=[];return I.Children.forEach(t,(n,i)=>{if(!I.isValidElement(n))return;let a=[...e,i];if(n.type===I.Fragment){r.push.apply(r,HS(n.props.children,a));return}n.type!==Mn&&nr(!1),!n.props.index||!n.props.children||nr(!1);let s={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=HS(n.props.children,a)),r.push(s)}),r}/**
 * React Router DOM v6.11.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qv(){return Qv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Qv.apply(this,arguments)}function D4(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function _Y(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function xY(t,e){return t.button===0&&(!e||e==="_self")&&!_Y(t)}function WS(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function OY(t,e){let r=WS(t);if(e)for(let n of e.keys())r.has(n)||e.getAll(n).forEach(i=>{r.append(n,i)});return r}const SY=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],PY=["aria-current","caseSensitive","className","end","style","to","children"];function EY(t){let{basename:e,children:r,window:n}=t,i=I.useRef();i.current==null&&(i.current=kG({window:n,v5Compat:!0}));let a=i.current,[s,o]=I.useState({action:a.action,location:a.location});return I.useLayoutEffect(()=>a.listen(o),[a]),I.createElement(bY,{basename:e,children:r,location:s.location,navigationType:s.action,navigator:a})}const AY=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",TY=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,L4=I.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:a,replace:s,state:o,target:u,to:l,preventScrollReset:c}=e,h=D4(e,SY),{basename:d}=I.useContext(zl),f,p=!1;if(typeof l=="string"&&TY.test(l)&&(f=l,AY))try{let y=new URL(window.location.href),b=l.startsWith("//")?new URL(y.protocol+l):new URL(l),w=TT(b.pathname,d);b.origin===y.origin&&w!=null?l=w+b.search+b.hash:p=!0}catch{}let m=eY(l,{relative:i}),g=CY(l,{replace:s,state:o,target:u,preventScrollReset:c,relative:i});function v(y){n&&n(y),y.defaultPrevented||g(y)}return I.createElement("a",Qv({},h,{href:f||m,onClick:p||a?n:v,ref:r,target:u}))}),kY=I.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:i=!1,className:a="",end:s=!1,style:o,to:u,children:l}=e,c=D4(e,PY),h=IT(u,{relative:c.relative}),d=Bl(),f=I.useContext(j4),{navigator:p}=I.useContext(zl),m=p.encodeLocation?p.encodeLocation(h).pathname:h.pathname,g=d.pathname,v=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;i||(g=g.toLowerCase(),v=v?v.toLowerCase():null,m=m.toLowerCase());let y=g===m||!s&&g.startsWith(m)&&g.charAt(m.length)==="/",b=v!=null&&(v===m||!s&&v.startsWith(m)&&v.charAt(m.length)==="/"),w=y?n:void 0,_;typeof a=="function"?_=a({isActive:y,isPending:b}):_=[a,y?"active":null,b?"pending":null].filter(Boolean).join(" ");let O=typeof o=="function"?o({isActive:y,isPending:b}):o;return I.createElement(L4,Qv({},c,{"aria-current":w,className:_,ref:r,style:O,to:u}),typeof l=="function"?l({isActive:y,isPending:b}):l)});var Dj;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmitImpl="useSubmitImpl",t.UseFetcher="useFetcher"})(Dj||(Dj={}));var Lj;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Lj||(Lj={}));function CY(t,e){let{target:r,replace:n,state:i,preventScrollReset:a,relative:s}=e===void 0?{}:e,o=Ta(),u=Bl(),l=IT(t,{relative:s});return I.useCallback(c=>{if(xY(c,r)){c.preventDefault();let h=n!==void 0?n:Zv(u)===Zv(l);o(t,{replace:h,state:i,preventScrollReset:a,relative:s})}},[u,o,l,n,i,r,t,a,s])}function ql(t){let e=I.useRef(WS(t)),r=I.useRef(!1),n=Bl(),i=I.useMemo(()=>OY(n.search,r.current?null:e.current),[n.search]),a=Ta(),s=I.useCallback((o,u)=>{const l=WS(typeof o=="function"?o(i):o);r.current=!0,a("?"+l,u)},[a,i]);return[i,s]}class hd{constructor(){this.listeners=[],this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.push(e),this.onSubscribe(),()=>{this.listeners=this.listeners.filter(r=>r!==e),this.onUnsubscribe()}}hasListeners(){return this.listeners.length>0}onSubscribe(){}onUnsubscribe(){}}const Dp=typeof window>"u"||"Deno"in window;function Ei(){}function IY(t,e){return typeof t=="function"?t(e):t}function GS(t){return typeof t=="number"&&t>=0&&t!==1/0}function F4(t,e){return Math.max(t+(e||0)-Date.now(),0)}function jf(t,e,r){return ug(t)?typeof e=="function"?{...r,queryKey:t,queryFn:e}:{...e,queryKey:t}:t}function $Y(t,e,r){return ug(t)?typeof e=="function"?{...r,mutationKey:t,mutationFn:e}:{...e,mutationKey:t}:typeof t=="function"?{...e,mutationFn:t}:{...t}}function $o(t,e,r){return ug(t)?[{...e,queryKey:t},r]:[t||{},e]}function Fj(t,e){const{type:r="all",exact:n,fetchStatus:i,predicate:a,queryKey:s,stale:o}=t;if(ug(s)){if(n){if(e.queryHash!==$T(s,e.options))return!1}else if(!eb(e.queryKey,s))return!1}if(r!=="all"){const u=e.isActive();if(r==="active"&&!u||r==="inactive"&&u)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||typeof i<"u"&&i!==e.state.fetchStatus||a&&!a(e))}function Uj(t,e){const{exact:r,fetching:n,predicate:i,mutationKey:a}=t;if(ug(a)){if(!e.options.mutationKey)return!1;if(r){if(Qu(e.options.mutationKey)!==Qu(a))return!1}else if(!eb(e.options.mutationKey,a))return!1}return!(typeof n=="boolean"&&e.state.status==="loading"!==n||i&&!i(e))}function $T(t,e){return((e==null?void 0:e.queryKeyHashFn)||Qu)(t)}function Qu(t){return JSON.stringify(t,(e,r)=>JS(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function eb(t,e){return U4(t,e)}function U4(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(r=>!U4(t[r],e[r])):!1}function z4(t,e){if(t===e)return t;const r=zj(t)&&zj(e);if(r||JS(t)&&JS(e)){const n=r?t.length:Object.keys(t).length,i=r?e:Object.keys(e),a=i.length,s=r?[]:{};let o=0;for(let u=0;u<a;u++){const l=r?u:i[u];s[l]=z4(t[l],e[l]),s[l]===t[l]&&o++}return n===a&&o===n?t:s}return e}function YS(t,e){if(t&&!e||e&&!t)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function zj(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function JS(t){if(!Bj(t))return!1;const e=t.constructor;if(typeof e>"u")return!0;const r=e.prototype;return!(!Bj(r)||!r.hasOwnProperty("isPrototypeOf"))}function Bj(t){return Object.prototype.toString.call(t)==="[object Object]"}function ug(t){return Array.isArray(t)}function B4(t){return new Promise(e=>{setTimeout(e,t)})}function qj(t){B4(0).then(t)}function jY(){if(typeof AbortController=="function")return new AbortController}function ZS(t,e,r){return r.isDataEqual!=null&&r.isDataEqual(t,e)?t:typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?z4(t,e):e}class RY extends hd{constructor(){super(),this.setup=e=>{if(!Dp&&window.addEventListener){const r=()=>e();return window.addEventListener("visibilitychange",r,!1),window.addEventListener("focus",r,!1),()=>{window.removeEventListener("visibilitychange",r),window.removeEventListener("focus",r)}}}}onSubscribe(){this.cleanup||this.setEventListener(this.setup)}onUnsubscribe(){if(!this.hasListeners()){var e;(e=this.cleanup)==null||e.call(this),this.cleanup=void 0}}setEventListener(e){var r;this.setup=e,(r=this.cleanup)==null||r.call(this),this.cleanup=e(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()})}setFocused(e){this.focused=e,e&&this.onFocus()}onFocus(){this.listeners.forEach(e=>{e()})}isFocused(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)}}const tb=new RY;class NY extends hd{constructor(){super(),this.setup=e=>{if(!Dp&&window.addEventListener){const r=()=>e();return window.addEventListener("online",r,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",r)}}}}onSubscribe(){this.cleanup||this.setEventListener(this.setup)}onUnsubscribe(){if(!this.hasListeners()){var e;(e=this.cleanup)==null||e.call(this),this.cleanup=void 0}}setEventListener(e){var r;this.setup=e,(r=this.cleanup)==null||r.call(this),this.cleanup=e(n=>{typeof n=="boolean"?this.setOnline(n):this.onOnline()})}setOnline(e){this.online=e,e&&this.onOnline()}onOnline(){this.listeners.forEach(e=>{e()})}isOnline(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine}}const rb=new NY;function MY(t){return Math.min(1e3*2**t,3e4)}function L0(t){return(t??"online")==="online"?rb.isOnline():!0}class q4{constructor(e){this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}}function cv(t){return t instanceof q4}function K4(t){let e=!1,r=0,n=!1,i,a,s;const o=new Promise((g,v)=>{a=g,s=v}),u=g=>{n||(f(new q4(g)),t.abort==null||t.abort())},l=()=>{e=!0},c=()=>{e=!1},h=()=>!tb.isFocused()||t.networkMode!=="always"&&!rb.isOnline(),d=g=>{n||(n=!0,t.onSuccess==null||t.onSuccess(g),i==null||i(),a(g))},f=g=>{n||(n=!0,t.onError==null||t.onError(g),i==null||i(),s(g))},p=()=>new Promise(g=>{i=v=>{const y=n||!h();return y&&g(v),y},t.onPause==null||t.onPause()}).then(()=>{i=void 0,n||t.onContinue==null||t.onContinue()}),m=()=>{if(n)return;let g;try{g=t.fn()}catch(v){g=Promise.reject(v)}Promise.resolve(g).then(d).catch(v=>{var y,b;if(n)return;const w=(y=t.retry)!=null?y:3,_=(b=t.retryDelay)!=null?b:MY,O=typeof _=="function"?_(r,v):_,P=w===!0||typeof w=="number"&&r<w||typeof w=="function"&&w(r,v);if(e||!P){f(v);return}r++,t.onFail==null||t.onFail(r,v),B4(O).then(()=>{if(h())return p()}).then(()=>{e?f(v):m()})})};return L0(t.networkMode)?m():p().then(m),{promise:o,cancel:u,continue:()=>(i==null?void 0:i())?o:Promise.resolve(),cancelRetry:l,continueRetry:c}}const jT=console;function DY(){let t=[],e=0,r=c=>{c()},n=c=>{c()};const i=c=>{let h;e++;try{h=c()}finally{e--,e||o()}return h},a=c=>{e?t.push(c):qj(()=>{r(c)})},s=c=>(...h)=>{a(()=>{c(...h)})},o=()=>{const c=t;t=[],c.length&&qj(()=>{n(()=>{c.forEach(h=>{r(h)})})})};return{batch:i,batchCalls:s,schedule:a,setNotifyFunction:c=>{r=c},setBatchNotifyFunction:c=>{n=c}}}const Yt=DY();class V4{destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),GS(this.cacheTime)&&(this.gcTimeout=setTimeout(()=>{this.optionalRemove()},this.cacheTime))}updateCacheTime(e){this.cacheTime=Math.max(this.cacheTime||0,e??(Dp?1/0:5*60*1e3))}clearGcTimeout(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)}}class LY extends V4{constructor(e){super(),this.abortSignalConsumed=!1,this.defaultOptions=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.cache=e.cache,this.logger=e.logger||jT,this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.initialState=e.state||FY(this.options),this.state=this.initialState,this.scheduleGc()}get meta(){return this.options.meta}setOptions(e){this.options={...this.defaultOptions,...e},this.updateCacheTime(this.options.cacheTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.cache.remove(this)}setData(e,r){const n=ZS(this.state.data,e,this.options);return this.dispatch({data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(e,r){this.dispatch({type:"setState",state:e,setStateOptions:r})}cancel(e){var r;const n=this.promise;return(r=this.retryer)==null||r.cancel(e),n?n.then(Ei).catch(Ei):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.initialState)}isActive(){return this.observers.some(e=>e.options.enabled!==!1)}isDisabled(){return this.getObserversCount()>0&&!this.isActive()}isStale(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(e=>e.getCurrentResult().isStale)}isStaleByTime(e=0){return this.state.isInvalidated||!this.state.dataUpdatedAt||!F4(this.state.dataUpdatedAt,e)}onFocus(){var e;const r=this.observers.find(n=>n.shouldFetchOnWindowFocus());r&&r.refetch({cancelRefetch:!1}),(e=this.retryer)==null||e.continue()}onOnline(){var e;const r=this.observers.find(n=>n.shouldFetchOnReconnect());r&&r.refetch({cancelRefetch:!1}),(e=this.retryer)==null||e.continue()}addObserver(e){this.observers.indexOf(e)===-1&&(this.observers.push(e),this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.indexOf(e)!==-1&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(this.retryer&&(this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.scheduleGc()),this.cache.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.dispatch({type:"invalidate"})}fetch(e,r){var n,i;if(this.state.fetchStatus!=="idle"){if(this.state.dataUpdatedAt&&r!=null&&r.cancelRefetch)this.cancel({silent:!0});else if(this.promise){var a;return(a=this.retryer)==null||a.continueRetry(),this.promise}}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(p=>p.options.queryFn);f&&this.setOptions(f.options)}Array.isArray(this.options.queryKey);const s=jY(),o={queryKey:this.queryKey,pageParam:void 0,meta:this.meta},u=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>{if(s)return this.abortSignalConsumed=!0,s.signal}})};u(o);const l=()=>this.options.queryFn?(this.abortSignalConsumed=!1,this.options.queryFn(o)):Promise.reject("Missing queryFn"),c={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:l};if(u(c),(n=this.options.behavior)==null||n.onFetch(c),this.revertState=this.state,this.state.fetchStatus==="idle"||this.state.fetchMeta!==((i=c.fetchOptions)==null?void 0:i.meta)){var h;this.dispatch({type:"fetch",meta:(h=c.fetchOptions)==null?void 0:h.meta})}const d=f=>{if(cv(f)&&f.silent||this.dispatch({type:"error",error:f}),!cv(f)){var p,m,g,v;(p=(m=this.cache.config).onError)==null||p.call(m,f,this),(g=(v=this.cache.config).onSettled)==null||g.call(v,this.state.data,f,this)}this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1};return this.retryer=K4({fn:c.fetchFn,abort:s==null?void 0:s.abort.bind(s),onSuccess:f=>{var p,m,g,v;if(typeof f>"u"){d(new Error(this.queryHash+" data is undefined"));return}this.setData(f),(p=(m=this.cache.config).onSuccess)==null||p.call(m,f,this),(g=(v=this.cache.config).onSettled)==null||g.call(v,f,this.state.error,this),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1},onError:d,onFail:(f,p)=>{this.dispatch({type:"failed",failureCount:f,error:p})},onPause:()=>{this.dispatch({type:"pause"})},onContinue:()=>{this.dispatch({type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode}),this.promise=this.retryer.promise,this.promise}dispatch(e){const r=n=>{var i,a;switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:(i=e.meta)!=null?i:null,fetchStatus:L0(this.options.networkMode)?"fetching":"paused",...!n.dataUpdatedAt&&{error:null,status:"loading"}};case"success":return{...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:(a=e.dataUpdatedAt)!=null?a:Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=e.error;return cv(s)&&s.revert&&this.revertState?{...this.revertState}:{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=r(this.state),Yt.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate(e)}),this.cache.notify({query:this,type:"updated",action:e})})}}function FY(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=typeof e<"u",n=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"loading",fetchStatus:"idle"}}class UY extends hd{constructor(e){super(),this.config=e||{},this.queries=[],this.queriesMap={}}build(e,r,n){var i;const a=r.queryKey,s=(i=r.queryHash)!=null?i:$T(a,r);let o=this.get(s);return o||(o=new LY({cache:this,logger:e.getLogger(),queryKey:a,queryHash:s,options:e.defaultQueryOptions(r),state:n,defaultOptions:e.getQueryDefaults(a)}),this.add(o)),o}add(e){this.queriesMap[e.queryHash]||(this.queriesMap[e.queryHash]=e,this.queries.push(e),this.notify({type:"added",query:e}))}remove(e){const r=this.queriesMap[e.queryHash];r&&(e.destroy(),this.queries=this.queries.filter(n=>n!==e),r===e&&delete this.queriesMap[e.queryHash],this.notify({type:"removed",query:e}))}clear(){Yt.batch(()=>{this.queries.forEach(e=>{this.remove(e)})})}get(e){return this.queriesMap[e]}getAll(){return this.queries}find(e,r){const[n]=$o(e,r);return typeof n.exact>"u"&&(n.exact=!0),this.queries.find(i=>Fj(n,i))}findAll(e,r){const[n]=$o(e,r);return Object.keys(n).length>0?this.queries.filter(i=>Fj(n,i)):this.queries}notify(e){Yt.batch(()=>{this.listeners.forEach(r=>{r(e)})})}onFocus(){Yt.batch(()=>{this.queries.forEach(e=>{e.onFocus()})})}onOnline(){Yt.batch(()=>{this.queries.forEach(e=>{e.onOnline()})})}}class zY extends V4{constructor(e){super(),this.defaultOptions=e.defaultOptions,this.mutationId=e.mutationId,this.mutationCache=e.mutationCache,this.logger=e.logger||jT,this.observers=[],this.state=e.state||H4(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options={...this.defaultOptions,...e},this.updateCacheTime(this.options.cacheTime)}get meta(){return this.options.meta}setState(e){this.dispatch({type:"setState",state:e})}addObserver(e){this.observers.indexOf(e)===-1&&(this.observers.push(e),this.clearGcTimeout(),this.mutationCache.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.observers=this.observers.filter(r=>r!==e),this.scheduleGc(),this.mutationCache.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.observers.length||(this.state.status==="loading"?this.scheduleGc():this.mutationCache.remove(this))}continue(){var e,r;return(e=(r=this.retryer)==null?void 0:r.continue())!=null?e:this.execute()}async execute(){const e=()=>{var P;return this.retryer=K4({fn:()=>this.options.mutationFn?this.options.mutationFn(this.state.variables):Promise.reject("No mutationFn found"),onFail:(x,j)=>{this.dispatch({type:"failed",failureCount:x,error:j})},onPause:()=>{this.dispatch({type:"pause"})},onContinue:()=>{this.dispatch({type:"continue"})},retry:(P=this.options.retry)!=null?P:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode}),this.retryer.promise},r=this.state.status==="loading";try{var n,i,a,s,o,u,l,c;if(!r){var h,d,f,p;this.dispatch({type:"loading",variables:this.options.variables}),await((h=(d=this.mutationCache.config).onMutate)==null?void 0:h.call(d,this.state.variables,this));const x=await((f=(p=this.options).onMutate)==null?void 0:f.call(p,this.state.variables));x!==this.state.context&&this.dispatch({type:"loading",context:x,variables:this.state.variables})}const P=await e();return await((n=(i=this.mutationCache.config).onSuccess)==null?void 0:n.call(i,P,this.state.variables,this.state.context,this)),await((a=(s=this.options).onSuccess)==null?void 0:a.call(s,P,this.state.variables,this.state.context)),await((o=(u=this.mutationCache.config).onSettled)==null?void 0:o.call(u,P,null,this.state.variables,this.state.context,this)),await((l=(c=this.options).onSettled)==null?void 0:l.call(c,P,null,this.state.variables,this.state.context)),this.dispatch({type:"success",data:P}),P}catch(P){try{var m,g,v,y,b,w,_,O;throw await((m=(g=this.mutationCache.config).onError)==null?void 0:m.call(g,P,this.state.variables,this.state.context,this)),await((v=(y=this.options).onError)==null?void 0:v.call(y,P,this.state.variables,this.state.context)),await((b=(w=this.mutationCache.config).onSettled)==null?void 0:b.call(w,void 0,P,this.state.variables,this.state.context,this)),await((_=(O=this.options).onSettled)==null?void 0:_.call(O,void 0,P,this.state.variables,this.state.context)),P}finally{this.dispatch({type:"error",error:P})}}}dispatch(e){const r=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"loading":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:!L0(this.options.networkMode),status:"loading",variables:e.variables};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"};case"setState":return{...n,...e.state}}};this.state=r(this.state),Yt.batch(()=>{this.observers.forEach(n=>{n.onMutationUpdate(e)}),this.mutationCache.notify({mutation:this,type:"updated",action:e})})}}function H4(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0}}class BY extends hd{constructor(e){super(),this.config=e||{},this.mutations=[],this.mutationId=0}build(e,r,n){const i=new zY({mutationCache:this,logger:e.getLogger(),mutationId:++this.mutationId,options:e.defaultMutationOptions(r),state:n,defaultOptions:r.mutationKey?e.getMutationDefaults(r.mutationKey):void 0});return this.add(i),i}add(e){this.mutations.push(e),this.notify({type:"added",mutation:e})}remove(e){this.mutations=this.mutations.filter(r=>r!==e),this.notify({type:"removed",mutation:e})}clear(){Yt.batch(()=>{this.mutations.forEach(e=>{this.remove(e)})})}getAll(){return this.mutations}find(e){return typeof e.exact>"u"&&(e.exact=!0),this.mutations.find(r=>Uj(e,r))}findAll(e){return this.mutations.filter(r=>Uj(e,r))}notify(e){Yt.batch(()=>{this.listeners.forEach(r=>{r(e)})})}resumePausedMutations(){var e;return this.resuming=((e=this.resuming)!=null?e:Promise.resolve()).then(()=>{const r=this.mutations.filter(n=>n.state.isPaused);return Yt.batch(()=>r.reduce((n,i)=>n.then(()=>i.continue().catch(Ei)),Promise.resolve()))}).then(()=>{this.resuming=void 0}),this.resuming}}function qY(){return{onFetch:t=>{t.fetchFn=()=>{var e,r,n,i,a,s;const o=(e=t.fetchOptions)==null||(r=e.meta)==null?void 0:r.refetchPage,u=(n=t.fetchOptions)==null||(i=n.meta)==null?void 0:i.fetchMore,l=u==null?void 0:u.pageParam,c=(u==null?void 0:u.direction)==="forward",h=(u==null?void 0:u.direction)==="backward",d=((a=t.state.data)==null?void 0:a.pages)||[],f=((s=t.state.data)==null?void 0:s.pageParams)||[];let p=f,m=!1;const g=O=>{Object.defineProperty(O,"signal",{enumerable:!0,get:()=>{var P;if((P=t.signal)!=null&&P.aborted)m=!0;else{var x;(x=t.signal)==null||x.addEventListener("abort",()=>{m=!0})}return t.signal}})},v=t.options.queryFn||(()=>Promise.reject("Missing queryFn")),y=(O,P,x,j)=>(p=j?[P,...p]:[...p,P],j?[x,...O]:[...O,x]),b=(O,P,x,j)=>{if(m)return Promise.reject("Cancelled");if(typeof x>"u"&&!P&&O.length)return Promise.resolve(O);const k={queryKey:t.queryKey,pageParam:x,meta:t.options.meta};g(k);const R=v(k);return Promise.resolve(R).then(z=>y(O,x,z,j))};let w;if(!d.length)w=b([]);else if(c){const O=typeof l<"u",P=O?l:Kj(t.options,d);w=b(d,O,P)}else if(h){const O=typeof l<"u",P=O?l:KY(t.options,d);w=b(d,O,P,!0)}else{p=[];const O=typeof t.options.getNextPageParam>"u";w=(o&&d[0]?o(d[0],0,d):!0)?b([],O,f[0]):Promise.resolve(y([],f[0],d[0]));for(let x=1;x<d.length;x++)w=w.then(j=>{if(o&&d[x]?o(d[x],x,d):!0){const R=O?f[x]:Kj(t.options,j);return b(j,O,R)}return Promise.resolve(y(j,f[x],d[x]))})}return w.then(O=>({pages:O,pageParams:p}))}}}}function Kj(t,e){return t.getNextPageParam==null?void 0:t.getNextPageParam(e[e.length-1],e)}function KY(t,e){return t.getPreviousPageParam==null?void 0:t.getPreviousPageParam(e[0],e)}class VY{constructor(e={}){this.queryCache=e.queryCache||new UY,this.mutationCache=e.mutationCache||new BY,this.logger=e.logger||jT,this.defaultOptions=e.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[],this.mountCount=0}mount(){this.mountCount++,this.mountCount===1&&(this.unsubscribeFocus=tb.subscribe(()=>{tb.isFocused()&&(this.resumePausedMutations(),this.queryCache.onFocus())}),this.unsubscribeOnline=rb.subscribe(()=>{rb.isOnline()&&(this.resumePausedMutations(),this.queryCache.onOnline())}))}unmount(){var e,r;this.mountCount--,this.mountCount===0&&((e=this.unsubscribeFocus)==null||e.call(this),this.unsubscribeFocus=void 0,(r=this.unsubscribeOnline)==null||r.call(this),this.unsubscribeOnline=void 0)}isFetching(e,r){const[n]=$o(e,r);return n.fetchStatus="fetching",this.queryCache.findAll(n).length}isMutating(e){return this.mutationCache.findAll({...e,fetching:!0}).length}getQueryData(e,r){var n;return(n=this.queryCache.find(e,r))==null?void 0:n.state.data}ensureQueryData(e,r,n){const i=jf(e,r,n),a=this.getQueryData(i.queryKey);return a?Promise.resolve(a):this.fetchQuery(i)}getQueriesData(e){return this.getQueryCache().findAll(e).map(({queryKey:r,state:n})=>{const i=n.data;return[r,i]})}setQueryData(e,r,n){const i=this.queryCache.find(e),a=i==null?void 0:i.state.data,s=IY(r,a);if(typeof s>"u")return;const o=jf(e),u=this.defaultQueryOptions(o);return this.queryCache.build(this,u).setData(s,{...n,manual:!0})}setQueriesData(e,r,n){return Yt.batch(()=>this.getQueryCache().findAll(e).map(({queryKey:i})=>[i,this.setQueryData(i,r,n)]))}getQueryState(e,r){var n;return(n=this.queryCache.find(e,r))==null?void 0:n.state}removeQueries(e,r){const[n]=$o(e,r),i=this.queryCache;Yt.batch(()=>{i.findAll(n).forEach(a=>{i.remove(a)})})}resetQueries(e,r,n){const[i,a]=$o(e,r,n),s=this.queryCache,o={type:"active",...i};return Yt.batch(()=>(s.findAll(i).forEach(u=>{u.reset()}),this.refetchQueries(o,a)))}cancelQueries(e,r,n){const[i,a={}]=$o(e,r,n);typeof a.revert>"u"&&(a.revert=!0);const s=Yt.batch(()=>this.queryCache.findAll(i).map(o=>o.cancel(a)));return Promise.all(s).then(Ei).catch(Ei)}invalidateQueries(e,r,n){const[i,a]=$o(e,r,n);return Yt.batch(()=>{var s,o;if(this.queryCache.findAll(i).forEach(l=>{l.invalidate()}),i.refetchType==="none")return Promise.resolve();const u={...i,type:(s=(o=i.refetchType)!=null?o:i.type)!=null?s:"active"};return this.refetchQueries(u,a)})}refetchQueries(e,r,n){const[i,a]=$o(e,r,n),s=Yt.batch(()=>this.queryCache.findAll(i).filter(u=>!u.isDisabled()).map(u=>{var l;return u.fetch(void 0,{...a,cancelRefetch:(l=a==null?void 0:a.cancelRefetch)!=null?l:!0,meta:{refetchPage:i.refetchPage}})}));let o=Promise.all(s).then(Ei);return a!=null&&a.throwOnError||(o=o.catch(Ei)),o}fetchQuery(e,r,n){const i=jf(e,r,n),a=this.defaultQueryOptions(i);typeof a.retry>"u"&&(a.retry=!1);const s=this.queryCache.build(this,a);return s.isStaleByTime(a.staleTime)?s.fetch(a):Promise.resolve(s.state.data)}prefetchQuery(e,r,n){return this.fetchQuery(e,r,n).then(Ei).catch(Ei)}fetchInfiniteQuery(e,r,n){const i=jf(e,r,n);return i.behavior=qY(),this.fetchQuery(i)}prefetchInfiniteQuery(e,r,n){return this.fetchInfiniteQuery(e,r,n).then(Ei).catch(Ei)}resumePausedMutations(){return this.mutationCache.resumePausedMutations()}getQueryCache(){return this.queryCache}getMutationCache(){return this.mutationCache}getLogger(){return this.logger}getDefaultOptions(){return this.defaultOptions}setDefaultOptions(e){this.defaultOptions=e}setQueryDefaults(e,r){const n=this.queryDefaults.find(i=>Qu(e)===Qu(i.queryKey));n?n.defaultOptions=r:this.queryDefaults.push({queryKey:e,defaultOptions:r})}getQueryDefaults(e){if(!e)return;const r=this.queryDefaults.find(n=>eb(e,n.queryKey));return r==null?void 0:r.defaultOptions}setMutationDefaults(e,r){const n=this.mutationDefaults.find(i=>Qu(e)===Qu(i.mutationKey));n?n.defaultOptions=r:this.mutationDefaults.push({mutationKey:e,defaultOptions:r})}getMutationDefaults(e){if(!e)return;const r=this.mutationDefaults.find(n=>eb(e,n.mutationKey));return r==null?void 0:r.defaultOptions}defaultQueryOptions(e){if(e!=null&&e._defaulted)return e;const r={...this.defaultOptions.queries,...this.getQueryDefaults(e==null?void 0:e.queryKey),...e,_defaulted:!0};return!r.queryHash&&r.queryKey&&(r.queryHash=$T(r.queryKey,r)),typeof r.refetchOnReconnect>"u"&&(r.refetchOnReconnect=r.networkMode!=="always"),typeof r.useErrorBoundary>"u"&&(r.useErrorBoundary=!!r.suspense),r}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...this.defaultOptions.mutations,...this.getMutationDefaults(e==null?void 0:e.mutationKey),...e,_defaulted:!0}}clear(){this.queryCache.clear(),this.mutationCache.clear()}}class HY extends hd{constructor(e,r){super(),this.client=e,this.options=r,this.trackedProps=new Set,this.selectError=null,this.bindMethods(),this.setOptions(r)}bindMethods(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.length===1&&(this.currentQuery.addObserver(this),Vj(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())}onUnsubscribe(){this.listeners.length||this.destroy()}shouldFetchOnReconnect(){return XS(this.currentQuery,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return XS(this.currentQuery,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=[],this.clearStaleTimeout(),this.clearRefetchInterval(),this.currentQuery.removeObserver(this)}setOptions(e,r){const n=this.options,i=this.currentQuery;if(this.options=this.client.defaultQueryOptions(e),YS(n,this.options)||this.client.getQueryCache().notify({type:"observerOptionsUpdated",query:this.currentQuery,observer:this}),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=n.queryKey),this.updateQuery();const a=this.hasListeners();a&&Hj(this.currentQuery,i,this.options,n)&&this.executeFetch(),this.updateResult(r),a&&(this.currentQuery!==i||this.options.enabled!==n.enabled||this.options.staleTime!==n.staleTime)&&this.updateStaleTimeout();const s=this.computeRefetchInterval();a&&(this.currentQuery!==i||this.options.enabled!==n.enabled||s!==this.currentRefetchInterval)&&this.updateRefetchInterval(s)}getOptimisticResult(e){const r=this.client.getQueryCache().build(this.client,e);return this.createResult(r,e)}getCurrentResult(){return this.currentResult}trackResult(e){const r={};return Object.keys(e).forEach(n=>{Object.defineProperty(r,n,{configurable:!1,enumerable:!0,get:()=>(this.trackedProps.add(n),e[n])})}),r}getCurrentQuery(){return this.currentQuery}remove(){this.client.getQueryCache().remove(this.currentQuery)}refetch({refetchPage:e,...r}={}){return this.fetch({...r,meta:{refetchPage:e}})}fetchOptimistic(e){const r=this.client.defaultQueryOptions(e),n=this.client.getQueryCache().build(this.client,r);return n.isFetchingOptimistic=!0,n.fetch().then(()=>this.createResult(n,r))}fetch(e){var r;return this.executeFetch({...e,cancelRefetch:(r=e.cancelRefetch)!=null?r:!0}).then(()=>(this.updateResult(),this.currentResult))}executeFetch(e){this.updateQuery();let r=this.currentQuery.fetch(this.options,e);return e!=null&&e.throwOnError||(r=r.catch(Ei)),r}updateStaleTimeout(){if(this.clearStaleTimeout(),Dp||this.currentResult.isStale||!GS(this.options.staleTime))return;const r=F4(this.currentResult.dataUpdatedAt,this.options.staleTime)+1;this.staleTimeoutId=setTimeout(()=>{this.currentResult.isStale||this.updateResult()},r)}computeRefetchInterval(){var e;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(e=this.options.refetchInterval)!=null?e:!1}updateRefetchInterval(e){this.clearRefetchInterval(),this.currentRefetchInterval=e,!(Dp||this.options.enabled===!1||!GS(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(()=>{(this.options.refetchIntervalInBackground||tb.isFocused())&&this.executeFetch()},this.currentRefetchInterval))}updateTimers(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())}clearStaleTimeout(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)}clearRefetchInterval(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)}createResult(e,r){const n=this.currentQuery,i=this.options,a=this.currentResult,s=this.currentResultState,o=this.currentResultOptions,u=e!==n,l=u?e.state:this.currentQueryInitialState,c=u?this.currentResult:this.previousQueryResult,{state:h}=e;let{dataUpdatedAt:d,error:f,errorUpdatedAt:p,fetchStatus:m,status:g}=h,v=!1,y=!1,b;if(r._optimisticResults){const x=this.hasListeners(),j=!x&&Vj(e,r),k=x&&Hj(e,n,r,i);(j||k)&&(m=L0(e.options.networkMode)?"fetching":"paused",d||(g="loading")),r._optimisticResults==="isRestoring"&&(m="idle")}if(r.keepPreviousData&&!h.dataUpdatedAt&&c!=null&&c.isSuccess&&g!=="error")b=c.data,d=c.dataUpdatedAt,g=c.status,v=!0;else if(r.select&&typeof h.data<"u")if(a&&h.data===(s==null?void 0:s.data)&&r.select===this.selectFn)b=this.selectResult;else try{this.selectFn=r.select,b=r.select(h.data),b=ZS(a==null?void 0:a.data,b,r),this.selectResult=b,this.selectError=null}catch(x){this.selectError=x}else b=h.data;if(typeof r.placeholderData<"u"&&typeof b>"u"&&g==="loading"){let x;if(a!=null&&a.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData))x=a.data;else if(x=typeof r.placeholderData=="function"?r.placeholderData():r.placeholderData,r.select&&typeof x<"u")try{x=r.select(x),this.selectError=null}catch(j){this.selectError=j}typeof x<"u"&&(g="success",b=ZS(a==null?void 0:a.data,x,r),y=!0)}this.selectError&&(f=this.selectError,b=this.selectResult,p=Date.now(),g="error");const w=m==="fetching",_=g==="loading",O=g==="error";return{status:g,fetchStatus:m,isLoading:_,isSuccess:g==="success",isError:O,isInitialLoading:_&&w,data:b,dataUpdatedAt:d,error:f,errorUpdatedAt:p,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>l.dataUpdateCount||h.errorUpdateCount>l.errorUpdateCount,isFetching:w,isRefetching:w&&!_,isLoadingError:O&&h.dataUpdatedAt===0,isPaused:m==="paused",isPlaceholderData:y,isPreviousData:v,isRefetchError:O&&h.dataUpdatedAt!==0,isStale:RT(e,r),refetch:this.refetch,remove:this.remove}}updateResult(e){const r=this.currentResult,n=this.createResult(this.currentQuery,this.options);if(this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,YS(n,r))return;this.currentResult=n;const i={cache:!0},a=()=>{if(!r)return!0;const{notifyOnChangeProps:s}=this.options;if(s==="all"||!s&&!this.trackedProps.size)return!0;const o=new Set(s??this.trackedProps);return this.options.useErrorBoundary&&o.add("error"),Object.keys(this.currentResult).some(u=>{const l=u;return this.currentResult[l]!==r[l]&&o.has(l)})};(e==null?void 0:e.listeners)!==!1&&a()&&(i.listeners=!0),this.notify({...i,...e})}updateQuery(){const e=this.client.getQueryCache().build(this.client,this.options);if(e===this.currentQuery)return;const r=this.currentQuery;this.currentQuery=e,this.currentQueryInitialState=e.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(r==null||r.removeObserver(this),e.addObserver(this))}onQueryUpdate(e){const r={};e.type==="success"?r.onSuccess=!e.manual:e.type==="error"&&!cv(e.error)&&(r.onError=!0),this.updateResult(r),this.hasListeners()&&this.updateTimers()}notify(e){Yt.batch(()=>{if(e.onSuccess){var r,n,i,a;(r=(n=this.options).onSuccess)==null||r.call(n,this.currentResult.data),(i=(a=this.options).onSettled)==null||i.call(a,this.currentResult.data,null)}else if(e.onError){var s,o,u,l;(s=(o=this.options).onError)==null||s.call(o,this.currentResult.error),(u=(l=this.options).onSettled)==null||u.call(l,void 0,this.currentResult.error)}e.listeners&&this.listeners.forEach(c=>{c(this.currentResult)}),e.cache&&this.client.getQueryCache().notify({query:this.currentQuery,type:"observerResultsUpdated"})})}}function WY(t,e){return e.enabled!==!1&&!t.state.dataUpdatedAt&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Vj(t,e){return WY(t,e)||t.state.dataUpdatedAt>0&&XS(t,e,e.refetchOnMount)}function XS(t,e,r){if(e.enabled!==!1){const n=typeof r=="function"?r(t):r;return n==="always"||n!==!1&&RT(t,e)}return!1}function Hj(t,e,r,n){return r.enabled!==!1&&(t!==e||n.enabled===!1)&&(!r.suspense||t.state.status!=="error")&&RT(t,r)}function RT(t,e){return t.isStaleByTime(e.staleTime)}let GY=class extends hd{constructor(e,r){super(),this.client=e,this.setOptions(r),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var r;const n=this.options;this.options=this.client.defaultMutationOptions(e),YS(n,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),(r=this.currentMutation)==null||r.setOptions(this.options)}onUnsubscribe(){if(!this.listeners.length){var e;(e=this.currentMutation)==null||e.removeObserver(this)}}onMutationUpdate(e){this.updateResult();const r={listeners:!0};e.type==="success"?r.onSuccess=!0:e.type==="error"&&(r.onError=!0),this.notify(r)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(e,r){return this.mutateOptions=r,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:typeof e<"u"?e:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const e=this.currentMutation?this.currentMutation.state:H4(),r={...e,isLoading:e.status==="loading",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset};this.currentResult=r}notify(e){Yt.batch(()=>{if(this.mutateOptions&&this.hasListeners()){if(e.onSuccess){var r,n,i,a;(r=(n=this.mutateOptions).onSuccess)==null||r.call(n,this.currentResult.data,this.currentResult.variables,this.currentResult.context),(i=(a=this.mutateOptions).onSettled)==null||i.call(a,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)}else if(e.onError){var s,o,u,l;(s=(o=this.mutateOptions).onError)==null||s.call(o,this.currentResult.error,this.currentResult.variables,this.currentResult.context),(u=(l=this.mutateOptions).onSettled)==null||u.call(l,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}}e.listeners&&this.listeners.forEach(c=>{c(this.currentResult)})})}};var W4={exports:{}},G4={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xh=I;function YY(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var JY=typeof Object.is=="function"?Object.is:YY,ZY=xh.useState,XY=xh.useEffect,QY=xh.useLayoutEffect,eJ=xh.useDebugValue;function tJ(t,e){var r=e(),n=ZY({inst:{value:r,getSnapshot:e}}),i=n[0].inst,a=n[1];return QY(function(){i.value=r,i.getSnapshot=e,cx(i)&&a({inst:i})},[t,r,e]),XY(function(){return cx(i)&&a({inst:i}),t(function(){cx(i)&&a({inst:i})})},[t]),eJ(r),r}function cx(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!JY(t,r)}catch{return!0}}function rJ(t,e){return e()}var nJ=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?rJ:tJ;G4.useSyncExternalStore=xh.useSyncExternalStore!==void 0?xh.useSyncExternalStore:nJ;W4.exports=G4;var iJ=W4.exports;const Y4=iJ.useSyncExternalStore,Wj=I.createContext(void 0),J4=I.createContext(!1);function Z4(t,e){return t||(e&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=Wj),window.ReactQueryClientContext):Wj)}const vi=({context:t}={})=>{const e=I.useContext(Z4(t,I.useContext(J4)));if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},aJ=({client:t,children:e,context:r,contextSharing:n=!1})=>{I.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]);const i=Z4(r,n);return I.createElement(J4.Provider,{value:!r&&n},I.createElement(i.Provider,{value:t},e))},X4=I.createContext(!1),sJ=()=>I.useContext(X4);X4.Provider;function oJ(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}const uJ=I.createContext(oJ()),lJ=()=>I.useContext(uJ);function Q4(t,e){return typeof t=="function"?t(...e):!!t}const cJ=(t,e)=>{(t.suspense||t.useErrorBoundary)&&(e.isReset()||(t.retryOnMount=!1))},hJ=t=>{I.useEffect(()=>{t.clearReset()},[t])},dJ=({result:t,errorResetBoundary:e,useErrorBoundary:r,query:n})=>t.isError&&!e.isReset()&&!t.isFetching&&Q4(r,[t.error,n]),fJ=t=>{t.suspense&&typeof t.staleTime!="number"&&(t.staleTime=1e3)},pJ=(t,e)=>t.isLoading&&t.isFetching&&!e,mJ=(t,e,r)=>(t==null?void 0:t.suspense)&&pJ(e,r),gJ=(t,e,r)=>e.fetchOptimistic(t).then(({data:n})=>{t.onSuccess==null||t.onSuccess(n),t.onSettled==null||t.onSettled(n,null)}).catch(n=>{r.clearReset(),t.onError==null||t.onError(n),t.onSettled==null||t.onSettled(void 0,n)});function yJ(t,e){const r=vi({context:t.context}),n=sJ(),i=lJ(),a=r.defaultQueryOptions(t);a._optimisticResults=n?"isRestoring":"optimistic",a.onError&&(a.onError=Yt.batchCalls(a.onError)),a.onSuccess&&(a.onSuccess=Yt.batchCalls(a.onSuccess)),a.onSettled&&(a.onSettled=Yt.batchCalls(a.onSettled)),fJ(a),cJ(a,i),hJ(i);const[s]=I.useState(()=>new e(r,a)),o=s.getOptimisticResult(a);if(Y4(I.useCallback(u=>n?()=>{}:s.subscribe(Yt.batchCalls(u)),[s,n]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),I.useEffect(()=>{s.setOptions(a,{listeners:!1})},[a,s]),mJ(a,o,n))throw gJ(a,s,i);if(dJ({result:o,errorResetBoundary:i,useErrorBoundary:a.useErrorBoundary,query:s.getCurrentQuery()}))throw o.error;return a.notifyOnChangeProps?o:s.trackResult(o)}function lo(t,e,r){const n=jf(t,e,r);return yJ(n,HY)}function ka(t,e,r){const n=$Y(t,e,r),i=vi({context:n.context}),[a]=I.useState(()=>new GY(i,n));I.useEffect(()=>{a.setOptions(n)},[a,n]);const s=Y4(I.useCallback(u=>a.subscribe(Yt.batchCalls(u)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),o=I.useCallback((u,l)=>{a.mutate(u,l).catch(vJ)},[a]);if(s.error&&Q4(a.options.useErrorBoundary,[s.error]))throw s.error;return{...s,mutate:o,mutateAsync:s.mutate}}function vJ(){}const bJ=function(){return null};let wJ={data:""},_J=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||wJ,xJ=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,OJ=/\/\*[^]*?\*\/|  +/g,Gj=/\n+/g,Lo=(t,e)=>{let r="",n="",i="";for(let a in t){let s=t[a];a[0]=="@"?a[1]=="i"?r=a+" "+s+";":n+=a[1]=="f"?Lo(s,a):a+"{"+Lo(s,a[1]=="k"?"":e)+"}":typeof s=="object"?n+=Lo(s,e?e.replace(/([^,])+/g,o=>a.replace(/(^:.*)|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,o):o?o+" "+u:u)):a):s!=null&&(a=/^--/.test(a)?a:a.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=Lo.p?Lo.p(a,s):a+":"+s+";")}return r+(e&&i?e+"{"+i+"}":i)+n},Ss={},eU=t=>{if(typeof t=="object"){let e="";for(let r in t)e+=r+eU(t[r]);return e}return t},SJ=(t,e,r,n,i)=>{let a=eU(t),s=Ss[a]||(Ss[a]=(u=>{let l=0,c=11;for(;l<u.length;)c=101*c+u.charCodeAt(l++)>>>0;return"go"+c})(a));if(!Ss[s]){let u=a!==t?t:(l=>{let c,h,d=[{}];for(;c=xJ.exec(l.replace(OJ,""));)c[4]?d.shift():c[3]?(h=c[3].replace(Gj," ").trim(),d.unshift(d[0][h]=d[0][h]||{})):d[0][c[1]]=c[2].replace(Gj," ").trim();return d[0]})(t);Ss[s]=Lo(i?{["@keyframes "+s]:u}:u,r?"":"."+s)}let o=r&&Ss.g?Ss.g:null;return r&&(Ss.g=Ss[s]),((u,l,c,h)=>{h?l.data=l.data.replace(h,u):l.data.indexOf(u)===-1&&(l.data=c?u+l.data:l.data+u)})(Ss[s],e,n,o),s},PJ=(t,e,r)=>t.reduce((n,i,a)=>{let s=e[a];if(s&&s.call){let o=s(r),u=o&&o.props&&o.props.className||/^go/.test(o)&&o;s=u?"."+u:o&&typeof o=="object"?o.props?"":Lo(o,""):o===!1?"":o}return n+i+(s??"")},"");function F0(t){let e=this||{},r=t.call?t(e.p):t;return SJ(r.unshift?r.raw?PJ(r,[].slice.call(arguments,1),e.p):r.reduce((n,i)=>Object.assign(n,i&&i.call?i(e.p):i),{}):r,_J(e.target),e.g,e.o,e.k)}let tU,QS,eP;F0.bind({g:1});let Xs=F0.bind({k:1});function EJ(t,e,r,n){Lo.p=e,tU=t,QS=r,eP=n}function _u(t,e){let r=this||{};return function(){let n=arguments;function i(a,s){let o=Object.assign({},a),u=o.className||i.className;r.p=Object.assign({theme:QS&&QS()},o),r.o=/ *go\d+/.test(u),o.className=F0.apply(r,n)+(u?" "+u:""),e&&(o.ref=s);let l=t;return t[0]&&(l=o.as||t,delete o.as),eP&&l[0]&&eP(o),tU(l,o)}return e?e(i):i}}var AJ=t=>typeof t=="function",nb=(t,e)=>AJ(t)?t(e):t,TJ=(()=>{let t=0;return()=>(++t).toString()})(),rU=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),kJ=20,hv=new Map,CJ=1e3,Yj=t=>{if(hv.has(t))return;let e=setTimeout(()=>{hv.delete(t),Kl({type:4,toastId:t})},CJ);hv.set(t,e)},IJ=t=>{let e=hv.get(t);e&&clearTimeout(e)},tP=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,kJ)};case 1:return e.toast.id&&IJ(e.toast.id),{...t,toasts:t.toasts.map(a=>a.id===e.toast.id?{...a,...e.toast}:a)};case 2:let{toast:r}=e;return t.toasts.find(a=>a.id===r.id)?tP(t,{type:1,toast:r}):tP(t,{type:0,toast:r});case 3:let{toastId:n}=e;return n?Yj(n):t.toasts.forEach(a=>{Yj(a.id)}),{...t,toasts:t.toasts.map(a=>a.id===n||n===void 0?{...a,visible:!1}:a)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(a=>({...a,pauseDuration:a.pauseDuration+i}))}}},dv=[],fv={toasts:[],pausedAt:void 0},Kl=t=>{fv=tP(fv,t),dv.forEach(e=>{e(fv)})},$J={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},jJ=(t={})=>{let[e,r]=I.useState(fv);I.useEffect(()=>(dv.push(r),()=>{let i=dv.indexOf(r);i>-1&&dv.splice(i,1)}),[e]);let n=e.toasts.map(i=>{var a,s;return{...t,...t[i.type],...i,duration:i.duration||((a=t[i.type])==null?void 0:a.duration)||(t==null?void 0:t.duration)||$J[i.type],style:{...t.style,...(s=t[i.type])==null?void 0:s.style,...i.style}}});return{...e,toasts:n}},RJ=(t,e="blank",r)=>({createdAt:Date.now(),visible:!0,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...r,id:(r==null?void 0:r.id)||TJ()}),lg=t=>(e,r)=>{let n=RJ(e,t,r);return Kl({type:2,toast:n}),n.id},ut=(t,e)=>lg("blank")(t,e);ut.error=lg("error");ut.success=lg("success");ut.loading=lg("loading");ut.custom=lg("custom");ut.dismiss=t=>{Kl({type:3,toastId:t})};ut.remove=t=>Kl({type:4,toastId:t});ut.promise=(t,e,r)=>{let n=ut.loading(e.loading,{...r,...r==null?void 0:r.loading});return t.then(i=>(ut.success(nb(e.success,i),{id:n,...r,...r==null?void 0:r.success}),i)).catch(i=>{ut.error(nb(e.error,i),{id:n,...r,...r==null?void 0:r.error})}),t};var NJ=(t,e)=>{Kl({type:1,toast:{id:t,height:e}})},MJ=()=>{Kl({type:5,time:Date.now()})},DJ=t=>{let{toasts:e,pausedAt:r}=jJ(t);I.useEffect(()=>{if(r)return;let a=Date.now(),s=e.map(o=>{if(o.duration===1/0)return;let u=(o.duration||0)+o.pauseDuration-(a-o.createdAt);if(u<0){o.visible&&ut.dismiss(o.id);return}return setTimeout(()=>ut.dismiss(o.id),u)});return()=>{s.forEach(o=>o&&clearTimeout(o))}},[e,r]);let n=I.useCallback(()=>{r&&Kl({type:6,time:Date.now()})},[r]),i=I.useCallback((a,s)=>{let{reverseOrder:o=!1,gutter:u=8,defaultPosition:l}=s||{},c=e.filter(f=>(f.position||l)===(a.position||l)&&f.height),h=c.findIndex(f=>f.id===a.id),d=c.filter((f,p)=>p<h&&f.visible).length;return c.filter(f=>f.visible).slice(...o?[d+1]:[0,d]).reduce((f,p)=>f+(p.height||0)+u,0)},[e]);return{toasts:e,handlers:{updateHeight:NJ,startPause:MJ,endPause:n,calculateOffset:i}}},LJ=Xs`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,FJ=Xs`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,UJ=Xs`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,zJ=_u("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${LJ} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${FJ} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${UJ} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,BJ=Xs`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,qJ=_u("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${BJ} 1s linear infinite;
`,KJ=Xs`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,VJ=Xs`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,HJ=_u("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${KJ} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${VJ} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,WJ=_u("div")`
  position: absolute;
`,GJ=_u("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,YJ=Xs`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,JJ=_u("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${YJ} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,ZJ=({toast:t})=>{let{icon:e,type:r,iconTheme:n}=t;return e!==void 0?typeof e=="string"?I.createElement(JJ,null,e):e:r==="blank"?null:I.createElement(GJ,null,I.createElement(qJ,{...n}),r!=="loading"&&I.createElement(WJ,null,r==="error"?I.createElement(zJ,{...n}):I.createElement(HJ,{...n})))},XJ=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,QJ=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,eZ="0%{opacity:0;} 100%{opacity:1;}",tZ="0%{opacity:1;} 100%{opacity:0;}",rZ=_u("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,nZ=_u("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,iZ=(t,e)=>{let r=t.includes("top")?1:-1,[n,i]=rU()?[eZ,tZ]:[XJ(r),QJ(r)];return{animation:e?`${Xs(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Xs(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},aZ=I.memo(({toast:t,position:e,style:r,children:n})=>{let i=t.height?iZ(t.position||e||"top-center",t.visible):{opacity:0},a=I.createElement(ZJ,{toast:t}),s=I.createElement(nZ,{...t.ariaProps},nb(t.message,t));return I.createElement(rZ,{className:t.className,style:{...i,...r,...t.style}},typeof n=="function"?n({icon:a,message:s}):I.createElement(I.Fragment,null,a,s))});EJ(I.createElement);var sZ=({id:t,className:e,style:r,onHeightUpdate:n,children:i})=>{let a=I.useCallback(s=>{if(s){let o=()=>{let u=s.getBoundingClientRect().height;n(t,u)};o(),new MutationObserver(o).observe(s,{subtree:!0,childList:!0,characterData:!0})}},[t,n]);return I.createElement("div",{ref:a,className:e,style:r},i)},oZ=(t,e)=>{let r=t.includes("top"),n=r?{top:0}:{bottom:0},i=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:rU()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(r?1:-1)}px)`,...n,...i}},uZ=F0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,dy=16,lZ=({reverseOrder:t,position:e="top-center",toastOptions:r,gutter:n,children:i,containerStyle:a,containerClassName:s})=>{let{toasts:o,handlers:u}=DJ(r);return I.createElement("div",{style:{position:"fixed",zIndex:9999,top:dy,left:dy,right:dy,bottom:dy,pointerEvents:"none",...a},className:s,onMouseEnter:u.startPause,onMouseLeave:u.endPause},o.map(l=>{let c=l.position||e,h=u.calculateOffset(l,{reverseOrder:t,gutter:n,defaultPosition:e}),d=oZ(c,h);return I.createElement(sZ,{id:l.id,key:l.id,onHeightUpdate:u.updateHeight,className:l.visible?uZ:"",style:d},l.type==="custom"?nb(l.message,l):i?i(l):I.createElement(aZ,{toast:l,position:c}))}))},nU={exports:{}},mt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lr=typeof Symbol=="function"&&Symbol.for,NT=Lr?Symbol.for("react.element"):60103,MT=Lr?Symbol.for("react.portal"):60106,U0=Lr?Symbol.for("react.fragment"):60107,z0=Lr?Symbol.for("react.strict_mode"):60108,B0=Lr?Symbol.for("react.profiler"):60114,q0=Lr?Symbol.for("react.provider"):60109,K0=Lr?Symbol.for("react.context"):60110,DT=Lr?Symbol.for("react.async_mode"):60111,V0=Lr?Symbol.for("react.concurrent_mode"):60111,H0=Lr?Symbol.for("react.forward_ref"):60112,W0=Lr?Symbol.for("react.suspense"):60113,cZ=Lr?Symbol.for("react.suspense_list"):60120,G0=Lr?Symbol.for("react.memo"):60115,Y0=Lr?Symbol.for("react.lazy"):60116,hZ=Lr?Symbol.for("react.block"):60121,dZ=Lr?Symbol.for("react.fundamental"):60117,fZ=Lr?Symbol.for("react.responder"):60118,pZ=Lr?Symbol.for("react.scope"):60119;function bi(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case NT:switch(t=t.type,t){case DT:case V0:case U0:case B0:case z0:case W0:return t;default:switch(t=t&&t.$$typeof,t){case K0:case H0:case Y0:case G0:case q0:return t;default:return e}}case MT:return e}}}function iU(t){return bi(t)===V0}mt.AsyncMode=DT;mt.ConcurrentMode=V0;mt.ContextConsumer=K0;mt.ContextProvider=q0;mt.Element=NT;mt.ForwardRef=H0;mt.Fragment=U0;mt.Lazy=Y0;mt.Memo=G0;mt.Portal=MT;mt.Profiler=B0;mt.StrictMode=z0;mt.Suspense=W0;mt.isAsyncMode=function(t){return iU(t)||bi(t)===DT};mt.isConcurrentMode=iU;mt.isContextConsumer=function(t){return bi(t)===K0};mt.isContextProvider=function(t){return bi(t)===q0};mt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===NT};mt.isForwardRef=function(t){return bi(t)===H0};mt.isFragment=function(t){return bi(t)===U0};mt.isLazy=function(t){return bi(t)===Y0};mt.isMemo=function(t){return bi(t)===G0};mt.isPortal=function(t){return bi(t)===MT};mt.isProfiler=function(t){return bi(t)===B0};mt.isStrictMode=function(t){return bi(t)===z0};mt.isSuspense=function(t){return bi(t)===W0};mt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===U0||t===V0||t===B0||t===z0||t===W0||t===cZ||typeof t=="object"&&t!==null&&(t.$$typeof===Y0||t.$$typeof===G0||t.$$typeof===q0||t.$$typeof===K0||t.$$typeof===H0||t.$$typeof===dZ||t.$$typeof===fZ||t.$$typeof===pZ||t.$$typeof===hZ)};mt.typeOf=bi;nU.exports=mt;var Oh=nU.exports;function mZ(t){function e(K,J,ie,oe,S){for(var E=0,U=0,T=0,ee=0,se,H,Oe=0,be=0,xe,C=xe=se=0,B=0,Y=0,me=0,W=0,ae=ie.length,ne=ae-1,le,X="",ce="",pe="",Ie="",Se;B<ae;){if(H=ie.charCodeAt(B),B===ne&&U+ee+T+E!==0&&(U!==0&&(H=U===47?10:47),ee=T=E=0,ae++,ne++),U+ee+T+E===0){if(B===ne&&(0<Y&&(X=X.replace(d,"")),0<X.trim().length)){switch(H){case 32:case 9:case 59:case 13:case 10:break;default:X+=ie.charAt(B)}H=59}switch(H){case 123:for(X=X.trim(),se=X.charCodeAt(0),xe=1,W=++B;B<ae;){switch(H=ie.charCodeAt(B)){case 123:xe++;break;case 125:xe--;break;case 47:switch(H=ie.charCodeAt(B+1)){case 42:case 47:e:{for(C=B+1;C<ne;++C)switch(ie.charCodeAt(C)){case 47:if(H===42&&ie.charCodeAt(C-1)===42&&B+2!==C){B=C+1;break e}break;case 10:if(H===47){B=C+1;break e}}B=C}}break;case 91:H++;case 40:H++;case 34:case 39:for(;B++<ne&&ie.charCodeAt(B)!==H;);}if(xe===0)break;B++}switch(xe=ie.substring(W,B),se===0&&(se=(X=X.replace(h,"").trim()).charCodeAt(0)),se){case 64:switch(0<Y&&(X=X.replace(d,"")),H=X.charCodeAt(1),H){case 100:case 109:case 115:case 45:Y=J;break;default:Y=D}if(xe=e(J,Y,xe,H,S+1),W=xe.length,0<M&&(Y=r(D,X,me),Se=o(3,xe,Y,J,z,F,W,H,S,oe),X=Y.join(""),Se!==void 0&&(W=(xe=Se.trim()).length)===0&&(H=0,xe="")),0<W)switch(H){case 115:X=X.replace(O,s);case 100:case 109:case 45:xe=X+"{"+xe+"}";break;case 107:X=X.replace(y,"$1 $2"),xe=X+"{"+xe+"}",xe=L===1||L===2&&a("@"+xe,3)?"@-webkit-"+xe+"@"+xe:"@"+xe;break;default:xe=X+xe,oe===112&&(xe=(ce+=xe,""))}else xe="";break;default:xe=e(J,r(J,X,me),xe,oe,S+1)}pe+=xe,xe=me=Y=C=se=0,X="",H=ie.charCodeAt(++B);break;case 125:case 59:if(X=(0<Y?X.replace(d,""):X).trim(),1<(W=X.length))switch(C===0&&(se=X.charCodeAt(0),se===45||96<se&&123>se)&&(W=(X=X.replace(" ",":")).length),0<M&&(Se=o(1,X,J,K,z,F,ce.length,oe,S,oe))!==void 0&&(W=(X=Se.trim()).length)===0&&(X="\0\0"),se=X.charCodeAt(0),H=X.charCodeAt(1),se){case 0:break;case 64:if(H===105||H===99){Ie+=X+ie.charAt(B);break}default:X.charCodeAt(W-1)!==58&&(ce+=i(X,se,H,X.charCodeAt(2)))}me=Y=C=se=0,X="",H=ie.charCodeAt(++B)}}switch(H){case 13:case 10:U===47?U=0:1+se===0&&oe!==107&&0<X.length&&(Y=1,X+="\0"),0<M*G&&o(0,X,J,K,z,F,ce.length,oe,S,oe),F=1,z++;break;case 59:case 125:if(U+ee+T+E===0){F++;break}default:switch(F++,le=ie.charAt(B),H){case 9:case 32:if(ee+E+U===0)switch(Oe){case 44:case 58:case 9:case 32:le="";break;default:H!==32&&(le=" ")}break;case 0:le="\\0";break;case 12:le="\\f";break;case 11:le="\\v";break;case 38:ee+U+E===0&&(Y=me=1,le="\f"+le);break;case 108:if(ee+U+E+N===0&&0<C)switch(B-C){case 2:Oe===112&&ie.charCodeAt(B-3)===58&&(N=Oe);case 8:be===111&&(N=be)}break;case 58:ee+U+E===0&&(C=B);break;case 44:U+T+ee+E===0&&(Y=1,le+="\r");break;case 34:case 39:U===0&&(ee=ee===H?0:ee===0?H:ee);break;case 91:ee+U+T===0&&E++;break;case 93:ee+U+T===0&&E--;break;case 41:ee+U+E===0&&T--;break;case 40:if(ee+U+E===0){if(se===0)switch(2*Oe+3*be){case 533:break;default:se=1}T++}break;case 64:U+T+ee+E+C+xe===0&&(xe=1);break;case 42:case 47:if(!(0<ee+E+T))switch(U){case 0:switch(2*H+3*ie.charCodeAt(B+1)){case 235:U=47;break;case 220:W=B,U=42}break;case 42:H===47&&Oe===42&&W+2!==B&&(ie.charCodeAt(W+2)===33&&(ce+=ie.substring(W,B+1)),le="",U=0)}}U===0&&(X+=le)}be=Oe,Oe=H,B++}if(W=ce.length,0<W){if(Y=J,0<M&&(Se=o(2,ce,Y,K,z,F,W,oe,S,oe),Se!==void 0&&(ce=Se).length===0))return Ie+ce+pe;if(ce=Y.join(",")+"{"+ce+"}",L*N!==0){switch(L!==2||a(ce,2)||(N=0),N){case 111:ce=ce.replace(w,":-moz-$1")+ce;break;case 112:ce=ce.replace(b,"::-webkit-input-$1")+ce.replace(b,"::-moz-$1")+ce.replace(b,":-ms-input-$1")+ce}N=0}}return Ie+ce+pe}function r(K,J,ie){var oe=J.trim().split(g);J=oe;var S=oe.length,E=K.length;switch(E){case 0:case 1:var U=0;for(K=E===0?"":K[0]+" ";U<S;++U)J[U]=n(K,J[U],ie).trim();break;default:var T=U=0;for(J=[];U<S;++U)for(var ee=0;ee<E;++ee)J[T++]=n(K[ee]+" ",oe[U],ie).trim()}return J}function n(K,J,ie){var oe=J.charCodeAt(0);switch(33>oe&&(oe=(J=J.trim()).charCodeAt(0)),oe){case 38:return J.replace(v,"$1"+K.trim());case 58:return K.trim()+J.replace(v,"$1"+K.trim());default:if(0<1*ie&&0<J.indexOf("\f"))return J.replace(v,(K.charCodeAt(0)===58?"":"$1")+K.trim())}return K+J}function i(K,J,ie,oe){var S=K+";",E=2*J+3*ie+4*oe;if(E===944){K=S.indexOf(":",9)+1;var U=S.substring(K,S.length-1).trim();return U=S.substring(0,K).trim()+U+";",L===1||L===2&&a(U,1)?"-webkit-"+U+U:U}if(L===0||L===2&&!a(S,1))return S;switch(E){case 1015:return S.charCodeAt(10)===97?"-webkit-"+S+S:S;case 951:return S.charCodeAt(3)===116?"-webkit-"+S+S:S;case 963:return S.charCodeAt(5)===110?"-webkit-"+S+S:S;case 1009:if(S.charCodeAt(4)!==100)break;case 969:case 942:return"-webkit-"+S+S;case 978:return"-webkit-"+S+"-moz-"+S+S;case 1019:case 983:return"-webkit-"+S+"-moz-"+S+"-ms-"+S+S;case 883:if(S.charCodeAt(8)===45)return"-webkit-"+S+S;if(0<S.indexOf("image-set(",11))return S.replace(R,"$1-webkit-$2")+S;break;case 932:if(S.charCodeAt(4)===45)switch(S.charCodeAt(5)){case 103:return"-webkit-box-"+S.replace("-grow","")+"-webkit-"+S+"-ms-"+S.replace("grow","positive")+S;case 115:return"-webkit-"+S+"-ms-"+S.replace("shrink","negative")+S;case 98:return"-webkit-"+S+"-ms-"+S.replace("basis","preferred-size")+S}return"-webkit-"+S+"-ms-"+S+S;case 964:return"-webkit-"+S+"-ms-flex-"+S+S;case 1023:if(S.charCodeAt(8)!==99)break;return U=S.substring(S.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),"-webkit-box-pack"+U+"-webkit-"+S+"-ms-flex-pack"+U+S;case 1005:return p.test(S)?S.replace(f,":-webkit-")+S.replace(f,":-moz-")+S:S;case 1e3:switch(U=S.substring(13).trim(),J=U.indexOf("-")+1,U.charCodeAt(0)+U.charCodeAt(J)){case 226:U=S.replace(_,"tb");break;case 232:U=S.replace(_,"tb-rl");break;case 220:U=S.replace(_,"lr");break;default:return S}return"-webkit-"+S+"-ms-"+U+S;case 1017:if(S.indexOf("sticky",9)===-1)break;case 975:switch(J=(S=K).length-10,U=(S.charCodeAt(J)===33?S.substring(0,J):S).substring(K.indexOf(":",7)+1).trim(),E=U.charCodeAt(0)+(U.charCodeAt(7)|0)){case 203:if(111>U.charCodeAt(8))break;case 115:S=S.replace(U,"-webkit-"+U)+";"+S;break;case 207:case 102:S=S.replace(U,"-webkit-"+(102<E?"inline-":"")+"box")+";"+S.replace(U,"-webkit-"+U)+";"+S.replace(U,"-ms-"+U+"box")+";"+S}return S+";";case 938:if(S.charCodeAt(5)===45)switch(S.charCodeAt(6)){case 105:return U=S.replace("-items",""),"-webkit-"+S+"-webkit-box-"+U+"-ms-flex-"+U+S;case 115:return"-webkit-"+S+"-ms-flex-item-"+S.replace(x,"")+S;default:return"-webkit-"+S+"-ms-flex-line-pack"+S.replace("align-content","").replace(x,"")+S}break;case 973:case 989:if(S.charCodeAt(3)!==45||S.charCodeAt(4)===122)break;case 931:case 953:if(k.test(K)===!0)return(U=K.substring(K.indexOf(":")+1)).charCodeAt(0)===115?i(K.replace("stretch","fill-available"),J,ie,oe).replace(":fill-available",":stretch"):S.replace(U,"-webkit-"+U)+S.replace(U,"-moz-"+U.replace("fill-",""))+S;break;case 962:if(S="-webkit-"+S+(S.charCodeAt(5)===102?"-ms-"+S:"")+S,ie+oe===211&&S.charCodeAt(13)===105&&0<S.indexOf("transform",10))return S.substring(0,S.indexOf(";",27)+1).replace(m,"$1-webkit-$2")+S}return S}function a(K,J){var ie=K.indexOf(J===1?":":"{"),oe=K.substring(0,J!==3?ie:10);return ie=K.substring(ie+1,K.length-1),V(J!==2?oe:oe.replace(j,"$1"),ie,J)}function s(K,J){var ie=i(J,J.charCodeAt(0),J.charCodeAt(1),J.charCodeAt(2));return ie!==J+";"?ie.replace(P," or ($1)").substring(4):"("+J+")"}function o(K,J,ie,oe,S,E,U,T,ee,se){for(var H=0,Oe=J,be;H<M;++H)switch(be=q[H].call(c,K,Oe,ie,oe,S,E,U,T,ee,se)){case void 0:case!1:case!0:case null:break;default:Oe=be}if(Oe!==J)return Oe}function u(K){switch(K){case void 0:case null:M=q.length=0;break;default:if(typeof K=="function")q[M++]=K;else if(typeof K=="object")for(var J=0,ie=K.length;J<ie;++J)u(K[J]);else G=!!K|0}return u}function l(K){return K=K.prefix,K!==void 0&&(V=null,K?typeof K!="function"?L=1:(L=2,V=K):L=0),l}function c(K,J){var ie=K;if(33>ie.charCodeAt(0)&&(ie=ie.trim()),re=ie,ie=[re],0<M){var oe=o(-1,J,ie,ie,z,F,0,0,0,0);oe!==void 0&&typeof oe=="string"&&(J=oe)}var S=e(D,ie,J,0,0);return 0<M&&(oe=o(-2,S,ie,ie,z,F,S.length,0,0,0),oe!==void 0&&(S=oe)),re="",N=0,F=z=1,S}var h=/^\0+/g,d=/[\0\r\f]/g,f=/: */g,p=/zoo|gra/,m=/([,: ])(transform)/g,g=/,\r+?/g,v=/([\t\r\n ])*\f?&/g,y=/@(k\w+)\s*(\S*)\s*/,b=/::(place)/g,w=/:(read-only)/g,_=/[svh]\w+-[tblr]{2}/,O=/\(\s*(.*)\s*\)/g,P=/([\s\S]*?);/g,x=/-self|flex-/g,j=/[^]*?(:[rp][el]a[\w-]+)[^]*/,k=/stretch|:\s*\w+\-(?:conte|avail)/,R=/([^-])(image-set\()/,F=1,z=1,N=0,L=1,D=[],q=[],M=0,V=null,G=0,re="";return c.use=u,c.set=l,t!==void 0&&l(t),c}var gZ={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function yZ(t){var e=Object.create(null);return function(r){return e[r]===void 0&&(e[r]=t(r)),e[r]}}var vZ=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Jj=yZ(function(t){return vZ.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),LT=Oh,bZ={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},wZ={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},_Z={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},aU={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},FT={};FT[LT.ForwardRef]=_Z;FT[LT.Memo]=aU;function Zj(t){return LT.isMemo(t)?aU:FT[t.$$typeof]||bZ}var xZ=Object.defineProperty,OZ=Object.getOwnPropertyNames,Xj=Object.getOwnPropertySymbols,SZ=Object.getOwnPropertyDescriptor,PZ=Object.getPrototypeOf,Qj=Object.prototype;function sU(t,e,r){if(typeof e!="string"){if(Qj){var n=PZ(e);n&&n!==Qj&&sU(t,n,r)}var i=OZ(e);Xj&&(i=i.concat(Xj(e)));for(var a=Zj(t),s=Zj(e),o=0;o<i.length;++o){var u=i[o];if(!wZ[u]&&!(r&&r[u])&&!(s&&s[u])&&!(a&&a[u])){var l=SZ(e,u);try{xZ(t,u,l)}catch{}}}}return t}var EZ=sU;const AZ=Ze(EZ);function Wa(){return(Wa=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}var eR=function(t,e){for(var r=[t[0]],n=0,i=e.length;n<i;n+=1)r.push(e[n],t[n+1]);return r},rP=function(t){return t!==null&&typeof t=="object"&&(t.toString?t.toString():Object.prototype.toString.call(t))==="[object Object]"&&!Oh.typeOf(t)},ib=Object.freeze([]),iu=Object.freeze({});function Lp(t){return typeof t=="function"}function tR(t){return t.displayName||t.name||"Component"}function UT(t){return t&&typeof t.styledComponentId=="string"}var Sh=typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_ATTR||{}.SC_ATTR)||"data-styled",zT=typeof window<"u"&&"HTMLElement"in window,TZ=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==""?{}.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&{}.REACT_APP_SC_DISABLE_SPEEDY:{}.SC_DISABLE_SPEEDY!==void 0&&{}.SC_DISABLE_SPEEDY!==""&&{}.SC_DISABLE_SPEEDY!=="false"&&{}.SC_DISABLE_SPEEDY)),kZ={};function cg(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];throw new Error("An error occurred. See https://git.io/JUIaE#"+t+" for more information."+(r.length>0?" Args: "+r.join(", "):""))}var CZ=function(){function t(r){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=r}var e=t.prototype;return e.indexOfGroup=function(r){for(var n=0,i=0;i<r;i++)n+=this.groupSizes[i];return n},e.insertRules=function(r,n){if(r>=this.groupSizes.length){for(var i=this.groupSizes,a=i.length,s=a;r>=s;)(s<<=1)<0&&cg(16,""+r);this.groupSizes=new Uint32Array(s),this.groupSizes.set(i),this.length=s;for(var o=a;o<s;o++)this.groupSizes[o]=0}for(var u=this.indexOfGroup(r+1),l=0,c=n.length;l<c;l++)this.tag.insertRule(u,n[l])&&(this.groupSizes[r]++,u++)},e.clearGroup=function(r){if(r<this.length){var n=this.groupSizes[r],i=this.indexOfGroup(r),a=i+n;this.groupSizes[r]=0;for(var s=i;s<a;s++)this.tag.deleteRule(i)}},e.getGroup=function(r){var n="";if(r>=this.length||this.groupSizes[r]===0)return n;for(var i=this.groupSizes[r],a=this.indexOfGroup(r),s=a+i,o=a;o<s;o++)n+=this.tag.getRule(o)+`/*!sc*/
`;return n},t}(),pv=new Map,ab=new Map,np=1,fy=function(t){if(pv.has(t))return pv.get(t);for(;ab.has(np);)np++;var e=np++;return pv.set(t,e),ab.set(e,t),e},IZ=function(t){return ab.get(t)},$Z=function(t,e){e>=np&&(np=e+1),pv.set(t,e),ab.set(e,t)},jZ="style["+Sh+'][data-styled-version="5.3.10"]',RZ=new RegExp("^"+Sh+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),NZ=function(t,e,r){for(var n,i=r.split(","),a=0,s=i.length;a<s;a++)(n=i[a])&&t.registerName(e,n)},MZ=function(t,e){for(var r=(e.textContent||"").split(`/*!sc*/
`),n=[],i=0,a=r.length;i<a;i++){var s=r[i].trim();if(s){var o=s.match(RZ);if(o){var u=0|parseInt(o[1],10),l=o[2];u!==0&&($Z(l,u),NZ(t,l,o[3]),t.getTag().insertRules(u,n)),n.length=0}else n.push(s)}}},DZ=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null},oU=function(t){var e=document.head,r=t||e,n=document.createElement("style"),i=function(o){for(var u=o.childNodes,l=u.length;l>=0;l--){var c=u[l];if(c&&c.nodeType===1&&c.hasAttribute(Sh))return c}}(r),a=i!==void 0?i.nextSibling:null;n.setAttribute(Sh,"active"),n.setAttribute("data-styled-version","5.3.10");var s=DZ();return s&&n.setAttribute("nonce",s),r.insertBefore(n,a),n},LZ=function(){function t(r){var n=this.element=oU(r);n.appendChild(document.createTextNode("")),this.sheet=function(i){if(i.sheet)return i.sheet;for(var a=document.styleSheets,s=0,o=a.length;s<o;s++){var u=a[s];if(u.ownerNode===i)return u}cg(17)}(n),this.length=0}var e=t.prototype;return e.insertRule=function(r,n){try{return this.sheet.insertRule(n,r),this.length++,!0}catch{return!1}},e.deleteRule=function(r){this.sheet.deleteRule(r),this.length--},e.getRule=function(r){var n=this.sheet.cssRules[r];return n!==void 0&&typeof n.cssText=="string"?n.cssText:""},t}(),FZ=function(){function t(r){var n=this.element=oU(r);this.nodes=n.childNodes,this.length=0}var e=t.prototype;return e.insertRule=function(r,n){if(r<=this.length&&r>=0){var i=document.createTextNode(n),a=this.nodes[r];return this.element.insertBefore(i,a||null),this.length++,!0}return!1},e.deleteRule=function(r){this.element.removeChild(this.nodes[r]),this.length--},e.getRule=function(r){return r<this.length?this.nodes[r].textContent:""},t}(),UZ=function(){function t(r){this.rules=[],this.length=0}var e=t.prototype;return e.insertRule=function(r,n){return r<=this.length&&(this.rules.splice(r,0,n),this.length++,!0)},e.deleteRule=function(r){this.rules.splice(r,1),this.length--},e.getRule=function(r){return r<this.length?this.rules[r]:""},t}(),rR=zT,zZ={isServer:!zT,useCSSOMInjection:!TZ},sb=function(){function t(r,n,i){r===void 0&&(r=iu),n===void 0&&(n={}),this.options=Wa({},zZ,{},r),this.gs=n,this.names=new Map(i),this.server=!!r.isServer,!this.server&&zT&&rR&&(rR=!1,function(a){for(var s=document.querySelectorAll(jZ),o=0,u=s.length;o<u;o++){var l=s[o];l&&l.getAttribute(Sh)!=="active"&&(MZ(a,l),l.parentNode&&l.parentNode.removeChild(l))}}(this))}t.registerId=function(r){return fy(r)};var e=t.prototype;return e.reconstructWithOptions=function(r,n){return n===void 0&&(n=!0),new t(Wa({},this.options,{},r),this.gs,n&&this.names||void 0)},e.allocateGSInstance=function(r){return this.gs[r]=(this.gs[r]||0)+1},e.getTag=function(){return this.tag||(this.tag=(i=(n=this.options).isServer,a=n.useCSSOMInjection,s=n.target,r=i?new UZ(s):a?new LZ(s):new FZ(s),new CZ(r)));var r,n,i,a,s},e.hasNameForId=function(r,n){return this.names.has(r)&&this.names.get(r).has(n)},e.registerName=function(r,n){if(fy(r),this.names.has(r))this.names.get(r).add(n);else{var i=new Set;i.add(n),this.names.set(r,i)}},e.insertRules=function(r,n,i){this.registerName(r,n),this.getTag().insertRules(fy(r),i)},e.clearNames=function(r){this.names.has(r)&&this.names.get(r).clear()},e.clearRules=function(r){this.getTag().clearGroup(fy(r)),this.clearNames(r)},e.clearTag=function(){this.tag=void 0},e.toString=function(){return function(r){for(var n=r.getTag(),i=n.length,a="",s=0;s<i;s++){var o=IZ(s);if(o!==void 0){var u=r.names.get(o),l=n.getGroup(s);if(u&&l&&u.size){var c=Sh+".g"+s+'[id="'+o+'"]',h="";u!==void 0&&u.forEach(function(d){d.length>0&&(h+=d+",")}),a+=""+l+c+'{content:"'+h+`"}/*!sc*/
`}}}return a}(this)},t}(),BZ=/(a)(d)/gi,nR=function(t){return String.fromCharCode(t+(t>25?39:97))};function nP(t){var e,r="";for(e=Math.abs(t);e>52;e=e/52|0)r=nR(e%52)+r;return(nR(e%52)+r).replace(BZ,"$1-$2")}var Lc=function(t,e){for(var r=e.length;r;)t=33*t^e.charCodeAt(--r);return t},uU=function(t){return Lc(5381,t)};function lU(t){for(var e=0;e<t.length;e+=1){var r=t[e];if(Lp(r)&&!UT(r))return!1}return!0}var qZ=uU("5.3.10"),KZ=function(){function t(e,r,n){this.rules=e,this.staticRulesId="",this.isStatic=(n===void 0||n.isStatic)&&lU(e),this.componentId=r,this.baseHash=Lc(qZ,r),this.baseStyle=n,sb.registerId(r)}return t.prototype.generateAndInjectStyles=function(e,r,n){var i=this.componentId,a=[];if(this.baseStyle&&a.push(this.baseStyle.generateAndInjectStyles(e,r,n)),this.isStatic&&!n.hash)if(this.staticRulesId&&r.hasNameForId(i,this.staticRulesId))a.push(this.staticRulesId);else{var s=Sl(this.rules,e,r,n).join(""),o=nP(Lc(this.baseHash,s)>>>0);if(!r.hasNameForId(i,o)){var u=n(s,"."+o,void 0,i);r.insertRules(i,o,u)}a.push(o),this.staticRulesId=o}else{for(var l=this.rules.length,c=Lc(this.baseHash,n.hash),h="",d=0;d<l;d++){var f=this.rules[d];if(typeof f=="string")h+=f;else if(f){var p=Sl(f,e,r,n),m=Array.isArray(p)?p.join(""):p;c=Lc(c,m+d),h+=m}}if(h){var g=nP(c>>>0);if(!r.hasNameForId(i,g)){var v=n(h,"."+g,void 0,i);r.insertRules(i,g,v)}a.push(g)}}return a.join(" ")},t}(),VZ=/^\s*\/\/.*$/gm,HZ=[":","[",".","#"];function WZ(t){var e,r,n,i,a=t===void 0?iu:t,s=a.options,o=s===void 0?iu:s,u=a.plugins,l=u===void 0?ib:u,c=new mZ(o),h=[],d=function(m){function g(v){if(v)try{m(v+"}")}catch{}}return function(v,y,b,w,_,O,P,x,j,k){switch(v){case 1:if(j===0&&y.charCodeAt(0)===64)return m(y+";"),"";break;case 2:if(x===0)return y+"/*|*/";break;case 3:switch(x){case 102:case 112:return m(b[0]+y),"";default:return y+(k===0?"/*|*/":"")}case-2:y.split("/*|*/}").forEach(g)}}}(function(m){h.push(m)}),f=function(m,g,v){return g===0&&HZ.indexOf(v[r.length])!==-1||v.match(i)?m:"."+e};function p(m,g,v,y){y===void 0&&(y="&");var b=m.replace(VZ,""),w=g&&v?v+" "+g+" { "+b+" }":b;return e=y,r=g,n=new RegExp("\\"+r+"\\b","g"),i=new RegExp("(\\"+r+"\\b){2,}"),c(v||!g?"":g,w)}return c.use([].concat(l,[function(m,g,v){m===2&&v.length&&v[0].lastIndexOf(r)>0&&(v[0]=v[0].replace(n,f))},d,function(m){if(m===-2){var g=h;return h=[],g}}])),p.hash=l.length?l.reduce(function(m,g){return g.name||cg(15),Lc(m,g.name)},5381).toString():"",p}var cU=$.createContext();cU.Consumer;var hU=$.createContext(),GZ=(hU.Consumer,new sb),iP=WZ();function dU(){return I.useContext(cU)||GZ}function fU(){return I.useContext(hU)||iP}var pU=function(){function t(e,r){var n=this;this.inject=function(i,a){a===void 0&&(a=iP);var s=n.name+a.hash;i.hasNameForId(n.id,s)||i.insertRules(n.id,s,a(n.rules,s,"@keyframes"))},this.toString=function(){return cg(12,String(n.name))},this.name=e,this.id="sc-keyframes-"+e,this.rules=r}return t.prototype.getName=function(e){return e===void 0&&(e=iP),this.name+e.hash},t}(),YZ=/([A-Z])/,JZ=/([A-Z])/g,ZZ=/^ms-/,XZ=function(t){return"-"+t.toLowerCase()};function iR(t){return YZ.test(t)?t.replace(JZ,XZ).replace(ZZ,"-ms-"):t}var aR=function(t){return t==null||t===!1||t===""};function Sl(t,e,r,n){if(Array.isArray(t)){for(var i,a=[],s=0,o=t.length;s<o;s+=1)(i=Sl(t[s],e,r,n))!==""&&(Array.isArray(i)?a.push.apply(a,i):a.push(i));return a}if(aR(t))return"";if(UT(t))return"."+t.styledComponentId;if(Lp(t)){if(typeof(l=t)!="function"||l.prototype&&l.prototype.isReactComponent||!e)return t;var u=t(e);return Sl(u,e,r,n)}var l;return t instanceof pU?r?(t.inject(r,n),t.getName(n)):t:rP(t)?function c(h,d){var f,p,m=[];for(var g in h)h.hasOwnProperty(g)&&!aR(h[g])&&(Array.isArray(h[g])&&h[g].isCss||Lp(h[g])?m.push(iR(g)+":",h[g],";"):rP(h[g])?m.push.apply(m,c(h[g],g)):m.push(iR(g)+": "+(f=g,(p=h[g])==null||typeof p=="boolean"||p===""?"":typeof p!="number"||p===0||f in gZ||f.startsWith("--")?String(p).trim():p+"px")+";"));return d?[d+" {"].concat(m,["}"]):m}(t):t.toString()}var sR=function(t){return Array.isArray(t)&&(t.isCss=!0),t};function $r(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Lp(t)||rP(t)?sR(Sl(eR(ib,[t].concat(r)))):r.length===0&&t.length===1&&typeof t[0]=="string"?t:sR(Sl(eR(t,r)))}var mU=function(t,e,r){return r===void 0&&(r=iu),t.theme!==r.theme&&t.theme||e||r.theme},QZ=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,eX=/(^-|-$)/g;function hx(t){return t.replace(QZ,"-").replace(eX,"")}var BT=function(t){return nP(uU(t)>>>0)};function py(t){return typeof t=="string"&&!0}var aP=function(t){return typeof t=="function"||typeof t=="object"&&t!==null&&!Array.isArray(t)},tX=function(t){return t!=="__proto__"&&t!=="constructor"&&t!=="prototype"};function rX(t,e,r){var n=t[r];aP(e)&&aP(n)?gU(n,e):t[r]=e}function gU(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];for(var i=0,a=r;i<a.length;i++){var s=a[i];if(aP(s))for(var o in s)tX(o)&&rX(t,s[o],o)}return t}var qT=$.createContext();qT.Consumer;var dx={};function yU(t,e,r){var n=UT(t),i=!py(t),a=e.attrs,s=a===void 0?ib:a,o=e.componentId,u=o===void 0?function(y,b){var w=typeof y!="string"?"sc":hx(y);dx[w]=(dx[w]||0)+1;var _=w+"-"+BT("5.3.10"+w+dx[w]);return b?b+"-"+_:_}(e.displayName,e.parentComponentId):o,l=e.displayName,c=l===void 0?function(y){return py(y)?"styled."+y:"Styled("+tR(y)+")"}(t):l,h=e.displayName&&e.componentId?hx(e.displayName)+"-"+e.componentId:e.componentId||u,d=n&&t.attrs?Array.prototype.concat(t.attrs,s).filter(Boolean):s,f=e.shouldForwardProp;n&&t.shouldForwardProp&&(f=e.shouldForwardProp?function(y,b,w){return t.shouldForwardProp(y,b,w)&&e.shouldForwardProp(y,b,w)}:t.shouldForwardProp);var p,m=new KZ(r,h,n?t.componentStyle:void 0),g=m.isStatic&&s.length===0,v=function(y,b){return function(w,_,O,P){var x=w.attrs,j=w.componentStyle,k=w.defaultProps,R=w.foldedComponentIds,F=w.shouldForwardProp,z=w.styledComponentId,N=w.target,L=function(oe,S,E){oe===void 0&&(oe=iu);var U=Wa({},S,{theme:oe}),T={};return E.forEach(function(ee){var se,H,Oe,be=ee;for(se in Lp(be)&&(be=be(U)),be)U[se]=T[se]=se==="className"?(H=T[se],Oe=be[se],H&&Oe?H+" "+Oe:H||Oe):be[se]}),[U,T]}(mU(_,I.useContext(qT),k)||iu,_,x),D=L[0],q=L[1],M=function(oe,S,E,U){var T=dU(),ee=fU(),se=S?oe.generateAndInjectStyles(iu,T,ee):oe.generateAndInjectStyles(E,T,ee);return se}(j,P,D),V=O,G=q.$as||_.$as||q.as||_.as||N,re=py(G),K=q!==_?Wa({},_,{},q):_,J={};for(var ie in K)ie[0]!=="$"&&ie!=="as"&&(ie==="forwardedAs"?J.as=K[ie]:(F?F(ie,Jj,G):!re||Jj(ie))&&(J[ie]=K[ie]));return _.style&&q.style!==_.style&&(J.style=Wa({},_.style,{},q.style)),J.className=Array.prototype.concat(R,z,M!==z?M:null,_.className,q.className).filter(Boolean).join(" "),J.ref=V,I.createElement(G,J)}(p,y,b,g)};return v.displayName=c,(p=$.forwardRef(v)).attrs=d,p.componentStyle=m,p.displayName=c,p.shouldForwardProp=f,p.foldedComponentIds=n?Array.prototype.concat(t.foldedComponentIds,t.styledComponentId):ib,p.styledComponentId=h,p.target=n?t.target:t,p.withComponent=function(y){var b=e.componentId,w=function(O,P){if(O==null)return{};var x,j,k={},R=Object.keys(O);for(j=0;j<R.length;j++)x=R[j],P.indexOf(x)>=0||(k[x]=O[x]);return k}(e,["componentId"]),_=b&&b+"-"+(py(y)?y:hx(tR(y)));return yU(y,Wa({},w,{attrs:d,componentId:_}),r)},Object.defineProperty(p,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(y){this._foldedDefaultProps=n?gU({},t.defaultProps,y):y}}),Object.defineProperty(p,"toString",{value:function(){return"."+p.styledComponentId}}),i&&AZ(p,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),p}var sP=function(t){return function e(r,n,i){if(i===void 0&&(i=iu),!Oh.isValidElementType(n))return cg(1,String(n));var a=function(){return r(n,i,$r.apply(void 0,arguments))};return a.withConfig=function(s){return e(r,n,Wa({},i,{},s))},a.attrs=function(s){return e(r,n,Wa({},i,{attrs:Array.prototype.concat(i.attrs,s).filter(Boolean)}))},a}(yU,t)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach(function(t){sP[t]=sP(t)});var nX=function(){function t(r,n){this.rules=r,this.componentId=n,this.isStatic=lU(r),sb.registerId(this.componentId+1)}var e=t.prototype;return e.createStyles=function(r,n,i,a){var s=a(Sl(this.rules,n,i,a).join(""),""),o=this.componentId+r;i.insertRules(o,o,s)},e.removeStyles=function(r,n){n.clearRules(this.componentId+r)},e.renderStyles=function(r,n,i,a){r>2&&sb.registerId(this.componentId+r),this.removeStyles(r,i),this.createStyles(r,n,i,a)},t}();function iX(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i=$r.apply(void 0,[t].concat(r)),a="sc-global-"+BT(JSON.stringify(i)),s=new nX(i,a);function o(l){var c=dU(),h=fU(),d=I.useContext(qT),f=I.useRef(c.allocateGSInstance(a)).current;return c.server&&u(f,l,c,d,h),I.useLayoutEffect(function(){if(!c.server)return u(f,l,c,d,h),function(){return s.removeStyles(f,c)}},[f,l,c,d,h]),null}function u(l,c,h,d,f){if(s.isStatic)s.renderStyles(l,kZ,h,f);else{var p=Wa({},c,{theme:mU(c,d,o.defaultProps)});s.renderStyles(l,p,h,f)}}return $.memo(o)}function vU(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i=$r.apply(void 0,[t].concat(r)).join(""),a=BT(i);return new pU(a,i)}const ue=sP,bU=iX`
:root {
  &, &.light-mode {
  /* Grey */
  --color-grey-0: #fff;
  --color-grey-50: #f9fafb;
  --color-grey-100: #f3f4f6;
  --color-grey-200: #e5e7eb;
  --color-grey-300: #d1d5db;
  --color-grey-400: #9ca3af;
  --color-grey-500: #6b7280;
  --color-grey-600: #4b5563;
  --color-grey-700: #374151;
  --color-grey-800: #1f2937;
  --color-grey-900: #111827;

  --color-blue-100: #e0f2fe;
  --color-blue-700: #0369a1;
  --color-green-100: #dcfce7;
  --color-green-700: #15803d;
  --color-yellow-100: #fef9c3;
  --color-yellow-700: #a16207;
  --color-silver-100: #e5e7eb;
  --color-silver-700: #374151;
  --color-indigo-100: #e0e7ff;
  --color-indigo-700: #4338ca;

  --color-red-100: #fee2e2;
  --color-red-700: #b91c1c;
  --color-red-800: #991b1b;

  --backdrop-color: rgba(255, 255, 255, 0.1);

  --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.04);
  --shadow-md: 0px 0.6rem 2.4rem rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 2.4rem 3.2rem rgba(0, 0, 0, 0.12);
  

    --image-grayscale: 0;
  --image-opacity: 100%;
  }
  
  &.dark-mode {
    --color-grey-0: #18212f;
--color-grey-50: #111827;
--color-grey-100: #1f2937;
--color-grey-200: #374151;
--color-grey-300: #4b5563;
--color-grey-400: #6b7280;
--color-grey-500: #9ca3af;
--color-grey-600: #d1d5db;
--color-grey-700: #e5e7eb;
--color-grey-800: #f3f4f6;
--color-grey-900: #f9fafb;

--color-blue-100: #075985;
--color-blue-700: #e0f2fe;
--color-green-100: #166534;
--color-green-700: #dcfce7;
--color-yellow-100: #854d0e;
--color-yellow-700: #fef9c3;
--color-silver-100: #374151;
--color-silver-700: #f3f4f6;
--color-indigo-100: #3730a3;
--color-indigo-700: #e0e7ff;

--color-red-100: #fee2e2;
--color-red-700: #b91c1c;
--color-red-800: #991b1b;

--backdrop-color: rgba(0, 0, 0, 0.3);

--shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.4);
--shadow-md: 0px 0.6rem 2.4rem rgba(0, 0, 0, 0.3);
--shadow-lg: 0 2.4rem 3.2rem rgba(0, 0, 0, 0.4);

--image-grayscale: 10%;
--image-opacity: 90%;
  }
  
  /* Indigo */
  --color-brand-50: #eef2ff;
  --color-brand-100: #e0e7ff;
  --color-brand-200: #c7d2fe;
  --color-brand-500: #6366f1;
  --color-brand-600: #4f46e5;
  --color-brand-700: #4338ca;
  --color-brand-800: #3730a3;
  --color-brand-900: #312e81;
  
  --border-radius-tiny: 3px;
  --border-radius-sm: 5px;
  --border-radius-md: 7px;
  --border-radius-lg: 9px;


}

*,
*::before,
*::after {
  box-sizing: border-box;
  padding: 0;
  margin: 0;

  /* Creating animations for dark mode */
  transition: background-color 0.3s, border 0.3s;
}

html {
  font-size: 62.5%;
}

body {
  font-family: "Poppins", sans-serif;
  color: var(--color-grey-700);

  transition: color 0.3s, background-color 0.3s;
  min-height: 100vh;
  line-height: 1.5;
  font-size: 1.6rem;
}

input,
button,
textarea,
select {
  font: inherit;
  color: inherit;
}

button {
  cursor: pointer;
}

*:disabled {
  cursor: not-allowed;
}

select:disabled,
input:disabled {
  background-color: var(--color-grey-200);
  color: var(--color-grey-500);
}

input:focus,
button:focus,
textarea:focus,
select:focus {
  outline: 2px solid var(--color-brand-600);
  outline-offset: -1px;
}

/* Parent selector, finally 😃 */
button:has(svg) {
  line-height: 0;
}

a {
  color: inherit;
  text-decoration: none;
}

ul {
  list-style: none;
}

p,
h1,
h2,
h3,
h4,
h5,
h6 {
  overflow-wrap: break-word;
  hyphens: auto;
}

img {
  max-width: 100%;

  /* For dark mode */
  filter: grayscale(var(--image-grayscale)) opacity(var(--image-opacity));
}

`;function ob(t){return ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ob(t)}function os(t){if(t===null||t===!0||t===!1)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function ot(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function at(t){ot(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||ob(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function aX(t,e){ot(2,arguments);var r=at(t),n=os(e);return isNaN(n)?new Date(NaN):(n&&r.setDate(r.getDate()+n),r)}function sX(t,e){ot(2,arguments);var r=at(t).getTime(),n=os(e);return new Date(r+n)}var oX={};function hg(){return oX}function oP(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function oR(t){ot(1,arguments);var e=at(t);return e.setHours(0,0,0,0),e}function mv(t,e){ot(2,arguments);var r=at(t),n=at(e),i=r.getTime()-n.getTime();return i<0?-1:i>0?1:i}var wU=6e4,_U=36e5;function uP(t,e){ot(2,arguments);var r=oR(t),n=oR(e);return r.getTime()===n.getTime()}function uX(t){return ot(1,arguments),t instanceof Date||ob(t)==="object"&&Object.prototype.toString.call(t)==="[object Date]"}function lX(t){if(ot(1,arguments),!uX(t)&&typeof t!="number")return!1;var e=at(t);return!isNaN(Number(e))}function cX(t,e){ot(2,arguments);var r=at(t),n=at(e),i=r.getFullYear()-n.getFullYear(),a=r.getMonth()-n.getMonth();return i*12+a}function hX(t,e){return ot(2,arguments),at(t).getTime()-at(e).getTime()}var uR={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},dX="trunc";function fX(t){return t?uR[t]:uR[dX]}function pX(t){ot(1,arguments);var e=at(t);return e.setHours(23,59,59,999),e}function mX(t){ot(1,arguments);var e=at(t),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}function gX(t){ot(1,arguments);var e=at(t);return pX(e).getTime()===mX(e).getTime()}function yX(t,e){ot(2,arguments);var r=at(t),n=at(e),i=mv(r,n),a=Math.abs(cX(r,n)),s;if(a<1)s=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-i*a);var o=mv(r,n)===-i;gX(at(t))&&a===1&&mv(t,n)===1&&(o=!1),s=i*(a-Number(o))}return s===0?0:s}function vX(t,e,r){ot(2,arguments);var n=hX(t,e)/1e3;return fX(r==null?void 0:r.roundingMethod)(n)}function bX(t,e){var r;ot(1,arguments);var n=t||{},i=at(n.start),a=at(n.end),s=a.getTime();if(!(i.getTime()<=s))throw new RangeError("Invalid interval");var o=[],u=i;u.setHours(0,0,0,0);var l=Number((r=e==null?void 0:e.step)!==null&&r!==void 0?r:1);if(l<1||isNaN(l))throw new RangeError("`options.step` must be a number greater than 1");for(;u.getTime()<=s;)o.push(at(u)),u.setDate(u.getDate()+l),u.setHours(0,0,0,0);return o}function wX(t,e){ot(2,arguments);var r=os(e);return sX(t,-r)}var _X=864e5;function xX(t){ot(1,arguments);var e=at(t),r=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var n=e.getTime(),i=r-n;return Math.floor(i/_X)+1}function ub(t){ot(1,arguments);var e=1,r=at(t),n=r.getUTCDay(),i=(n<e?7:0)+n-e;return r.setUTCDate(r.getUTCDate()-i),r.setUTCHours(0,0,0,0),r}function xU(t){ot(1,arguments);var e=at(t),r=e.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(r+1,0,4),n.setUTCHours(0,0,0,0);var i=ub(n),a=new Date(0);a.setUTCFullYear(r,0,4),a.setUTCHours(0,0,0,0);var s=ub(a);return e.getTime()>=i.getTime()?r+1:e.getTime()>=s.getTime()?r:r-1}function OX(t){ot(1,arguments);var e=xU(t),r=new Date(0);r.setUTCFullYear(e,0,4),r.setUTCHours(0,0,0,0);var n=ub(r);return n}var SX=6048e5;function PX(t){ot(1,arguments);var e=at(t),r=ub(e).getTime()-OX(e).getTime();return Math.round(r/SX)+1}function lb(t,e){var r,n,i,a,s,o,u,l;ot(1,arguments);var c=hg(),h=os((r=(n=(i=(a=e==null?void 0:e.weekStartsOn)!==null&&a!==void 0?a:e==null||(s=e.locale)===null||s===void 0||(o=s.options)===null||o===void 0?void 0:o.weekStartsOn)!==null&&i!==void 0?i:c.weekStartsOn)!==null&&n!==void 0?n:(u=c.locale)===null||u===void 0||(l=u.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&r!==void 0?r:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=at(t),f=d.getUTCDay(),p=(f<h?7:0)+f-h;return d.setUTCDate(d.getUTCDate()-p),d.setUTCHours(0,0,0,0),d}function OU(t,e){var r,n,i,a,s,o,u,l;ot(1,arguments);var c=at(t),h=c.getUTCFullYear(),d=hg(),f=os((r=(n=(i=(a=e==null?void 0:e.firstWeekContainsDate)!==null&&a!==void 0?a:e==null||(s=e.locale)===null||s===void 0||(o=s.options)===null||o===void 0?void 0:o.firstWeekContainsDate)!==null&&i!==void 0?i:d.firstWeekContainsDate)!==null&&n!==void 0?n:(u=d.locale)===null||u===void 0||(l=u.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var p=new Date(0);p.setUTCFullYear(h+1,0,f),p.setUTCHours(0,0,0,0);var m=lb(p,e),g=new Date(0);g.setUTCFullYear(h,0,f),g.setUTCHours(0,0,0,0);var v=lb(g,e);return c.getTime()>=m.getTime()?h+1:c.getTime()>=v.getTime()?h:h-1}function EX(t,e){var r,n,i,a,s,o,u,l;ot(1,arguments);var c=hg(),h=os((r=(n=(i=(a=e==null?void 0:e.firstWeekContainsDate)!==null&&a!==void 0?a:e==null||(s=e.locale)===null||s===void 0||(o=s.options)===null||o===void 0?void 0:o.firstWeekContainsDate)!==null&&i!==void 0?i:c.firstWeekContainsDate)!==null&&n!==void 0?n:(u=c.locale)===null||u===void 0||(l=u.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&r!==void 0?r:1),d=OU(t,e),f=new Date(0);f.setUTCFullYear(d,0,h),f.setUTCHours(0,0,0,0);var p=lb(f,e);return p}var AX=6048e5;function TX(t,e){ot(1,arguments);var r=at(t),n=lb(r,e).getTime()-EX(r,e).getTime();return Math.round(n/AX)+1}function lt(t,e){for(var r=t<0?"-":"",n=Math.abs(t).toString();n.length<e;)n="0"+n;return r+n}var kX={y:function(e,r){var n=e.getUTCFullYear(),i=n>0?n:1-n;return lt(r==="yy"?i%100:i,r.length)},M:function(e,r){var n=e.getUTCMonth();return r==="M"?String(n+1):lt(n+1,2)},d:function(e,r){return lt(e.getUTCDate(),r.length)},a:function(e,r){var n=e.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h:function(e,r){return lt(e.getUTCHours()%12||12,r.length)},H:function(e,r){return lt(e.getUTCHours(),r.length)},m:function(e,r){return lt(e.getUTCMinutes(),r.length)},s:function(e,r){return lt(e.getUTCSeconds(),r.length)},S:function(e,r){var n=r.length,i=e.getUTCMilliseconds(),a=Math.floor(i*Math.pow(10,n-3));return lt(a,r.length)}};const Oo=kX;var nc={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},CX={G:function(e,r,n){var i=e.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});case"GGGG":default:return n.era(i,{width:"wide"})}},y:function(e,r,n){if(r==="yo"){var i=e.getUTCFullYear(),a=i>0?i:1-i;return n.ordinalNumber(a,{unit:"year"})}return Oo.y(e,r)},Y:function(e,r,n,i){var a=OU(e,i),s=a>0?a:1-a;if(r==="YY"){var o=s%100;return lt(o,2)}return r==="Yo"?n.ordinalNumber(s,{unit:"year"}):lt(s,r.length)},R:function(e,r){var n=xU(e);return lt(n,r.length)},u:function(e,r){var n=e.getUTCFullYear();return lt(n,r.length)},Q:function(e,r,n){var i=Math.ceil((e.getUTCMonth()+1)/3);switch(r){case"Q":return String(i);case"QQ":return lt(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,r,n){var i=Math.ceil((e.getUTCMonth()+1)/3);switch(r){case"q":return String(i);case"qq":return lt(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,r,n){var i=e.getUTCMonth();switch(r){case"M":case"MM":return Oo.M(e,r);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(e,r,n){var i=e.getUTCMonth();switch(r){case"L":return String(i+1);case"LL":return lt(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(e,r,n,i){var a=TX(e,i);return r==="wo"?n.ordinalNumber(a,{unit:"week"}):lt(a,r.length)},I:function(e,r,n){var i=PX(e);return r==="Io"?n.ordinalNumber(i,{unit:"week"}):lt(i,r.length)},d:function(e,r,n){return r==="do"?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):Oo.d(e,r)},D:function(e,r,n){var i=xX(e);return r==="Do"?n.ordinalNumber(i,{unit:"dayOfYear"}):lt(i,r.length)},E:function(e,r,n){var i=e.getUTCDay();switch(r){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});case"EEEE":default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(e,r,n,i){var a=e.getUTCDay(),s=(a-i.weekStartsOn+8)%7||7;switch(r){case"e":return String(s);case"ee":return lt(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,r,n,i){var a=e.getUTCDay(),s=(a-i.weekStartsOn+8)%7||7;switch(r){case"c":return String(s);case"cc":return lt(s,r.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,r,n){var i=e.getUTCDay(),a=i===0?7:i;switch(r){case"i":return String(a);case"ii":return lt(a,r.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});case"iiii":default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(e,r,n){var i=e.getUTCHours(),a=i/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,r,n){var i=e.getUTCHours(),a;switch(i===12?a=nc.noon:i===0?a=nc.midnight:a=i/12>=1?"pm":"am",r){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,r,n){var i=e.getUTCHours(),a;switch(i>=17?a=nc.evening:i>=12?a=nc.afternoon:i>=4?a=nc.morning:a=nc.night,r){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,r,n){if(r==="ho"){var i=e.getUTCHours()%12;return i===0&&(i=12),n.ordinalNumber(i,{unit:"hour"})}return Oo.h(e,r)},H:function(e,r,n){return r==="Ho"?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):Oo.H(e,r)},K:function(e,r,n){var i=e.getUTCHours()%12;return r==="Ko"?n.ordinalNumber(i,{unit:"hour"}):lt(i,r.length)},k:function(e,r,n){var i=e.getUTCHours();return i===0&&(i=24),r==="ko"?n.ordinalNumber(i,{unit:"hour"}):lt(i,r.length)},m:function(e,r,n){return r==="mo"?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):Oo.m(e,r)},s:function(e,r,n){return r==="so"?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):Oo.s(e,r)},S:function(e,r){return Oo.S(e,r)},X:function(e,r,n,i){var a=i._originalDate||e,s=a.getTimezoneOffset();if(s===0)return"Z";switch(r){case"X":return cR(s);case"XXXX":case"XX":return Lu(s);case"XXXXX":case"XXX":default:return Lu(s,":")}},x:function(e,r,n,i){var a=i._originalDate||e,s=a.getTimezoneOffset();switch(r){case"x":return cR(s);case"xxxx":case"xx":return Lu(s);case"xxxxx":case"xxx":default:return Lu(s,":")}},O:function(e,r,n,i){var a=i._originalDate||e,s=a.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+lR(s,":");case"OOOO":default:return"GMT"+Lu(s,":")}},z:function(e,r,n,i){var a=i._originalDate||e,s=a.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+lR(s,":");case"zzzz":default:return"GMT"+Lu(s,":")}},t:function(e,r,n,i){var a=i._originalDate||e,s=Math.floor(a.getTime()/1e3);return lt(s,r.length)},T:function(e,r,n,i){var a=i._originalDate||e,s=a.getTime();return lt(s,r.length)}};function lR(t,e){var r=t>0?"-":"+",n=Math.abs(t),i=Math.floor(n/60),a=n%60;if(a===0)return r+String(i);var s=e||"";return r+String(i)+s+lt(a,2)}function cR(t,e){if(t%60===0){var r=t>0?"-":"+";return r+lt(Math.abs(t)/60,2)}return Lu(t,e)}function Lu(t,e){var r=e||"",n=t>0?"-":"+",i=Math.abs(t),a=lt(Math.floor(i/60),2),s=lt(i%60,2);return n+a+r+s}const IX=CX;var hR=function(e,r){switch(e){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},SU=function(e,r){switch(e){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},$X=function(e,r){var n=e.match(/(P+)(p+)?/)||[],i=n[1],a=n[2];if(!a)return hR(e,r);var s;switch(i){case"P":s=r.dateTime({width:"short"});break;case"PP":s=r.dateTime({width:"medium"});break;case"PPP":s=r.dateTime({width:"long"});break;case"PPPP":default:s=r.dateTime({width:"full"});break}return s.replace("{{date}}",hR(i,r)).replace("{{time}}",SU(a,r))},jX={p:SU,P:$X};const RX=jX;var NX=["D","DD"],MX=["YY","YYYY"];function DX(t){return NX.indexOf(t)!==-1}function LX(t){return MX.indexOf(t)!==-1}function dR(t,e,r){if(t==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var FX={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},UX=function(e,r,n){var i,a=FX[e];return typeof a=="string"?i=a:r===1?i=a.one:i=a.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};const zX=UX;function fx(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.width?String(e.width):t.defaultWidth,n=t.formats[r]||t.formats[t.defaultWidth];return n}}var BX={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},qX={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},KX={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},VX={date:fx({formats:BX,defaultWidth:"full"}),time:fx({formats:qX,defaultWidth:"full"}),dateTime:fx({formats:KX,defaultWidth:"full"})};const HX=VX;var WX={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},GX=function(e,r,n,i){return WX[e]};const YX=GX;function cf(t){return function(e,r){var n=r!=null&&r.context?String(r.context):"standalone",i;if(n==="formatting"&&t.formattingValues){var a=t.defaultFormattingWidth||t.defaultWidth,s=r!=null&&r.width?String(r.width):a;i=t.formattingValues[s]||t.formattingValues[a]}else{var o=t.defaultWidth,u=r!=null&&r.width?String(r.width):t.defaultWidth;i=t.values[u]||t.values[o]}var l=t.argumentCallback?t.argumentCallback(e):e;return i[l]}}var JX={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ZX={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},XX={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},QX={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},eQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},tQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},rQ=function(e,r){var n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},nQ={ordinalNumber:rQ,era:cf({values:JX,defaultWidth:"wide"}),quarter:cf({values:ZX,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:cf({values:XX,defaultWidth:"wide"}),day:cf({values:QX,defaultWidth:"wide"}),dayPeriod:cf({values:eQ,defaultWidth:"wide",formattingValues:tQ,defaultFormattingWidth:"wide"})};const iQ=nQ;function hf(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(i);if(!a)return null;var s=a[0],o=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],u=Array.isArray(o)?sQ(o,function(h){return h.test(s)}):aQ(o,function(h){return h.test(s)}),l;l=t.valueCallback?t.valueCallback(u):u,l=r.valueCallback?r.valueCallback(l):l;var c=e.slice(s.length);return{value:l,rest:c}}}function aQ(t,e){for(var r in t)if(t.hasOwnProperty(r)&&e(t[r]))return r}function sQ(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return r}function oQ(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.match(t.matchPattern);if(!n)return null;var i=n[0],a=e.match(t.parsePattern);if(!a)return null;var s=t.valueCallback?t.valueCallback(a[0]):a[0];s=r.valueCallback?r.valueCallback(s):s;var o=e.slice(i.length);return{value:s,rest:o}}}var uQ=/^(\d+)(th|st|nd|rd)?/i,lQ=/\d+/i,cQ={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},hQ={any:[/^b/i,/^(a|c)/i]},dQ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},fQ={any:[/1/i,/2/i,/3/i,/4/i]},pQ={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},mQ={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},gQ={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},yQ={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},vQ={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},bQ={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},wQ={ordinalNumber:oQ({matchPattern:uQ,parsePattern:lQ,valueCallback:function(e){return parseInt(e,10)}}),era:hf({matchPatterns:cQ,defaultMatchWidth:"wide",parsePatterns:hQ,defaultParseWidth:"any"}),quarter:hf({matchPatterns:dQ,defaultMatchWidth:"wide",parsePatterns:fQ,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:hf({matchPatterns:pQ,defaultMatchWidth:"wide",parsePatterns:mQ,defaultParseWidth:"any"}),day:hf({matchPatterns:gQ,defaultMatchWidth:"wide",parsePatterns:yQ,defaultParseWidth:"any"}),dayPeriod:hf({matchPatterns:vQ,defaultMatchWidth:"any",parsePatterns:bQ,defaultParseWidth:"any"})};const _Q=wQ;var xQ={code:"en-US",formatDistance:zX,formatLong:HX,formatRelative:YX,localize:iQ,match:_Q,options:{weekStartsOn:0,firstWeekContainsDate:1}};const PU=xQ;var OQ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,SQ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,PQ=/^'([^]*?)'?$/,EQ=/''/g,AQ=/[a-zA-Z]/;function au(t,e,r){var n,i,a,s,o,u,l,c,h,d,f,p,m,g,v,y,b,w;ot(2,arguments);var _=String(e),O=hg(),P=(n=(i=r==null?void 0:r.locale)!==null&&i!==void 0?i:O.locale)!==null&&n!==void 0?n:PU,x=os((a=(s=(o=(u=r==null?void 0:r.firstWeekContainsDate)!==null&&u!==void 0?u:r==null||(l=r.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&o!==void 0?o:O.firstWeekContainsDate)!==null&&s!==void 0?s:(h=O.locale)===null||h===void 0||(d=h.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&a!==void 0?a:1);if(!(x>=1&&x<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var j=os((f=(p=(m=(g=r==null?void 0:r.weekStartsOn)!==null&&g!==void 0?g:r==null||(v=r.locale)===null||v===void 0||(y=v.options)===null||y===void 0?void 0:y.weekStartsOn)!==null&&m!==void 0?m:O.weekStartsOn)!==null&&p!==void 0?p:(b=O.locale)===null||b===void 0||(w=b.options)===null||w===void 0?void 0:w.weekStartsOn)!==null&&f!==void 0?f:0);if(!(j>=0&&j<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!P.localize)throw new RangeError("locale must contain localize property");if(!P.formatLong)throw new RangeError("locale must contain formatLong property");var k=at(t);if(!lX(k))throw new RangeError("Invalid time value");var R=oP(k),F=wX(k,R),z={firstWeekContainsDate:x,weekStartsOn:j,locale:P,_originalDate:k},N=_.match(SQ).map(function(L){var D=L[0];if(D==="p"||D==="P"){var q=RX[D];return q(L,P.formatLong)}return L}).join("").match(OQ).map(function(L){if(L==="''")return"'";var D=L[0];if(D==="'")return TQ(L);var q=IX[D];if(q)return!(r!=null&&r.useAdditionalWeekYearTokens)&&LX(L)&&dR(L,e,String(t)),!(r!=null&&r.useAdditionalDayOfYearTokens)&&DX(L)&&dR(L,e,String(t)),q(F,L,P.localize,z);if(D.match(AQ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+D+"`");return L}).join("");return N}function TQ(t){var e=t.match(PQ);return e?e[1].replace(EQ,"'"):t}function EU(t,e){if(t==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function kQ(t){return EU({},t)}var fR=1440,CQ=2520,px=43200,IQ=86400;function $Q(t,e,r){var n,i;ot(2,arguments);var a=hg(),s=(n=(i=r==null?void 0:r.locale)!==null&&i!==void 0?i:a.locale)!==null&&n!==void 0?n:PU;if(!s.formatDistance)throw new RangeError("locale must contain formatDistance property");var o=mv(t,e);if(isNaN(o))throw new RangeError("Invalid time value");var u=EU(kQ(r),{addSuffix:!!(r!=null&&r.addSuffix),comparison:o}),l,c;o>0?(l=at(e),c=at(t)):(l=at(t),c=at(e));var h=vX(c,l),d=(oP(c)-oP(l))/1e3,f=Math.round((h-d)/60),p;if(f<2)return r!=null&&r.includeSeconds?h<5?s.formatDistance("lessThanXSeconds",5,u):h<10?s.formatDistance("lessThanXSeconds",10,u):h<20?s.formatDistance("lessThanXSeconds",20,u):h<40?s.formatDistance("halfAMinute",0,u):h<60?s.formatDistance("lessThanXMinutes",1,u):s.formatDistance("xMinutes",1,u):f===0?s.formatDistance("lessThanXMinutes",1,u):s.formatDistance("xMinutes",f,u);if(f<45)return s.formatDistance("xMinutes",f,u);if(f<90)return s.formatDistance("aboutXHours",1,u);if(f<fR){var m=Math.round(f/60);return s.formatDistance("aboutXHours",m,u)}else{if(f<CQ)return s.formatDistance("xDays",1,u);if(f<px){var g=Math.round(f/fR);return s.formatDistance("xDays",g,u)}else if(f<IQ)return p=Math.round(f/px),s.formatDistance("aboutXMonths",p,u)}if(p=yX(c,l),p<12){var v=Math.round(f/px);return s.formatDistance("xMonths",v,u)}else{var y=p%12,b=Math.floor(p/12);return y<3?s.formatDistance("aboutXYears",b,u):y<9?s.formatDistance("overXYears",b,u):s.formatDistance("almostXYears",b+1,u)}}function AU(t){return ot(1,arguments),uP(t,Date.now())}function KT(t,e){ot(2,arguments);var r=os(e);return aX(t,-r)}function jQ(t,e){var r;ot(1,arguments);var n=os((r=e==null?void 0:e.additionalDigits)!==null&&r!==void 0?r:2);if(n!==2&&n!==1&&n!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof t=="string"||Object.prototype.toString.call(t)==="[object String]"))return new Date(NaN);var i=DQ(t),a;if(i.date){var s=LQ(i.date,n);a=FQ(s.restDateString,s.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);var o=a.getTime(),u=0,l;if(i.time&&(u=UQ(i.time),isNaN(u)))return new Date(NaN);if(i.timezone){if(l=zQ(i.timezone),isNaN(l))return new Date(NaN)}else{var c=new Date(o+u),h=new Date(0);return h.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),h.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),h}return new Date(o+u+l)}var my={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},RQ=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,NQ=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,MQ=/^([+-])(\d{2})(?::?(\d{2}))?$/;function DQ(t){var e={},r=t.split(my.dateTimeDelimiter),n;if(r.length>2)return e;if(/:/.test(r[0])?n=r[0]:(e.date=r[0],n=r[1],my.timeZoneDelimiter.test(e.date)&&(e.date=t.split(my.timeZoneDelimiter)[0],n=t.substr(e.date.length,t.length))),n){var i=my.timezone.exec(n);i?(e.time=n.replace(i[1],""),e.timezone=i[1]):e.time=n}return e}function LQ(t,e){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),n=t.match(r);if(!n)return{year:NaN,restDateString:""};var i=n[1]?parseInt(n[1]):null,a=n[2]?parseInt(n[2]):null;return{year:a===null?i:a*100,restDateString:t.slice((n[1]||n[2]).length)}}function FQ(t,e){if(e===null)return new Date(NaN);var r=t.match(RQ);if(!r)return new Date(NaN);var n=!!r[4],i=df(r[1]),a=df(r[2])-1,s=df(r[3]),o=df(r[4]),u=df(r[5])-1;if(n)return HQ(e,o,u)?BQ(e,o,u):new Date(NaN);var l=new Date(0);return!KQ(e,a,s)||!VQ(e,i)?new Date(NaN):(l.setUTCFullYear(e,a,Math.max(i,s)),l)}function df(t){return t?parseInt(t):1}function UQ(t){var e=t.match(NQ);if(!e)return NaN;var r=mx(e[1]),n=mx(e[2]),i=mx(e[3]);return WQ(r,n,i)?r*_U+n*wU+i*1e3:NaN}function mx(t){return t&&parseFloat(t.replace(",","."))||0}function zQ(t){if(t==="Z")return 0;var e=t.match(MQ);if(!e)return 0;var r=e[1]==="+"?-1:1,n=parseInt(e[2]),i=e[3]&&parseInt(e[3])||0;return GQ(n,i)?r*(n*_U+i*wU):NaN}function BQ(t,e,r){var n=new Date(0);n.setUTCFullYear(t,0,4);var i=n.getUTCDay()||7,a=(e-1)*7+r+1-i;return n.setUTCDate(n.getUTCDate()+a),n}var qQ=[31,null,31,30,31,30,31,31,30,31,30,31];function TU(t){return t%400===0||t%4===0&&t%100!==0}function KQ(t,e,r){return e>=0&&e<=11&&r>=1&&r<=(qQ[e]||(TU(t)?29:28))}function VQ(t,e){return e>=1&&e<=(TU(t)?366:365)}function HQ(t,e,r){return e>=1&&e<=53&&r>=0&&r<=6}function WQ(t,e,r){return t===24?e===0&&r===0:r>=0&&r<60&&e>=0&&e<60&&t>=0&&t<25}function GQ(t,e){return e>=0&&e<=59}const kU=t=>$Q(jQ(t),new Date,{addSuffix:!0}).replace("about ","").replace("in","In"),cb=function(t={}){const e=new Date;return t!=null&&t.end?e.setUTCHours(23,59,59,999):e.setUTCHours(0,0,0,0),e.toISOString()},$i=t=>new Intl.NumberFormat("en",{style:"currency",currency:"USD"}).format(t),YQ="modulepreload",JQ=function(t){return"/"+t},pR={},Cr=function(e,r,n){if(!r||r.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(r.map(a=>{if(a=JQ(a),a in pR)return;pR[a]=!0;const s=a.endsWith(".css"),o=s?'[rel="stylesheet"]':"";if(!!n)for(let c=i.length-1;c>=0;c--){const h=i[c];if(h.href===a&&(!s||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${o}`))return;const l=document.createElement("link");if(l.rel=s?"stylesheet":YQ,s||(l.as="script",l.crossOrigin=""),l.href=a,document.head.appendChild(l),s)return new Promise((c,h)=>{l.addEventListener("load",c),l.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>e())},ZQ=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Cr(()=>Promise.resolve().then(()=>dd),void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class VT extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class XQ extends VT{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class QQ extends VT{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class eee extends VT{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var lP;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(lP||(lP={}));var tee=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(h){s(h)}}function u(c){try{l(n.throw(c))}catch(h){s(h)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(t,e||[])).next())})};class ree{constructor(e,{headers:r={},customFetch:n,region:i=lP.Any}={}){this.url=e,this.headers=r,this.region=i,this.fetch=ZQ(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return tee(this,void 0,void 0,function*(){try{const{headers:i,method:a,body:s}=r;let o={},{region:u}=r;u||(u=this.region),u&&u!=="any"&&(o["x-region"]=u);let l;s&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",l=s):typeof s=="string"?(o["Content-Type"]="text/plain",l=s):typeof FormData<"u"&&s instanceof FormData?l=s:(o["Content-Type"]="application/json",l=JSON.stringify(s)));const c=yield this.fetch(`${this.url}/${e}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:l}).catch(p=>{throw new XQ(p)}),h=c.headers.get("x-relay-error");if(h&&h==="true")throw new QQ(c);if(!c.ok)throw new eee(c);let d=((n=c.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),f;return d==="application/json"?f=yield c.json():d==="application/octet-stream"?f=yield c.blob():d==="text/event-stream"?f=c:d==="multipart/form-data"?f=yield c.formData():f=yield c.text(),{data:f,error:null}}catch(i){return{data:null,error:i}}})}}var ji={},HT={},J0={},dg={},Z0={},X0={},nee=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ph=nee();const iee=Ph.fetch,CU=Ph.fetch.bind(Ph),IU=Ph.Headers,aee=Ph.Request,see=Ph.Response,dd=Object.freeze(Object.defineProperty({__proto__:null,Headers:IU,Request:aee,Response:see,default:CU,fetch:iee},Symbol.toStringTag,{value:"Module"})),oee=iH(dd);var WT={};Object.defineProperty(WT,"__esModule",{value:!0});class uee extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}WT.default=uee;var $U=ln&&ln.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(X0,"__esModule",{value:!0});const lee=$U(oee),cee=$U(WT);let hee=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=lee.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var s,o,u;let l=null,c=null,h=null,d=a.status,f=a.statusText;if(a.ok){if(this.method!=="HEAD"){const v=await a.text();v===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=v:c=JSON.parse(v))}const m=(s=this.headers.Prefer)===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),g=(o=a.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");m&&g&&g.length>1&&(h=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(l={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,d=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const m=await a.text();try{l=JSON.parse(m),Array.isArray(l)&&a.status===404&&(c=[],l=null,d=200,f="OK")}catch{a.status===404&&m===""?(d=204,f="No Content"):l={message:m}}if(l&&this.isMaybeSingle&&(!((u=l==null?void 0:l.details)===null||u===void 0)&&u.includes("0 rows"))&&(l=null,d=200,f="OK"),l&&this.shouldThrowOnError)throw new cee.default(l)}return{error:l,data:c,count:h,status:d,statusText:f}});return this.shouldThrowOnError||(i=i.catch(a=>{var s,o,u;return{error:{message:`${(s=a==null?void 0:a.name)!==null&&s!==void 0?s:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(o=a==null?void 0:a.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(u=a==null?void 0:a.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,r)}};X0.default=hee;var dee=ln&&ln.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Z0,"__esModule",{value:!0});const fee=dee(X0);let pee=class extends fee.default{select(e){let r=!1;const n=(e??"*").split("").map(i=>/\s/.test(i)&&!r?"":(i==='"'&&(r=!r),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:r=!0,nullsFirst:n,foreignTable:i,referencedTable:a=i}={}){const s=a?`${a}.order`:"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${o?`${o},`:""}${e}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,r,{foreignTable:n,referencedTable:i=n}={}){const a=typeof i>"u"?"offset":`${i}.offset`,s=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(s,`${r-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:r=!1,settings:n=!1,buffers:i=!1,wal:a=!1,format:s="text"}={}){var o;const u=[e?"analyze":null,r?"verbose":null,n?"settings":null,i?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${l}"; options=${u};`,s==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Z0.default=pee;var mee=ln&&ln.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(dg,"__esModule",{value:!0});const gee=mee(Z0);let yee=class extends gee.default{eq(e,r){return this.url.searchParams.append(e,`eq.${r}`),this}neq(e,r){return this.url.searchParams.append(e,`neq.${r}`),this}gt(e,r){return this.url.searchParams.append(e,`gt.${r}`),this}gte(e,r){return this.url.searchParams.append(e,`gte.${r}`),this}lt(e,r){return this.url.searchParams.append(e,`lt.${r}`),this}lte(e,r){return this.url.searchParams.append(e,`lte.${r}`),this}like(e,r){return this.url.searchParams.append(e,`like.${r}`),this}likeAllOf(e,r){return this.url.searchParams.append(e,`like(all).{${r.join(",")}}`),this}likeAnyOf(e,r){return this.url.searchParams.append(e,`like(any).{${r.join(",")}}`),this}ilike(e,r){return this.url.searchParams.append(e,`ilike.${r}`),this}ilikeAllOf(e,r){return this.url.searchParams.append(e,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(e,r){return this.url.searchParams.append(e,`ilike(any).{${r.join(",")}}`),this}is(e,r){return this.url.searchParams.append(e,`is.${r}`),this}in(e,r){const n=Array.from(new Set(r)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cs.{${r.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(r)}`),this}containedBy(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cd.{${r.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(r)}`),this}rangeGt(e,r){return this.url.searchParams.append(e,`sr.${r}`),this}rangeGte(e,r){return this.url.searchParams.append(e,`nxl.${r}`),this}rangeLt(e,r){return this.url.searchParams.append(e,`sl.${r}`),this}rangeLte(e,r){return this.url.searchParams.append(e,`nxr.${r}`),this}rangeAdjacent(e,r){return this.url.searchParams.append(e,`adj.${r}`),this}overlaps(e,r){return typeof r=="string"?this.url.searchParams.append(e,`ov.${r}`):this.url.searchParams.append(e,`ov.{${r.join(",")}}`),this}textSearch(e,r,{config:n,type:i}={}){let a="";i==="plain"?a="pl":i==="phrase"?a="ph":i==="websearch"&&(a="w");const s=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${a}fts${s}.${r}`),this}match(e){return Object.entries(e).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(e,r,n){return this.url.searchParams.append(e,`not.${r}.${n}`),this}or(e,{foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,r,n){return this.url.searchParams.append(e,`${r}.${n}`),this}};dg.default=yee;var vee=ln&&ln.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(J0,"__esModule",{value:!0});const ff=vee(dg);let bee=class{constructor(e,{headers:r={},schema:n,fetch:i}){this.url=e,this.headers=r,this.schema=n,this.fetch=i}select(e,{head:r=!1,count:n}={}){const i=r?"HEAD":"GET";let a=!1;const s=(e??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",s),n&&(this.headers.Prefer=`count=${n}`),new ff.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:r,defaultToNull:n=!0}={}){const i="POST",a=[];if(this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),n||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const s=e.reduce((o,u)=>o.concat(Object.keys(u)),[]);if(s.length>0){const o=[...new Set(s)].map(u=>`"${u}"`);this.url.searchParams.set("columns",o.join(","))}}return new ff.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:r,ignoreDuplicates:n=!1,count:i,defaultToNull:a=!0}={}){const s="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),a||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const u=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(u.length>0){const l=[...new Set(u)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new ff.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:r}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),this.headers.Prefer=i.join(","),new ff.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const r="DELETE",n=[];return e&&n.push(`count=${e}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new ff.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};J0.default=bee;var Q0={},e_={};Object.defineProperty(e_,"__esModule",{value:!0});e_.version=void 0;e_.version="0.0.0-automated";Object.defineProperty(Q0,"__esModule",{value:!0});Q0.DEFAULT_HEADERS=void 0;const wee=e_;Q0.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${wee.version}`};var jU=ln&&ln.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(HT,"__esModule",{value:!0});const _ee=jU(J0),xee=jU(dg),Oee=Q0;let See=class RU{constructor(e,{headers:r={},schema:n,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},Oee.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=i}from(e){const r=new URL(`${this.url}/${e}`);return new _ee.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new RU(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:n=!1,get:i=!1,count:a}={}){let s;const o=new URL(`${this.url}/rpc/${e}`);let u;n||i?(s=n?"HEAD":"GET",Object.entries(r).filter(([c,h])=>h!==void 0).map(([c,h])=>[c,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([c,h])=>{o.searchParams.append(c,h)})):(s="POST",u=r);const l=Object.assign({},this.headers);return a&&(l.Prefer=`count=${a}`),new xee.default({method:s,url:o,headers:l,schema:this.schemaName,body:u,fetch:this.fetch,allowEmpty:!1})}};HT.default=See;var fg=ln&&ln.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ji,"__esModule",{value:!0});ji.PostgrestBuilder=ji.PostgrestTransformBuilder=ji.PostgrestFilterBuilder=ji.PostgrestQueryBuilder=ji.PostgrestClient=void 0;const NU=fg(HT);ji.PostgrestClient=NU.default;const MU=fg(J0);ji.PostgrestQueryBuilder=MU.default;const DU=fg(dg);ji.PostgrestFilterBuilder=DU.default;const LU=fg(Z0);ji.PostgrestTransformBuilder=LU.default;const FU=fg(X0);ji.PostgrestBuilder=FU.default;var Pee=ji.default={PostgrestClient:NU.default,PostgrestQueryBuilder:MU.default,PostgrestFilterBuilder:DU.default,PostgrestTransformBuilder:LU.default,PostgrestBuilder:FU.default};const{PostgrestClient:Eee,PostgrestQueryBuilder:TVe,PostgrestFilterBuilder:kVe,PostgrestTransformBuilder:CVe,PostgrestBuilder:IVe}=Pee,Aee="2.10.2",Tee={"X-Client-Info":`realtime-js/${Aee}`},kee="1.0.0",UU=1e4,Cee=1e3;var rh;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(rh||(rh={}));var ri;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ri||(ri={}));var ua;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ua||(ua={}));var cP;(function(t){t.websocket="websocket"})(cP||(cP={}));var Ku;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ku||(Ku={}));class Iee{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const i=r.getUint8(1),a=r.getUint8(2);let s=this.HEADER_LENGTH+2;const o=n.decode(e.slice(s,s+i));s=s+i;const u=n.decode(e.slice(s,s+a));s=s+a;const l=JSON.parse(n.decode(e.slice(s,e.byteLength)));return{ref:null,topic:o,event:u,payload:l}}}class zU{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var St;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(St||(St={}));const mR=(t,e,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((a,s)=>(a[s]=$ee(s,t,e,i),a),{})},$ee=(t,e,r,n)=>{const i=e.find(o=>o.name===t),a=i==null?void 0:i.type,s=r[t];return a&&!n.includes(a)?BU(a,s):hP(s)},BU=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return Mee(e,r)}switch(t){case St.bool:return jee(e);case St.float4:case St.float8:case St.int2:case St.int4:case St.int8:case St.numeric:case St.oid:return Ree(e);case St.json:case St.jsonb:return Nee(e);case St.timestamp:return Dee(e);case St.abstime:case St.date:case St.daterange:case St.int4range:case St.int8range:case St.money:case St.reltime:case St.text:case St.time:case St.timestamptz:case St.timetz:case St.tsrange:case St.tstzrange:return hP(e);default:return hP(e)}},hP=t=>t,jee=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Ree=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Nee=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Mee=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let a;const s=t.slice(1,r);try{a=JSON.parse("["+s+"]")}catch{a=s?s.split(","):[]}return a.map(o=>BU(e,o))}return t},Dee=t=>typeof t=="string"?t.replace(" ","T"):t,qU=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class gx{constructor(e,r,n={},i=UU){this.channel=e,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var gR;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(gR||(gR={}));class ip{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:a,onLeave:s,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ip.syncState(this.state,i,a,s),this.pendingDiffs.forEach(u=>{this.state=ip.syncDiff(this.state,u,a,s)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:a,onLeave:s,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=ip.syncDiff(this.state,i,a,s),o())}),this.onJoin((i,a,s)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:s})}),this.onLeave((i,a,s)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,i){const a=this.cloneDeep(e),s=this.transformState(r),o={},u={};return this.map(a,(l,c)=>{s[l]||(u[l]=c)}),this.map(s,(l,c)=>{const h=a[l];if(h){const d=c.map(g=>g.presence_ref),f=h.map(g=>g.presence_ref),p=c.filter(g=>f.indexOf(g.presence_ref)<0),m=h.filter(g=>d.indexOf(g.presence_ref)<0);p.length>0&&(o[l]=p),m.length>0&&(u[l]=m)}else o[l]=c}),this.syncDiff(a,{joins:o,leaves:u},n,i)}static syncDiff(e,r,n,i){const{joins:a,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(a,(o,u)=>{var l;const c=(l=e[o])!==null&&l!==void 0?l:[];if(e[o]=this.cloneDeep(u),c.length>0){const h=e[o].map(f=>f.presence_ref),d=c.filter(f=>h.indexOf(f.presence_ref)<0);e[o].unshift(...d)}n(o,c,u)}),this.map(s,(o,u)=>{let l=e[o];if(!l)return;const c=u.map(h=>h.presence_ref);l=l.filter(h=>c.indexOf(h.presence_ref)<0),e[o]=l,i(o,l,u),l.length===0&&delete e[o]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const i=e[n];return"metas"in i?r[n]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=i,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var yR;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(yR||(yR={}));var vR;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes"})(vR||(vR={}));var bR;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(bR||(bR={}));class GT{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=ri.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new gx(this,ua.join,this.params,this.timeout),this.rejoinTimer=new zU(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ri.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ri.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=ri.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ri.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ua.reply,{},(i,a)=>{this._trigger(this._replyEventName(a),i)}),this.presence=new ip(this),this.broadcastEndpointURL=qU(this.socket.endPoint)+"/api/broadcast"}subscribe(e,r=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:a,presence:s,private:o}}=this.params;this._onError(c=>e&&e("CHANNEL_ERROR",c)),this._onClose(()=>e&&e("CLOSED"));const u={},l={broadcast:a,presence:s,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(c=>c.filter))!==null&&i!==void 0?i:[],private:o};this.socket.accessToken&&(u.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:l},u)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",({postgres_changes:c})=>{var h;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),c===void 0){e&&e("SUBSCRIBED");return}else{const d=this.bindings.postgres_changes,f=(h=d==null?void 0:d.length)!==null&&h!==void 0?h:0,p=[];for(let m=0;m<f;m++){const g=d[m],{filter:{event:v,schema:y,table:b,filter:w}}=g,_=c&&c[m];if(_&&_.event===v&&_.schema===y&&_.table===b&&_.filter===w)p.push(Object.assign(Object.assign({},g),{id:_.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e("SUBSCRIBED");return}}).receive("error",c=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this._on(e,r,n)}async send(e,r={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:s}=e,o={method:"POST",headers:{Authorization:this.socket.accessToken?`Bearer ${this.socket.accessToken}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:s}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var s,o,u;const l=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(o=(s=this.params)===null||s===void 0?void 0:s.config)===null||o===void 0?void 0:o.broadcast)===null||u===void 0)&&u.ack)&&a("ok"),l.receive("ok",()=>a("ok")),l.receive("error",()=>a("error")),l.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ri.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ua.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const i=new gx(this,ua.leave,{},e);i.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(e,r,n){const i=new AbortController,a=setTimeout(()=>i.abort(),n),s=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(a),s}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new gx(this,e,r,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var i,a;const s=e.toLocaleLowerCase(),{close:o,error:u,leave:l,join:c}=ua;if(n&&[o,u,l,c].indexOf(s)>=0&&n!==this._joinRef())return;let d=this._onMessage(s,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(f=>{var p,m,g;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((g=(m=f.filter)===null||m===void 0?void 0:m.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===s}).map(f=>f.callback(d,n)):(a=this.bindings[s])===null||a===void 0||a.filter(f=>{var p,m,g,v,y,b;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in f){const w=f.id,_=(p=f.filter)===null||p===void 0?void 0:p.event;return w&&((m=r.ids)===null||m===void 0?void 0:m.includes(w))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const w=(y=(v=f==null?void 0:f.filter)===null||v===void 0?void 0:v.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return w==="*"||w===((b=r==null?void 0:r.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===s}).map(f=>{if(typeof d=="object"&&"ids"in d){const p=d.data,{schema:m,table:g,commit_timestamp:v,type:y,errors:b}=p;d=Object.assign(Object.assign({},{schema:m,table:g,commit_timestamp:v,eventType:y,new:{},old:{},errors:b}),this._getPayloadRecords(p))}f.callback(d,n)})}_isClosed(){return this.state===ri.closed}_isJoined(){return this.state===ri.joined}_isJoining(){return this.state===ri.joining}_isLeaving(){return this.state===ri.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const i=e.toLocaleLowerCase(),a={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&GT.isEqual(i.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ua.close,{},e)}_onError(e){this._on(ua.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ri.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=mR(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=mR(e.columns,e.old_record)),r}}const Lee=()=>{},Fee=typeof WebSocket<"u";class Uee{constructor(e,r){var n;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Tee,this.params={},this.timeout=UU,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Lee,this.conn=null,this.sendBuffer=[],this.serializer=new Iee,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...o)=>Cr(()=>Promise.resolve().then(()=>dd),void 0).then(({default:u})=>u(...o)):s=fetch,(...o)=>s(...o)},this.endPoint=`${e}/${cP.websocket}`,this.httpEndpoint=qU(e),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const i=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;i&&(this.accessToken=i,this.apiKey=i),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(a,s)=>s(JSON.stringify(a)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new zU(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(Fee){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new zee(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Cr(()=>import("./browser-5078b7dc.js").then(e=>e.b),[]).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case rh.connecting:return Ku.Connecting;case rh.open:return Ku.Open;case rh.closing:return Ku.Closing;default:return Ku.Closed}}isConnected(){return this.connectionState()===Ku.Open}channel(e,r={config:{}}){const n=new GT(`realtime:${e}`,r,this);return this.channels.push(n),n}push(e){const{topic:r,event:n,payload:i,ref:a}=e,s=()=>{this.encode(e,o=>{var u;(u=this.conn)===null||u===void 0||u.send(o)})};this.log("push",`${r} ${n} (${a})`,i),this.isConnected()?s():this.sendBuffer.push(s)}setAuth(e){this.accessToken=e,this.channels.forEach(r=>{e&&r.updateJoinPayload({access_token:e}),r.joinedOnce&&r._isJoined()&&r._push(ua.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:kee}))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:n,event:i,payload:a,ref:s}=r;(s&&s===this.pendingHeartbeatRef||i===(a==null?void 0:a.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${n} ${i} ${s&&"("+s+")"||""}`,a),this.channels.filter(o=>o._isMember(n)).forEach(o=>o._trigger(i,a,s)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(ua.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${e}${n}${i}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Cee,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class zee{constructor(e,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=rh.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}}class YT extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function nn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Bee extends YT{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class wR extends YT{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var qee=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(h){s(h)}}function u(c){try{l(n.throw(c))}catch(h){s(h)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(t,e||[])).next())})};const KU=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Cr(()=>Promise.resolve().then(()=>dd),void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},Kee=()=>qee(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Cr(()=>Promise.resolve().then(()=>dd),void 0)).Response:Response});var fd=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(h){s(h)}}function u(c){try{l(n.throw(c))}catch(h){s(h)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(t,e||[])).next())})};const yx=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Vee=(t,e)=>fd(void 0,void 0,void 0,function*(){const r=yield Kee();t instanceof r?t.json().then(n=>{e(new Bee(yx(n),t.status||500))}).catch(n=>{e(new wR(yx(n),n))}):e(new wR(yx(t),t))}),Hee=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};function t_(t,e,r,n,i,a){return fd(this,void 0,void 0,function*(){return new Promise((s,o)=>{t(r,Hee(e,n,i,a)).then(u=>{if(!u.ok)throw u;return n!=null&&n.noResolveJson?u:u.json()}).then(u=>s(u)).catch(u=>Vee(u,o))})})}function dP(t,e,r,n){return fd(this,void 0,void 0,function*(){return t_(t,"GET",e,r,n)})}function jo(t,e,r,n,i){return fd(this,void 0,void 0,function*(){return t_(t,"POST",e,n,i,r)})}function Wee(t,e,r,n,i){return fd(this,void 0,void 0,function*(){return t_(t,"PUT",e,n,i,r)})}function VU(t,e,r,n,i){return fd(this,void 0,void 0,function*(){return t_(t,"DELETE",e,n,i,r)})}var _i=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(h){s(h)}}function u(c){try{l(n.throw(c))}catch(h){s(h)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(t,e||[])).next())})};const Gee={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},_R={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Yee{constructor(e,r={},n,i){this.url=e,this.headers=r,this.bucketId=n,this.fetch=KU(i)}uploadOrUpdate(e,r,n,i){return _i(this,void 0,void 0,function*(){try{let a;const s=Object.assign(Object.assign({},_R),i),o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(s.upsert)});typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",s.cacheControl),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",s.cacheControl)):(a=n,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType);const u=this._removeEmptyFolders(r),l=this._getFinalPath(u),c=yield this.fetch(`${this.url}/object/${l}`,Object.assign({method:e,body:a,headers:o},s!=null&&s.duplex?{duplex:s.duplex}:{})),h=yield c.json();return c.ok?{data:{path:u,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(a){if(nn(a))return{data:null,error:a};throw a}})}upload(e,r,n){return _i(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,i){return _i(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),s=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${s}`);o.searchParams.set("token",r);try{let u;const l=Object.assign({upsert:_R.upsert},i),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(l.upsert)});typeof Blob<"u"&&n instanceof Blob?(u=new FormData,u.append("cacheControl",l.cacheControl),u.append("",n)):typeof FormData<"u"&&n instanceof FormData?(u=n,u.append("cacheControl",l.cacheControl)):(u=n,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:u,headers:c}),d=yield h.json();return h.ok?{data:{path:a,fullPath:d.Key},error:null}:{data:null,error:d}}catch(u){if(nn(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e,r){return _i(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const a=yield jo(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),s=new URL(this.url+a.url),o=s.searchParams.get("token");if(!o)throw new YT("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:o},error:null}}catch(n){if(nn(n))return{data:null,error:n};throw n}})}update(e,r,n){return _i(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return _i(this,void 0,void 0,function*(){try{return{data:yield jo(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(nn(i))return{data:null,error:i};throw i}})}copy(e,r,n){return _i(this,void 0,void 0,function*(){try{return{data:{path:(yield jo(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(nn(i))return{data:null,error:i};throw i}})}createSignedUrl(e,r,n){return _i(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),a=yield jo(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${s}`)},{data:a,error:null}}catch(i){if(nn(i))return{data:null,error:i};throw i}})}createSignedUrls(e,r,n){return _i(this,void 0,void 0,function*(){try{const i=yield jo(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${a}`):null})),error:null}}catch(i){if(nn(i))return{data:null,error:i};throw i}})}download(e,r){return _i(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),s=a?`?${a}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield dP(this.fetch,`${this.url}/${i}/${o}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(nn(o))return{data:null,error:o};throw o}})}getPublicUrl(e,r){const n=this._getFinalPath(e),i=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&i.push(a);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});u!==""&&i.push(u);let l=i.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${l}`)}}}remove(e){return _i(this,void 0,void 0,function*(){try{return{data:yield VU(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(nn(r))return{data:null,error:r};throw r}})}list(e,r,n){return _i(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Gee),r),{prefix:e||""});return{data:yield jo(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(nn(i))return{data:null,error:i};throw i}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const Jee="2.6.0",Zee={"X-Client-Info":`storage-js/${Jee}`};var ic=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(h){s(h)}}function u(c){try{l(n.throw(c))}catch(h){s(h)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(t,e||[])).next())})};class Xee{constructor(e,r={},n){this.url=e,this.headers=Object.assign(Object.assign({},Zee),r),this.fetch=KU(n)}listBuckets(){return ic(this,void 0,void 0,function*(){try{return{data:yield dP(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(nn(e))return{data:null,error:e};throw e}})}getBucket(e){return ic(this,void 0,void 0,function*(){try{return{data:yield dP(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(nn(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return ic(this,void 0,void 0,function*(){try{return{data:yield jo(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(nn(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return ic(this,void 0,void 0,function*(){try{return{data:yield Wee(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(nn(n))return{data:null,error:n};throw n}})}emptyBucket(e){return ic(this,void 0,void 0,function*(){try{return{data:yield jo(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(nn(r))return{data:null,error:r};throw r}})}deleteBucket(e){return ic(this,void 0,void 0,function*(){try{return{data:yield VU(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(nn(r))return{data:null,error:r};throw r}})}}class Qee extends Xee{constructor(e,r={},n){super(e,r,n)}from(e){return new Yee(this.url,this.headers,e,this.fetch)}}const ete="2.45.1";let Rf="";typeof Deno<"u"?Rf="deno":typeof document<"u"?Rf="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Rf="react-native":Rf="node";const tte={"X-Client-Info":`supabase-js-${Rf}/${ete}`},rte={headers:tte},nte={schema:"public"},ite={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ate={};var ste=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(h){s(h)}}function u(c){try{l(n.throw(c))}catch(h){s(h)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(t,e||[])).next())})};const ote=t=>{let e;return t?e=t:typeof fetch>"u"?e=CU:e=fetch,(...r)=>e(...r)},ute=()=>typeof Headers>"u"?IU:Headers,lte=(t,e,r)=>{const n=ote(r),i=ute();return(a,s)=>ste(void 0,void 0,void 0,function*(){var o;const u=(o=yield e())!==null&&o!==void 0?o:t;let l=new i(s==null?void 0:s.headers);return l.has("apikey")||l.set("apikey",t),l.has("Authorization")||l.set("Authorization",`Bearer ${u}`),n(a,Object.assign(Object.assign({},s),{headers:l}))})};var cte=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(h){s(h)}}function u(c){try{l(n.throw(c))}catch(h){s(h)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(t,e||[])).next())})};function hte(t){return t.replace(/\/$/,"")}function dte(t,e){const{db:r,auth:n,realtime:i,global:a}=t,{db:s,auth:o,realtime:u,global:l}=e,c={db:Object.assign(Object.assign({},s),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},u),i),global:Object.assign(Object.assign({},l),a),accessToken:()=>cte(this,void 0,void 0,function*(){return""})};return t.accessToken?c.accessToken=t.accessToken:delete c.accessToken,c}const HU="2.64.4",fte="http://localhost:9999",pte="supabase.auth.token",mte={"X-Client-Info":`gotrue-js/${HU}`},xR=10,fP="X-Supabase-Api-Version",WU={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function gte(t){return Math.round(Date.now()/1e3)+t}function yte(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const ra=()=>typeof document<"u",ku={tested:!1,writable:!1},ap=()=>{if(!ra())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ku.tested)return ku.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ku.tested=!0,ku.writable=!0}catch{ku.tested=!0,ku.writable=!1}return ku.writable};function vx(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,a)=>{e[a]=i})}catch{}return r.searchParams.forEach((n,i)=>{e[i]=n}),e}const GU=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Cr(()=>Promise.resolve().then(()=>dd),void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},vte=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",YU=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},gy=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},bx=async(t,e)=>{await t.removeItem(e)};function bte(t){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let r="",n,i,a,s,o,u,l,c=0;for(t=t.replace("-","+").replace("_","/");c<t.length;)s=e.indexOf(t.charAt(c++)),o=e.indexOf(t.charAt(c++)),u=e.indexOf(t.charAt(c++)),l=e.indexOf(t.charAt(c++)),n=s<<2|o>>4,i=(o&15)<<4|u>>2,a=(u&3)<<6|l,r=r+String.fromCharCode(n),u!=64&&i!=0&&(r=r+String.fromCharCode(i)),l!=64&&a!=0&&(r=r+String.fromCharCode(a));return r}class r_{constructor(){this.promise=new r_.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}r_.promiseConstructor=Promise;function OR(t){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,r=t.split(".");if(r.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(r[1]))throw new Error("JWT is not valid: payload is not in base64url format");const n=r[1];return JSON.parse(bte(n))}async function wte(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function _te(t,e){return new Promise((n,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const s=await t(a);if(!e(a,null,s)){n(s);return}}catch(s){if(!e(a,s)){i(s);return}}})()})}function xte(t){return("0"+t.toString(16)).substr(-2)}function Ote(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let a=0;a<56;a++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,xte).join("")}async function Ste(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}function Pte(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ete(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await Ste(t);return Pte(r)}async function ac(t,e,r=!1){const n=Ote();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await YU(t,`${e}-code-verifier`,i);const a=await Ete(n);return[a,n===a?"plain":"s256"]}const Ate=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Tte(t){const e=t.headers.get(fP);if(!e||!e.match(Ate))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class JT extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function qe(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class kte extends JT{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Cte(t){return qe(t)&&t.name==="AuthApiError"}class JU extends JT{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Vl extends JT{constructor(e,r,n,i){super(e,n,i),this.name=r,this.status=n}}class Cu extends Vl{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class wx extends Vl{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class yy extends Vl{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class vy extends Vl{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class SR extends Vl{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class pP extends Vl{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function _x(t){return qe(t)&&t.name==="AuthRetryableFetchError"}class PR extends Vl{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}var Ite=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};const Fu=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),$te=[502,503,504];async function ER(t){var e;if(!vte(t))throw new pP(Fu(t),0);if($te.includes(t.status))throw new pP(Fu(t),t.status);let r;try{r=await t.json()}catch(a){throw new JU(Fu(a),a)}let n;const i=Tte(t);if(i&&i.getTime()>=WU["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new PR(Fu(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[])}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,s)=>a&&typeof s=="string",!0))throw new PR(Fu(r),t.status,r.weak_password.reasons);throw new kte(Fu(r),t.status||500,n)}const jte=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function We(t,e,r,n){var i;const a=Object.assign({},n==null?void 0:n.headers);a[fP]||(a[fP]=WU["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const s=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",u=await Rte(t,e,r+o,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function Rte(t,e,r,n,i,a){const s=jte(e,n,i,a);let o;try{o=await t(r,Object.assign({},s))}catch(u){throw console.error(u),new pP(Fu(u),0)}if(o.ok||await ER(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(u){await ER(u)}}function To(t){var e;let r=null;Lte(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=gte(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function AR(t){const e=To(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Fo(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Nte(t){return{data:t,error:null}}function Mte(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a}=t,s=Ite(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a},u=Object.assign({},s);return{data:{properties:o,user:u},error:null}}function Dte(t){return t}function Lte(t){return t.access_token&&t.refresh_token&&t.expires_in}var Fte=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class Ute{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=GU(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r="global"){try{return await We(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(qe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await We(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Fo})}catch(n){if(qe(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=Fte(e,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await We(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Mte,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(qe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await We(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Fo})}catch(r){if(qe(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,i,a,s,o,u;try{const l={nextPage:null,lastPage:0,total:0},c=await We(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:Dte});if(c.error)throw c.error;const h=await c.json(),d=(s=c.headers.get("x-total-count"))!==null&&s!==void 0?s:0,f=(u=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&u!==void 0?u:[];return f.length>0&&(f.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);l[`${g}Page`]=m}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},h),l),error:null}}catch(l){if(qe(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await We(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Fo})}catch(r){if(qe(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){try{return await We(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Fo})}catch(n){if(qe(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){try{return await We(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Fo})}catch(n){if(qe(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){try{const{data:r,error:n}=await We(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(qe(r))return{data:null,error:r};throw r}}async _deleteFactor(e){try{return{data:await We(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(qe(r))return{data:null,error:r};throw r}}}const zte={getItem:t=>ap()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{ap()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{ap()&&globalThis.localStorage.removeItem(t)}};function TR(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function Bte(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const sc={debug:!!(globalThis&&ap()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ZU extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class qte extends ZU{}async function Kte(t,e,r){sc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),sc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){sc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await r()}finally{sc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw sc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new qte(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(sc.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}})}Bte();const Vte={url:fte,storageKey:pte,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mte,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},pf=30*1e3,kR=3;async function CR(t,e,r){return await r()}class Fp{constructor(e){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Fp.nextInstanceID,Fp.nextInstanceID+=1,this.instanceID>0&&ra()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Vte),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Ute({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=GU(i.fetch),this.lock=i.lock||CR,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:ra()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Kte:this.lock=CR,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:ap()?this.storage=zte:(this.memoryStorage={},this.storage=TR(this.memoryStorage)):(this.memoryStorage={},this.storage=TR(this.memoryStorage)),ra()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${HU}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=ra()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:r,error:n}=await this._getSessionFromURL(e);if(n)return this._debug("#_initialize()","error detecting session from URL",n),(n==null?void 0:n.message)==="Identity is already linked"||(n==null?void 0:n.message)==="Identity is already linked to another user"?{error:n}:(await this._removeSession(),{error:n});const{session:i,redirectType:a}=r;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return qe(e)?{error:e}:{error:new JU("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,i;try{const a=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:To}),{data:s,error:o}=a;if(o||!s)return{data:{user:null,session:null},error:o};const u=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(a){if(qe(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var r,n,i;try{let a;if("email"in e){const{email:c,password:h,options:d}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await ac(this.storage,this.storageKey)),a=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:c,password:h,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:p},xform:To})}else if("phone"in e){const{phone:c,password:h,options:d}=e;a=await We(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(i=d==null?void 0:d.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:To})}else throw new yy("You must provide either an email or phone number and a password");const{data:s,error:o}=a;if(o||!s)return{data:{user:null,session:null},error:o};const u=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(a){if(qe(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let r;if("email"in e){const{email:a,password:s,options:o}=e;r=await We(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:AR})}else if("phone"in e){const{phone:a,password:s,options:o}=e;r=await We(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:AR})}else throw new yy("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new wx}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(qe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,i,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const r=await gy(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/"),{data:a,error:s}=await We(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:To});return await bx(this.storage,`${this.storageKey}-code-verifier`),s?{data:{user:null,session:null,redirectType:null},error:s}:!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new wx}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:s})}async signInWithIdToken(e){try{const{options:r,provider:n,token:i,access_token:a,nonce:s}=e,o=await We(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:a,nonce:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:To}),{data:u,error:l}=o;return l?{data:{user:null,session:null},error:l}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new wx}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:l})}catch(r){if(qe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,i,a,s;try{if("email"in e){const{email:o,options:u}=e;let l=null,c=null;this.flowType==="pkce"&&([l,c]=await ac(this.storage,this.storageKey));const{error:h}=await We(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=u==null?void 0:u.data)!==null&&r!==void 0?r:{},create_user:(n=u==null?void 0:u.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:l,code_challenge_method:c},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:u}=e,{data:l,error:c}=await We(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=u==null?void 0:u.data)!==null&&i!==void 0?i:{},create_user:(a=u==null?void 0:u.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(s=u==null?void 0:u.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:c}}throw new yy("You must provide either an email or phone number.")}catch(o){if(qe(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var r,n;try{let i,a;"options"in e&&(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo,a=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:o}=await We(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:To});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const u=s.session,l=s.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(i){if(qe(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var r,n,i;try{let a=null,s=null;return this.flowType==="pkce"&&([a,s]=await ac(this.storage,this.storageKey)),await We(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:s}),headers:this.headers,xform:Nte})}catch(a){if(qe(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Cu;const{error:i}=await We(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(qe(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:a}=e,{error:s}=await We(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in e){const{phone:n,type:i,options:a}=e,{data:s,error:o}=await We(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:o}}throw new yy("You must provide either an email or phone number and a type")}catch(r){if(qe(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await gy(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let s=this.suppressGetSessionWarning;e=new Proxy(e,{get:(u,l,c)=>(!s&&l==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,l,c))})}return{data:{session:e},error:null}}const{session:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await We(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Fo}):await this._useSession(async r=>{var n,i,a;const{data:s,error:o}=r;if(o)throw o;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Cu}:await We(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=s.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:Fo})})}catch(r){if(qe(r))return{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:i,error:a}=n;if(a)throw a;if(!i.session)throw new Cu;const s=i.session;let o=null,u=null;this.flowType==="pkce"&&e.email!=null&&([o,u]=await ac(this.storage,this.storageKey));const{data:l,error:c}=await We(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:u}),jwt:s.access_token,xform:Fo});if(c)throw c;return s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(n){if(qe(n))return{data:{user:null},error:n};throw n}}_decodeJWT(e){return OR(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Cu;const r=Date.now()/1e3;let n=r,i=!0,a=null;const s=OR(e.access_token);if(s.exp&&(n=s.exp,i=n<=r),i){const{session:o,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:u}=await this._getUser(e.access_token);if(u)throw u;a={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(r){if(qe(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:s,error:o}=r;if(o)throw o;e=(n=s.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Cu;const{session:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(qe(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e){try{if(!ra())throw new vy("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new vy("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new SR("Not a valid PKCE flow url.");const r=vx(window.location.href);if(e){if(!r.code)throw new SR("No code detected.");const{data:y,error:b}=await this._exchangeCodeForSession(r.code);if(b)throw b;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:y.session,redirectType:null},error:null}}if(r.error||r.error_description||r.error_code)throw new vy(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});const{provider_token:n,provider_refresh_token:i,access_token:a,refresh_token:s,expires_in:o,expires_at:u,token_type:l}=r;if(!a||!o||!s||!l)throw new vy("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(o);let d=c+h;u&&(d=parseInt(u));const f=d-c;f*1e3<=pf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const p=d-h;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",p,d,c);const{data:m,error:g}=await this._getUser(a);if(g)throw g;const v={provider_token:n,provider_refresh_token:i,access_token:a,expires_in:h,expires_at:d,refresh_token:s,token_type:l,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:r.type},error:null}}catch(r){if(qe(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantFlow(){const e=vx(window.location.href);return!!(ra()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=vx(window.location.href),r=await gy(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return{error:a};const s=(n=i.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:o}=await this.admin.signOut(s,e);if(o&&!(Cte(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await bx(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const r=yte(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,i;try{const{data:{session:a},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await ac(this.storage,this.storageKey,!0));try{return await We(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(qe(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(qe(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:i}=await this._useSession(async a=>{var s,o,u,l,c;const{data:h,error:d}=a;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await We(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(l=h.session)===null||l===void 0?void 0:l.access_token)!==null&&c!==void 0?c:void 0})});if(i)throw i;return ra()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(qe(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,i;const{data:a,error:s}=r;if(s)throw s;return await We(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(qe(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await _te(async i=>(i>0&&await wte(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await We(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:To})),(i,a)=>{const s=200*Math.pow(2,i);return a&&_x(a)&&Date.now()+s-n<pf})}catch(n){if(this._debug(r,"error",n),qe(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),ra()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await gy(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const i=Math.round(Date.now()/1e3),a=((e=n.expires_at)!==null&&e!==void 0?e:1/0)<i+xR;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${xR}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),_x(s)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new Cu;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new r_;const{data:a,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!a.session)throw new Cu;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={session:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(i,"error",a),qe(a)){const s={session:null,error:a};return _x(a)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,r,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const a=[],s=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,r)}catch(u){a.push(u)}});if(await Promise.all(s),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await YU(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await bx(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ra()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),pf);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/pf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${pf}ms, refresh threshold is ${kR} ticks`),i<=kR&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ZU)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ra()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,s]=await ac(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(s)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);i.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;return a?{data:null,error:a}:await We(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(qe(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,i;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:o,error:u}=await We(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(!((i=o==null?void 0:o.totp)===null||i===void 0)&&i.qr_code&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(r){if(qe(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return{data:null,error:a};const{data:s,error:o}=await We(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:o})})}catch(r){if(qe(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;return a?{data:null,error:a}:await We(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(qe(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(e==null?void 0:e.factors)||[],i=n.filter(a=>a.factor_type==="totp"&&a.status==="verified");return{data:{all:n,totp:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:i},error:a}=e;if(a)return{data:null,error:a};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const s=this._decodeJWT(i.access_token);let o=null;s.aal&&(o=s.aal);let u=o;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(u="aal2");const c=s.amr||[];return{data:{currentLevel:o,nextLevel:u,currentAuthenticationMethods:c},error:null}}))}}Fp.nextInstanceID=0;const Hte=Fp;class Wte extends Hte{constructor(e){super(e)}}var Gte=globalThis&&globalThis.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(h){s(h)}}function u(c){try{l(n.throw(c))}catch(h){s(h)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(t,e||[])).next())})};class Yte{constructor(e,r,n){var i,a,s;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=hte(e);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const u=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l={db:nte,realtime:ate,auth:Object.assign(Object.assign({},ite),{storageKey:u}),global:rte},c=dte(n??{},l);this.storageKey=(i=c.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=c.global.headers)!==null&&a!==void 0?a:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(h,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=c.auth)!==null&&s!==void 0?s:{},this.headers,c.global.fetch),this.fetch=lte(r,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},c.realtime)),this.rest=new Eee(`${o}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new ree(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Qee(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return Gte(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:a,flowType:s,lock:o,debug:u},l,c){var h;const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Wte({url:this.authUrl,headers:Object.assign(Object.assign({},d),l),storageKey:a,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,flowType:s,lock:o,debug:u,fetch:c,hasCustomAuthorizationHeader:(h="Authorization"in this.headers)!==null&&h!==void 0?h:!1})}_initRealtimeClient(e){return new Uee(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.realtime.setAuth(n??null),this.changedAccessToken=n):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Jte=(t,e,r)=>new Yte(t,e,r),hb="https://oqthbxvxdlmdkxynzlyt.supabase.co",Zte="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9xdGhieHZ4ZGxtZGt4eW56bHl0Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcxODI2OTM1MywiZXhwIjoyMDMzODQ1MzUzfQ.K8SKaBhGCb5ATx-868hcDsMMp8en0h3ka-ovZqd6ZGk",Vt=Jte(hb,Zte),nh=10;async function Xte(){let t=Vt.from("bookings").select("id, created_at, startDate, endDate, numNights, numGuests, status, totalPrice, cabins(name), guests(fullName, email)",{count:"exact"});const{data:e,error:r,count:n}=await t;if(r)throw console.error(r),new Error("Bookings could not be loaded");return{data:e,count:n}}async function xx({filter:t,sortBy:e,page:r}){let n=Vt.from("bookings").select("id, created_at, startDate, endDate, numNights, numGuests, status, totalPrice, cabins(name), guests(fullName, email)",{count:"exact"});if(t&&(n=n[t.method||"eq"](t.field,t.value)),e&&(n=n.order(e.field,{ascending:e.direction==="asc"})),r){const o=(r-1)*nh,u=o+nh-1;n=n.range(o,u)}const{data:i,error:a,count:s}=await n;if(a)throw console.error(a),new Error("Bookings could not be loaded");return{data:i,count:s}}async function Qte(t){const{data:e,error:r}=await Vt.from("bookings").select("*, cabins(*), guests(*)").eq("id",t).single();if(r)throw console.error(r),new Error("Booking not found");return e}async function ere(t){const{data:e,error:r}=await Vt.from("bookings").select("created_at, totalPrice, extrasPrice").gte("created_at",t).lte("created_at",cb({end:!0}));if(r)throw console.error(r),new Error("Bookings could not get loaded");return e}async function tre(t){const{data:e,error:r}=await Vt.from("bookings").select("*, guests(fullName)").gte("startDate",t).lte("startDate",cb());if(r)throw console.error(r),new Error("Bookings could not get loaded");return e}async function rre(){const{data:t,error:e}=await Vt.from("bookings").select("*, guests(fullName, nationality, countryFlag)").or(`and(status.eq.unconfirmed,startDate.eq.${cb()}),and(status.eq.checked-in,endDate.eq.${cb()})`).order("created_at");if(e)throw console.error(e),new Error("Bookings could not get loaded");return t}async function XU(t,e){const{data:r,error:n}=await Vt.from("bookings").update(e).eq("id",t).select().single();if(n)throw console.error(n),new Error("Booking could not be updated");return r}async function nre(t){const{data:e,error:r}=await Vt.from("bookings").delete().eq("id",t);if(r)throw console.error(r),new Error("Booking could not be deleted");return e}function ire(){const[t]=ql(),e=t.get("last")?Number(t.get("last")):7,r=KT(new Date,e).toISOString(),{isLoading:n,data:i}=lo({queryFn:()=>tre(r),queryKey:["stays",`last-${e}`]}),a=i==null?void 0:i.filter(s=>s.status==="checked-in"||s.status==="checked-out");return{isLoading:n,stays:i,confirmedStays:a,numDays:e}}function are(){const[t]=ql(),e=t.get("last")?Number(t.get("last")):7,r=KT(new Date,e).toISOString(),{isLoading:n,data:i}=lo({queryFn:()=>ere(r),queryKey:["bookings",`last-${e}`]});return{isLoading:n,bookings:i}}const sre=vU`
  to {
    transform: rotate(1turn)
  }
`,ms=ue.div`
  margin: 4.8rem auto;

  width: 6.4rem;
  aspect-ratio: 1;
  border-radius: 50%;
  background: radial-gradient(farthest-side, var(--color-brand-600) 94%, #0000)
      top/10px 10px no-repeat,
    conic-gradient(#0000 30%, var(--color-brand-600));
  -webkit-mask: radial-gradient(farthest-side, #0000 calc(100% - 10px), #000 0);
  animation: ${sre} 1.5s infinite linear;
`;var QU={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},IR=$.createContext&&$.createContext(QU),su=globalThis&&globalThis.__assign||function(){return su=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},su.apply(this,arguments)},ore=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};function ez(t){return t&&t.map(function(e,r){return $.createElement(e.tag,su({key:r},e.attr),ez(e.child))})}function wt(t){return function(e){return $.createElement(ure,su({attr:su({},t.attr)},e),ez(t.child))}}function ure(t){var e=function(r){var n=t.attr,i=t.size,a=t.title,s=ore(t,["attr","size","title"]),o=i||r.size||"1em",u;return r.className&&(u=r.className),t.className&&(u=(u?u+" ":"")+t.className),$.createElement("svg",su({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,s,{className:u,style:su(su({color:t.color||r.color},r.style),t.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),a&&$.createElement("title",null,a),t.children)};return IR!==void 0?$.createElement(IR.Consumer,null,function(r){return e(r)}):e(QU)}function lre(t){return wt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M12 1.5a.75.75 0 01.75.75V7.5h-1.5V2.25A.75.75 0 0112 1.5zM11.25 7.5v5.69l-1.72-1.72a.75.75 0 00-1.06 1.06l3 3a.75.75 0 001.06 0l3-3a.75.75 0 10-1.06-1.06l-1.72 1.72V7.5h3.75a3 3 0 013 3v9a3 3 0 01-3 3h-9a3 3 0 01-3-3v-9a3 3 0 013-3h3.75z"}}]})(t)}function cre(t){return wt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M7.5 3.75A1.5 1.5 0 006 5.25v13.5a1.5 1.5 0 001.5 1.5h6a1.5 1.5 0 001.5-1.5V15a.75.75 0 011.5 0v3.75a3 3 0 01-3 3h-6a3 3 0 01-3-3V5.25a3 3 0 013-3h6a3 3 0 013 3V9A.75.75 0 0115 9V5.25a1.5 1.5 0 00-1.5-1.5h-6zm10.72 4.72a.75.75 0 011.06 0l3 3a.75.75 0 010 1.06l-3 3a.75.75 0 11-1.06-1.06l1.72-1.72H9a.75.75 0 010-1.5h10.94l-1.72-1.72a.75.75 0 010-1.06z",clipRule:"evenodd"}}]})(t)}function tz(t){return wt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M11.47 1.72a.75.75 0 011.06 0l3 3a.75.75 0 01-1.06 1.06l-1.72-1.72V7.5h-1.5V4.06L9.53 5.78a.75.75 0 01-1.06-1.06l3-3zM11.25 7.5V15a.75.75 0 001.5 0V7.5h3.75a3 3 0 013 3v9a3 3 0 01-3 3h-9a3 3 0 01-3-3v-9a3 3 0 013-3h3.75z"}}]})(t)}function hre(t){return wt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M7.72 12.53a.75.75 0 010-1.06l7.5-7.5a.75.75 0 111.06 1.06L9.31 12l6.97 6.97a.75.75 0 11-1.06 1.06l-7.5-7.5z",clipRule:"evenodd"}}]})(t)}function dre(t){return wt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z",clipRule:"evenodd"}}]})(t)}function fre(t){return wt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M10.5 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z",clipRule:"evenodd"}}]})(t)}function pre(t){return wt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M12 15a3 3 0 100-6 3 3 0 000 6z"}},{tag:"path",attr:{fillRule:"evenodd",d:"M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 010-1.113zM17.25 12a5.25 5.25 0 11-10.5 0 5.25 5.25 0 0110.5 0z",clipRule:"evenodd"}}]})(t)}function mre(t){return wt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"}}]})(t)}function gre(t){return wt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M21.731 2.269a2.625 2.625 0 00-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 000-3.712zM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 00-1.32 2.214l-.8 2.685a.75.75 0 00.933.933l2.685-.8a5.25 5.25 0 002.214-1.32L19.513 8.2z"}}]})(t)}function yre(t){return wt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M16.5 6a3 3 0 00-3-3H6a3 3 0 00-3 3v7.5a3 3 0 003 3v-6A4.5 4.5 0 0110.5 6h6z"}},{tag:"path",attr:{d:"M18 7.5a3 3 0 013 3V18a3 3 0 01-3 3h-7.5a3 3 0 01-3-3v-7.5a3 3 0 013-3H18z"}}]})(t)}function rz(t){return wt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M16.5 4.478v.227a48.816 48.816 0 013.878.512.75.75 0 11-.256 1.478l-.209-.035-1.005 13.07a3 3 0 01-2.991 2.77H8.084a3 3 0 01-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 01-.256-1.478A48.567 48.567 0 017.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 013.369 0c1.603.051 2.815 1.387 2.815 2.951zm-6.136-1.452a51.196 51.196 0 013.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 00-6 0v-.113c0-.794.609-1.428 1.364-1.452zm-.355 5.945a.75.75 0 10-1.5.058l.347 9a.75.75 0 101.499-.058l-.346-9zm5.48.058a.75.75 0 10-1.498-.058l-.347 9a.75.75 0 001.5.058l.345-9z",clipRule:"evenodd"}}]})(t)}function vre(t){return wt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5.47 5.47a.75.75 0 011.06 0L12 10.94l5.47-5.47a.75.75 0 111.06 1.06L13.06 12l5.47 5.47a.75.75 0 11-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 01-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 010-1.06z",clipRule:"evenodd"}}]})(t)}function bre(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 003 15h-.75M15 10.5a3 3 0 11-6 0 3 3 0 016 0zm3 0h.008v.008H18V10.5zm-12 0h.008v.008H6V10.5z"}}]})(t)}function wre(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 00.75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 00-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0112 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 01-.673-.38m0 0A2.18 2.18 0 013 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 013.413-.387m7.5 0V5.25A2.25 2.25 0 0013.5 3h-3a2.25 2.25 0 00-2.25 2.25v.894m7.5 0a48.667 48.667 0 00-7.5 0M12 12.75h.008v.008H12v-.008z"}}]})(t)}function nz(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5m-9-6h.008v.008H12v-.008zM12 15h.008v.008H12V15zm0 2.25h.008v.008H12v-.008zM9.75 15h.008v.008H9.75V15zm0 2.25h.008v.008H9.75v-.008zM7.5 15h.008v.008H7.5V15zm0 2.25h.008v.008H7.5v-.008zm6.75-4.5h.008v.008h-.008v-.008zm0 2.25h.008v.008h-.008V15zm0 2.25h.008v.008h-.008v-.008zm2.25-4.5h.008v.008H16.5v-.008zm0 2.25h.008v.008H16.5V15z"}}]})(t)}function _re(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z"}}]})(t)}function xre(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z"}}]})(t)}function Ore(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}}]})(t)}function Sre(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}},{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}}]})(t)}function Pre(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}}]})(t)}function iz(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 21v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21m0 0h4.5V3.545M12.75 21h7.5V10.75M2.25 21h1.5m18 0h-18M2.25 9l4.5-1.636M18.75 3l-1.5.545m0 6.205l3 1m1.5.5l-1.5-.5M6.75 7.364V3h-3v18m3-13.636l10.5-3.819"}}]})(t)}function Ere(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}}]})(t)}function Are(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"}}]})(t)}function Tre(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z"}}]})(t)}function kre(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"}}]})(t)}function Cre(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"}}]})(t)}function Ire(t){return wt({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"}}]})(t)}const $re=ue.div`
  /* Box */
  background-color: var(--color-grey-0);
  border: 1px solid var(--color-grey-100);
  border-radius: var(--border-radius-md);

  padding: 1.6rem;
  display: grid;
  grid-template-columns: 6.4rem 1fr;
  grid-template-rows: auto auto;
  column-gap: 1.6rem;
  row-gap: 0.4rem;
`,jre=ue.div`
  grid-row: 1 / -1;
  aspect-ratio: 1;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;

  /* Make these dynamic, based on the received prop */
  background-color: var(--color-${t=>t.color}-100);

  & svg {
    width: 3.2rem;
    height: 3.2rem;
    color: var(--color-${t=>t.color}-700);
  }
`,Rre=ue.h5`
  align-self: end;
  font-size: 1.2rem;
  text-transform: uppercase;
  letter-spacing: 0.4px;
  font-weight: 600;
  color: var(--color-grey-500);
`,Nre=ue.p`
  font-size: 2.4rem;
  line-height: 1;
  font-weight: 500;
`;function by({icon:t,title:e,value:r,color:n}){return Q($re,{children:[A(jre,{color:n,children:t}),A(Rre,{children:e}),A(Nre,{children:r})]})}function Mre({bookings:t,confirmedStays:e,numDays:r,cabinCount:n}){const i=t.length,a=t.reduce((u,l)=>u+l.totalPrice,0),s=e.length,o=e.reduce((u,l)=>u+l.numNights,0)/(r*n);return Q(fs,{children:[A(by,{title:"Bookings",color:"blue",icon:A(wre,{}),value:i}),A(by,{title:"Sales",color:"green",icon:A(bre,{}),value:$i(a)}),A(by,{title:"Check ins",color:"indigo",icon:A(nz,{}),value:s}),A(by,{title:"Occupancy rate",color:"yellow",icon:A(_re,{}),value:Math.round(o*100)+"%"})]})}async function Dre(){const{data:t,error:e}=await Vt.from("cabins").select("*");if(e)throw console.error(e),new Error("Cabins could not be loaded");return t}async function az(t,e){var l,c;const r=(c=(l=t.image)==null?void 0:l.startsWith)==null?void 0:c.call(l,hb),n=`${Math.random()}-${t.image.name}`.replaceAll("/",""),i=r?t.image:`${hb}/storage/v1/object/public/cabin-images/${n}`;let a=Vt.from("cabins");e||(a=a.insert([{...t,image:i}])),e&&(a=a.update({...t,image:i}).eq("id",e));const{data:s,error:o}=await a.select().single();if(o)throw console.error(o),new Error("Cabin could not be created");if(r)return s;const{error:u}=await Vt.storage.from("cabin-images").upload(n,t.image);if(u)throw await Vt.from("cabins").delete().eq("id",s.id),console.error(u),new Error("Cabin image could not be uploaded and the cabin was not created");return s}async function Lre(t){const{data:e,error:r}=await Vt.from("cabins").delete().eq("id",t);if(r)throw console.error(r),new Error("Cabin could not be deleted");return e}function ZT(){const{isLoading:t,data:e,error:r}=lo({queryKey:["cabins"],queryFn:Dre});return{isLoading:t,error:r,cabins:e}}const Fre=ue.div`
  /* Box */
  background-color: var(--color-grey-0);
  border: 1px solid var(--color-grey-100);
  border-radius: var(--border-radius-md);

  padding: 3.2rem;

  display: flex;
  flex-direction: column;
  gap: 2.4rem;
`,Jr=ue.h1`
  ${t=>t.as==="h1"&&$r`
      font-size: 3rem;
      font-weight: 600;
    `}

  ${t=>t.as==="h2"&&$r`
      font-size: 2rem;
      font-weight: 600;
    `}
    
    ${t=>t.as==="h3"&&$r`
      font-size: 2rem;
      font-weight: 500;
    `}
    
    ${t=>t.as==="h4"&&$r`
      font-size: 3rem;
      font-weight: 600;
      text-align: center;
    `}
    
  line-height: 1.4;
`;function sz(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=sz(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function ze(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=sz(t))&&(n&&(n+=" "),n+=e);return n}var Ure=Array.isArray,Xn=Ure,zre=typeof ln=="object"&&ln&&ln.Object===Object&&ln,oz=zre,Bre=oz,qre=typeof self=="object"&&self&&self.Object===Object&&self,Kre=Bre||qre||Function("return this")(),gs=Kre,Vre=gs,Hre=Vre.Symbol,pg=Hre,$R=pg,uz=Object.prototype,Wre=uz.hasOwnProperty,Gre=uz.toString,mf=$R?$R.toStringTag:void 0;function Yre(t){var e=Wre.call(t,mf),r=t[mf];try{t[mf]=void 0;var n=!0}catch{}var i=Gre.call(t);return n&&(e?t[mf]=r:delete t[mf]),i}var Jre=Yre,Zre=Object.prototype,Xre=Zre.toString;function Qre(t){return Xre.call(t)}var ene=Qre,jR=pg,tne=Jre,rne=ene,nne="[object Null]",ine="[object Undefined]",RR=jR?jR.toStringTag:void 0;function ane(t){return t==null?t===void 0?ine:nne:RR&&RR in Object(t)?tne(t):rne(t)}var co=ane;function sne(t){return t!=null&&typeof t=="object"}var ho=sne,one=co,une=ho,lne="[object Symbol]";function cne(t){return typeof t=="symbol"||une(t)&&one(t)==lne}var pd=cne,hne=Xn,dne=pd,fne=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,pne=/^\w*$/;function mne(t,e){if(hne(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||dne(t)?!0:pne.test(t)||!fne.test(t)||e!=null&&t in Object(e)}var XT=mne;function gne(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var xu=gne;const md=Ze(xu);var yne=co,vne=xu,bne="[object AsyncFunction]",wne="[object Function]",_ne="[object GeneratorFunction]",xne="[object Proxy]";function One(t){if(!vne(t))return!1;var e=yne(t);return e==wne||e==_ne||e==bne||e==xne}var QT=One;const Ne=Ze(QT);var Sne=gs,Pne=Sne["__core-js_shared__"],Ene=Pne,Ox=Ene,NR=function(){var t=/[^.]+$/.exec(Ox&&Ox.keys&&Ox.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Ane(t){return!!NR&&NR in t}var Tne=Ane,kne=Function.prototype,Cne=kne.toString;function Ine(t){if(t!=null){try{return Cne.call(t)}catch{}try{return t+""}catch{}}return""}var lz=Ine,$ne=QT,jne=Tne,Rne=xu,Nne=lz,Mne=/[\\^$.*+?()[\]{}|]/g,Dne=/^\[object .+?Constructor\]$/,Lne=Function.prototype,Fne=Object.prototype,Une=Lne.toString,zne=Fne.hasOwnProperty,Bne=RegExp("^"+Une.call(zne).replace(Mne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function qne(t){if(!Rne(t)||jne(t))return!1;var e=$ne(t)?Bne:Dne;return e.test(Nne(t))}var Kne=qne;function Vne(t,e){return t==null?void 0:t[e]}var Hne=Vne,Wne=Kne,Gne=Hne;function Yne(t,e){var r=Gne(t,e);return Wne(r)?r:void 0}var Hl=Yne,Jne=Hl,Zne=Jne(Object,"create"),n_=Zne,MR=n_;function Xne(){this.__data__=MR?MR(null):{},this.size=0}var Qne=Xne;function eie(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var tie=eie,rie=n_,nie="__lodash_hash_undefined__",iie=Object.prototype,aie=iie.hasOwnProperty;function sie(t){var e=this.__data__;if(rie){var r=e[t];return r===nie?void 0:r}return aie.call(e,t)?e[t]:void 0}var oie=sie,uie=n_,lie=Object.prototype,cie=lie.hasOwnProperty;function hie(t){var e=this.__data__;return uie?e[t]!==void 0:cie.call(e,t)}var die=hie,fie=n_,pie="__lodash_hash_undefined__";function mie(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=fie&&e===void 0?pie:e,this}var gie=mie,yie=Qne,vie=tie,bie=oie,wie=die,_ie=gie;function gd(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}gd.prototype.clear=yie;gd.prototype.delete=vie;gd.prototype.get=bie;gd.prototype.has=wie;gd.prototype.set=_ie;var xie=gd;function Oie(){this.__data__=[],this.size=0}var Sie=Oie;function Pie(t,e){return t===e||t!==t&&e!==e}var ek=Pie,Eie=ek;function Aie(t,e){for(var r=t.length;r--;)if(Eie(t[r][0],e))return r;return-1}var i_=Aie,Tie=i_,kie=Array.prototype,Cie=kie.splice;function Iie(t){var e=this.__data__,r=Tie(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Cie.call(e,r,1),--this.size,!0}var $ie=Iie,jie=i_;function Rie(t){var e=this.__data__,r=jie(e,t);return r<0?void 0:e[r][1]}var Nie=Rie,Mie=i_;function Die(t){return Mie(this.__data__,t)>-1}var Lie=Die,Fie=i_;function Uie(t,e){var r=this.__data__,n=Fie(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}var zie=Uie,Bie=Sie,qie=$ie,Kie=Nie,Vie=Lie,Hie=zie;function yd(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}yd.prototype.clear=Bie;yd.prototype.delete=qie;yd.prototype.get=Kie;yd.prototype.has=Vie;yd.prototype.set=Hie;var a_=yd,Wie=Hl,Gie=gs,Yie=Wie(Gie,"Map"),tk=Yie,DR=xie,Jie=a_,Zie=tk;function Xie(){this.size=0,this.__data__={hash:new DR,map:new(Zie||Jie),string:new DR}}var Qie=Xie;function eae(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var tae=eae,rae=tae;function nae(t,e){var r=t.__data__;return rae(e)?r[typeof e=="string"?"string":"hash"]:r.map}var s_=nae,iae=s_;function aae(t){var e=iae(this,t).delete(t);return this.size-=e?1:0,e}var sae=aae,oae=s_;function uae(t){return oae(this,t).get(t)}var lae=uae,cae=s_;function hae(t){return cae(this,t).has(t)}var dae=hae,fae=s_;function pae(t,e){var r=fae(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}var mae=pae,gae=Qie,yae=sae,vae=lae,bae=dae,wae=mae;function vd(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}vd.prototype.clear=gae;vd.prototype.delete=yae;vd.prototype.get=vae;vd.prototype.has=bae;vd.prototype.set=wae;var rk=vd,cz=rk,_ae="Expected a function";function nk(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(_ae);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var s=t.apply(this,n);return r.cache=a.set(i,s)||a,s};return r.cache=new(nk.Cache||cz),r}nk.Cache=cz;var hz=nk;const xae=Ze(hz);var Oae=hz,Sae=500;function Pae(t){var e=Oae(t,function(n){return r.size===Sae&&r.clear(),n}),r=e.cache;return e}var Eae=Pae,Aae=Eae,Tae=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kae=/\\(\\)?/g,Cae=Aae(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Tae,function(r,n,i,a){e.push(i?a.replace(kae,"$1"):n||r)}),e}),Iae=Cae;function $ae(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var ik=$ae,LR=pg,jae=ik,Rae=Xn,Nae=pd,Mae=1/0,FR=LR?LR.prototype:void 0,UR=FR?FR.toString:void 0;function dz(t){if(typeof t=="string")return t;if(Rae(t))return jae(t,dz)+"";if(Nae(t))return UR?UR.call(t):"";var e=t+"";return e=="0"&&1/t==-Mae?"-0":e}var Dae=dz,Lae=Dae;function Fae(t){return t==null?"":Lae(t)}var fz=Fae,Uae=Xn,zae=XT,Bae=Iae,qae=fz;function Kae(t,e){return Uae(t)?t:zae(t,e)?[t]:Bae(qae(t))}var pz=Kae,Vae=pd,Hae=1/0;function Wae(t){if(typeof t=="string"||Vae(t))return t;var e=t+"";return e=="0"&&1/t==-Hae?"-0":e}var o_=Wae,Gae=pz,Yae=o_;function Jae(t,e){e=Gae(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[Yae(e[r++])];return r&&r==n?t:void 0}var ak=Jae,Zae=ak;function Xae(t,e,r){var n=t==null?void 0:Zae(t,e);return n===void 0?r:n}var mz=Xae;const di=Ze(mz);function Qae(t){return t==null}var ese=Qae;const De=Ze(ese);var tse=co,rse=Xn,nse=ho,ise="[object String]";function ase(t){return typeof t=="string"||!rse(t)&&nse(t)&&tse(t)==ise}var sse=ase;const mg=Ze(sse);var ose=co,use=ho,lse="[object Number]";function cse(t){return typeof t=="number"||use(t)&&ose(t)==lse}var gz=cse;const hse=Ze(gz);var dse=gz;function fse(t){return dse(t)&&t!=+t}var pse=fse;const bd=Ze(pse);var Sn=function(e){return e===0?0:e>0?1:-1},el=function(e){return mg(e)&&e.indexOf("%")===e.length-1},fe=function(e){return hse(e)&&!bd(e)},vr=function(e){return fe(e)||mg(e)},mse=0,wd=function(e){var r=++mse;return"".concat(e||"").concat(r)},Pn=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!fe(e)&&!mg(e))return n;var a;if(el(e)){var s=e.indexOf("%");a=r*parseFloat(e.slice(0,s))/100}else a=+e;return bd(a)&&(a=n),i&&a>r&&(a=r),a},Uo=function(e){if(!e)return null;var r=Object.keys(e);return r&&r.length?e[r[0]]:null},gse=function(e){if(!Array.isArray(e))return!1;for(var r=e.length,n={},i=0;i<r;i++)if(!n[e[i]])n[e[i]]=!0;else return!0;return!1},Un=function(e,r){return fe(e)&&fe(r)?function(n){return e+n*(r-e)}:function(){return r}};function db(t,e,r){return!t||!t.length?null:t.find(function(n){return n&&(typeof e=="function"?e(n):di(n,e))===r})}function ih(t,e){for(var r in t)if({}.hasOwnProperty.call(t,r)&&(!{}.hasOwnProperty.call(e,r)||t[r]!==e[r]))return!1;for(var n in e)if({}.hasOwnProperty.call(e,n)&&!{}.hasOwnProperty.call(t,n))return!1;return!0}function mP(t){return mP=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mP(t)}var yse=["viewBox","children"],vse=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],zR=["points","pathLength"],Sx={svg:yse,polygon:zR,polyline:zR},sk=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],fb=function(e,r){if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(I.isValidElement(e)&&(n=e.props),!md(n))return null;var i={};return Object.keys(n).forEach(function(a){sk.includes(a)&&(i[a]=r||function(s){return n[a](n,s)})}),i},bse=function(e,r,n){return function(i){return e(r,n,i),null}},Pl=function(e,r,n){if(!md(e)||mP(e)!=="object")return null;var i=null;return Object.keys(e).forEach(function(a){var s=e[a];sk.includes(a)&&typeof s=="function"&&(i||(i={}),i[a]=bse(s,r,n))}),i},wse=["children"],_se=["children"];function BR(t,e){if(t==null)return{};var r=xse(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function xse(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function gP(t){return gP=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gP(t)}var qR={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},Ks=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},KR=null,Px=null,ok=function t(e){if(e===KR&&Array.isArray(Px))return Px;var r=[];return I.Children.forEach(e,function(n){De(n)||(Oh.isFragment(n)?r=r.concat(t(n.props.children)):r.push(n))}),Px=r,KR=e,r};function Fi(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(function(i){return Ks(i)}):n=[Ks(e)],ok(t).forEach(function(i){var a=di(i,"type.displayName")||di(i,"type.name");n.indexOf(a)!==-1&&r.push(i)}),r}function si(t,e){var r=Fi(t,e);return r&&r[0]}var VR=function(e){if(!e||!e.props)return!1;var r=e.props,n=r.width,i=r.height;return!(!fe(n)||n<=0||!fe(i)||i<=0)},Ose=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Sse=function(e){return e&&e.type&&mg(e.type)&&Ose.indexOf(e.type)>=0},Pse=function(e){return e&&gP(e)==="object"&&"cx"in e&&"cy"in e&&"r"in e},Ese=function(e,r,n,i){var a,s=(a=Sx==null?void 0:Sx[i])!==null&&a!==void 0?a:[];return!Ne(e)&&(i&&s.includes(r)||vse.includes(r))||n&&sk.includes(r)},$e=function(e,r,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var i=e;if(I.isValidElement(e)&&(i=e.props),!md(i))return null;var a={};return Object.keys(i).forEach(function(s){var o;Ese((o=i)===null||o===void 0?void 0:o[s],s,r,n)&&(a[s]=i[s])}),a},yP=function t(e,r){if(e===r)return!0;var n=I.Children.count(e);if(n!==I.Children.count(r))return!1;if(n===0)return!0;if(n===1)return HR(Array.isArray(e)?e[0]:e,Array.isArray(r)?r[0]:r);for(var i=0;i<n;i++){var a=e[i],s=r[i];if(Array.isArray(a)||Array.isArray(s)){if(!t(a,s))return!1}else if(!HR(a,s))return!1}return!0},HR=function(e,r){if(De(e)&&De(r))return!0;if(!De(e)&&!De(r)){var n=e.props||{},i=n.children,a=BR(n,wse),s=r.props||{},o=s.children,u=BR(s,_se);return i&&o?ih(a,u)&&yP(i,o):!i&&!o?ih(a,u):!1}return!1},WR=function(e,r){var n=[],i={};return ok(e).forEach(function(a,s){if(Sse(a))n.push(a);else if(a){var o=Ks(a.type),u=r[o]||{},l=u.handler,c=u.once;if(l&&(!c||!i[o])){var h=l(a,o,s);n.push(h),i[o]=!0}}}),n},Ase=function(e){var r=e&&e.type;return r&&qR[r]?qR[r]:null},Tse=function(e,r){return ok(r).indexOf(e)},kse=["children","width","height","viewBox","className","style","title","desc"];function vP(){return vP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},vP.apply(this,arguments)}function Cse(t,e){if(t==null)return{};var r=Ise(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Ise(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function bP(t){var e=t.children,r=t.width,n=t.height,i=t.viewBox,a=t.className,s=t.style,o=t.title,u=t.desc,l=Cse(t,kse),c=i||{width:r,height:n,x:0,y:0},h=ze("recharts-surface",a);return $.createElement("svg",vP({},$e(l,!0,"svg"),{className:h,width:r,height:n,style:s,viewBox:"".concat(c.x," ").concat(c.y," ").concat(c.width," ").concat(c.height)}),$.createElement("title",null,o),$.createElement("desc",null,u),e)}var $se=["children","className"];function wP(){return wP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wP.apply(this,arguments)}function jse(t,e){if(t==null)return{};var r=Rse(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Rse(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}var Ye=$.forwardRef(function(t,e){var r=t.children,n=t.className,i=jse(t,$se),a=ze("recharts-layer",n);return $.createElement("g",wP({className:a},$e(i,!0),{ref:e}),r)}),wa=function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a]};function Nse(t,e,r){var n=-1,i=t.length;e<0&&(e=-e>i?0:i+e),r=r>i?i:r,r<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var a=Array(i);++n<i;)a[n]=t[n+e];return a}var Mse=Nse,Dse=Mse;function Lse(t,e,r){var n=t.length;return r=r===void 0?n:r,!e&&r>=n?t:Dse(t,e,r)}var Fse=Lse,Use="\\ud800-\\udfff",zse="\\u0300-\\u036f",Bse="\\ufe20-\\ufe2f",qse="\\u20d0-\\u20ff",Kse=zse+Bse+qse,Vse="\\ufe0e\\ufe0f",Hse="\\u200d",Wse=RegExp("["+Hse+Use+Kse+Vse+"]");function Gse(t){return Wse.test(t)}var yz=Gse;function Yse(t){return t.split("")}var Jse=Yse,vz="\\ud800-\\udfff",Zse="\\u0300-\\u036f",Xse="\\ufe20-\\ufe2f",Qse="\\u20d0-\\u20ff",eoe=Zse+Xse+Qse,toe="\\ufe0e\\ufe0f",roe="["+vz+"]",_P="["+eoe+"]",xP="\\ud83c[\\udffb-\\udfff]",noe="(?:"+_P+"|"+xP+")",bz="[^"+vz+"]",wz="(?:\\ud83c[\\udde6-\\uddff]){2}",_z="[\\ud800-\\udbff][\\udc00-\\udfff]",ioe="\\u200d",xz=noe+"?",Oz="["+toe+"]?",aoe="(?:"+ioe+"(?:"+[bz,wz,_z].join("|")+")"+Oz+xz+")*",soe=Oz+xz+aoe,ooe="(?:"+[bz+_P+"?",_P,wz,_z,roe].join("|")+")",uoe=RegExp(xP+"(?="+xP+")|"+ooe+soe,"g");function loe(t){return t.match(uoe)||[]}var coe=loe,hoe=Jse,doe=yz,foe=coe;function poe(t){return doe(t)?foe(t):hoe(t)}var moe=poe,goe=Fse,yoe=yz,voe=moe,boe=fz;function woe(t){return function(e){e=boe(e);var r=yoe(e)?voe(e):void 0,n=r?r[0]:e.charAt(0),i=r?goe(r,1).join(""):e.slice(1);return n[t]()+i}}var _oe=woe,xoe=_oe,Ooe=xoe("toUpperCase"),Soe=Ooe;const u_=Ze(Soe);function Pt(t){return function(){return t}}const Sz=Math.cos,pb=Math.sin,Ca=Math.sqrt,mb=Math.PI,l_=2*mb,OP=Math.PI,SP=2*OP,Uu=1e-6,Poe=SP-Uu;function Pz(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function Eoe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Pz;const r=10**e;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class Aoe{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Pz:Eoe(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,i){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,r,n,i,a,s){this._append`C${+e},${+r},${+n},${+i},${this._x1=+a},${this._y1=+s}`}arcTo(e,r,n,i,a){if(e=+e,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,o=this._y1,u=n-e,l=i-r,c=s-e,h=o-r,d=c*c+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(d>Uu)if(!(Math.abs(h*u-l*c)>Uu)||!a)this._append`L${this._x1=e},${this._y1=r}`;else{let f=n-s,p=i-o,m=u*u+l*l,g=f*f+p*p,v=Math.sqrt(m),y=Math.sqrt(d),b=a*Math.tan((OP-Math.acos((m+d-g)/(2*v*y)))/2),w=b/y,_=b/v;Math.abs(w-1)>Uu&&this._append`L${e+w*c},${r+w*h}`,this._append`A${a},${a},0,0,${+(h*f>c*p)},${this._x1=e+_*u},${this._y1=r+_*l}`}}arc(e,r,n,i,a,s){if(e=+e,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(i),u=n*Math.sin(i),l=e+o,c=r+u,h=1^s,d=s?i-a:a-i;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>Uu||Math.abs(this._y1-c)>Uu)&&this._append`L${l},${c}`,n&&(d<0&&(d=d%SP+SP),d>Poe?this._append`A${n},${n},0,1,${h},${e-o},${r-u}A${n},${n},0,1,${h},${this._x1=l},${this._y1=c}`:d>Uu&&this._append`A${n},${n},0,${+(d>=OP)},${h},${this._x1=e+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(e,r,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function uk(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new Aoe(e)}function lk(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ez(t){this._context=t}Ez.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function c_(t){return new Ez(t)}function Az(t){return t[0]}function Tz(t){return t[1]}function kz(t,e){var r=Pt(!0),n=null,i=c_,a=null,s=uk(o);t=typeof t=="function"?t:t===void 0?Az:Pt(t),e=typeof e=="function"?e:e===void 0?Tz:Pt(e);function o(u){var l,c=(u=lk(u)).length,h,d=!1,f;for(n==null&&(a=i(f=s())),l=0;l<=c;++l)!(l<c&&r(h=u[l],l,u))===d&&((d=!d)?a.lineStart():a.lineEnd()),d&&a.point(+t(h,l,u),+e(h,l,u));if(f)return a=null,f+""||null}return o.x=function(u){return arguments.length?(t=typeof u=="function"?u:Pt(+u),o):t},o.y=function(u){return arguments.length?(e=typeof u=="function"?u:Pt(+u),o):e},o.defined=function(u){return arguments.length?(r=typeof u=="function"?u:Pt(!!u),o):r},o.curve=function(u){return arguments.length?(i=u,n!=null&&(a=i(n)),o):i},o.context=function(u){return arguments.length?(u==null?n=a=null:a=i(n=u),o):n},o}function wy(t,e,r){var n=null,i=Pt(!0),a=null,s=c_,o=null,u=uk(l);t=typeof t=="function"?t:t===void 0?Az:Pt(+t),e=typeof e=="function"?e:Pt(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?Tz:Pt(+r);function l(h){var d,f,p,m=(h=lk(h)).length,g,v=!1,y,b=new Array(m),w=new Array(m);for(a==null&&(o=s(y=u())),d=0;d<=m;++d){if(!(d<m&&i(g=h[d],d,h))===v)if(v=!v)f=d,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),p=d-1;p>=f;--p)o.point(b[p],w[p]);o.lineEnd(),o.areaEnd()}v&&(b[d]=+t(g,d,h),w[d]=+e(g,d,h),o.point(n?+n(g,d,h):b[d],r?+r(g,d,h):w[d]))}if(y)return o=null,y+""||null}function c(){return kz().defined(i).curve(s).context(a)}return l.x=function(h){return arguments.length?(t=typeof h=="function"?h:Pt(+h),n=null,l):t},l.x0=function(h){return arguments.length?(t=typeof h=="function"?h:Pt(+h),l):t},l.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:Pt(+h),l):n},l.y=function(h){return arguments.length?(e=typeof h=="function"?h:Pt(+h),r=null,l):e},l.y0=function(h){return arguments.length?(e=typeof h=="function"?h:Pt(+h),l):e},l.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:Pt(+h),l):r},l.lineX0=l.lineY0=function(){return c().x(t).y(e)},l.lineY1=function(){return c().x(t).y(r)},l.lineX1=function(){return c().x(n).y(e)},l.defined=function(h){return arguments.length?(i=typeof h=="function"?h:Pt(!!h),l):i},l.curve=function(h){return arguments.length?(s=h,a!=null&&(o=s(a)),l):s},l.context=function(h){return arguments.length?(h==null?a=o=null:o=s(a=h),l):a},l}class Cz{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function Toe(t){return new Cz(t,!0)}function koe(t){return new Cz(t,!1)}const ck={draw(t,e){const r=Ca(e/mb);t.moveTo(r,0),t.arc(0,0,r,0,l_)}},Coe={draw(t,e){const r=Ca(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},Iz=Ca(1/3),Ioe=Iz*2,$oe={draw(t,e){const r=Ca(e/Ioe),n=r*Iz;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},joe={draw(t,e){const r=Ca(e),n=-r/2;t.rect(n,n,r,r)}},Roe=.8908130915292852,$z=pb(mb/10)/pb(7*mb/10),Noe=pb(l_/10)*$z,Moe=-Sz(l_/10)*$z,Doe={draw(t,e){const r=Ca(e*Roe),n=Noe*r,i=Moe*r;t.moveTo(0,-r),t.lineTo(n,i);for(let a=1;a<5;++a){const s=l_*a/5,o=Sz(s),u=pb(s);t.lineTo(u*r,-o*r),t.lineTo(o*n-u*i,u*n+o*i)}t.closePath()}},Ex=Ca(3),Loe={draw(t,e){const r=-Ca(e/(Ex*3));t.moveTo(0,r*2),t.lineTo(-Ex*r,-r),t.lineTo(Ex*r,-r),t.closePath()}},xi=-.5,Oi=Ca(3)/2,PP=1/Ca(12),Foe=(PP/2+1)*3,Uoe={draw(t,e){const r=Ca(e/Foe),n=r/2,i=r*PP,a=n,s=r*PP+r,o=-a,u=s;t.moveTo(n,i),t.lineTo(a,s),t.lineTo(o,u),t.lineTo(xi*n-Oi*i,Oi*n+xi*i),t.lineTo(xi*a-Oi*s,Oi*a+xi*s),t.lineTo(xi*o-Oi*u,Oi*o+xi*u),t.lineTo(xi*n+Oi*i,xi*i-Oi*n),t.lineTo(xi*a+Oi*s,xi*s-Oi*a),t.lineTo(xi*o+Oi*u,xi*u-Oi*o),t.closePath()}};function zoe(t,e){let r=null,n=uk(i);t=typeof t=="function"?t:Pt(t||ck),e=typeof e=="function"?e:Pt(e===void 0?64:+e);function i(){let a;if(r||(r=a=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),a)return r=null,a+""||null}return i.type=function(a){return arguments.length?(t=typeof a=="function"?a:Pt(a),i):t},i.size=function(a){return arguments.length?(e=typeof a=="function"?a:Pt(+a),i):e},i.context=function(a){return arguments.length?(r=a??null,i):r},i}function gb(){}function yb(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function jz(t){this._context=t}jz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:yb(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:yb(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Boe(t){return new jz(t)}function Rz(t){this._context=t}Rz.prototype={areaStart:gb,areaEnd:gb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:yb(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function qoe(t){return new Rz(t)}function Nz(t){this._context=t}Nz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:yb(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Koe(t){return new Nz(t)}function Mz(t){this._context=t}Mz.prototype={areaStart:gb,areaEnd:gb,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function Voe(t){return new Mz(t)}function GR(t){return t<0?-1:1}function YR(t,e,r){var n=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(n||i<0&&-0),s=(r-t._y1)/(i||n<0&&-0),o=(a*i+s*n)/(n+i);return(GR(a)+GR(s))*Math.min(Math.abs(a),Math.abs(s),.5*Math.abs(o))||0}function JR(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function Ax(t,e,r){var n=t._x0,i=t._y0,a=t._x1,s=t._y1,o=(a-n)/3;t._context.bezierCurveTo(n+o,i+o*e,a-o,s-o*r,a,s)}function vb(t){this._context=t}vb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ax(this,this._t0,JR(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Ax(this,JR(this,r=YR(this,t,e)),r);break;default:Ax(this,this._t0,r=YR(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function Dz(t){this._context=new Lz(t)}(Dz.prototype=Object.create(vb.prototype)).point=function(t,e){vb.prototype.point.call(this,e,t)};function Lz(t){this._context=t}Lz.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,i,a){this._context.bezierCurveTo(e,t,n,r,a,i)}};function Hoe(t){return new vb(t)}function Woe(t){return new Dz(t)}function Fz(t){this._context=t}Fz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=ZR(t),i=ZR(e),a=0,s=1;s<r;++a,++s)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],t[s],e[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function ZR(t){var e,r=t.length-1,n,i=new Array(r),a=new Array(r),s=new Array(r);for(i[0]=0,a[0]=2,s[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,s[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,s[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,s[e]-=n*s[e-1];for(i[r-1]=s[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(s[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function Goe(t){return new Fz(t)}function h_(t,e){this._context=t,this._t=e}h_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function Yoe(t){return new h_(t,.5)}function Joe(t){return new h_(t,0)}function Zoe(t){return new h_(t,1)}function Eh(t,e){if((s=t.length)>1)for(var r=1,n,i,a=t[e[0]],s,o=a.length;r<s;++r)for(i=a,a=t[e[r]],n=0;n<o;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function EP(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function Xoe(t,e){return t[e]}function Qoe(t){const e=[];return e.key=t,e}function eue(){var t=Pt([]),e=EP,r=Eh,n=Xoe;function i(a){var s=Array.from(t.apply(this,arguments),Qoe),o,u=s.length,l=-1,c;for(const h of a)for(o=0,++l;o<u;++o)(s[o][l]=[0,+n(h,s[o].key,l,a)]).data=h;for(o=0,c=lk(e(s));o<u;++o)s[c[o]].index=o;return r(s,c),s}return i.keys=function(a){return arguments.length?(t=typeof a=="function"?a:Pt(Array.from(a)),i):t},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:Pt(+a),i):n},i.order=function(a){return arguments.length?(e=a==null?EP:typeof a=="function"?a:Pt(Array.from(a)),i):e},i.offset=function(a){return arguments.length?(r=a??Eh,i):r},i}function tue(t,e){if((n=t.length)>0){for(var r,n,i=0,a=t[0].length,s;i<a;++i){for(s=r=0;r<n;++r)s+=t[r][i][1]||0;if(s)for(r=0;r<n;++r)t[r][i][1]/=s}Eh(t,e)}}function rue(t,e){if((i=t.length)>0){for(var r=0,n=t[e[0]],i,a=n.length;r<a;++r){for(var s=0,o=0;s<i;++s)o+=t[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}Eh(t,e)}}function nue(t,e){if(!(!((s=t.length)>0)||!((a=(i=t[e[0]]).length)>0))){for(var r=0,n=1,i,a,s;n<a;++n){for(var o=0,u=0,l=0;o<s;++o){for(var c=t[e[o]],h=c[n][1]||0,d=c[n-1][1]||0,f=(h-d)/2,p=0;p<o;++p){var m=t[e[p]],g=m[n][1]||0,v=m[n-1][1]||0;f+=g-v}u+=h,l+=f*h}i[n-1][1]+=i[n-1][0]=r,u&&(r-=l/u)}i[n-1][1]+=i[n-1][0]=r,Eh(t,e)}}function Up(t){return Up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Up(t)}var iue=["type","size","sizeType"];function AP(){return AP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},AP.apply(this,arguments)}function XR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function QR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XR(Object(r),!0).forEach(function(n){aue(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XR(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function aue(t,e,r){return e=sue(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sue(t){var e=oue(t,"string");return Up(e)=="symbol"?e:String(e)}function oue(t,e){if(Up(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Up(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uue(t,e){if(t==null)return{};var r=lue(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function lue(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}var Uz={symbolCircle:ck,symbolCross:Coe,symbolDiamond:$oe,symbolSquare:joe,symbolStar:Doe,symbolTriangle:Loe,symbolWye:Uoe},cue=Math.PI/180,hue=function(e){var r="symbol".concat(u_(e));return Uz[r]||ck},due=function(e,r,n){if(r==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var i=18*cue;return 1.25*e*e*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},fue=function(e,r){Uz["symbol".concat(u_(e))]=r},hk=function(e){var r=e.type,n=r===void 0?"circle":r,i=e.size,a=i===void 0?64:i,s=e.sizeType,o=s===void 0?"area":s,u=uue(e,iue),l=QR(QR({},u),{},{type:n,size:a,sizeType:o}),c=function(){var g=hue(n),v=zoe().type(g).size(due(a,o,n));return v()},h=l.className,d=l.cx,f=l.cy,p=$e(l,!0);return d===+d&&f===+f&&a===+a?$.createElement("path",AP({},p,{className:ze("recharts-symbols",h),transform:"translate(".concat(d,", ").concat(f,")"),d:c()})):null};hk.registerSymbol=fue;function Ah(t){return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ah(t)}function TP(){return TP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},TP.apply(this,arguments)}function eN(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function pue(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eN(Object(r),!0).forEach(function(n){zp(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eN(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mue(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bz(n.key),n)}}function gue(t,e,r){return e&&tN(t.prototype,e),r&&tN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function yue(t,e,r){return e=bb(e),vue(t,zz()?Reflect.construct(e,r||[],bb(t).constructor):e.apply(t,r))}function vue(t,e){if(e&&(Ah(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bue(t)}function bue(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zz(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zz=function(){return!!t})()}function bb(t){return bb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bb(t)}function wue(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kP(t,e)}function kP(t,e){return kP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kP(t,e)}function zp(t,e,r){return e=Bz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bz(t){var e=_ue(t,"string");return Ah(e)=="symbol"?e:String(e)}function _ue(t,e){if(Ah(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ah(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Si=32,dk=function(t){wue(e,t);function e(){return mue(this,e),yue(this,e,arguments)}return gue(e,[{key:"renderIcon",value:function(n){var i=this.props.inactiveColor,a=Si/2,s=Si/6,o=Si/3,u=n.inactive?i:n.color;if(n.type==="plainline")return $.createElement("line",{strokeWidth:4,fill:"none",stroke:u,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:a,x2:Si,y2:a,className:"recharts-legend-icon"});if(n.type==="line")return $.createElement("path",{strokeWidth:4,fill:"none",stroke:u,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(Si,"M").concat(2*o,",").concat(a,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(n.type==="rect")return $.createElement("path",{stroke:"none",fill:u,d:"M0,".concat(Si/8,"h").concat(Si,"v").concat(Si*3/4,"h").concat(-Si,"z"),className:"recharts-legend-icon"});if($.isValidElement(n.legendIcon)){var l=pue({},n);return delete l.legendIcon,$.cloneElement(n.legendIcon,l)}return $.createElement(hk,{fill:u,cx:a,cy:a,size:Si,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,i=this.props,a=i.payload,s=i.iconSize,o=i.layout,u=i.formatter,l=i.inactiveColor,c={x:0,y:0,width:Si,height:Si},h={display:o==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return a.map(function(f,p){var m=f.formatter||u,g=ze(zp(zp({"recharts-legend-item":!0},"legend-item-".concat(p),!0),"inactive",f.inactive));if(f.type==="none")return null;var v=Ne(f.value)?null:f.value;wa(!Ne(f.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var y=f.inactive?l:f.color;return $.createElement("li",TP({className:g,style:h,key:"legend-item-".concat(p)},Pl(n.props,f,p)),$.createElement(bP,{width:s,height:s,viewBox:c,style:d},n.renderIcon(f)),$.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},m?m(v,f,p):v))})}},{key:"render",value:function(){var n=this.props,i=n.payload,a=n.layout,s=n.align;if(!i||!i.length)return null;var o={padding:0,margin:0,textAlign:a==="horizontal"?s:"left"};return $.createElement("ul",{className:"recharts-default-legend",style:o},this.renderItems())}}]),e}(I.PureComponent);zp(dk,"displayName","Legend");zp(dk,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var xue=a_;function Oue(){this.__data__=new xue,this.size=0}var Sue=Oue;function Pue(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var Eue=Pue;function Aue(t){return this.__data__.get(t)}var Tue=Aue;function kue(t){return this.__data__.has(t)}var Cue=kue,Iue=a_,$ue=tk,jue=rk,Rue=200;function Nue(t,e){var r=this.__data__;if(r instanceof Iue){var n=r.__data__;if(!$ue||n.length<Rue-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new jue(n)}return r.set(t,e),this.size=r.size,this}var Mue=Nue,Due=a_,Lue=Sue,Fue=Eue,Uue=Tue,zue=Cue,Bue=Mue;function _d(t){var e=this.__data__=new Due(t);this.size=e.size}_d.prototype.clear=Lue;_d.prototype.delete=Fue;_d.prototype.get=Uue;_d.prototype.has=zue;_d.prototype.set=Bue;var qz=_d,que="__lodash_hash_undefined__";function Kue(t){return this.__data__.set(t,que),this}var Vue=Kue;function Hue(t){return this.__data__.has(t)}var Wue=Hue,Gue=rk,Yue=Vue,Jue=Wue;function wb(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Gue;++e<r;)this.add(t[e])}wb.prototype.add=wb.prototype.push=Yue;wb.prototype.has=Jue;var Kz=wb;function Zue(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var Vz=Zue;function Xue(t,e){return t.has(e)}var Hz=Xue,Que=Kz,ele=Vz,tle=Hz,rle=1,nle=2;function ile(t,e,r,n,i,a){var s=r&rle,o=t.length,u=e.length;if(o!=u&&!(s&&u>o))return!1;var l=a.get(t),c=a.get(e);if(l&&c)return l==e&&c==t;var h=-1,d=!0,f=r&nle?new Que:void 0;for(a.set(t,e),a.set(e,t);++h<o;){var p=t[h],m=e[h];if(n)var g=s?n(m,p,h,e,t,a):n(p,m,h,t,e,a);if(g!==void 0){if(g)continue;d=!1;break}if(f){if(!ele(e,function(v,y){if(!tle(f,y)&&(p===v||i(p,v,r,n,a)))return f.push(y)})){d=!1;break}}else if(!(p===m||i(p,m,r,n,a))){d=!1;break}}return a.delete(t),a.delete(e),d}var Wz=ile,ale=gs,sle=ale.Uint8Array,ole=sle;function ule(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}var lle=ule;function cle(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var fk=cle,rN=pg,nN=ole,hle=ek,dle=Wz,fle=lle,ple=fk,mle=1,gle=2,yle="[object Boolean]",vle="[object Date]",ble="[object Error]",wle="[object Map]",_le="[object Number]",xle="[object RegExp]",Ole="[object Set]",Sle="[object String]",Ple="[object Symbol]",Ele="[object ArrayBuffer]",Ale="[object DataView]",iN=rN?rN.prototype:void 0,Tx=iN?iN.valueOf:void 0;function Tle(t,e,r,n,i,a,s){switch(r){case Ale:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Ele:return!(t.byteLength!=e.byteLength||!a(new nN(t),new nN(e)));case yle:case vle:case _le:return hle(+t,+e);case ble:return t.name==e.name&&t.message==e.message;case xle:case Sle:return t==e+"";case wle:var o=fle;case Ole:var u=n&mle;if(o||(o=ple),t.size!=e.size&&!u)return!1;var l=s.get(t);if(l)return l==e;n|=gle,s.set(t,e);var c=dle(o(t),o(e),n,i,a,s);return s.delete(t),c;case Ple:if(Tx)return Tx.call(t)==Tx.call(e)}return!1}var kle=Tle;function Cle(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var Gz=Cle,Ile=Gz,$le=Xn;function jle(t,e,r){var n=e(t);return $le(t)?n:Ile(n,r(t))}var Rle=jle;function Nle(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var s=t[r];e(s,r,t)&&(a[i++]=s)}return a}var Mle=Nle;function Dle(){return[]}var Lle=Dle,Fle=Mle,Ule=Lle,zle=Object.prototype,Ble=zle.propertyIsEnumerable,aN=Object.getOwnPropertySymbols,qle=aN?function(t){return t==null?[]:(t=Object(t),Fle(aN(t),function(e){return Ble.call(t,e)}))}:Ule,Kle=qle;function Vle(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Hle=Vle,Wle=co,Gle=ho,Yle="[object Arguments]";function Jle(t){return Gle(t)&&Wle(t)==Yle}var Zle=Jle,sN=Zle,Xle=ho,Yz=Object.prototype,Qle=Yz.hasOwnProperty,ece=Yz.propertyIsEnumerable,tce=sN(function(){return arguments}())?sN:function(t){return Xle(t)&&Qle.call(t,"callee")&&!ece.call(t,"callee")},pk=tce,_b={exports:{}};function rce(){return!1}var nce=rce;_b.exports;(function(t,e){var r=gs,n=nce,i=e&&!e.nodeType&&e,a=i&&!0&&t&&!t.nodeType&&t,s=a&&a.exports===i,o=s?r.Buffer:void 0,u=o?o.isBuffer:void 0,l=u||n;t.exports=l})(_b,_b.exports);var Jz=_b.exports,ice=9007199254740991,ace=/^(?:0|[1-9]\d*)$/;function sce(t,e){var r=typeof t;return e=e??ice,!!e&&(r=="number"||r!="symbol"&&ace.test(t))&&t>-1&&t%1==0&&t<e}var mk=sce,oce=9007199254740991;function uce(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=oce}var gk=uce,lce=co,cce=gk,hce=ho,dce="[object Arguments]",fce="[object Array]",pce="[object Boolean]",mce="[object Date]",gce="[object Error]",yce="[object Function]",vce="[object Map]",bce="[object Number]",wce="[object Object]",_ce="[object RegExp]",xce="[object Set]",Oce="[object String]",Sce="[object WeakMap]",Pce="[object ArrayBuffer]",Ece="[object DataView]",Ace="[object Float32Array]",Tce="[object Float64Array]",kce="[object Int8Array]",Cce="[object Int16Array]",Ice="[object Int32Array]",$ce="[object Uint8Array]",jce="[object Uint8ClampedArray]",Rce="[object Uint16Array]",Nce="[object Uint32Array]",Ct={};Ct[Ace]=Ct[Tce]=Ct[kce]=Ct[Cce]=Ct[Ice]=Ct[$ce]=Ct[jce]=Ct[Rce]=Ct[Nce]=!0;Ct[dce]=Ct[fce]=Ct[Pce]=Ct[pce]=Ct[Ece]=Ct[mce]=Ct[gce]=Ct[yce]=Ct[vce]=Ct[bce]=Ct[wce]=Ct[_ce]=Ct[xce]=Ct[Oce]=Ct[Sce]=!1;function Mce(t){return hce(t)&&cce(t.length)&&!!Ct[lce(t)]}var Dce=Mce;function Lce(t){return function(e){return t(e)}}var Zz=Lce,xb={exports:{}};xb.exports;(function(t,e){var r=oz,n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,a=i&&i.exports===n,s=a&&r.process,o=function(){try{var u=i&&i.require&&i.require("util").types;return u||s&&s.binding&&s.binding("util")}catch{}}();t.exports=o})(xb,xb.exports);var Fce=xb.exports,Uce=Dce,zce=Zz,oN=Fce,uN=oN&&oN.isTypedArray,Bce=uN?zce(uN):Uce,Xz=Bce,qce=Hle,Kce=pk,Vce=Xn,Hce=Jz,Wce=mk,Gce=Xz,Yce=Object.prototype,Jce=Yce.hasOwnProperty;function Zce(t,e){var r=Vce(t),n=!r&&Kce(t),i=!r&&!n&&Hce(t),a=!r&&!n&&!i&&Gce(t),s=r||n||i||a,o=s?qce(t.length,String):[],u=o.length;for(var l in t)(e||Jce.call(t,l))&&!(s&&(l=="length"||i&&(l=="offset"||l=="parent")||a&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Wce(l,u)))&&o.push(l);return o}var Xce=Zce,Qce=Object.prototype;function ehe(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Qce;return t===r}var the=ehe;function rhe(t,e){return function(r){return t(e(r))}}var Qz=rhe,nhe=Qz,ihe=nhe(Object.keys,Object),ahe=ihe,she=the,ohe=ahe,uhe=Object.prototype,lhe=uhe.hasOwnProperty;function che(t){if(!she(t))return ohe(t);var e=[];for(var r in Object(t))lhe.call(t,r)&&r!="constructor"&&e.push(r);return e}var hhe=che,dhe=QT,fhe=gk;function phe(t){return t!=null&&fhe(t.length)&&!dhe(t)}var gg=phe,mhe=Xce,ghe=hhe,yhe=gg;function vhe(t){return yhe(t)?mhe(t):ghe(t)}var d_=vhe,bhe=Rle,whe=Kle,_he=d_;function xhe(t){return bhe(t,_he,whe)}var Ohe=xhe,lN=Ohe,She=1,Phe=Object.prototype,Ehe=Phe.hasOwnProperty;function Ahe(t,e,r,n,i,a){var s=r&She,o=lN(t),u=o.length,l=lN(e),c=l.length;if(u!=c&&!s)return!1;for(var h=u;h--;){var d=o[h];if(!(s?d in e:Ehe.call(e,d)))return!1}var f=a.get(t),p=a.get(e);if(f&&p)return f==e&&p==t;var m=!0;a.set(t,e),a.set(e,t);for(var g=s;++h<u;){d=o[h];var v=t[d],y=e[d];if(n)var b=s?n(y,v,d,e,t,a):n(v,y,d,t,e,a);if(!(b===void 0?v===y||i(v,y,r,n,a):b)){m=!1;break}g||(g=d=="constructor")}if(m&&!g){var w=t.constructor,_=e.constructor;w!=_&&"constructor"in t&&"constructor"in e&&!(typeof w=="function"&&w instanceof w&&typeof _=="function"&&_ instanceof _)&&(m=!1)}return a.delete(t),a.delete(e),m}var The=Ahe,khe=Hl,Che=gs,Ihe=khe(Che,"DataView"),$he=Ihe,jhe=Hl,Rhe=gs,Nhe=jhe(Rhe,"Promise"),Mhe=Nhe,Dhe=Hl,Lhe=gs,Fhe=Dhe(Lhe,"Set"),eB=Fhe,Uhe=Hl,zhe=gs,Bhe=Uhe(zhe,"WeakMap"),qhe=Bhe,CP=$he,IP=tk,$P=Mhe,jP=eB,RP=qhe,tB=co,xd=lz,cN="[object Map]",Khe="[object Object]",hN="[object Promise]",dN="[object Set]",fN="[object WeakMap]",pN="[object DataView]",Vhe=xd(CP),Hhe=xd(IP),Whe=xd($P),Ghe=xd(jP),Yhe=xd(RP),zu=tB;(CP&&zu(new CP(new ArrayBuffer(1)))!=pN||IP&&zu(new IP)!=cN||$P&&zu($P.resolve())!=hN||jP&&zu(new jP)!=dN||RP&&zu(new RP)!=fN)&&(zu=function(t){var e=tB(t),r=e==Khe?t.constructor:void 0,n=r?xd(r):"";if(n)switch(n){case Vhe:return pN;case Hhe:return cN;case Whe:return hN;case Ghe:return dN;case Yhe:return fN}return e});var Jhe=zu,kx=qz,Zhe=Wz,Xhe=kle,Qhe=The,mN=Jhe,gN=Xn,yN=Jz,ede=Xz,tde=1,vN="[object Arguments]",bN="[object Array]",_y="[object Object]",rde=Object.prototype,wN=rde.hasOwnProperty;function nde(t,e,r,n,i,a){var s=gN(t),o=gN(e),u=s?bN:mN(t),l=o?bN:mN(e);u=u==vN?_y:u,l=l==vN?_y:l;var c=u==_y,h=l==_y,d=u==l;if(d&&yN(t)){if(!yN(e))return!1;s=!0,c=!1}if(d&&!c)return a||(a=new kx),s||ede(t)?Zhe(t,e,r,n,i,a):Xhe(t,e,u,r,n,i,a);if(!(r&tde)){var f=c&&wN.call(t,"__wrapped__"),p=h&&wN.call(e,"__wrapped__");if(f||p){var m=f?t.value():t,g=p?e.value():e;return a||(a=new kx),i(m,g,r,n,a)}}return d?(a||(a=new kx),Qhe(t,e,r,n,i,a)):!1}var ide=nde,ade=ide,_N=ho;function rB(t,e,r,n,i){return t===e?!0:t==null||e==null||!_N(t)&&!_N(e)?t!==t&&e!==e:ade(t,e,r,n,rB,i)}var yk=rB,sde=qz,ode=yk,ude=1,lde=2;function cde(t,e,r,n){var i=r.length,a=i,s=!n;if(t==null)return!a;for(t=Object(t);i--;){var o=r[i];if(s&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++i<a;){o=r[i];var u=o[0],l=t[u],c=o[1];if(s&&o[2]){if(l===void 0&&!(u in t))return!1}else{var h=new sde;if(n)var d=n(l,c,u,t,e,h);if(!(d===void 0?ode(c,l,ude|lde,n,h):d))return!1}}return!0}var hde=cde,dde=xu;function fde(t){return t===t&&!dde(t)}var nB=fde,pde=nB,mde=d_;function gde(t){for(var e=mde(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,pde(i)]}return e}var yde=gde;function vde(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var iB=vde,bde=hde,wde=yde,_de=iB;function xde(t){var e=wde(t);return e.length==1&&e[0][2]?_de(e[0][0],e[0][1]):function(r){return r===t||bde(r,t,e)}}var Ode=xde;function Sde(t,e){return t!=null&&e in Object(t)}var Pde=Sde,Ede=pz,Ade=pk,Tde=Xn,kde=mk,Cde=gk,Ide=o_;function $de(t,e,r){e=Ede(e,t);for(var n=-1,i=e.length,a=!1;++n<i;){var s=Ide(e[n]);if(!(a=t!=null&&r(t,s)))break;t=t[s]}return a||++n!=i?a:(i=t==null?0:t.length,!!i&&Cde(i)&&kde(s,i)&&(Tde(t)||Ade(t)))}var jde=$de,Rde=Pde,Nde=jde;function Mde(t,e){return t!=null&&Nde(t,e,Rde)}var Dde=Mde,Lde=yk,Fde=mz,Ude=Dde,zde=XT,Bde=nB,qde=iB,Kde=o_,Vde=1,Hde=2;function Wde(t,e){return zde(t)&&Bde(e)?qde(Kde(t),e):function(r){var n=Fde(r,t);return n===void 0&&n===e?Ude(r,t):Lde(e,n,Vde|Hde)}}var Gde=Wde;function Yde(t){return t}var Od=Yde;function Jde(t){return function(e){return e==null?void 0:e[t]}}var Zde=Jde,Xde=ak;function Qde(t){return function(e){return Xde(e,t)}}var efe=Qde,tfe=Zde,rfe=efe,nfe=XT,ife=o_;function afe(t){return nfe(t)?tfe(ife(t)):rfe(t)}var sfe=afe,ofe=Ode,ufe=Gde,lfe=Od,cfe=Xn,hfe=sfe;function dfe(t){return typeof t=="function"?t:t==null?lfe:typeof t=="object"?cfe(t)?ufe(t[0],t[1]):ofe(t):hfe(t)}var ys=dfe;function ffe(t,e,r,n){for(var i=t.length,a=r+(n?1:-1);n?a--:++a<i;)if(e(t[a],a,t))return a;return-1}var aB=ffe;function pfe(t){return t!==t}var mfe=pfe;function gfe(t,e,r){for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1}var yfe=gfe,vfe=aB,bfe=mfe,wfe=yfe;function _fe(t,e,r){return e===e?wfe(t,e,r):vfe(t,bfe,r)}var xfe=_fe,Ofe=xfe;function Sfe(t,e){var r=t==null?0:t.length;return!!r&&Ofe(t,e,0)>-1}var Pfe=Sfe;function Efe(t,e,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(e,t[n]))return!0;return!1}var Afe=Efe;function Tfe(){}var kfe=Tfe,Cx=eB,Cfe=kfe,Ife=fk,$fe=1/0,jfe=Cx&&1/Ife(new Cx([,-0]))[1]==$fe?function(t){return new Cx(t)}:Cfe,Rfe=jfe,Nfe=Kz,Mfe=Pfe,Dfe=Afe,Lfe=Hz,Ffe=Rfe,Ufe=fk,zfe=200;function Bfe(t,e,r){var n=-1,i=Mfe,a=t.length,s=!0,o=[],u=o;if(r)s=!1,i=Dfe;else if(a>=zfe){var l=e?null:Ffe(t);if(l)return Ufe(l);s=!1,i=Lfe,u=new Nfe}else u=e?[]:o;e:for(;++n<a;){var c=t[n],h=e?e(c):c;if(c=r||c!==0?c:0,s&&h===h){for(var d=u.length;d--;)if(u[d]===h)continue e;e&&u.push(h),o.push(c)}else i(u,h,r)||(u!==o&&u.push(h),o.push(c))}return o}var qfe=Bfe,Kfe=ys,Vfe=qfe;function Hfe(t,e){return t&&t.length?Vfe(t,Kfe(e)):[]}var Wfe=Hfe;const xN=Ze(Wfe);function sB(t,e,r){return e===!0?xN(t,r):Ne(e)?xN(t,e):t}function Th(t){return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Th(t)}var Gfe=["ref"];function ON(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Iu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ON(Object(r),!0).forEach(function(n){f_(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ON(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Yfe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function SN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lB(n.key),n)}}function Jfe(t,e,r){return e&&SN(t.prototype,e),r&&SN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zfe(t,e,r){return e=Ob(e),Xfe(t,oB()?Reflect.construct(e,r||[],Ob(t).constructor):e.apply(t,r))}function Xfe(t,e){if(e&&(Th(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uB(t)}function oB(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oB=function(){return!!t})()}function Ob(t){return Ob=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ob(t)}function uB(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qfe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&NP(t,e)}function NP(t,e){return NP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},NP(t,e)}function f_(t,e,r){return e=lB(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lB(t){var e=epe(t,"string");return Th(e)=="symbol"?e:String(e)}function epe(t,e){if(Th(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Th(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tpe(t,e){if(t==null)return{};var r=rpe(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function rpe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function npe(t){return t.value}function ipe(t,e){if($.isValidElement(t))return $.cloneElement(t,e);if(typeof t=="function")return $.createElement(t,e);e.ref;var r=tpe(e,Gfe);return $.createElement(dk,r)}var PN=1,kh=function(t){Qfe(e,t);function e(){var r;Yfe(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return r=Zfe(this,e,[].concat(i)),f_(uB(r),"lastBoundingBox",{width:-1,height:-1}),r}return Jfe(e,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,i=this.getBBox();i?(Math.abs(i.width-this.lastBoundingBox.width)>PN||Math.abs(i.height-this.lastBoundingBox.height)>PN)&&(this.lastBoundingBox.width=i.width,this.lastBoundingBox.height=i.height,n&&n(i)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Iu({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var i=this.props,a=i.layout,s=i.align,o=i.verticalAlign,u=i.margin,l=i.chartWidth,c=i.chartHeight,h,d;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(s==="center"&&a==="vertical"){var f=this.getBBoxSnapshot();h={left:((l||0)-f.width)/2}}else h=s==="right"?{right:u&&u.right||0}:{left:u&&u.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(o==="middle"){var p=this.getBBoxSnapshot();d={top:((c||0)-p.height)/2}}else d=o==="bottom"?{bottom:u&&u.bottom||0}:{top:u&&u.top||0};return Iu(Iu({},h),d)}},{key:"render",value:function(){var n=this,i=this.props,a=i.content,s=i.width,o=i.height,u=i.wrapperStyle,l=i.payloadUniqBy,c=i.payload,h=Iu(Iu({position:"absolute",width:s||"auto",height:o||"auto"},this.getDefaultPosition(u)),u);return $.createElement("div",{className:"recharts-legend-wrapper",style:h,ref:function(f){n.wrapperNode=f}},ipe(a,Iu(Iu({},this.props),{},{payload:sB(c,l,npe)})))}}],[{key:"getWithHeight",value:function(n,i){var a=n.props.layout;return a==="vertical"&&fe(n.props.height)?{height:n.props.height}:a==="horizontal"?{width:n.props.width||i}:null}}]),e}(I.PureComponent);f_(kh,"displayName","Legend");f_(kh,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var EN=pg,ape=pk,spe=Xn,AN=EN?EN.isConcatSpreadable:void 0;function ope(t){return spe(t)||ape(t)||!!(AN&&t&&t[AN])}var upe=ope,lpe=Gz,cpe=upe;function cB(t,e,r,n,i){var a=-1,s=t.length;for(r||(r=cpe),i||(i=[]);++a<s;){var o=t[a];e>0&&r(o)?e>1?cB(o,e-1,r,n,i):lpe(i,o):n||(i[i.length]=o)}return i}var hB=cB;function hpe(t){return function(e,r,n){for(var i=-1,a=Object(e),s=n(e),o=s.length;o--;){var u=s[t?o:++i];if(r(a[u],u,a)===!1)break}return e}}var dpe=hpe,fpe=dpe,ppe=fpe(),mpe=ppe,gpe=mpe,ype=d_;function vpe(t,e){return t&&gpe(t,e,ype)}var dB=vpe,bpe=gg;function wpe(t,e){return function(r,n){if(r==null)return r;if(!bpe(r))return t(r,n);for(var i=r.length,a=e?i:-1,s=Object(r);(e?a--:++a<i)&&n(s[a],a,s)!==!1;);return r}}var _pe=wpe,xpe=dB,Ope=_pe,Spe=Ope(xpe),vk=Spe,Ppe=vk,Epe=gg;function Ape(t,e){var r=-1,n=Epe(t)?Array(t.length):[];return Ppe(t,function(i,a,s){n[++r]=e(i,a,s)}),n}var fB=Ape;function Tpe(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}var kpe=Tpe,TN=pd;function Cpe(t,e){if(t!==e){var r=t!==void 0,n=t===null,i=t===t,a=TN(t),s=e!==void 0,o=e===null,u=e===e,l=TN(e);if(!o&&!l&&!a&&t>e||a&&s&&u&&!o&&!l||n&&s&&u||!r&&u||!i)return 1;if(!n&&!a&&!l&&t<e||l&&r&&i&&!n&&!a||o&&r&&i||!s&&i||!u)return-1}return 0}var Ipe=Cpe,$pe=Ipe;function jpe(t,e,r){for(var n=-1,i=t.criteria,a=e.criteria,s=i.length,o=r.length;++n<s;){var u=$pe(i[n],a[n]);if(u){if(n>=o)return u;var l=r[n];return u*(l=="desc"?-1:1)}}return t.index-e.index}var Rpe=jpe,Ix=ik,Npe=ak,Mpe=ys,Dpe=fB,Lpe=kpe,Fpe=Zz,Upe=Rpe,zpe=Od,Bpe=Xn;function qpe(t,e,r){e.length?e=Ix(e,function(a){return Bpe(a)?function(s){return Npe(s,a.length===1?a[0]:a)}:a}):e=[zpe];var n=-1;e=Ix(e,Fpe(Mpe));var i=Dpe(t,function(a,s,o){var u=Ix(e,function(l){return l(a)});return{criteria:u,index:++n,value:a}});return Lpe(i,function(a,s){return Upe(a,s,r)})}var Kpe=qpe;function Vpe(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var Hpe=Vpe,Wpe=Hpe,kN=Math.max;function Gpe(t,e,r){return e=kN(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,a=kN(n.length-e,0),s=Array(a);++i<a;)s[i]=n[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=n[i];return o[e]=r(s),Wpe(t,this,o)}}var Ype=Gpe;function Jpe(t){return function(){return t}}var Zpe=Jpe,Xpe=Hl,Qpe=function(){try{var t=Xpe(Object,"defineProperty");return t({},"",{}),t}catch{}}(),pB=Qpe,eme=Zpe,CN=pB,tme=Od,rme=CN?function(t,e){return CN(t,"toString",{configurable:!0,enumerable:!1,value:eme(e),writable:!0})}:tme,nme=rme,ime=800,ame=16,sme=Date.now;function ome(t){var e=0,r=0;return function(){var n=sme(),i=ame-(n-r);if(r=n,i>0){if(++e>=ime)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var ume=ome,lme=nme,cme=ume,hme=cme(lme),dme=hme,fme=Od,pme=Ype,mme=dme;function gme(t,e){return mme(pme(t,e,fme),t+"")}var yme=gme,vme=ek,bme=gg,wme=mk,_me=xu;function xme(t,e,r){if(!_me(r))return!1;var n=typeof e;return(n=="number"?bme(r)&&wme(e,r.length):n=="string"&&e in r)?vme(r[e],t):!1}var p_=xme,Ome=hB,Sme=Kpe,Pme=yme,IN=p_,Eme=Pme(function(t,e){if(t==null)return[];var r=e.length;return r>1&&IN(t,e[0],e[1])?e=[]:r>2&&IN(e[0],e[1],e[2])&&(e=[e[0]]),Sme(t,Ome(e,1),[])}),Ame=Eme;const bk=Ze(Ame);function Bp(t){return Bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bp(t)}function MP(){return MP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},MP.apply(this,arguments)}function Tme(t,e){return $me(t)||Ime(t,e)||Cme(t,e)||kme()}function kme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cme(t,e){if(t){if(typeof t=="string")return $N(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $N(t,e)}}function $N(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ime(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw i}}return o}}function $me(t){if(Array.isArray(t))return t}function jN(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function $x(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jN(Object(r),!0).forEach(function(n){jme(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jN(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jme(t,e,r){return e=Rme(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rme(t){var e=Nme(t,"string");return Bp(e)=="symbol"?e:String(e)}function Nme(t,e){if(Bp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Bp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mme(t){return Array.isArray(t)&&vr(t[0])&&vr(t[1])?t.join(" ~ "):t}var Dme=function(e){var r=e.separator,n=r===void 0?" : ":r,i=e.contentStyle,a=i===void 0?{}:i,s=e.itemStyle,o=s===void 0?{}:s,u=e.labelStyle,l=u===void 0?{}:u,c=e.payload,h=e.formatter,d=e.itemSorter,f=e.wrapperClassName,p=e.labelClassName,m=e.label,g=e.labelFormatter,v=e.accessibilityLayer,y=v===void 0?!1:v,b=function(){if(c&&c.length){var F={padding:0,margin:0},z=(d?bk(c,d):c).map(function(N,L){if(N.type==="none")return null;var D=$x({display:"block",paddingTop:4,paddingBottom:4,color:N.color||"#000"},o),q=N.formatter||h||Mme,M=N.value,V=N.name,G=M,re=V;if(q&&G!=null&&re!=null){var K=q(M,V,N,L,c);if(Array.isArray(K)){var J=Tme(K,2);G=J[0],re=J[1]}else G=K}return $.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(L),style:D},vr(re)?$.createElement("span",{className:"recharts-tooltip-item-name"},re):null,vr(re)?$.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,$.createElement("span",{className:"recharts-tooltip-item-value"},G),$.createElement("span",{className:"recharts-tooltip-item-unit"},N.unit||""))});return $.createElement("ul",{className:"recharts-tooltip-item-list",style:F},z)}return null},w=$x({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),_=$x({margin:0},l),O=!De(m),P=O?m:"",x=ze("recharts-default-tooltip",f),j=ze("recharts-tooltip-label",p);O&&g&&c!==void 0&&c!==null&&(P=g(m,c));var k=y?{role:"status","aria-live":"assertive"}:{};return $.createElement("div",MP({className:x,style:w},k),$.createElement("p",{className:j,style:_},$.isValidElement(P)?P:"".concat(P)),b())};function qp(t){return qp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qp(t)}function xy(t,e,r){return e=Lme(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lme(t){var e=Fme(t,"string");return qp(e)=="symbol"?e:String(e)}function Fme(t,e){if(qp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gf="recharts-tooltip-wrapper",Ume={visibility:"hidden"};function zme(t){var e=t.coordinate,r=t.translateX,n=t.translateY;return ze(gf,xy(xy(xy(xy({},"".concat(gf,"-right"),fe(r)&&e&&fe(e.x)&&r>=e.x),"".concat(gf,"-left"),fe(r)&&e&&fe(e.x)&&r<e.x),"".concat(gf,"-bottom"),fe(n)&&e&&fe(e.y)&&n>=e.y),"".concat(gf,"-top"),fe(n)&&e&&fe(e.y)&&n<e.y))}function RN(t){var e=t.allowEscapeViewBox,r=t.coordinate,n=t.key,i=t.offsetTopLeft,a=t.position,s=t.reverseDirection,o=t.tooltipDimension,u=t.viewBox,l=t.viewBoxDimension;if(a&&fe(a[n]))return a[n];var c=r[n]-o-i,h=r[n]+i;if(e[n])return s[n]?c:h;if(s[n]){var d=c,f=u[n];return d<f?Math.max(h,u[n]):Math.max(c,u[n])}var p=h+o,m=u[n]+l;return p>m?Math.max(c,u[n]):Math.max(h,u[n])}function Bme(t){var e=t.translateX,r=t.translateY,n=t.useTranslate3d;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function qme(t){var e=t.allowEscapeViewBox,r=t.coordinate,n=t.offsetTopLeft,i=t.position,a=t.reverseDirection,s=t.tooltipBox,o=t.useTranslate3d,u=t.viewBox,l,c,h;return s.height>0&&s.width>0&&r?(c=RN({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.width,viewBox:u,viewBoxDimension:u.width}),h=RN({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.height,viewBox:u,viewBoxDimension:u.height}),l=Bme({translateX:c,translateY:h,useTranslate3d:o})):l=Ume,{cssProperties:l,cssClasses:zme({translateX:c,translateY:h,coordinate:r})}}function Ch(t){return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ch(t)}function NN(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function MN(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?NN(Object(r),!0).forEach(function(n){FP(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):NN(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Kme(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gB(n.key),n)}}function Vme(t,e,r){return e&&DN(t.prototype,e),r&&DN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Hme(t,e,r){return e=Sb(e),Wme(t,mB()?Reflect.construct(e,r||[],Sb(t).constructor):e.apply(t,r))}function Wme(t,e){if(e&&(Ch(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DP(t)}function mB(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mB=function(){return!!t})()}function Sb(t){return Sb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sb(t)}function DP(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gme(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&LP(t,e)}function LP(t,e){return LP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},LP(t,e)}function FP(t,e,r){return e=gB(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gB(t){var e=Yme(t,"string");return Ch(e)=="symbol"?e:String(e)}function Yme(t,e){if(Ch(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ch(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var LN=1,Jme=function(t){Gme(e,t);function e(){var r;Kme(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return r=Hme(this,e,[].concat(i)),FP(DP(r),"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),FP(DP(r),"handleKeyDown",function(s){if(s.key==="Escape"){var o,u,l,c;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(o=(u=r.props.coordinate)===null||u===void 0?void 0:u.x)!==null&&o!==void 0?o:0,y:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.y)!==null&&l!==void 0?l:0}})}}),r}return Vme(e,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>LN||Math.abs(n.height-this.state.lastBoundingBox.height)>LN)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,i;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,i=this.props,a=i.active,s=i.allowEscapeViewBox,o=i.animationDuration,u=i.animationEasing,l=i.children,c=i.coordinate,h=i.hasPayload,d=i.isAnimationActive,f=i.offset,p=i.position,m=i.reverseDirection,g=i.useTranslate3d,v=i.viewBox,y=i.wrapperStyle,b=qme({allowEscapeViewBox:s,coordinate:c,offsetTopLeft:f,position:p,reverseDirection:m,tooltipBox:this.state.lastBoundingBox,useTranslate3d:g,viewBox:v}),w=b.cssClasses,_=b.cssProperties,O=MN(MN({transition:d&&a?"transform ".concat(o,"ms ").concat(u):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&a&&h?"visible":"hidden",position:"absolute",top:0,left:0},y);return $.createElement("div",{tabIndex:-1,className:w,style:O,ref:function(x){n.wrapperNode=x}},l)}}]),e}(I.PureComponent),Zme=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},ts={isSsr:Zme(),get:function(e){return ts[e]},set:function(e,r){if(typeof e=="string")ts[e]=r;else{var n=Object.keys(e);n&&n.length&&n.forEach(function(i){ts[i]=e[i]})}}};function Ih(t){return Ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ih(t)}function FN(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function UN(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?FN(Object(r),!0).forEach(function(n){wk(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):FN(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Xme(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vB(n.key),n)}}function Qme(t,e,r){return e&&zN(t.prototype,e),r&&zN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ege(t,e,r){return e=Pb(e),tge(t,yB()?Reflect.construct(e,r||[],Pb(t).constructor):e.apply(t,r))}function tge(t,e){if(e&&(Ih(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rge(t)}function rge(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yB(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yB=function(){return!!t})()}function Pb(t){return Pb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pb(t)}function nge(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&UP(t,e)}function UP(t,e){return UP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},UP(t,e)}function wk(t,e,r){return e=vB(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vB(t){var e=ige(t,"string");return Ih(e)=="symbol"?e:String(e)}function ige(t,e){if(Ih(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ih(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function age(t){return t.dataKey}function sge(t,e){return $.isValidElement(t)?$.cloneElement(t,e):typeof t=="function"?$.createElement(t,e):$.createElement(Dme,e)}var la=function(t){nge(e,t);function e(){return Xme(this,e),ege(this,e,arguments)}return Qme(e,[{key:"render",value:function(){var n=this,i=this.props,a=i.active,s=i.allowEscapeViewBox,o=i.animationDuration,u=i.animationEasing,l=i.content,c=i.coordinate,h=i.filterNull,d=i.isAnimationActive,f=i.offset,p=i.payload,m=i.payloadUniqBy,g=i.position,v=i.reverseDirection,y=i.useTranslate3d,b=i.viewBox,w=i.wrapperStyle,_=p??[];h&&_.length&&(_=sB(p.filter(function(P){return P.value!=null&&(P.hide!==!0||n.props.includeHidden)}),m,age));var O=_.length>0;return $.createElement(Jme,{allowEscapeViewBox:s,animationDuration:o,animationEasing:u,isAnimationActive:d,active:a,coordinate:c,hasPayload:O,offset:f,position:g,reverseDirection:v,useTranslate3d:y,viewBox:b,wrapperStyle:w},sge(l,UN(UN({},this.props),{},{payload:_})))}}]),e}(I.PureComponent);wk(la,"displayName","Tooltip");wk(la,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!ts.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var oge=gs,uge=function(){return oge.Date.now()},lge=uge,cge=/\s/;function hge(t){for(var e=t.length;e--&&cge.test(t.charAt(e)););return e}var dge=hge,fge=dge,pge=/^\s+/;function mge(t){return t&&t.slice(0,fge(t)+1).replace(pge,"")}var gge=mge,yge=gge,BN=xu,vge=pd,qN=0/0,bge=/^[-+]0x[0-9a-f]+$/i,wge=/^0b[01]+$/i,_ge=/^0o[0-7]+$/i,xge=parseInt;function Oge(t){if(typeof t=="number")return t;if(vge(t))return qN;if(BN(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=BN(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=yge(t);var r=wge.test(t);return r||_ge.test(t)?xge(t.slice(2),r?2:8):bge.test(t)?qN:+t}var bB=Oge,Sge=xu,jx=lge,KN=bB,Pge="Expected a function",Ege=Math.max,Age=Math.min;function Tge(t,e,r){var n,i,a,s,o,u,l=0,c=!1,h=!1,d=!0;if(typeof t!="function")throw new TypeError(Pge);e=KN(e)||0,Sge(r)&&(c=!!r.leading,h="maxWait"in r,a=h?Ege(KN(r.maxWait)||0,e):a,d="trailing"in r?!!r.trailing:d);function f(O){var P=n,x=i;return n=i=void 0,l=O,s=t.apply(x,P),s}function p(O){return l=O,o=setTimeout(v,e),c?f(O):s}function m(O){var P=O-u,x=O-l,j=e-P;return h?Age(j,a-x):j}function g(O){var P=O-u,x=O-l;return u===void 0||P>=e||P<0||h&&x>=a}function v(){var O=jx();if(g(O))return y(O);o=setTimeout(v,m(O))}function y(O){return o=void 0,d&&n?f(O):(n=i=void 0,s)}function b(){o!==void 0&&clearTimeout(o),l=0,n=u=i=o=void 0}function w(){return o===void 0?s:y(jx())}function _(){var O=jx(),P=g(O);if(n=arguments,i=this,u=O,P){if(o===void 0)return p(u);if(h)return clearTimeout(o),o=setTimeout(v,e),f(u)}return o===void 0&&(o=setTimeout(v,e)),s}return _.cancel=b,_.flush=w,_}var kge=Tge,Cge=kge,Ige=xu,$ge="Expected a function";function jge(t,e,r){var n=!0,i=!0;if(typeof t!="function")throw new TypeError($ge);return Ige(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),Cge(t,e,{leading:n,maxWait:e,trailing:i})}var Rge=jge;const wB=Ze(Rge);function Kp(t){return Kp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kp(t)}function VN(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Oy(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?VN(Object(r),!0).forEach(function(n){Nge(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):VN(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Nge(t,e,r){return e=Mge(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mge(t){var e=Dge(t,"string");return Kp(e)=="symbol"?e:String(e)}function Dge(t,e){if(Kp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Kp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lge(t,e){return Bge(t)||zge(t,e)||Uge(t,e)||Fge()}function Fge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uge(t,e){if(t){if(typeof t=="string")return HN(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HN(t,e)}}function HN(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zge(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw i}}return o}}function Bge(t){if(Array.isArray(t))return t}var _B=I.forwardRef(function(t,e){var r=t.aspect,n=t.initialDimension,i=n===void 0?{width:-1,height:-1}:n,a=t.width,s=a===void 0?"100%":a,o=t.height,u=o===void 0?"100%":o,l=t.minWidth,c=l===void 0?0:l,h=t.minHeight,d=t.maxHeight,f=t.children,p=t.debounce,m=p===void 0?0:p,g=t.id,v=t.className,y=t.onResize,b=t.style,w=b===void 0?{}:b,_=I.useRef(null),O=I.useRef();O.current=y,I.useImperativeHandle(e,function(){return Object.defineProperty(_.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),_.current},configurable:!0})});var P=I.useState({containerWidth:i.width,containerHeight:i.height}),x=Lge(P,2),j=x[0],k=x[1],R=I.useCallback(function(z,N){k(function(L){var D=Math.round(z),q=Math.round(N);return L.containerWidth===D&&L.containerHeight===q?L:{containerWidth:D,containerHeight:q}})},[]);I.useEffect(function(){var z=function(V){var G,re=V[0].contentRect,K=re.width,J=re.height;R(K,J),(G=O.current)===null||G===void 0||G.call(O,K,J)};m>0&&(z=wB(z,m,{trailing:!0,leading:!1}));var N=new ResizeObserver(z),L=_.current.getBoundingClientRect(),D=L.width,q=L.height;return R(D,q),N.observe(_.current),function(){N.disconnect()}},[R,m]);var F=I.useMemo(function(){var z=j.containerWidth,N=j.containerHeight;if(z<0||N<0)return null;wa(el(s)||el(u),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,u),wa(!r||r>0,"The aspect(%s) must be greater than zero.",r);var L=el(s)?z:s,D=el(u)?N:u;r&&r>0&&(L?D=L/r:D&&(L=D*r),d&&D>d&&(D=d)),wa(L>0||D>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,L,D,s,u,c,h,r);var q=!Array.isArray(f)&&Oh.isElement(f)&&Ks(f.type).endsWith("Chart");return $.Children.map(f,function(M){return Oh.isElement(M)?I.cloneElement(M,Oy({width:L,height:D},q?{style:Oy({height:"100%",width:"100%",maxHeight:D,maxWidth:L},M.props.style)}:{})):M})},[r,f,u,d,h,c,j,s]);return $.createElement("div",{id:g?"".concat(g):void 0,className:ze("recharts-responsive-container",v),style:Oy(Oy({},w),{},{width:s,height:u,minWidth:c,minHeight:h,maxHeight:d}),ref:_},F)}),m_=function(e){return null};m_.displayName="Cell";function Vp(t){return Vp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vp(t)}function WN(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function zP(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?WN(Object(r),!0).forEach(function(n){qge(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):WN(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qge(t,e,r){return e=Kge(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kge(t){var e=Vge(t,"string");return Vp(e)=="symbol"?e:String(e)}function Vge(t,e){if(Vp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Vp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oc={widthCache:{},cacheCount:0},Hge=2e3,Wge={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},GN="recharts_measurement_span";function Gge(t){var e=zP({},t);return Object.keys(e).forEach(function(r){e[r]||delete e[r]}),e}var sp=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||ts.isSsr)return{width:0,height:0};var n=Gge(r),i=JSON.stringify({text:e,copyStyle:n});if(oc.widthCache[i])return oc.widthCache[i];try{var a=document.getElementById(GN);a||(a=document.createElement("span"),a.setAttribute("id",GN),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var s=zP(zP({},Wge),n);Object.assign(a.style,s),a.textContent="".concat(e);var o=a.getBoundingClientRect(),u={width:o.width,height:o.height};return oc.widthCache[i]=u,++oc.cacheCount>Hge&&(oc.cacheCount=0,oc.widthCache={}),u}catch{return{width:0,height:0}}},Yge=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function Hp(t){return Hp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hp(t)}function Eb(t,e){return Qge(t)||Xge(t,e)||Zge(t,e)||Jge()}function Jge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zge(t,e){if(t){if(typeof t=="string")return YN(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YN(t,e)}}function YN(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Xge(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw i}}return o}}function Qge(t){if(Array.isArray(t))return t}function eye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rye(n.key),n)}}function tye(t,e,r){return e&&JN(t.prototype,e),r&&JN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function rye(t){var e=nye(t,"string");return Hp(e)=="symbol"?e:String(e)}function nye(t,e){if(Hp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Hp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ZN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,XN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,iye=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,aye=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,xB={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},sye=Object.keys(xB),Fc="NaN";function oye(t,e){return t*xB[e]}var Sy=function(){function t(e,r){eye(this,t),this.num=e,this.unit=r,this.num=e,this.unit=r,Number.isNaN(e)&&(this.unit=""),r!==""&&!iye.test(r)&&(this.num=NaN,this.unit=""),sye.includes(r)&&(this.num=oye(e,r),this.unit="px")}return tye(t,[{key:"add",value:function(r){return this.unit!==r.unit?new t(NaN,""):new t(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new t(NaN,""):new t(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new t(NaN,""):new t(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new t(NaN,""):new t(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,i=(n=aye.exec(r))!==null&&n!==void 0?n:[],a=Eb(i,3),s=a[1],o=a[2];return new t(parseFloat(s),o??"")}}]),t}();function OB(t){if(t.includes(Fc))return Fc;for(var e=t;e.includes("*")||e.includes("/");){var r,n=(r=ZN.exec(e))!==null&&r!==void 0?r:[],i=Eb(n,4),a=i[1],s=i[2],o=i[3],u=Sy.parse(a??""),l=Sy.parse(o??""),c=s==="*"?u.multiply(l):u.divide(l);if(c.isNaN())return Fc;e=e.replace(ZN,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var h,d=(h=XN.exec(e))!==null&&h!==void 0?h:[],f=Eb(d,4),p=f[1],m=f[2],g=f[3],v=Sy.parse(p??""),y=Sy.parse(g??""),b=m==="+"?v.add(y):v.subtract(y);if(b.isNaN())return Fc;e=e.replace(XN,b.toString())}return e}var QN=/\(([^()]*)\)/;function uye(t){for(var e=t;e.includes("(");){var r=QN.exec(e),n=Eb(r,2),i=n[1];e=e.replace(QN,OB(i))}return e}function lye(t){var e=t.replace(/\s+/g,"");return e=uye(e),e=OB(e),e}function cye(t){try{return lye(t)}catch{return Fc}}function Rx(t){var e=cye(t.slice(5,-1));return e===Fc?"":e}var hye=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],dye=["dx","dy","angle","className","breakAll"];function BP(){return BP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},BP.apply(this,arguments)}function e2(t,e){if(t==null)return{};var r=fye(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function fye(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function t2(t,e){return yye(t)||gye(t,e)||mye(t,e)||pye()}function pye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mye(t,e){if(t){if(typeof t=="string")return r2(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r2(t,e)}}function r2(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function gye(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw i}}return o}}function yye(t){if(Array.isArray(t))return t}var SB=/[ \f\n\r\t\v\u2028\u2029]+/,PB=function(e){var r=e.children,n=e.breakAll,i=e.style;try{var a=[];De(r)||(n?a=r.toString().split(""):a=r.toString().split(SB));var s=a.map(function(u){return{word:u,width:sp(u,i).width}}),o=n?0:sp(" ",i).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}},vye=function(e,r,n,i,a){var s=e.maxLines,o=e.children,u=e.style,l=e.breakAll,c=fe(s),h=o,d=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return L.reduce(function(D,q){var M=q.word,V=q.width,G=D[D.length-1];if(G&&(i==null||a||G.width+V+n<Number(i)))G.words.push(M),G.width+=V+n;else{var re={words:[M],width:V};D.push(re)}return D},[])},f=d(r),p=function(L){return L.reduce(function(D,q){return D.width>q.width?D:q})};if(!c)return f;for(var m="…",g=function(L){var D=h.slice(0,L),q=PB({breakAll:l,style:u,children:D+m}).wordsWithComputedWidth,M=d(q),V=M.length>s||p(M).width>Number(i);return[V,M]},v=0,y=h.length-1,b=0,w;v<=y&&b<=h.length-1;){var _=Math.floor((v+y)/2),O=_-1,P=g(O),x=t2(P,2),j=x[0],k=x[1],R=g(_),F=t2(R,1),z=F[0];if(!j&&!z&&(v=_+1),j&&z&&(y=_-1),!j&&z){w=k;break}b++}return w||f},n2=function(e){var r=De(e)?[]:e.toString().split(SB);return[{words:r}]},bye=function(e){var r=e.width,n=e.scaleToFit,i=e.children,a=e.style,s=e.breakAll,o=e.maxLines;if((r||n)&&!ts.isSsr){var u,l,c=PB({breakAll:s,children:i,style:a});if(c){var h=c.wordsWithComputedWidth,d=c.spaceWidth;u=h,l=d}else return n2(i);return vye({breakAll:s,children:i,maxLines:o,style:a},u,l,r,n)}return n2(i)},i2="#808080",El=function(e){var r=e.x,n=r===void 0?0:r,i=e.y,a=i===void 0?0:i,s=e.lineHeight,o=s===void 0?"1em":s,u=e.capHeight,l=u===void 0?"0.71em":u,c=e.scaleToFit,h=c===void 0?!1:c,d=e.textAnchor,f=d===void 0?"start":d,p=e.verticalAnchor,m=p===void 0?"end":p,g=e.fill,v=g===void 0?i2:g,y=e2(e,hye),b=I.useMemo(function(){return bye({breakAll:y.breakAll,children:y.children,maxLines:y.maxLines,scaleToFit:h,style:y.style,width:y.width})},[y.breakAll,y.children,y.maxLines,h,y.style,y.width]),w=y.dx,_=y.dy,O=y.angle,P=y.className,x=y.breakAll,j=e2(y,dye);if(!vr(n)||!vr(a))return null;var k=n+(fe(w)?w:0),R=a+(fe(_)?_:0),F;switch(m){case"start":F=Rx("calc(".concat(l,")"));break;case"middle":F=Rx("calc(".concat((b.length-1)/2," * -").concat(o," + (").concat(l," / 2))"));break;default:F=Rx("calc(".concat(b.length-1," * -").concat(o,")"));break}var z=[];if(h){var N=b[0].width,L=y.width;z.push("scale(".concat((fe(L)?L/N:1)/N,")"))}return O&&z.push("rotate(".concat(O,", ").concat(k,", ").concat(R,")")),z.length&&(j.transform=z.join(" ")),$.createElement("text",BP({},$e(j,!0),{x:k,y:R,className:ze("recharts-text",P),textAnchor:f,fill:v.includes("url")?i2:v}),b.map(function(D,q){var M=D.words.join(x?"":" ");return $.createElement("tspan",{x:k,dy:q===0?F:o,key:M},M)}))};function ou(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function wye(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function _k(t){let e,r,n;t.length!==2?(e=ou,r=(o,u)=>ou(t(o),u),n=(o,u)=>t(o)-u):(e=t===ou||t===wye?t:_ye,r=t,n=t);function i(o,u,l=0,c=o.length){if(l<c){if(e(u,u)!==0)return c;do{const h=l+c>>>1;r(o[h],u)<0?l=h+1:c=h}while(l<c)}return l}function a(o,u,l=0,c=o.length){if(l<c){if(e(u,u)!==0)return c;do{const h=l+c>>>1;r(o[h],u)<=0?l=h+1:c=h}while(l<c)}return l}function s(o,u,l=0,c=o.length){const h=i(o,u,l,c-1);return h>l&&n(o[h-1],u)>-n(o[h],u)?h-1:h}return{left:i,center:s,right:a}}function _ye(){return 0}function EB(t){return t===null?NaN:+t}function*xye(t,e){if(e===void 0)for(let r of t)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of t)(n=e(n,++r,t))!=null&&(n=+n)>=n&&(yield n)}}const Oye=_k(ou),Sye=Oye.right;_k(EB).center;const yg=Sye;class a2 extends Map{constructor(e,r=Aye){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(s2(this,e))}has(e){return super.has(s2(this,e))}set(e,r){return super.set(Pye(this,e),r)}delete(e){return super.delete(Eye(this,e))}}function s2({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function Pye({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function Eye({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function Aye(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Tye(t=ou){if(t===ou)return AB;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function AB(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const kye=Math.sqrt(50),Cye=Math.sqrt(10),Iye=Math.sqrt(2);function Ab(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),s=a>=kye?10:a>=Cye?5:a>=Iye?2:1;let o,u,l;return i<0?(l=Math.pow(10,-i)/s,o=Math.round(t*l),u=Math.round(e*l),o/l<t&&++o,u/l>e&&--u,l=-l):(l=Math.pow(10,i)*s,o=Math.round(t/l),u=Math.round(e/l),o*l<t&&++o,u*l>e&&--u),u<o&&.5<=r&&r<2?Ab(t,e,r*2):[o,u,l]}function qP(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[i,a,s]=n?Ab(e,t,r):Ab(t,e,r);if(!(a>=i))return[];const o=a-i+1,u=new Array(o);if(n)if(s<0)for(let l=0;l<o;++l)u[l]=(a-l)/-s;else for(let l=0;l<o;++l)u[l]=(a-l)*s;else if(s<0)for(let l=0;l<o;++l)u[l]=(i+l)/-s;else for(let l=0;l<o;++l)u[l]=(i+l)*s;return u}function KP(t,e,r){return e=+e,t=+t,r=+r,Ab(t,e,r)[2]}function VP(t,e,r){e=+e,t=+t,r=+r;const n=e<t,i=n?KP(e,t,r):KP(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function o2(t,e){let r;if(e===void 0)for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of t)(i=e(i,++n,t))!=null&&(r<i||r===void 0&&i>=i)&&(r=i)}return r}function u2(t,e){let r;if(e===void 0)for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of t)(i=e(i,++n,t))!=null&&(r>i||r===void 0&&i>=i)&&(r=i)}return r}function TB(t,e,r=0,n=1/0,i){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(i=i===void 0?AB:Tye(i);n>r;){if(n-r>600){const u=n-r+1,l=e-r+1,c=Math.log(u),h=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*h*(u-h)/u)*(l-u/2<0?-1:1),f=Math.max(r,Math.floor(e-l*h/u+d)),p=Math.min(n,Math.floor(e+(u-l)*h/u+d));TB(t,e,f,p,i)}const a=t[e];let s=r,o=n;for(yf(t,r,e),i(t[n],a)>0&&yf(t,r,n);s<o;){for(yf(t,s,o),++s,--o;i(t[s],a)<0;)++s;for(;i(t[o],a)>0;)--o}i(t[r],a)===0?yf(t,r,o):(++o,yf(t,o,n)),o<=e&&(r=o+1),e<=o&&(n=o-1)}return t}function yf(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function $ye(t,e,r){if(t=Float64Array.from(xye(t,r)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return u2(t);if(e>=1)return o2(t);var n,i=(n-1)*e,a=Math.floor(i),s=o2(TB(t,a).subarray(0,a+1)),o=u2(t.subarray(a+1));return s+(o-s)*(i-a)}}function jye(t,e,r=EB){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,i=(n-1)*e,a=Math.floor(i),s=+r(t[a],a,t),o=+r(t[a+1],a+1,t);return s+(o-s)*(i-a)}}function Rye(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,a=new Array(i);++n<i;)a[n]=t+n*r;return a}function Hi(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function fo(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const HP=Symbol("implicit");function xk(){var t=new a2,e=[],r=[],n=HP;function i(a){let s=t.get(a);if(s===void 0){if(n!==HP)return n;t.set(a,s=e.push(a)-1)}return r[s%r.length]}return i.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new a2;for(const s of a)t.has(s)||t.set(s,e.push(s)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return xk(e,r).unknown(n)},Hi.apply(i,arguments),i}function Wp(){var t=xk().unknown(void 0),e=t.domain,r=t.range,n=0,i=1,a,s,o=!1,u=0,l=0,c=.5;delete t.unknown;function h(){var d=e().length,f=i<n,p=f?i:n,m=f?n:i;a=(m-p)/Math.max(1,d-u+l*2),o&&(a=Math.floor(a)),p+=(m-p-a*(d-u))*c,s=a*(1-u),o&&(p=Math.round(p),s=Math.round(s));var g=Rye(d).map(function(v){return p+a*v});return r(f?g.reverse():g)}return t.domain=function(d){return arguments.length?(e(d),h()):e()},t.range=function(d){return arguments.length?([n,i]=d,n=+n,i=+i,h()):[n,i]},t.rangeRound=function(d){return[n,i]=d,n=+n,i=+i,o=!0,h()},t.bandwidth=function(){return s},t.step=function(){return a},t.round=function(d){return arguments.length?(o=!!d,h()):o},t.padding=function(d){return arguments.length?(u=Math.min(1,l=+d),h()):u},t.paddingInner=function(d){return arguments.length?(u=Math.min(1,d),h()):u},t.paddingOuter=function(d){return arguments.length?(l=+d,h()):l},t.align=function(d){return arguments.length?(c=Math.max(0,Math.min(1,d)),h()):c},t.copy=function(){return Wp(e(),[n,i]).round(o).paddingInner(u).paddingOuter(l).align(c)},Hi.apply(h(),arguments)}function kB(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return kB(e())},t}function op(){return kB(Wp.apply(null,arguments).paddingInner(1))}function Ok(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function CB(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function vg(){}var Gp=.7,Tb=1/Gp,ah="\\s*([+-]?\\d+)\\s*",Yp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",rs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Nye=/^#([0-9a-f]{3,8})$/,Mye=new RegExp(`^rgb\\(${ah},${ah},${ah}\\)$`),Dye=new RegExp(`^rgb\\(${rs},${rs},${rs}\\)$`),Lye=new RegExp(`^rgba\\(${ah},${ah},${ah},${Yp}\\)$`),Fye=new RegExp(`^rgba\\(${rs},${rs},${rs},${Yp}\\)$`),Uye=new RegExp(`^hsl\\(${Yp},${rs},${rs}\\)$`),zye=new RegExp(`^hsla\\(${Yp},${rs},${rs},${Yp}\\)$`),l2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ok(vg,Jp,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:c2,formatHex:c2,formatHex8:Bye,formatHsl:qye,formatRgb:h2,toString:h2});function c2(){return this.rgb().formatHex()}function Bye(){return this.rgb().formatHex8()}function qye(){return IB(this).formatHsl()}function h2(){return this.rgb().formatRgb()}function Jp(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=Nye.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?d2(e):r===3?new Bn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Py(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Py(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Mye.exec(t))?new Bn(e[1],e[2],e[3],1):(e=Dye.exec(t))?new Bn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Lye.exec(t))?Py(e[1],e[2],e[3],e[4]):(e=Fye.exec(t))?Py(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Uye.exec(t))?m2(e[1],e[2]/100,e[3]/100,1):(e=zye.exec(t))?m2(e[1],e[2]/100,e[3]/100,e[4]):l2.hasOwnProperty(t)?d2(l2[t]):t==="transparent"?new Bn(NaN,NaN,NaN,0):null}function d2(t){return new Bn(t>>16&255,t>>8&255,t&255,1)}function Py(t,e,r,n){return n<=0&&(t=e=r=NaN),new Bn(t,e,r,n)}function Kye(t){return t instanceof vg||(t=Jp(t)),t?(t=t.rgb(),new Bn(t.r,t.g,t.b,t.opacity)):new Bn}function WP(t,e,r,n){return arguments.length===1?Kye(t):new Bn(t,e,r,n??1)}function Bn(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}Ok(Bn,WP,CB(vg,{brighter(t){return t=t==null?Tb:Math.pow(Tb,t),new Bn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Gp:Math.pow(Gp,t),new Bn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Bn(hl(this.r),hl(this.g),hl(this.b),kb(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:f2,formatHex:f2,formatHex8:Vye,formatRgb:p2,toString:p2}));function f2(){return`#${tl(this.r)}${tl(this.g)}${tl(this.b)}`}function Vye(){return`#${tl(this.r)}${tl(this.g)}${tl(this.b)}${tl((isNaN(this.opacity)?1:this.opacity)*255)}`}function p2(){const t=kb(this.opacity);return`${t===1?"rgb(":"rgba("}${hl(this.r)}, ${hl(this.g)}, ${hl(this.b)}${t===1?")":`, ${t})`}`}function kb(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function hl(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function tl(t){return t=hl(t),(t<16?"0":"")+t.toString(16)}function m2(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new fa(t,e,r,n)}function IB(t){if(t instanceof fa)return new fa(t.h,t.s,t.l,t.opacity);if(t instanceof vg||(t=Jp(t)),!t)return new fa;if(t instanceof fa)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),a=Math.max(e,r,n),s=NaN,o=a-i,u=(a+i)/2;return o?(e===a?s=(r-n)/o+(r<n)*6:r===a?s=(n-e)/o+2:s=(e-r)/o+4,o/=u<.5?a+i:2-a-i,s*=60):o=u>0&&u<1?0:s,new fa(s,o,u,t.opacity)}function Hye(t,e,r,n){return arguments.length===1?IB(t):new fa(t,e,r,n??1)}function fa(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}Ok(fa,Hye,CB(vg,{brighter(t){return t=t==null?Tb:Math.pow(Tb,t),new fa(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Gp:Math.pow(Gp,t),new fa(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new Bn(Nx(t>=240?t-240:t+120,i,n),Nx(t,i,n),Nx(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new fa(g2(this.h),Ey(this.s),Ey(this.l),kb(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=kb(this.opacity);return`${t===1?"hsl(":"hsla("}${g2(this.h)}, ${Ey(this.s)*100}%, ${Ey(this.l)*100}%${t===1?")":`, ${t})`}`}}));function g2(t){return t=(t||0)%360,t<0?t+360:t}function Ey(t){return Math.max(0,Math.min(1,t||0))}function Nx(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const Sk=t=>()=>t;function Wye(t,e){return function(r){return t+r*e}}function Gye(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function Yye(t){return(t=+t)==1?$B:function(e,r){return r-e?Gye(e,r,t):Sk(isNaN(e)?r:e)}}function $B(t,e){var r=e-t;return r?Wye(t,r):Sk(isNaN(t)?e:t)}const y2=function t(e){var r=Yye(e);function n(i,a){var s=r((i=WP(i)).r,(a=WP(a)).r),o=r(i.g,a.g),u=r(i.b,a.b),l=$B(i.opacity,a.opacity);return function(c){return i.r=s(c),i.g=o(c),i.b=u(c),i.opacity=l(c),i+""}}return n.gamma=t,n}(1);function Jye(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=t[i]*(1-a)+e[i]*a;return n}}function Zye(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Xye(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),a=new Array(r),s;for(s=0;s<n;++s)i[s]=Sd(t[s],e[s]);for(;s<r;++s)a[s]=e[s];return function(o){for(s=0;s<n;++s)a[s]=i[s](o);return a}}function Qye(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Cb(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function eve(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=Sd(t[i],e[i]):n[i]=e[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var GP=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Mx=new RegExp(GP.source,"g");function tve(t){return function(){return t}}function rve(t){return function(e){return t(e)+""}}function nve(t,e){var r=GP.lastIndex=Mx.lastIndex=0,n,i,a,s=-1,o=[],u=[];for(t=t+"",e=e+"";(n=GP.exec(t))&&(i=Mx.exec(e));)(a=i.index)>r&&(a=e.slice(r,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,u.push({i:s,x:Cb(n,i)})),r=Mx.lastIndex;return r<e.length&&(a=e.slice(r),o[s]?o[s]+=a:o[++s]=a),o.length<2?u[0]?rve(u[0].x):tve(e):(e=u.length,function(l){for(var c=0,h;c<e;++c)o[(h=u[c]).i]=h.x(l);return o.join("")})}function Sd(t,e){var r=typeof e,n;return e==null||r==="boolean"?Sk(e):(r==="number"?Cb:r==="string"?(n=Jp(e))?(e=n,y2):nve:e instanceof Jp?y2:e instanceof Date?Qye:Zye(e)?Jye:Array.isArray(e)?Xye:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?eve:Cb)(t,e)}function Pk(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function ive(t,e){e===void 0&&(e=t,t=Sd);for(var r=0,n=e.length-1,i=e[0],a=new Array(n<0?0:n);r<n;)a[r]=t(i,i=e[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return a[o](s-o)}}function ave(t){return function(){return t}}function Ib(t){return+t}var v2=[0,1];function En(t){return t}function YP(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:ave(isNaN(e)?NaN:.5)}function sve(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function ove(t,e,r){var n=t[0],i=t[1],a=e[0],s=e[1];return i<n?(n=YP(i,n),a=r(s,a)):(n=YP(n,i),a=r(a,s)),function(o){return a(n(o))}}function uve(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),a=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)i[s]=YP(t[s],t[s+1]),a[s]=r(e[s],e[s+1]);return function(o){var u=yg(t,o,1,n)-1;return a[u](i[u](o))}}function bg(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function g_(){var t=v2,e=v2,r=Sd,n,i,a,s=En,o,u,l;function c(){var d=Math.min(t.length,e.length);return s!==En&&(s=sve(t[0],t[d-1])),o=d>2?uve:ove,u=l=null,h}function h(d){return d==null||isNaN(d=+d)?a:(u||(u=o(t.map(n),e,r)))(n(s(d)))}return h.invert=function(d){return s(i((l||(l=o(e,t.map(n),Cb)))(d)))},h.domain=function(d){return arguments.length?(t=Array.from(d,Ib),c()):t.slice()},h.range=function(d){return arguments.length?(e=Array.from(d),c()):e.slice()},h.rangeRound=function(d){return e=Array.from(d),r=Pk,c()},h.clamp=function(d){return arguments.length?(s=d?!0:En,c()):s!==En},h.interpolate=function(d){return arguments.length?(r=d,c()):r},h.unknown=function(d){return arguments.length?(a=d,h):a},function(d,f){return n=d,i=f,c()}}function Ek(){return g_()(En,En)}function lve(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function $b(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function $h(t){return t=$b(Math.abs(t)),t?t[1]:NaN}function cve(t,e){return function(r,n){for(var i=r.length,a=[],s=0,o=t[0],u=0;i>0&&o>0&&(u+o+1>n&&(o=Math.max(1,n-u)),a.push(r.substring(i-=o,i+o)),!((u+=o+1)>n));)o=t[s=(s+1)%t.length];return a.reverse().join(e)}}function hve(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var dve=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Zp(t){if(!(e=dve.exec(t)))throw new Error("invalid format: "+t);var e;return new Ak({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Zp.prototype=Ak.prototype;function Ak(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Ak.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function fve(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var jB;function pve(t,e){var r=$b(t,e);if(!r)return t+"";var n=r[0],i=r[1],a=i-(jB=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=n.length;return a===s?n:a>s?n+new Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+$b(t,Math.max(0,e+a-1))[0]}function b2(t,e){var r=$b(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const w2={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:lve,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>b2(t*100,e),r:b2,s:pve,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function _2(t){return t}var x2=Array.prototype.map,O2=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function mve(t){var e=t.grouping===void 0||t.thousands===void 0?_2:cve(x2.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?_2:hve(x2.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",u=t.nan===void 0?"NaN":t.nan+"";function l(h){h=Zp(h);var d=h.fill,f=h.align,p=h.sign,m=h.symbol,g=h.zero,v=h.width,y=h.comma,b=h.precision,w=h.trim,_=h.type;_==="n"?(y=!0,_="g"):w2[_]||(b===void 0&&(b=12),w=!0,_="g"),(g||d==="0"&&f==="=")&&(g=!0,d="0",f="=");var O=m==="$"?r:m==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",P=m==="$"?n:/[%p]/.test(_)?s:"",x=w2[_],j=/[defgprs%]/.test(_);b=b===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function k(R){var F=O,z=P,N,L,D;if(_==="c")z=x(R)+z,R="";else{R=+R;var q=R<0||1/R<0;if(R=isNaN(R)?u:x(Math.abs(R),b),w&&(R=fve(R)),q&&+R==0&&p!=="+"&&(q=!1),F=(q?p==="("?p:o:p==="-"||p==="("?"":p)+F,z=(_==="s"?O2[8+jB/3]:"")+z+(q&&p==="("?")":""),j){for(N=-1,L=R.length;++N<L;)if(D=R.charCodeAt(N),48>D||D>57){z=(D===46?i+R.slice(N+1):R.slice(N))+z,R=R.slice(0,N);break}}}y&&!g&&(R=e(R,1/0));var M=F.length+R.length+z.length,V=M<v?new Array(v-M+1).join(d):"";switch(y&&g&&(R=e(V+R,V.length?v-z.length:1/0),V=""),f){case"<":R=F+R+z+V;break;case"=":R=F+V+R+z;break;case"^":R=V.slice(0,M=V.length>>1)+F+R+z+V.slice(M);break;default:R=V+F+R+z;break}return a(R)}return k.toString=function(){return h+""},k}function c(h,d){var f=l((h=Zp(h),h.type="f",h)),p=Math.max(-8,Math.min(8,Math.floor($h(d)/3)))*3,m=Math.pow(10,-p),g=O2[8+p/3];return function(v){return f(m*v)+g}}return{format:l,formatPrefix:c}}var Ay,Tk,RB;gve({thousands:",",grouping:[3],currency:["$",""]});function gve(t){return Ay=mve(t),Tk=Ay.format,RB=Ay.formatPrefix,Ay}function yve(t){return Math.max(0,-$h(Math.abs(t)))}function vve(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor($h(e)/3)))*3-$h(Math.abs(t)))}function bve(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,$h(e)-$h(t))+1}function NB(t,e,r,n){var i=VP(t,e,r),a;switch(n=Zp(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(a=vve(i,s))&&(n.precision=a),RB(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=bve(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=yve(i))&&(n.precision=a-(n.type==="%")*2);break}}return Tk(n)}function Ou(t){var e=t.domain;return t.ticks=function(r){var n=e();return qP(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var i=e();return NB(i[0],i[i.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,a=n.length-1,s=n[i],o=n[a],u,l,c=10;for(o<s&&(l=s,s=o,o=l,l=i,i=a,a=l);c-- >0;){if(l=KP(s,o,r),l===u)return n[i]=s,n[a]=o,e(n);if(l>0)s=Math.floor(s/l)*l,o=Math.ceil(o/l)*l;else if(l<0)s=Math.ceil(s*l)/l,o=Math.floor(o*l)/l;else break;u=l}return t},t}function jb(){var t=Ek();return t.copy=function(){return bg(t,jb())},Hi.apply(t,arguments),Ou(t)}function MB(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,Ib),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return MB(t).unknown(e)},t=arguments.length?Array.from(t,Ib):[0,1],Ou(r)}function DB(t,e){t=t.slice();var r=0,n=t.length-1,i=t[r],a=t[n],s;return a<i&&(s=r,r=n,n=s,s=i,i=a,a=s),t[r]=e.floor(i),t[n]=e.ceil(a),t}function S2(t){return Math.log(t)}function P2(t){return Math.exp(t)}function wve(t){return-Math.log(-t)}function _ve(t){return-Math.exp(-t)}function xve(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Ove(t){return t===10?xve:t===Math.E?Math.exp:e=>Math.pow(t,e)}function Sve(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function E2(t){return(e,r)=>-t(-e,r)}function kk(t){const e=t(S2,P2),r=e.domain;let n=10,i,a;function s(){return i=Sve(n),a=Ove(n),r()[0]<0?(i=E2(i),a=E2(a),t(wve,_ve)):t(S2,P2),e}return e.base=function(o){return arguments.length?(n=+o,s()):n},e.domain=function(o){return arguments.length?(r(o),s()):r()},e.ticks=o=>{const u=r();let l=u[0],c=u[u.length-1];const h=c<l;h&&([l,c]=[c,l]);let d=i(l),f=i(c),p,m;const g=o==null?10:+o;let v=[];if(!(n%1)&&f-d<g){if(d=Math.floor(d),f=Math.ceil(f),l>0){for(;d<=f;++d)for(p=1;p<n;++p)if(m=d<0?p/a(-d):p*a(d),!(m<l)){if(m>c)break;v.push(m)}}else for(;d<=f;++d)for(p=n-1;p>=1;--p)if(m=d>0?p/a(-d):p*a(d),!(m<l)){if(m>c)break;v.push(m)}v.length*2<g&&(v=qP(l,c,g))}else v=qP(d,f,Math.min(f-d,g)).map(a);return h?v.reverse():v},e.tickFormat=(o,u)=>{if(o==null&&(o=10),u==null&&(u=n===10?"s":","),typeof u!="function"&&(!(n%1)&&(u=Zp(u)).precision==null&&(u.trim=!0),u=Tk(u)),o===1/0)return u;const l=Math.max(1,n*o/e.ticks().length);return c=>{let h=c/a(Math.round(i(c)));return h*n<n-.5&&(h*=n),h<=l?u(c):""}},e.nice=()=>r(DB(r(),{floor:o=>a(Math.floor(i(o))),ceil:o=>a(Math.ceil(i(o)))})),e}function LB(){const t=kk(g_()).domain([1,10]);return t.copy=()=>bg(t,LB()).base(t.base()),Hi.apply(t,arguments),t}function A2(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function T2(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Ck(t){var e=1,r=t(A2(e),T2(e));return r.constant=function(n){return arguments.length?t(A2(e=+n),T2(e)):e},Ou(r)}function FB(){var t=Ck(g_());return t.copy=function(){return bg(t,FB()).constant(t.constant())},Hi.apply(t,arguments)}function k2(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Pve(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Eve(t){return t<0?-t*t:t*t}function Ik(t){var e=t(En,En),r=1;function n(){return r===1?t(En,En):r===.5?t(Pve,Eve):t(k2(r),k2(1/r))}return e.exponent=function(i){return arguments.length?(r=+i,n()):r},Ou(e)}function $k(){var t=Ik(g_());return t.copy=function(){return bg(t,$k()).exponent(t.exponent())},Hi.apply(t,arguments),t}function Ave(){return $k.apply(null,arguments).exponent(.5)}function C2(t){return Math.sign(t)*t*t}function Tve(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function UB(){var t=Ek(),e=[0,1],r=!1,n;function i(a){var s=Tve(t(a));return isNaN(s)?n:r?Math.round(s):s}return i.invert=function(a){return t.invert(C2(a))},i.domain=function(a){return arguments.length?(t.domain(a),i):t.domain()},i.range=function(a){return arguments.length?(t.range((e=Array.from(a,Ib)).map(C2)),i):e.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(t.clamp(a),i):t.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return UB(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},Hi.apply(i,arguments),Ou(i)}function zB(){var t=[],e=[],r=[],n;function i(){var s=0,o=Math.max(1,e.length);for(r=new Array(o-1);++s<o;)r[s-1]=jye(t,s/o);return a}function a(s){return s==null||isNaN(s=+s)?n:e[yg(r,s)]}return a.invertExtent=function(s){var o=e.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:t[0],o<r.length?r[o]:t[t.length-1]]},a.domain=function(s){if(!arguments.length)return t.slice();t=[];for(let o of s)o!=null&&!isNaN(o=+o)&&t.push(o);return t.sort(ou),i()},a.range=function(s){return arguments.length?(e=Array.from(s),i()):e.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return zB().domain(t).range(e).unknown(n)},Hi.apply(a,arguments)}function BB(){var t=0,e=1,r=1,n=[.5],i=[0,1],a;function s(u){return u!=null&&u<=u?i[yg(n,u,0,r)]:a}function o(){var u=-1;for(n=new Array(r);++u<r;)n[u]=((u+1)*e-(u-r)*t)/(r+1);return s}return s.domain=function(u){return arguments.length?([t,e]=u,t=+t,e=+e,o()):[t,e]},s.range=function(u){return arguments.length?(r=(i=Array.from(u)).length-1,o()):i.slice()},s.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[t,n[0]]:l>=r?[n[r-1],e]:[n[l-1],n[l]]},s.unknown=function(u){return arguments.length&&(a=u),s},s.thresholds=function(){return n.slice()},s.copy=function(){return BB().domain([t,e]).range(i).unknown(a)},Hi.apply(Ou(s),arguments)}function qB(){var t=[.5],e=[0,1],r,n=1;function i(a){return a!=null&&a<=a?e[yg(t,a,0,n)]:r}return i.domain=function(a){return arguments.length?(t=Array.from(a),n=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(a){return arguments.length?(e=Array.from(a),n=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(a){var s=e.indexOf(a);return[t[s-1],t[s]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return qB().domain(t).range(e).unknown(r)},Hi.apply(i,arguments)}const Dx=new Date,Lx=new Date;function Pr(t,e,r,n){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(t(a=new Date(+a)),a),i.ceil=a=>(t(a=new Date(a-1)),e(a,1),t(a),a),i.round=a=>{const s=i(a),o=i.ceil(a);return a-s<o-a?s:o},i.offset=(a,s)=>(e(a=new Date(+a),s==null?1:Math.floor(s)),a),i.range=(a,s,o)=>{const u=[];if(a=i.ceil(a),o=o==null?1:Math.floor(o),!(a<s)||!(o>0))return u;let l;do u.push(l=new Date(+a)),e(a,o),t(a);while(l<a&&a<s);return u},i.filter=a=>Pr(s=>{if(s>=s)for(;t(s),!a(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;e(s,-1),!a(s););else for(;--o>=0;)for(;e(s,1),!a(s););}),r&&(i.count=(a,s)=>(Dx.setTime(+a),Lx.setTime(+s),t(Dx),t(Lx),Math.floor(r(Dx,Lx))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?s=>n(s)%a===0:s=>i.count(0,s)%a===0):i)),i}const Rb=Pr(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Rb.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Pr(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):Rb);Rb.range;const Ls=1e3,Mi=Ls*60,Fs=Mi*60,Qs=Fs*24,jk=Qs*7,I2=Qs*30,Fx=Qs*365,rl=Pr(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Ls)},(t,e)=>(e-t)/Ls,t=>t.getUTCSeconds());rl.range;const Rk=Pr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Ls)},(t,e)=>{t.setTime(+t+e*Mi)},(t,e)=>(e-t)/Mi,t=>t.getMinutes());Rk.range;const Nk=Pr(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Mi)},(t,e)=>(e-t)/Mi,t=>t.getUTCMinutes());Nk.range;const Mk=Pr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Ls-t.getMinutes()*Mi)},(t,e)=>{t.setTime(+t+e*Fs)},(t,e)=>(e-t)/Fs,t=>t.getHours());Mk.range;const Dk=Pr(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Fs)},(t,e)=>(e-t)/Fs,t=>t.getUTCHours());Dk.range;const wg=Pr(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Mi)/Qs,t=>t.getDate()-1);wg.range;const y_=Pr(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Qs,t=>t.getUTCDate()-1);y_.range;const KB=Pr(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Qs,t=>Math.floor(t/Qs));KB.range;function Wl(t){return Pr(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Mi)/jk)}const v_=Wl(0),Nb=Wl(1),kve=Wl(2),Cve=Wl(3),jh=Wl(4),Ive=Wl(5),$ve=Wl(6);v_.range;Nb.range;kve.range;Cve.range;jh.range;Ive.range;$ve.range;function Gl(t){return Pr(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/jk)}const b_=Gl(0),Mb=Gl(1),jve=Gl(2),Rve=Gl(3),Rh=Gl(4),Nve=Gl(5),Mve=Gl(6);b_.range;Mb.range;jve.range;Rve.range;Rh.range;Nve.range;Mve.range;const Lk=Pr(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());Lk.range;const Fk=Pr(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Fk.range;const eo=Pr(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());eo.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Pr(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});eo.range;const to=Pr(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());to.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Pr(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});to.range;function VB(t,e,r,n,i,a){const s=[[rl,1,Ls],[rl,5,5*Ls],[rl,15,15*Ls],[rl,30,30*Ls],[a,1,Mi],[a,5,5*Mi],[a,15,15*Mi],[a,30,30*Mi],[i,1,Fs],[i,3,3*Fs],[i,6,6*Fs],[i,12,12*Fs],[n,1,Qs],[n,2,2*Qs],[r,1,jk],[e,1,I2],[e,3,3*I2],[t,1,Fx]];function o(l,c,h){const d=c<l;d&&([l,c]=[c,l]);const f=h&&typeof h.range=="function"?h:u(l,c,h),p=f?f.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,h){const d=Math.abs(c-l)/h,f=_k(([,,g])=>g).right(s,d);if(f===s.length)return t.every(VP(l/Fx,c/Fx,h));if(f===0)return Rb.every(Math.max(VP(l,c,h),1));const[p,m]=s[d/s[f-1][2]<s[f][2]/d?f-1:f];return p.every(m)}return[o,u]}const[Dve,Lve]=VB(to,Fk,b_,KB,Dk,Nk),[Fve,Uve]=VB(eo,Lk,v_,wg,Mk,Rk);function Ux(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function zx(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function vf(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function zve(t){var e=t.dateTime,r=t.date,n=t.time,i=t.periods,a=t.days,s=t.shortDays,o=t.months,u=t.shortMonths,l=bf(i),c=wf(i),h=bf(a),d=wf(a),f=bf(s),p=wf(s),m=bf(o),g=wf(o),v=bf(u),y=wf(u),b={a:q,A:M,b:V,B:G,c:null,d:D2,e:D2,f:cbe,g:wbe,G:xbe,H:obe,I:ube,j:lbe,L:HB,m:hbe,M:dbe,p:re,q:K,Q:U2,s:z2,S:fbe,u:pbe,U:mbe,V:gbe,w:ybe,W:vbe,x:null,X:null,y:bbe,Y:_be,Z:Obe,"%":F2},w={a:J,A:ie,b:oe,B:S,c:null,d:L2,e:L2,f:Abe,g:Dbe,G:Fbe,H:Sbe,I:Pbe,j:Ebe,L:GB,m:Tbe,M:kbe,p:E,q:U,Q:U2,s:z2,S:Cbe,u:Ibe,U:$be,V:jbe,w:Rbe,W:Nbe,x:null,X:null,y:Mbe,Y:Lbe,Z:Ube,"%":F2},_={a:k,A:R,b:F,B:z,c:N,d:N2,e:N2,f:nbe,g:R2,G:j2,H:M2,I:M2,j:Qve,L:rbe,m:Xve,M:ebe,p:j,q:Zve,Q:abe,s:sbe,S:tbe,u:Hve,U:Wve,V:Gve,w:Vve,W:Yve,x:L,X:D,y:R2,Y:j2,Z:Jve,"%":ibe};b.x=O(r,b),b.X=O(n,b),b.c=O(e,b),w.x=O(r,w),w.X=O(n,w),w.c=O(e,w);function O(T,ee){return function(se){var H=[],Oe=-1,be=0,xe=T.length,C,B,Y;for(se instanceof Date||(se=new Date(+se));++Oe<xe;)T.charCodeAt(Oe)===37&&(H.push(T.slice(be,Oe)),(B=$2[C=T.charAt(++Oe)])!=null?C=T.charAt(++Oe):B=C==="e"?" ":"0",(Y=ee[C])&&(C=Y(se,B)),H.push(C),be=Oe+1);return H.push(T.slice(be,Oe)),H.join("")}}function P(T,ee){return function(se){var H=vf(1900,void 0,1),Oe=x(H,T,se+="",0),be,xe;if(Oe!=se.length)return null;if("Q"in H)return new Date(H.Q);if("s"in H)return new Date(H.s*1e3+("L"in H?H.L:0));if(ee&&!("Z"in H)&&(H.Z=0),"p"in H&&(H.H=H.H%12+H.p*12),H.m===void 0&&(H.m="q"in H?H.q:0),"V"in H){if(H.V<1||H.V>53)return null;"w"in H||(H.w=1),"Z"in H?(be=zx(vf(H.y,0,1)),xe=be.getUTCDay(),be=xe>4||xe===0?Mb.ceil(be):Mb(be),be=y_.offset(be,(H.V-1)*7),H.y=be.getUTCFullYear(),H.m=be.getUTCMonth(),H.d=be.getUTCDate()+(H.w+6)%7):(be=Ux(vf(H.y,0,1)),xe=be.getDay(),be=xe>4||xe===0?Nb.ceil(be):Nb(be),be=wg.offset(be,(H.V-1)*7),H.y=be.getFullYear(),H.m=be.getMonth(),H.d=be.getDate()+(H.w+6)%7)}else("W"in H||"U"in H)&&("w"in H||(H.w="u"in H?H.u%7:"W"in H?1:0),xe="Z"in H?zx(vf(H.y,0,1)).getUTCDay():Ux(vf(H.y,0,1)).getDay(),H.m=0,H.d="W"in H?(H.w+6)%7+H.W*7-(xe+5)%7:H.w+H.U*7-(xe+6)%7);return"Z"in H?(H.H+=H.Z/100|0,H.M+=H.Z%100,zx(H)):Ux(H)}}function x(T,ee,se,H){for(var Oe=0,be=ee.length,xe=se.length,C,B;Oe<be;){if(H>=xe)return-1;if(C=ee.charCodeAt(Oe++),C===37){if(C=ee.charAt(Oe++),B=_[C in $2?ee.charAt(Oe++):C],!B||(H=B(T,se,H))<0)return-1}else if(C!=se.charCodeAt(H++))return-1}return H}function j(T,ee,se){var H=l.exec(ee.slice(se));return H?(T.p=c.get(H[0].toLowerCase()),se+H[0].length):-1}function k(T,ee,se){var H=f.exec(ee.slice(se));return H?(T.w=p.get(H[0].toLowerCase()),se+H[0].length):-1}function R(T,ee,se){var H=h.exec(ee.slice(se));return H?(T.w=d.get(H[0].toLowerCase()),se+H[0].length):-1}function F(T,ee,se){var H=v.exec(ee.slice(se));return H?(T.m=y.get(H[0].toLowerCase()),se+H[0].length):-1}function z(T,ee,se){var H=m.exec(ee.slice(se));return H?(T.m=g.get(H[0].toLowerCase()),se+H[0].length):-1}function N(T,ee,se){return x(T,e,ee,se)}function L(T,ee,se){return x(T,r,ee,se)}function D(T,ee,se){return x(T,n,ee,se)}function q(T){return s[T.getDay()]}function M(T){return a[T.getDay()]}function V(T){return u[T.getMonth()]}function G(T){return o[T.getMonth()]}function re(T){return i[+(T.getHours()>=12)]}function K(T){return 1+~~(T.getMonth()/3)}function J(T){return s[T.getUTCDay()]}function ie(T){return a[T.getUTCDay()]}function oe(T){return u[T.getUTCMonth()]}function S(T){return o[T.getUTCMonth()]}function E(T){return i[+(T.getUTCHours()>=12)]}function U(T){return 1+~~(T.getUTCMonth()/3)}return{format:function(T){var ee=O(T+="",b);return ee.toString=function(){return T},ee},parse:function(T){var ee=P(T+="",!1);return ee.toString=function(){return T},ee},utcFormat:function(T){var ee=O(T+="",w);return ee.toString=function(){return T},ee},utcParse:function(T){var ee=P(T+="",!0);return ee.toString=function(){return T},ee}}}var $2={"-":"",_:" ",0:"0"},Fr=/^\s*\d+/,Bve=/^%/,qve=/[\\^$*+?|[\]().{}]/g;function it(t,e,r){var n=t<0?"-":"",i=(n?-t:t)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(e)+i:i)}function Kve(t){return t.replace(qve,"\\$&")}function bf(t){return new RegExp("^(?:"+t.map(Kve).join("|")+")","i")}function wf(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function Vve(t,e,r){var n=Fr.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function Hve(t,e,r){var n=Fr.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function Wve(t,e,r){var n=Fr.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function Gve(t,e,r){var n=Fr.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function Yve(t,e,r){var n=Fr.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function j2(t,e,r){var n=Fr.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function R2(t,e,r){var n=Fr.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Jve(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function Zve(t,e,r){var n=Fr.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function Xve(t,e,r){var n=Fr.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function N2(t,e,r){var n=Fr.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function Qve(t,e,r){var n=Fr.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function M2(t,e,r){var n=Fr.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function ebe(t,e,r){var n=Fr.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function tbe(t,e,r){var n=Fr.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function rbe(t,e,r){var n=Fr.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function nbe(t,e,r){var n=Fr.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function ibe(t,e,r){var n=Bve.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function abe(t,e,r){var n=Fr.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function sbe(t,e,r){var n=Fr.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function D2(t,e){return it(t.getDate(),e,2)}function obe(t,e){return it(t.getHours(),e,2)}function ube(t,e){return it(t.getHours()%12||12,e,2)}function lbe(t,e){return it(1+wg.count(eo(t),t),e,3)}function HB(t,e){return it(t.getMilliseconds(),e,3)}function cbe(t,e){return HB(t,e)+"000"}function hbe(t,e){return it(t.getMonth()+1,e,2)}function dbe(t,e){return it(t.getMinutes(),e,2)}function fbe(t,e){return it(t.getSeconds(),e,2)}function pbe(t){var e=t.getDay();return e===0?7:e}function mbe(t,e){return it(v_.count(eo(t)-1,t),e,2)}function WB(t){var e=t.getDay();return e>=4||e===0?jh(t):jh.ceil(t)}function gbe(t,e){return t=WB(t),it(jh.count(eo(t),t)+(eo(t).getDay()===4),e,2)}function ybe(t){return t.getDay()}function vbe(t,e){return it(Nb.count(eo(t)-1,t),e,2)}function bbe(t,e){return it(t.getFullYear()%100,e,2)}function wbe(t,e){return t=WB(t),it(t.getFullYear()%100,e,2)}function _be(t,e){return it(t.getFullYear()%1e4,e,4)}function xbe(t,e){var r=t.getDay();return t=r>=4||r===0?jh(t):jh.ceil(t),it(t.getFullYear()%1e4,e,4)}function Obe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+it(e/60|0,"0",2)+it(e%60,"0",2)}function L2(t,e){return it(t.getUTCDate(),e,2)}function Sbe(t,e){return it(t.getUTCHours(),e,2)}function Pbe(t,e){return it(t.getUTCHours()%12||12,e,2)}function Ebe(t,e){return it(1+y_.count(to(t),t),e,3)}function GB(t,e){return it(t.getUTCMilliseconds(),e,3)}function Abe(t,e){return GB(t,e)+"000"}function Tbe(t,e){return it(t.getUTCMonth()+1,e,2)}function kbe(t,e){return it(t.getUTCMinutes(),e,2)}function Cbe(t,e){return it(t.getUTCSeconds(),e,2)}function Ibe(t){var e=t.getUTCDay();return e===0?7:e}function $be(t,e){return it(b_.count(to(t)-1,t),e,2)}function YB(t){var e=t.getUTCDay();return e>=4||e===0?Rh(t):Rh.ceil(t)}function jbe(t,e){return t=YB(t),it(Rh.count(to(t),t)+(to(t).getUTCDay()===4),e,2)}function Rbe(t){return t.getUTCDay()}function Nbe(t,e){return it(Mb.count(to(t)-1,t),e,2)}function Mbe(t,e){return it(t.getUTCFullYear()%100,e,2)}function Dbe(t,e){return t=YB(t),it(t.getUTCFullYear()%100,e,2)}function Lbe(t,e){return it(t.getUTCFullYear()%1e4,e,4)}function Fbe(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Rh(t):Rh.ceil(t),it(t.getUTCFullYear()%1e4,e,4)}function Ube(){return"+0000"}function F2(){return"%"}function U2(t){return+t}function z2(t){return Math.floor(+t/1e3)}var uc,JB,ZB;zbe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function zbe(t){return uc=zve(t),JB=uc.format,uc.parse,ZB=uc.utcFormat,uc.utcParse,uc}function Bbe(t){return new Date(t)}function qbe(t){return t instanceof Date?+t:+new Date(+t)}function Uk(t,e,r,n,i,a,s,o,u,l){var c=Ek(),h=c.invert,d=c.domain,f=l(".%L"),p=l(":%S"),m=l("%I:%M"),g=l("%I %p"),v=l("%a %d"),y=l("%b %d"),b=l("%B"),w=l("%Y");function _(O){return(u(O)<O?f:o(O)<O?p:s(O)<O?m:a(O)<O?g:n(O)<O?i(O)<O?v:y:r(O)<O?b:w)(O)}return c.invert=function(O){return new Date(h(O))},c.domain=function(O){return arguments.length?d(Array.from(O,qbe)):d().map(Bbe)},c.ticks=function(O){var P=d();return t(P[0],P[P.length-1],O??10)},c.tickFormat=function(O,P){return P==null?_:l(P)},c.nice=function(O){var P=d();return(!O||typeof O.range!="function")&&(O=e(P[0],P[P.length-1],O??10)),O?d(DB(P,O)):c},c.copy=function(){return bg(c,Uk(t,e,r,n,i,a,s,o,u,l))},c}function Kbe(){return Hi.apply(Uk(Fve,Uve,eo,Lk,v_,wg,Mk,Rk,rl,JB).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Vbe(){return Hi.apply(Uk(Dve,Lve,to,Fk,b_,y_,Dk,Nk,rl,ZB).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function w_(){var t=0,e=1,r,n,i,a,s=En,o=!1,u;function l(h){return h==null||isNaN(h=+h)?u:s(i===0?.5:(h=(a(h)-r)*i,o?Math.max(0,Math.min(1,h)):h))}l.domain=function(h){return arguments.length?([t,e]=h,r=a(t=+t),n=a(e=+e),i=r===n?0:1/(n-r),l):[t,e]},l.clamp=function(h){return arguments.length?(o=!!h,l):o},l.interpolator=function(h){return arguments.length?(s=h,l):s};function c(h){return function(d){var f,p;return arguments.length?([f,p]=d,s=h(f,p),l):[s(0),s(1)]}}return l.range=c(Sd),l.rangeRound=c(Pk),l.unknown=function(h){return arguments.length?(u=h,l):u},function(h){return a=h,r=h(t),n=h(e),i=r===n?0:1/(n-r),l}}function Su(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function XB(){var t=Ou(w_()(En));return t.copy=function(){return Su(t,XB())},fo.apply(t,arguments)}function QB(){var t=kk(w_()).domain([1,10]);return t.copy=function(){return Su(t,QB()).base(t.base())},fo.apply(t,arguments)}function eq(){var t=Ck(w_());return t.copy=function(){return Su(t,eq()).constant(t.constant())},fo.apply(t,arguments)}function zk(){var t=Ik(w_());return t.copy=function(){return Su(t,zk()).exponent(t.exponent())},fo.apply(t,arguments)}function Hbe(){return zk.apply(null,arguments).exponent(.5)}function tq(){var t=[],e=En;function r(n){if(n!=null&&!isNaN(n=+n))return e((yg(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let i of n)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(ou),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,i)=>e(i/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>$ye(t,a/n))},r.copy=function(){return tq(e).domain(t)},fo.apply(r,arguments)}function __(){var t=0,e=.5,r=1,n=1,i,a,s,o,u,l=En,c,h=!1,d;function f(m){return isNaN(m=+m)?d:(m=.5+((m=+c(m))-a)*(n*m<n*a?o:u),l(h?Math.max(0,Math.min(1,m)):m))}f.domain=function(m){return arguments.length?([t,e,r]=m,i=c(t=+t),a=c(e=+e),s=c(r=+r),o=i===a?0:.5/(a-i),u=a===s?0:.5/(s-a),n=a<i?-1:1,f):[t,e,r]},f.clamp=function(m){return arguments.length?(h=!!m,f):h},f.interpolator=function(m){return arguments.length?(l=m,f):l};function p(m){return function(g){var v,y,b;return arguments.length?([v,y,b]=g,l=ive(m,[v,y,b]),f):[l(0),l(.5),l(1)]}}return f.range=p(Sd),f.rangeRound=p(Pk),f.unknown=function(m){return arguments.length?(d=m,f):d},function(m){return c=m,i=m(t),a=m(e),s=m(r),o=i===a?0:.5/(a-i),u=a===s?0:.5/(s-a),n=a<i?-1:1,f}}function rq(){var t=Ou(__()(En));return t.copy=function(){return Su(t,rq())},fo.apply(t,arguments)}function nq(){var t=kk(__()).domain([.1,1,10]);return t.copy=function(){return Su(t,nq()).base(t.base())},fo.apply(t,arguments)}function iq(){var t=Ck(__());return t.copy=function(){return Su(t,iq()).constant(t.constant())},fo.apply(t,arguments)}function Bk(){var t=Ik(__());return t.copy=function(){return Su(t,Bk()).exponent(t.exponent())},fo.apply(t,arguments)}function Wbe(){return Bk.apply(null,arguments).exponent(.5)}const B2=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Wp,scaleDiverging:rq,scaleDivergingLog:nq,scaleDivergingPow:Bk,scaleDivergingSqrt:Wbe,scaleDivergingSymlog:iq,scaleIdentity:MB,scaleImplicit:HP,scaleLinear:jb,scaleLog:LB,scaleOrdinal:xk,scalePoint:op,scalePow:$k,scaleQuantile:zB,scaleQuantize:BB,scaleRadial:UB,scaleSequential:XB,scaleSequentialLog:QB,scaleSequentialPow:zk,scaleSequentialQuantile:tq,scaleSequentialSqrt:Hbe,scaleSequentialSymlog:eq,scaleSqrt:Ave,scaleSymlog:FB,scaleThreshold:qB,scaleTime:Kbe,scaleUtc:Vbe,tickFormat:NB},Symbol.toStringTag,{value:"Module"}));var Gbe=pd;function Ybe(t,e,r){for(var n=-1,i=t.length;++n<i;){var a=t[n],s=e(a);if(s!=null&&(o===void 0?s===s&&!Gbe(s):r(s,o)))var o=s,u=a}return u}var x_=Ybe;function Jbe(t,e){return t>e}var aq=Jbe,Zbe=x_,Xbe=aq,Qbe=Od;function ewe(t){return t&&t.length?Zbe(t,Qbe,Xbe):void 0}var twe=ewe;const Vo=Ze(twe);function rwe(t,e){return t<e}var sq=rwe,nwe=x_,iwe=sq,awe=Od;function swe(t){return t&&t.length?nwe(t,awe,iwe):void 0}var owe=swe;const O_=Ze(owe);var uwe=ik,lwe=ys,cwe=fB,hwe=Xn;function dwe(t,e){var r=hwe(t)?uwe:cwe;return r(t,lwe(e))}var fwe=dwe,pwe=hB,mwe=fwe;function gwe(t,e){return pwe(mwe(t,e),1)}var ywe=gwe;const vwe=Ze(ywe);var bwe=yk;function wwe(t,e){return bwe(t,e)}var _we=wwe;const Nh=Ze(_we);var Pd=1e9,xwe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Kk,Dt=!0,qi="[DecimalError] ",dl=qi+"Invalid argument: ",qk=qi+"Exponent out of range: ",Ed=Math.floor,Bu=Math.pow,Owe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ui,Tr=1e7,It=7,oq=9007199254740991,Db=Ed(oq/It),_e={};_e.absoluteValue=_e.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};_e.comparedTo=_e.cmp=function(t){var e,r,n,i,a=this;if(t=new a.constructor(t),a.s!==t.s)return a.s||-t.s;if(a.e!==t.e)return a.e>t.e^a.s<0?1:-1;for(n=a.d.length,i=t.d.length,e=0,r=n<i?n:i;e<r;++e)if(a.d[e]!==t.d[e])return a.d[e]>t.d[e]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};_e.decimalPlaces=_e.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*It;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};_e.dividedBy=_e.div=function(t){return Vs(this,new this.constructor(t))};_e.dividedToIntegerBy=_e.idiv=function(t){var e=this,r=e.constructor;return Ot(Vs(e,new r(t),0,1),r.precision)};_e.equals=_e.eq=function(t){return!this.cmp(t)};_e.exponent=function(){return cr(this)};_e.greaterThan=_e.gt=function(t){return this.cmp(t)>0};_e.greaterThanOrEqualTo=_e.gte=function(t){return this.cmp(t)>=0};_e.isInteger=_e.isint=function(){return this.e>this.d.length-2};_e.isNegative=_e.isneg=function(){return this.s<0};_e.isPositive=_e.ispos=function(){return this.s>0};_e.isZero=function(){return this.s===0};_e.lessThan=_e.lt=function(t){return this.cmp(t)<0};_e.lessThanOrEqualTo=_e.lte=function(t){return this.cmp(t)<1};_e.logarithm=_e.log=function(t){var e,r=this,n=r.constructor,i=n.precision,a=i+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(ui))throw Error(qi+"NaN");if(r.s<1)throw Error(qi+(r.s?"NaN":"-Infinity"));return r.eq(ui)?new n(0):(Dt=!1,e=Vs(Xp(r,a),Xp(t,a),a),Dt=!0,Ot(e,i))};_e.minus=_e.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?cq(e,t):uq(e,(t.s=-t.s,t))};_e.modulo=_e.mod=function(t){var e,r=this,n=r.constructor,i=n.precision;if(t=new n(t),!t.s)throw Error(qi+"NaN");return r.s?(Dt=!1,e=Vs(r,t,0,1).times(t),Dt=!0,r.minus(e)):Ot(new n(r),i)};_e.naturalExponential=_e.exp=function(){return lq(this)};_e.naturalLogarithm=_e.ln=function(){return Xp(this)};_e.negated=_e.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};_e.plus=_e.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?uq(e,t):cq(e,(t.s=-t.s,t))};_e.precision=_e.sd=function(t){var e,r,n,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(dl+t);if(e=cr(i)+1,n=i.d.length-1,r=n*It+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};_e.squareRoot=_e.sqrt=function(){var t,e,r,n,i,a,s,o=this,u=o.constructor;if(o.s<1){if(!o.s)return new u(0);throw Error(qi+"NaN")}for(t=cr(o),Dt=!1,i=Math.sqrt(+o),i==0||i==1/0?(e=Ga(o.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=Ed((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new u(e)):n=new u(i.toString()),r=u.precision,i=s=r+3;;)if(a=n,n=a.plus(Vs(o,a,s+2)).times(.5),Ga(a.d).slice(0,s)===(e=Ga(n.d)).slice(0,s)){if(e=e.slice(s-3,s+1),i==s&&e=="4999"){if(Ot(a,r+1,0),a.times(a).eq(o)){n=a;break}}else if(e!="9999")break;s+=4}return Dt=!0,Ot(n,r)};_e.times=_e.mul=function(t){var e,r,n,i,a,s,o,u,l,c=this,h=c.constructor,d=c.d,f=(t=new h(t)).d;if(!c.s||!t.s)return new h(0);for(t.s*=c.s,r=c.e+t.e,u=d.length,l=f.length,u<l&&(a=d,d=f,f=a,s=u,u=l,l=s),a=[],s=u+l,n=s;n--;)a.push(0);for(n=l;--n>=0;){for(e=0,i=u+n;i>n;)o=a[i]+f[n]*d[i-n-1]+e,a[i--]=o%Tr|0,e=o/Tr|0;a[i]=(a[i]+e)%Tr|0}for(;!a[--s];)a.pop();return e?++r:a.shift(),t.d=a,t.e=r,Dt?Ot(t,h.precision):t};_e.toDecimalPlaces=_e.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(us(t,0,Pd),e===void 0?e=n.rounding:us(e,0,8),Ot(r,t+cr(r)+1,e))};_e.toExponential=function(t,e){var r,n=this,i=n.constructor;return t===void 0?r=Al(n,!0):(us(t,0,Pd),e===void 0?e=i.rounding:us(e,0,8),n=Ot(new i(n),t+1,e),r=Al(n,!0,t+1)),r};_e.toFixed=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?Al(i):(us(t,0,Pd),e===void 0?e=a.rounding:us(e,0,8),n=Ot(new a(i),t+cr(i)+1,e),r=Al(n.abs(),!1,t+cr(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};_e.toInteger=_e.toint=function(){var t=this,e=t.constructor;return Ot(new e(t),cr(t)+1,e.rounding)};_e.toNumber=function(){return+this};_e.toPower=_e.pow=function(t){var e,r,n,i,a,s,o=this,u=o.constructor,l=12,c=+(t=new u(t));if(!t.s)return new u(ui);if(o=new u(o),!o.s){if(t.s<1)throw Error(qi+"Infinity");return o}if(o.eq(ui))return o;if(n=u.precision,t.eq(ui))return Ot(o,n);if(e=t.e,r=t.d.length-1,s=e>=r,a=o.s,s){if((r=c<0?-c:c)<=oq){for(i=new u(ui),e=Math.ceil(n/It+4),Dt=!1;r%2&&(i=i.times(o),K2(i.d,e)),r=Ed(r/2),r!==0;)o=o.times(o),K2(o.d,e);return Dt=!0,t.s<0?new u(ui).div(i):Ot(i,n)}}else if(a<0)throw Error(qi+"NaN");return a=a<0&&t.d[Math.max(e,r)]&1?-1:1,o.s=1,Dt=!1,i=t.times(Xp(o,n+l)),Dt=!0,i=lq(i),i.s=a,i};_e.toPrecision=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?(r=cr(i),n=Al(i,r<=a.toExpNeg||r>=a.toExpPos)):(us(t,1,Pd),e===void 0?e=a.rounding:us(e,0,8),i=Ot(new a(i),t,e),r=cr(i),n=Al(i,t<=r||r<=a.toExpNeg,t)),n};_e.toSignificantDigits=_e.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(us(t,1,Pd),e===void 0?e=n.rounding:us(e,0,8)),Ot(new n(r),t,e)};_e.toString=_e.valueOf=_e.val=_e.toJSON=_e[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=cr(t),r=t.constructor;return Al(t,e<=r.toExpNeg||e>=r.toExpPos)};function uq(t,e){var r,n,i,a,s,o,u,l,c=t.constructor,h=c.precision;if(!t.s||!e.s)return e.s||(e=new c(t)),Dt?Ot(e,h):e;if(u=t.d,l=e.d,s=t.e,i=e.e,u=u.slice(),a=s-i,a){for(a<0?(n=u,a=-a,o=l.length):(n=l,i=s,o=u.length),s=Math.ceil(h/It),o=s>o?s+1:o+1,a>o&&(a=o,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(o=u.length,a=l.length,o-a<0&&(a=o,n=l,l=u,u=n),r=0;a;)r=(u[--a]=u[a]+l[a]+r)/Tr|0,u[a]%=Tr;for(r&&(u.unshift(r),++i),o=u.length;u[--o]==0;)u.pop();return e.d=u,e.e=i,Dt?Ot(e,h):e}function us(t,e,r){if(t!==~~t||t<e||t>r)throw Error(dl+t)}function Ga(t){var e,r,n,i=t.length-1,a="",s=t[0];if(i>0){for(a+=s,e=1;e<i;e++)n=t[e]+"",r=It-n.length,r&&(a+=Ro(r)),a+=n;s=t[e],n=s+"",r=It-n.length,r&&(a+=Ro(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return a+s}var Vs=function(){function t(n,i){var a,s=0,o=n.length;for(n=n.slice();o--;)a=n[o]*i+s,n[o]=a%Tr|0,s=a/Tr|0;return s&&n.unshift(s),n}function e(n,i,a,s){var o,u;if(a!=s)u=a>s?1:-1;else for(o=u=0;o<a;o++)if(n[o]!=i[o]){u=n[o]>i[o]?1:-1;break}return u}function r(n,i,a){for(var s=0;a--;)n[a]-=s,s=n[a]<i[a]?1:0,n[a]=s*Tr+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,s){var o,u,l,c,h,d,f,p,m,g,v,y,b,w,_,O,P,x,j=n.constructor,k=n.s==i.s?1:-1,R=n.d,F=i.d;if(!n.s)return new j(n);if(!i.s)throw Error(qi+"Division by zero");for(u=n.e-i.e,P=F.length,_=R.length,f=new j(k),p=f.d=[],l=0;F[l]==(R[l]||0);)++l;if(F[l]>(R[l]||0)&&--u,a==null?y=a=j.precision:s?y=a+(cr(n)-cr(i))+1:y=a,y<0)return new j(0);if(y=y/It+2|0,l=0,P==1)for(c=0,F=F[0],y++;(l<_||c)&&y--;l++)b=c*Tr+(R[l]||0),p[l]=b/F|0,c=b%F|0;else{for(c=Tr/(F[0]+1)|0,c>1&&(F=t(F,c),R=t(R,c),P=F.length,_=R.length),w=P,m=R.slice(0,P),g=m.length;g<P;)m[g++]=0;x=F.slice(),x.unshift(0),O=F[0],F[1]>=Tr/2&&++O;do c=0,o=e(F,m,P,g),o<0?(v=m[0],P!=g&&(v=v*Tr+(m[1]||0)),c=v/O|0,c>1?(c>=Tr&&(c=Tr-1),h=t(F,c),d=h.length,g=m.length,o=e(h,m,d,g),o==1&&(c--,r(h,P<d?x:F,d))):(c==0&&(o=c=1),h=F.slice()),d=h.length,d<g&&h.unshift(0),r(m,h,g),o==-1&&(g=m.length,o=e(F,m,P,g),o<1&&(c++,r(m,P<g?x:F,g))),g=m.length):o===0&&(c++,m=[0]),p[l++]=c,o&&m[0]?m[g++]=R[w]||0:(m=[R[w]],g=1);while((w++<_||m[0]!==void 0)&&y--)}return p[0]||p.shift(),f.e=u,Ot(f,s?a+cr(f)+1:a)}}();function lq(t,e){var r,n,i,a,s,o,u=0,l=0,c=t.constructor,h=c.precision;if(cr(t)>16)throw Error(qk+cr(t));if(!t.s)return new c(ui);for(e==null?(Dt=!1,o=h):o=e,s=new c(.03125);t.abs().gte(.1);)t=t.times(s),l+=5;for(n=Math.log(Bu(2,l))/Math.LN10*2+5|0,o+=n,r=i=a=new c(ui),c.precision=o;;){if(i=Ot(i.times(t),o),r=r.times(++u),s=a.plus(Vs(i,r,o)),Ga(s.d).slice(0,o)===Ga(a.d).slice(0,o)){for(;l--;)a=Ot(a.times(a),o);return c.precision=h,e==null?(Dt=!0,Ot(a,h)):a}a=s}}function cr(t){for(var e=t.e*It,r=t.d[0];r>=10;r/=10)e++;return e}function Bx(t,e,r){if(e>t.LN10.sd())throw Dt=!0,r&&(t.precision=r),Error(qi+"LN10 precision limit exceeded");return Ot(new t(t.LN10),e)}function Ro(t){for(var e="";t--;)e+="0";return e}function Xp(t,e){var r,n,i,a,s,o,u,l,c,h=1,d=10,f=t,p=f.d,m=f.constructor,g=m.precision;if(f.s<1)throw Error(qi+(f.s?"NaN":"-Infinity"));if(f.eq(ui))return new m(0);if(e==null?(Dt=!1,l=g):l=e,f.eq(10))return e==null&&(Dt=!0),Bx(m,l);if(l+=d,m.precision=l,r=Ga(p),n=r.charAt(0),a=cr(f),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)f=f.times(t),r=Ga(f.d),n=r.charAt(0),h++;a=cr(f),n>1?(f=new m("0."+r),a++):f=new m(n+"."+r.slice(1))}else return u=Bx(m,l+2,g).times(a+""),f=Xp(new m(n+"."+r.slice(1)),l-d).plus(u),m.precision=g,e==null?(Dt=!0,Ot(f,g)):f;for(o=s=f=Vs(f.minus(ui),f.plus(ui),l),c=Ot(f.times(f),l),i=3;;){if(s=Ot(s.times(c),l),u=o.plus(Vs(s,new m(i),l)),Ga(u.d).slice(0,l)===Ga(o.d).slice(0,l))return o=o.times(2),a!==0&&(o=o.plus(Bx(m,l+2,g).times(a+""))),o=Vs(o,new m(h),l),m.precision=g,e==null?(Dt=!0,Ot(o,g)):o;o=u,i+=2}}function q2(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(n,i),e){if(i-=n,r=r-n-1,t.e=Ed(r/It),t.d=[],n=(r+1)%It,r<0&&(n+=It),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=It;n<i;)t.d.push(+e.slice(n,n+=It));e=e.slice(n),n=It-e.length}else n-=i;for(;n--;)e+="0";if(t.d.push(+e),Dt&&(t.e>Db||t.e<-Db))throw Error(qk+r)}else t.s=0,t.e=0,t.d=[0];return t}function Ot(t,e,r){var n,i,a,s,o,u,l,c,h=t.d;for(s=1,a=h[0];a>=10;a/=10)s++;if(n=e-s,n<0)n+=It,i=e,l=h[c=0];else{if(c=Math.ceil((n+1)/It),a=h.length,c>=a)return t;for(l=a=h[c],s=1;a>=10;a/=10)s++;n%=It,i=n-It+s}if(r!==void 0&&(a=Bu(10,s-i-1),o=l/a%10|0,u=e<0||h[c+1]!==void 0||l%a,u=r<4?(o||u)&&(r==0||r==(t.s<0?3:2)):o>5||o==5&&(r==4||u||r==6&&(n>0?i>0?l/Bu(10,s-i):0:h[c-1])%10&1||r==(t.s<0?8:7))),e<1||!h[0])return u?(a=cr(t),h.length=1,e=e-a-1,h[0]=Bu(10,(It-e%It)%It),t.e=Ed(-e/It)||0):(h.length=1,h[0]=t.e=t.s=0),t;if(n==0?(h.length=c,a=1,c--):(h.length=c+1,a=Bu(10,It-n),h[c]=i>0?(l/Bu(10,s-i)%Bu(10,i)|0)*a:0),u)for(;;)if(c==0){(h[0]+=a)==Tr&&(h[0]=1,++t.e);break}else{if(h[c]+=a,h[c]!=Tr)break;h[c--]=0,a=1}for(n=h.length;h[--n]===0;)h.pop();if(Dt&&(t.e>Db||t.e<-Db))throw Error(qk+cr(t));return t}function cq(t,e){var r,n,i,a,s,o,u,l,c,h,d=t.constructor,f=d.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new d(t),Dt?Ot(e,f):e;if(u=t.d,h=e.d,n=e.e,l=t.e,u=u.slice(),s=l-n,s){for(c=s<0,c?(r=u,s=-s,o=h.length):(r=h,n=l,o=u.length),i=Math.max(Math.ceil(f/It),o)+2,s>i&&(s=i,r.length=1),r.reverse(),i=s;i--;)r.push(0);r.reverse()}else{for(i=u.length,o=h.length,c=i<o,c&&(o=i),i=0;i<o;i++)if(u[i]!=h[i]){c=u[i]<h[i];break}s=0}for(c&&(r=u,u=h,h=r,e.s=-e.s),o=u.length,i=h.length-o;i>0;--i)u[o++]=0;for(i=h.length;i>s;){if(u[--i]<h[i]){for(a=i;a&&u[--a]===0;)u[a]=Tr-1;--u[a],u[i]+=Tr}u[i]-=h[i]}for(;u[--o]===0;)u.pop();for(;u[0]===0;u.shift())--n;return u[0]?(e.d=u,e.e=n,Dt?Ot(e,f):e):new d(0)}function Al(t,e,r){var n,i=cr(t),a=Ga(t.d),s=a.length;return e?(r&&(n=r-s)>0?a=a.charAt(0)+"."+a.slice(1)+Ro(n):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+Ro(-i-1)+a,r&&(n=r-s)>0&&(a+=Ro(n))):i>=s?(a+=Ro(i+1-s),r&&(n=r-i-1)>0&&(a=a+"."+Ro(n))):((n=i+1)<s&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-s)>0&&(i+1===s&&(a+="."),a+=Ro(n))),t.s<0?"-"+a:a}function K2(t,e){if(t.length>e)return t.length=e,!0}function hq(t){var e,r,n;function i(a){var s=this;if(!(s instanceof i))return new i(a);if(s.constructor=i,a instanceof i){s.s=a.s,s.e=a.e,s.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(dl+a);if(a>0)s.s=1;else if(a<0)a=-a,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(a===~~a&&a<1e7){s.e=0,s.d=[a];return}return q2(s,a.toString())}else if(typeof a!="string")throw Error(dl+a);if(a.charCodeAt(0)===45?(a=a.slice(1),s.s=-1):s.s=1,Owe.test(a))q2(s,a);else throw Error(dl+a)}if(i.prototype=_e,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=hq,i.config=i.set=Swe,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return i.config(t),i}function Swe(t){if(!t||typeof t!="object")throw Error(qi+"Object expected");var e,r,n,i=["precision",1,Pd,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((n=t[r=i[e]])!==void 0)if(Ed(n)===n&&n>=i[e+1]&&n<=i[e+2])this[r]=n;else throw Error(dl+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(dl+r+": "+n);return this}var Kk=hq(xwe);ui=new Kk(1);const vt=Kk;function Pwe(t){return kwe(t)||Twe(t)||Awe(t)||Ewe()}function Ewe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Awe(t,e){if(t){if(typeof t=="string")return JP(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JP(t,e)}}function Twe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function kwe(t){if(Array.isArray(t))return JP(t)}function JP(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Cwe=function(e){return e},dq={"@@functional/placeholder":!0},fq=function(e){return e===dq},V2=function(e){return function r(){return arguments.length===0||arguments.length===1&&fq(arguments.length<=0?void 0:arguments[0])?r:e.apply(void 0,arguments)}},Iwe=function t(e,r){return e===1?r:V2(function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=i.filter(function(o){return o!==dq}).length;return s>=e?r.apply(void 0,i):t(e-s,V2(function(){for(var o=arguments.length,u=new Array(o),l=0;l<o;l++)u[l]=arguments[l];var c=i.map(function(h){return fq(h)?u.shift():h});return r.apply(void 0,Pwe(c).concat(u))}))})},S_=function(e){return Iwe(e.length,e)},ZP=function(e,r){for(var n=[],i=e;i<r;++i)n[i-e]=i;return n},$we=S_(function(t,e){return Array.isArray(e)?e.map(t):Object.keys(e).map(function(r){return e[r]}).map(t)}),jwe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return Cwe;var i=r.reverse(),a=i[0],s=i.slice(1);return function(){return s.reduce(function(o,u){return u(o)},a.apply(void 0,arguments))}},XP=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},pq=function(e){var r=null,n=null;return function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r&&a.every(function(o,u){return o===r[u]})||(r=a,n=e.apply(void 0,a)),n}};function Rwe(t){var e;return t===0?e=1:e=Math.floor(new vt(t).abs().log(10).toNumber())+1,e}function Nwe(t,e,r){for(var n=new vt(t),i=0,a=[];n.lt(e)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}var Mwe=S_(function(t,e,r){var n=+t,i=+e;return n+r*(i-n)}),Dwe=S_(function(t,e,r){var n=e-+t;return n=n||1/0,(r-t)/n}),Lwe=S_(function(t,e,r){var n=e-+t;return n=n||1/0,Math.max(0,Math.min(1,(r-t)/n))});const P_={rangeStep:Nwe,getDigitCount:Rwe,interpolateNumber:Mwe,uninterpolateNumber:Dwe,uninterpolateTruncation:Lwe};function QP(t){return zwe(t)||Uwe(t)||mq(t)||Fwe()}function Fwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uwe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function zwe(t){if(Array.isArray(t))return eE(t)}function Qp(t,e){return Kwe(t)||qwe(t,e)||mq(t,e)||Bwe()}function Bwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mq(t,e){if(t){if(typeof t=="string")return eE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eE(t,e)}}function eE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function qwe(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var r=[],n=!0,i=!1,a=void 0;try{for(var s=t[Symbol.iterator](),o;!(n=(o=s.next()).done)&&(r.push(o.value),!(e&&r.length===e));n=!0);}catch(u){i=!0,a=u}finally{try{!n&&s.return!=null&&s.return()}finally{if(i)throw a}}return r}}function Kwe(t){if(Array.isArray(t))return t}function gq(t){var e=Qp(t,2),r=e[0],n=e[1],i=r,a=n;return r>n&&(i=n,a=r),[i,a]}function yq(t,e,r){if(t.lte(0))return new vt(0);var n=P_.getDigitCount(t.toNumber()),i=new vt(10).pow(n),a=t.div(i),s=n!==1?.05:.1,o=new vt(Math.ceil(a.div(s).toNumber())).add(r).mul(s),u=o.mul(i);return e?u:new vt(Math.ceil(u))}function Vwe(t,e,r){var n=1,i=new vt(t);if(!i.isint()&&r){var a=Math.abs(t);a<1?(n=new vt(10).pow(P_.getDigitCount(t)-1),i=new vt(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new vt(Math.floor(t)))}else t===0?i=new vt(Math.floor((e-1)/2)):r||(i=new vt(Math.floor(t)));var s=Math.floor((e-1)/2),o=jwe($we(function(u){return i.add(new vt(u-s).mul(n)).toNumber()}),ZP);return o(0,e)}function vq(t,e,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((e-t)/(r-1)))return{step:new vt(0),tickMin:new vt(0),tickMax:new vt(0)};var a=yq(new vt(e).sub(t).div(r-1),n,i),s;t<=0&&e>=0?s=new vt(0):(s=new vt(t).add(e).div(2),s=s.sub(new vt(s).mod(a)));var o=Math.ceil(s.sub(t).div(a).toNumber()),u=Math.ceil(new vt(e).sub(s).div(a).toNumber()),l=o+u+1;return l>r?vq(t,e,r,n,i+1):(l<r&&(u=e>0?u+(r-l):u,o=e>0?o:o+(r-l)),{step:a,tickMin:s.sub(new vt(o).mul(a)),tickMax:s.add(new vt(u).mul(a))})}function Hwe(t){var e=Qp(t,2),r=e[0],n=e[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(i,2),o=gq([r,n]),u=Qp(o,2),l=u[0],c=u[1];if(l===-1/0||c===1/0){var h=c===1/0?[l].concat(QP(ZP(0,i-1).map(function(){return 1/0}))):[].concat(QP(ZP(0,i-1).map(function(){return-1/0})),[c]);return r>n?XP(h):h}if(l===c)return Vwe(l,i,a);var d=vq(l,c,s,a),f=d.step,p=d.tickMin,m=d.tickMax,g=P_.rangeStep(p,m.add(new vt(.1).mul(f)),f);return r>n?XP(g):g}function Wwe(t,e){var r=Qp(t,2),n=r[0],i=r[1],a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=gq([n,i]),o=Qp(s,2),u=o[0],l=o[1];if(u===-1/0||l===1/0)return[n,i];if(u===l)return[u];var c=Math.max(e,2),h=yq(new vt(l).sub(u).div(c-1),a,0),d=[].concat(QP(P_.rangeStep(new vt(u),new vt(l).sub(new vt(.99).mul(h)),h)),[l]);return n>i?XP(d):d}var Gwe=pq(Hwe),Ywe=pq(Wwe),Jwe=!0,qx="Invariant failed";function Tl(t,e){if(!t){if(Jwe)throw new Error(qx);var r=typeof e=="function"?e():e,n=r?"".concat(qx,": ").concat(r):qx;throw new Error(n)}}var Zwe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Lb(){return Lb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Lb.apply(this,arguments)}function Xwe(t,e){return r0e(t)||t0e(t,e)||e0e(t,e)||Qwe()}function Qwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e0e(t,e){if(t){if(typeof t=="string")return H2(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H2(t,e)}}function H2(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function t0e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw i}}return o}}function r0e(t){if(Array.isArray(t))return t}function n0e(t,e){if(t==null)return{};var r=i0e(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function i0e(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function E_(t){var e=t.offset,r=t.layout,n=t.width,i=t.dataKey,a=t.data,s=t.dataPointFormatter,o=t.xAxis,u=t.yAxis,l=n0e(t,Zwe),c=$e(l,!1);t.direction==="x"&&o.type!=="number"&&Tl(!1);var h=a.map(function(d){var f=s(d,i),p=f.x,m=f.y,g=f.value,v=f.errorVal;if(!v)return null;var y=[],b,w;if(Array.isArray(v)){var _=Xwe(v,2);b=_[0],w=_[1]}else b=w=v;if(r==="vertical"){var O=o.scale,P=m+e,x=P+n,j=P-n,k=O(g-b),R=O(g+w);y.push({x1:R,y1:x,x2:R,y2:j}),y.push({x1:k,y1:P,x2:R,y2:P}),y.push({x1:k,y1:x,x2:k,y2:j})}else if(r==="horizontal"){var F=u.scale,z=p+e,N=z-n,L=z+n,D=F(g-b),q=F(g+w);y.push({x1:N,y1:q,x2:L,y2:q}),y.push({x1:z,y1:D,x2:z,y2:q}),y.push({x1:N,y1:D,x2:L,y2:D})}return $.createElement(Ye,Lb({className:"recharts-errorBar",key:"bar-".concat(y.map(function(M){return"".concat(M.x1,"-").concat(M.x2,"-").concat(M.y1,"-").concat(M.y2)}))},c),y.map(function(M){return $.createElement("line",Lb({},M,{key:"line-".concat(M.x1,"-").concat(M.x2,"-").concat(M.y1,"-").concat(M.y2)}))}))});return $.createElement(Ye,{className:"recharts-errorBars"},h)}E_.defaultProps={stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"};E_.displayName="ErrorBar";function em(t){return em=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},em(t)}function W2(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Kx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?W2(Object(r),!0).forEach(function(n){a0e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):W2(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function a0e(t,e,r){return e=s0e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s0e(t){var e=o0e(t,"string");return em(e)=="symbol"?e:String(e)}function o0e(t,e){if(em(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(em(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bq=function(e){var r=e.children,n=e.formattedGraphicalItems,i=e.legendWidth,a=e.legendContent,s=si(r,kh);if(!s)return null;var o;return s.props&&s.props.payload?o=s.props&&s.props.payload:a==="children"?o=(n||[]).reduce(function(u,l){var c=l.item,h=l.props,d=h.sectors||h.data||[];return u.concat(d.map(function(f){return{type:s.props.iconType||c.props.legendType,value:f.name,color:f.fill,payload:f}}))},[]):o=(n||[]).map(function(u){var l=u.item,c=l.props,h=c.dataKey,d=c.name,f=c.legendType,p=c.hide;return{inactive:p,dataKey:h,type:s.props.iconType||f||"square",color:Vk(l),value:d||h,payload:l.props}}),Kx(Kx(Kx({},s.props),kh.getWithHeight(s,i)),{},{payload:o,item:s})};function tm(t){return tm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tm(t)}function G2(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ii(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?G2(Object(r),!0).forEach(function(n){sh(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):G2(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function sh(t,e,r){return e=u0e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u0e(t){var e=l0e(t,"string");return tm(e)=="symbol"?e:String(e)}function l0e(t,e){if(tm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(tm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Y2(t){return f0e(t)||d0e(t)||h0e(t)||c0e()}function c0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h0e(t,e){if(t){if(typeof t=="string")return tE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tE(t,e)}}function d0e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function f0e(t){if(Array.isArray(t))return tE(t)}function tE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function gr(t,e,r){return De(t)||De(e)?r:vr(e)?di(t,e,r):Ne(e)?e(t):r}function up(t,e,r,n){var i=vwe(t,function(o){return gr(o,e)});if(r==="number"){var a=i.filter(function(o){return fe(o)||parseFloat(o)});return a.length?[O_(a),Vo(a)]:[1/0,-1/0]}var s=n?i.filter(function(o){return!De(o)}):i;return s.map(function(o){return vr(o)||o instanceof Date?o:""})}var p0e=function(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,s=-1,o=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(o<=1)return 0;if(a&&a.axisType==="angleAxis"&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var u=a.range,l=0;l<o;l++){var c=l>0?i[l-1].coordinate:i[o-1].coordinate,h=i[l].coordinate,d=l>=o-1?i[0].coordinate:i[l+1].coordinate,f=void 0;if(Sn(h-c)!==Sn(d-h)){var p=[];if(Sn(d-h)===Sn(u[1]-u[0])){f=d;var m=h+u[1]-u[0];p[0]=Math.min(m,(m+c)/2),p[1]=Math.max(m,(m+c)/2)}else{f=c;var g=d+u[1]-u[0];p[0]=Math.min(h,(g+h)/2),p[1]=Math.max(h,(g+h)/2)}var v=[Math.min(h,(f+h)/2),Math.max(h,(f+h)/2)];if(e>v[0]&&e<=v[1]||e>=p[0]&&e<=p[1]){s=i[l].index;break}}else{var y=Math.min(c,d),b=Math.max(c,d);if(e>(y+h)/2&&e<=(b+h)/2){s=i[l].index;break}}}else for(var w=0;w<o;w++)if(w===0&&e<=(n[w].coordinate+n[w+1].coordinate)/2||w>0&&w<o-1&&e>(n[w].coordinate+n[w-1].coordinate)/2&&e<=(n[w].coordinate+n[w+1].coordinate)/2||w===o-1&&e>(n[w].coordinate+n[w-1].coordinate)/2){s=n[w].index;break}return s},Vk=function(e){var r=e,n=r.type.displayName,i=e.props,a=i.stroke,s=i.fill,o;switch(n){case"Line":o=a;break;case"Area":case"Radar":o=a&&a!=="none"?a:s;break;default:o=s;break}return o},m0e=function(e){var r=e.barSize,n=e.totalSize,i=e.stackGroups,a=i===void 0?{}:i;if(!a)return{};for(var s={},o=Object.keys(a),u=0,l=o.length;u<l;u++)for(var c=a[o[u]].stackGroups,h=Object.keys(c),d=0,f=h.length;d<f;d++){var p=c[h[d]],m=p.items,g=p.cateAxisId,v=m.filter(function(_){return Ks(_.type).indexOf("Bar")>=0});if(v&&v.length){var y=v[0].props.barSize,b=v[0].props[g];s[b]||(s[b]=[]);var w=De(y)?r:y;s[b].push({item:v[0],stackList:v.slice(1),barSize:De(w)?void 0:Pn(w,n,0)})}}return s},g0e=function(e){var r=e.barGap,n=e.barCategoryGap,i=e.bandSize,a=e.sizeList,s=a===void 0?[]:a,o=e.maxBarSize,u=s.length;if(u<1)return null;var l=Pn(r,i,0,!0),c,h=[];if(s[0].barSize===+s[0].barSize){var d=!1,f=i/u,p=s.reduce(function(w,_){return w+_.barSize||0},0);p+=(u-1)*l,p>=i&&(p-=(u-1)*l,l=0),p>=i&&f>0&&(d=!0,f*=.9,p=u*f);var m=(i-p)/2>>0,g={offset:m-l,size:0};c=s.reduce(function(w,_){var O={item:_.item,position:{offset:g.offset+g.size+l,size:d?f:_.barSize}},P=[].concat(Y2(w),[O]);return g=P[P.length-1].position,_.stackList&&_.stackList.length&&_.stackList.forEach(function(x){P.push({item:x,position:g})}),P},h)}else{var v=Pn(n,i,0,!0);i-2*v-(u-1)*l<=0&&(l=0);var y=(i-2*v-(u-1)*l)/u;y>1&&(y>>=0);var b=o===+o?Math.min(y,o):y;c=s.reduce(function(w,_,O){var P=[].concat(Y2(w),[{item:_.item,position:{offset:v+(y+l)*O+(y-b)/2,size:b}}]);return _.stackList&&_.stackList.length&&_.stackList.forEach(function(x){P.push({item:x,position:P[P.length-1].position})}),P},h)}return c},y0e=function(e,r,n,i){var a=n.children,s=n.width,o=n.margin,u=s-(o.left||0)-(o.right||0),l=bq({children:a,legendWidth:u});if(l){var c=i||{},h=c.width,d=c.height,f=l.align,p=l.verticalAlign,m=l.layout;if((m==="vertical"||m==="horizontal"&&p==="middle")&&f!=="center"&&fe(e[f]))return Ii(Ii({},e),{},sh({},f,e[f]+(h||0)));if((m==="horizontal"||m==="vertical"&&f==="center")&&p!=="middle"&&fe(e[p]))return Ii(Ii({},e),{},sh({},p,e[p]+(d||0)))}return e},v0e=function(e,r,n){return De(r)?!0:e==="horizontal"?r==="yAxis":e==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},wq=function(e,r,n,i,a){var s=r.props.children,o=Fi(s,E_).filter(function(l){return v0e(i,a,l.props.direction)});if(o&&o.length){var u=o.map(function(l){return l.props.dataKey});return e.reduce(function(l,c){var h=gr(c,n);if(De(h))return l;var d=Array.isArray(h)?[O_(h),Vo(h)]:[h,h],f=u.reduce(function(p,m){var g=gr(c,m,0),v=d[0]-Math.abs(Array.isArray(g)?g[0]:g),y=d[1]+Math.abs(Array.isArray(g)?g[1]:g);return[Math.min(v,p[0]),Math.max(y,p[1])]},[1/0,-1/0]);return[Math.min(f[0],l[0]),Math.max(f[1],l[1])]},[1/0,-1/0])}return null},b0e=function(e,r,n,i,a){var s=r.map(function(o){return wq(e,o,n,a,i)}).filter(function(o){return!De(o)});return s&&s.length?s.reduce(function(o,u){return[Math.min(o[0],u[0]),Math.max(o[1],u[1])]},[1/0,-1/0]):null},_q=function(e,r,n,i,a){var s=r.map(function(u){var l=u.props.dataKey;return n==="number"&&l&&wq(e,u,l,i)||up(e,l,n,a)});if(n==="number")return s.reduce(function(u,l){return[Math.min(u[0],l[0]),Math.max(u[1],l[1])]},[1/0,-1/0]);var o={};return s.reduce(function(u,l){for(var c=0,h=l.length;c<h;c++)o[l[c]]||(o[l[c]]=!0,u.push(l[c]));return u},[])},xq=function(e,r){return e==="horizontal"&&r==="xAxis"||e==="vertical"&&r==="yAxis"||e==="centric"&&r==="angleAxis"||e==="radial"&&r==="radiusAxis"},Oq=function(e,r,n,i){if(i)return e.map(function(u){return u.coordinate});var a,s,o=e.map(function(u){return u.coordinate===r&&(a=!0),u.coordinate===n&&(s=!0),u.coordinate});return a||o.push(r),s||o.push(n),o},Us=function(e,r,n){if(!e)return null;var i=e.scale,a=e.duplicateDomain,s=e.type,o=e.range,u=e.realScaleType==="scaleBand"?i.bandwidth()/2:2,l=(r||n)&&s==="category"&&i.bandwidth?i.bandwidth()/u:0;if(l=e.axisType==="angleAxis"&&(o==null?void 0:o.length)>=2?Sn(o[0]-o[1])*2*l:l,r&&(e.ticks||e.niceTicks)){var c=(e.ticks||e.niceTicks).map(function(h){var d=a?a.indexOf(h):h;return{coordinate:i(d)+l,value:h,offset:l}});return c.filter(function(h){return!bd(h.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(h,d){return{coordinate:i(h)+l,value:h,index:d,offset:l}}):i.ticks&&!n?i.ticks(e.tickCount).map(function(h){return{coordinate:i(h)+l,value:h,offset:l}}):i.domain().map(function(h,d){return{coordinate:i(h)+l,value:a?a[h]:h,index:d,offset:l}})},Vx=new WeakMap,Ty=function(e,r){if(typeof r!="function")return e;Vx.has(e)||Vx.set(e,new WeakMap);var n=Vx.get(e);if(n.has(r))return n.get(r);var i=function(){e.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,i),i},Sq=function(e,r,n){var i=e.scale,a=e.type,s=e.layout,o=e.axisType;if(i==="auto")return s==="radial"&&o==="radiusAxis"?{scale:Wp(),realScaleType:"band"}:s==="radial"&&o==="angleAxis"?{scale:jb(),realScaleType:"linear"}:a==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:op(),realScaleType:"point"}:a==="category"?{scale:Wp(),realScaleType:"band"}:{scale:jb(),realScaleType:"linear"};if(mg(i)){var u="scale".concat(u_(i));return{scale:(B2[u]||op)(),realScaleType:B2[u]?u:"point"}}return Ne(i)?{scale:i}:{scale:op(),realScaleType:"point"}},J2=1e-4,Pq=function(e){var r=e.domain();if(!(!r||r.length<=2)){var n=r.length,i=e.range(),a=Math.min(i[0],i[1])-J2,s=Math.max(i[0],i[1])+J2,o=e(r[0]),u=e(r[n-1]);(o<a||o>s||u<a||u>s)&&e.domain([r[0],r[n-1]])}},w0e=function(e,r){if(!e)return null;for(var n=0,i=e.length;n<i;n++)if(e[n].item===r)return e[n].position;return null},_0e=function(e,r){if(!r||r.length!==2||!fe(r[0])||!fe(r[1]))return e;var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]),a=[e[0],e[1]];return(!fe(e[0])||e[0]<n)&&(a[0]=n),(!fe(e[1])||e[1]>i)&&(a[1]=i),a[0]>i&&(a[0]=i),a[1]<n&&(a[1]=n),a},x0e=function(e){var r=e.length;if(!(r<=0))for(var n=0,i=e[0].length;n<i;++n)for(var a=0,s=0,o=0;o<r;++o){var u=bd(e[o][n][1])?e[o][n][0]:e[o][n][1];u>=0?(e[o][n][0]=a,e[o][n][1]=a+u,a=e[o][n][1]):(e[o][n][0]=s,e[o][n][1]=s+u,s=e[o][n][1])}},O0e=function(e){var r=e.length;if(!(r<=0))for(var n=0,i=e[0].length;n<i;++n)for(var a=0,s=0;s<r;++s){var o=bd(e[s][n][1])?e[s][n][0]:e[s][n][1];o>=0?(e[s][n][0]=a,e[s][n][1]=a+o,a=e[s][n][1]):(e[s][n][0]=0,e[s][n][1]=0)}},S0e={sign:x0e,expand:tue,none:Eh,silhouette:rue,wiggle:nue,positive:O0e},P0e=function(e,r,n){var i=r.map(function(o){return o.props.dataKey}),a=S0e[n],s=eue().keys(i).value(function(o,u){return+gr(o,u,0)}).order(EP).offset(a);return s(e)},E0e=function(e,r,n,i,a,s){if(!e)return null;var o=s?r.reverse():r,u={},l=o.reduce(function(h,d){var f=d.props,p=f.stackId,m=f.hide;if(m)return h;var g=d.props[n],v=h[g]||{hasStack:!1,stackGroups:{}};if(vr(p)){var y=v.stackGroups[p]||{numericAxisId:n,cateAxisId:i,items:[]};y.items.push(d),v.hasStack=!0,v.stackGroups[p]=y}else v.stackGroups[wd("_stackId_")]={numericAxisId:n,cateAxisId:i,items:[d]};return Ii(Ii({},h),{},sh({},g,v))},u),c={};return Object.keys(l).reduce(function(h,d){var f=l[d];if(f.hasStack){var p={};f.stackGroups=Object.keys(f.stackGroups).reduce(function(m,g){var v=f.stackGroups[g];return Ii(Ii({},m),{},sh({},g,{numericAxisId:n,cateAxisId:i,items:v.items,stackedData:P0e(e,v.items,a)}))},p)}return Ii(Ii({},h),{},sh({},d,f))},c)},Eq=function(e,r){var n=r.realScaleType,i=r.type,a=r.tickCount,s=r.originalDomain,o=r.allowDecimals,u=n||r.scale;if(u!=="auto"&&u!=="linear")return null;if(a&&i==="number"&&s&&(s[0]==="auto"||s[1]==="auto")){var l=e.domain();if(!l.length)return null;var c=Gwe(l,a,o);return e.domain([O_(c),Vo(c)]),{niceTicks:c}}if(a&&i==="number"){var h=e.domain(),d=Ywe(h,a,o);return{niceTicks:d}}return null};function Z2(t){var e=t.axis,r=t.ticks,n=t.bandSize,i=t.entry,a=t.index,s=t.dataKey;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!De(i[e.dataKey])){var o=db(r,"value",i[e.dataKey]);if(o)return o.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var u=gr(i,De(s)?e.dataKey:s);return De(u)?null:e.scale(u)}var X2=function(e){var r=e.axis,n=e.ticks,i=e.offset,a=e.bandSize,s=e.entry,o=e.index;if(r.type==="category")return n[o]?n[o].coordinate+i:null;var u=gr(s,r.dataKey,r.domain[o]);return De(u)?null:r.scale(u)-a/2+i},A0e=function(e){var r=e.numericAxis,n=r.scale.domain();if(r.type==="number"){var i=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return i<=0&&a>=0?0:a<0?a:i}return n[0]},T0e=function(e,r){var n=e.props.stackId;if(vr(n)){var i=r[n];if(i){var a=i.items.indexOf(e);return a>=0?i.stackedData[a]:null}}return null},k0e=function(e){return e.reduce(function(r,n){return[O_(n.concat([r[0]]).filter(fe)),Vo(n.concat([r[1]]).filter(fe))]},[1/0,-1/0])},Aq=function(e,r,n){return Object.keys(e).reduce(function(i,a){var s=e[a],o=s.stackedData,u=o.reduce(function(l,c){var h=k0e(c.slice(r,n+1));return[Math.min(l[0],h[0]),Math.max(l[1],h[1])]},[1/0,-1/0]);return[Math.min(u[0],i[0]),Math.max(u[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},Q2=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,eM=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,rE=function(e,r,n){if(Ne(e))return e(r,n);if(!Array.isArray(e))return r;var i=[];if(fe(e[0]))i[0]=n?e[0]:Math.min(e[0],r[0]);else if(Q2.test(e[0])){var a=+Q2.exec(e[0])[1];i[0]=r[0]-a}else Ne(e[0])?i[0]=e[0](r[0]):i[0]=r[0];if(fe(e[1]))i[1]=n?e[1]:Math.max(e[1],r[1]);else if(eM.test(e[1])){var s=+eM.exec(e[1])[1];i[1]=r[1]+s}else Ne(e[1])?i[1]=e[1](r[1]):i[1]=r[1];return i},Fb=function(e,r,n){if(e&&e.scale&&e.scale.bandwidth){var i=e.scale.bandwidth();if(!n||i>0)return i}if(e&&r&&r.length>=2){for(var a=bk(r,function(h){return h.coordinate}),s=1/0,o=1,u=a.length;o<u;o++){var l=a[o],c=a[o-1];s=Math.min((l.coordinate||0)-(c.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0},tM=function(e,r,n){return!e||!e.length||Nh(e,di(n,"type.defaultProps.domain"))?r:e},Tq=function(e,r){var n=e.props,i=n.dataKey,a=n.name,s=n.unit,o=n.formatter,u=n.tooltipType,l=n.chartType,c=n.hide;return Ii(Ii({},$e(e,!1)),{},{dataKey:i,unit:s,formatter:o,name:a||i,color:Vk(e),value:gr(r,i),type:u,payload:r,chartType:l,hide:c})};function rm(t){return rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rm(t)}function rM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function js(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rM(Object(r),!0).forEach(function(n){kq(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function kq(t,e,r){return e=C0e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function C0e(t){var e=I0e(t,"string");return rm(e)=="symbol"?e:String(e)}function I0e(t,e){if(rm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(rm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $0e(t,e){return M0e(t)||N0e(t,e)||R0e(t,e)||j0e()}function j0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R0e(t,e){if(t){if(typeof t=="string")return nM(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nM(t,e)}}function nM(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function N0e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw i}}return o}}function M0e(t){if(Array.isArray(t))return t}var Ub=Math.PI/180,D0e=function(e){return e*180/Math.PI},Tt=function(e,r,n,i){return{x:e+Math.cos(-Ub*i)*n,y:r+Math.sin(-Ub*i)*n}},Cq=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},L0e=function(e,r,n,i,a){var s=e.width,o=e.height,u=e.startAngle,l=e.endAngle,c=Pn(e.cx,s,s/2),h=Pn(e.cy,o,o/2),d=Cq(s,o,n),f=Pn(e.innerRadius,d,0),p=Pn(e.outerRadius,d,d*.8),m=Object.keys(r);return m.reduce(function(g,v){var y=r[v],b=y.domain,w=y.reversed,_;if(De(y.range))i==="angleAxis"?_=[u,l]:i==="radiusAxis"&&(_=[f,p]),w&&(_=[_[1],_[0]]);else{_=y.range;var O=_,P=$0e(O,2);u=P[0],l=P[1]}var x=Sq(y,a),j=x.realScaleType,k=x.scale;k.domain(b).range(_),Pq(k);var R=Eq(k,js(js({},y),{},{realScaleType:j})),F=js(js(js({},y),R),{},{range:_,radius:p,realScaleType:j,scale:k,cx:c,cy:h,innerRadius:f,outerRadius:p,startAngle:u,endAngle:l});return js(js({},g),{},kq({},v,F))},{})},F0e=function(e,r){var n=e.x,i=e.y,a=r.x,s=r.y;return Math.sqrt(Math.pow(n-a,2)+Math.pow(i-s,2))},U0e=function(e,r){var n=e.x,i=e.y,a=r.cx,s=r.cy,o=F0e({x:n,y:i},{x:a,y:s});if(o<=0)return{radius:o};var u=(n-a)/o,l=Math.acos(u);return i>s&&(l=2*Math.PI-l),{radius:o,angle:D0e(l),angleInRadian:l}},z0e=function(e){var r=e.startAngle,n=e.endAngle,i=Math.floor(r/360),a=Math.floor(n/360),s=Math.min(i,a);return{startAngle:r-s*360,endAngle:n-s*360}},B0e=function(e,r){var n=r.startAngle,i=r.endAngle,a=Math.floor(n/360),s=Math.floor(i/360),o=Math.min(a,s);return e+o*360},iM=function(e,r){var n=e.x,i=e.y,a=U0e({x:n,y:i},r),s=a.radius,o=a.angle,u=r.innerRadius,l=r.outerRadius;if(s<u||s>l)return!1;if(s===0)return!0;var c=z0e(r),h=c.startAngle,d=c.endAngle,f=o,p;if(h<=d){for(;f>d;)f-=360;for(;f<h;)f+=360;p=f>=h&&f<=d}else{for(;f>h;)f-=360;for(;f<d;)f+=360;p=f>=d&&f<=h}return p?js(js({},r),{},{radius:s,angle:B0e(f,r)}):null},Iq=function(e){return!I.isValidElement(e)&&!Ne(e)&&typeof e!="boolean"?e.className:""};function nm(t){return nm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nm(t)}var q0e=["offset"];function K0e(t){return G0e(t)||W0e(t)||H0e(t)||V0e()}function V0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H0e(t,e){if(t){if(typeof t=="string")return nE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nE(t,e)}}function W0e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function G0e(t){if(Array.isArray(t))return nE(t)}function nE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Y0e(t,e){if(t==null)return{};var r=J0e(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function J0e(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function aM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function dr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?aM(Object(r),!0).forEach(function(n){Z0e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):aM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Z0e(t,e,r){return e=X0e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function X0e(t){var e=Q0e(t,"string");return nm(e)=="symbol"?e:String(e)}function Q0e(t,e){if(nm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(nm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function im(){return im=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},im.apply(this,arguments)}var e_e=function(e){var r=e.value,n=e.formatter,i=De(e.children)?r:e.children;return Ne(n)?n(i):i},t_e=function(e,r){var n=Sn(r-e),i=Math.min(Math.abs(r-e),360);return n*i},r_e=function(e,r,n){var i=e.position,a=e.viewBox,s=e.offset,o=e.className,u=a,l=u.cx,c=u.cy,h=u.innerRadius,d=u.outerRadius,f=u.startAngle,p=u.endAngle,m=u.clockWise,g=(h+d)/2,v=t_e(f,p),y=v>=0?1:-1,b,w;i==="insideStart"?(b=f+y*s,w=m):i==="insideEnd"?(b=p-y*s,w=!m):i==="end"&&(b=p+y*s,w=m),w=v<=0?w:!w;var _=Tt(l,c,g,b),O=Tt(l,c,g,b+(w?1:-1)*359),P="M".concat(_.x,",").concat(_.y,`
    A`).concat(g,",").concat(g,",0,1,").concat(w?0:1,`,
    `).concat(O.x,",").concat(O.y),x=De(e.id)?wd("recharts-radial-line-"):e.id;return $.createElement("text",im({},n,{dominantBaseline:"central",className:ze("recharts-radial-bar-label",o)}),$.createElement("defs",null,$.createElement("path",{id:x,d:P})),$.createElement("textPath",{xlinkHref:"#".concat(x)},r))},n_e=function(e){var r=e.viewBox,n=e.offset,i=e.position,a=r,s=a.cx,o=a.cy,u=a.innerRadius,l=a.outerRadius,c=a.startAngle,h=a.endAngle,d=(c+h)/2;if(i==="outside"){var f=Tt(s,o,l+n,d),p=f.x,m=f.y;return{x:p,y:m,textAnchor:p>=s?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"end"};var g=(u+l)/2,v=Tt(s,o,g,d),y=v.x,b=v.y;return{x:y,y:b,textAnchor:"middle",verticalAnchor:"middle"}},i_e=function(e){var r=e.viewBox,n=e.parentViewBox,i=e.offset,a=e.position,s=r,o=s.x,u=s.y,l=s.width,c=s.height,h=c>=0?1:-1,d=h*i,f=h>0?"end":"start",p=h>0?"start":"end",m=l>=0?1:-1,g=m*i,v=m>0?"end":"start",y=m>0?"start":"end";if(a==="top"){var b={x:o+l/2,y:u-h*i,textAnchor:"middle",verticalAnchor:f};return dr(dr({},b),n?{height:Math.max(u-n.y,0),width:l}:{})}if(a==="bottom"){var w={x:o+l/2,y:u+c+d,textAnchor:"middle",verticalAnchor:p};return dr(dr({},w),n?{height:Math.max(n.y+n.height-(u+c),0),width:l}:{})}if(a==="left"){var _={x:o-g,y:u+c/2,textAnchor:v,verticalAnchor:"middle"};return dr(dr({},_),n?{width:Math.max(_.x-n.x,0),height:c}:{})}if(a==="right"){var O={x:o+l+g,y:u+c/2,textAnchor:y,verticalAnchor:"middle"};return dr(dr({},O),n?{width:Math.max(n.x+n.width-O.x,0),height:c}:{})}var P=n?{width:l,height:c}:{};return a==="insideLeft"?dr({x:o+g,y:u+c/2,textAnchor:y,verticalAnchor:"middle"},P):a==="insideRight"?dr({x:o+l-g,y:u+c/2,textAnchor:v,verticalAnchor:"middle"},P):a==="insideTop"?dr({x:o+l/2,y:u+d,textAnchor:"middle",verticalAnchor:p},P):a==="insideBottom"?dr({x:o+l/2,y:u+c-d,textAnchor:"middle",verticalAnchor:f},P):a==="insideTopLeft"?dr({x:o+g,y:u+d,textAnchor:y,verticalAnchor:p},P):a==="insideTopRight"?dr({x:o+l-g,y:u+d,textAnchor:v,verticalAnchor:p},P):a==="insideBottomLeft"?dr({x:o+g,y:u+c-d,textAnchor:y,verticalAnchor:f},P):a==="insideBottomRight"?dr({x:o+l-g,y:u+c-d,textAnchor:v,verticalAnchor:f},P):md(a)&&(fe(a.x)||el(a.x))&&(fe(a.y)||el(a.y))?dr({x:o+Pn(a.x,l),y:u+Pn(a.y,c),textAnchor:"end",verticalAnchor:"end"},P):dr({x:o+l/2,y:u+c/2,textAnchor:"middle",verticalAnchor:"middle"},P)},a_e=function(e){return"cx"in e&&fe(e.cx)};function Ir(t){var e=t.offset,r=e===void 0?5:e,n=Y0e(t,q0e),i=dr({offset:r},n),a=i.viewBox,s=i.position,o=i.value,u=i.children,l=i.content,c=i.className,h=c===void 0?"":c,d=i.textBreakAll;if(!a||De(o)&&De(u)&&!I.isValidElement(l)&&!Ne(l))return null;if(I.isValidElement(l))return I.cloneElement(l,i);var f;if(Ne(l)){if(f=I.createElement(l,i),I.isValidElement(f))return f}else f=e_e(i);var p=a_e(a),m=$e(i,!0);if(p&&(s==="insideStart"||s==="insideEnd"||s==="end"))return r_e(i,f,m);var g=p?n_e(i):i_e(i);return $.createElement(El,im({className:ze("recharts-label",h)},m,g,{breakAll:d}),f)}Ir.displayName="Label";var $q=function(e){var r=e.cx,n=e.cy,i=e.angle,a=e.startAngle,s=e.endAngle,o=e.r,u=e.radius,l=e.innerRadius,c=e.outerRadius,h=e.x,d=e.y,f=e.top,p=e.left,m=e.width,g=e.height,v=e.clockWise,y=e.labelViewBox;if(y)return y;if(fe(m)&&fe(g)){if(fe(h)&&fe(d))return{x:h,y:d,width:m,height:g};if(fe(f)&&fe(p))return{x:f,y:p,width:m,height:g}}return fe(h)&&fe(d)?{x:h,y:d,width:0,height:0}:fe(r)&&fe(n)?{cx:r,cy:n,startAngle:a||i||0,endAngle:s||i||0,innerRadius:l||0,outerRadius:c||u||o||0,clockWise:v}:e.viewBox?e.viewBox:{}},s_e=function(e,r){return e?e===!0?$.createElement(Ir,{key:"label-implicit",viewBox:r}):vr(e)?$.createElement(Ir,{key:"label-implicit",viewBox:r,value:e}):I.isValidElement(e)?e.type===Ir?I.cloneElement(e,{key:"label-implicit",viewBox:r}):$.createElement(Ir,{key:"label-implicit",content:e,viewBox:r}):Ne(e)?$.createElement(Ir,{key:"label-implicit",content:e,viewBox:r}):md(e)?$.createElement(Ir,im({viewBox:r},e,{key:"label-implicit"})):null:null},o_e=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var i=e.children,a=$q(e),s=Fi(i,Ir).map(function(u,l){return I.cloneElement(u,{viewBox:r||a,key:"label-".concat(l)})});if(!n)return s;var o=s_e(e.label,r||a);return[o].concat(K0e(s))};Ir.parseViewBox=$q;Ir.renderCallByParent=o_e;function u_e(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var l_e=u_e;const c_e=Ze(l_e);function am(t){return am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},am(t)}var h_e=["valueAccessor"],d_e=["data","dataKey","clockWise","id","textBreakAll"];function f_e(t){return y_e(t)||g_e(t)||m_e(t)||p_e()}function p_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m_e(t,e){if(t){if(typeof t=="string")return iE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iE(t,e)}}function g_e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function y_e(t){if(Array.isArray(t))return iE(t)}function iE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zb(){return zb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zb.apply(this,arguments)}function sM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function oM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sM(Object(r),!0).forEach(function(n){v_e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function v_e(t,e,r){return e=b_e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b_e(t){var e=w_e(t,"string");return am(e)=="symbol"?e:String(e)}function w_e(t,e){if(am(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(am(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uM(t,e){if(t==null)return{};var r=__e(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function __e(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}var x_e=function(e){return Array.isArray(e.value)?c_e(e.value):e.value};function Hs(t){var e=t.valueAccessor,r=e===void 0?x_e:e,n=uM(t,h_e),i=n.data,a=n.dataKey,s=n.clockWise,o=n.id,u=n.textBreakAll,l=uM(n,d_e);return!i||!i.length?null:$.createElement(Ye,{className:"recharts-label-list"},i.map(function(c,h){var d=De(a)?r(c,h):gr(c&&c.payload,a),f=De(o)?{}:{id:"".concat(o,"-").concat(h)};return $.createElement(Ir,zb({},$e(c,!0),l,f,{parentViewBox:c.parentViewBox,value:d,textBreakAll:u,viewBox:Ir.parseViewBox(De(s)?c:oM(oM({},c),{},{clockWise:s})),key:"label-".concat(h),index:h}))}))}Hs.displayName="LabelList";function O_e(t,e){return t?t===!0?$.createElement(Hs,{key:"labelList-implicit",data:e}):$.isValidElement(t)||Ne(t)?$.createElement(Hs,{key:"labelList-implicit",data:e,content:t}):md(t)?$.createElement(Hs,zb({data:e},t,{key:"labelList-implicit"})):null:null}function S_e(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var n=t.children,i=Fi(n,Hs).map(function(s,o){return I.cloneElement(s,{data:e,key:"labelList-".concat(o)})});if(!r)return i;var a=O_e(t.label,e);return[a].concat(f_e(i))}Hs.renderCallByParent=S_e;function sm(t){return sm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sm(t)}function aE(){return aE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},aE.apply(this,arguments)}function lM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function cM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lM(Object(r),!0).forEach(function(n){P_e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function P_e(t,e,r){return e=E_e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E_e(t){var e=A_e(t,"string");return sm(e)=="symbol"?e:String(e)}function A_e(t,e){if(sm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(sm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var T_e=function(e,r){var n=Sn(r-e),i=Math.min(Math.abs(r-e),359.999);return n*i},ky=function(e){var r=e.cx,n=e.cy,i=e.radius,a=e.angle,s=e.sign,o=e.isExternal,u=e.cornerRadius,l=e.cornerIsExternal,c=u*(o?1:-1)+i,h=Math.asin(u/c)/Ub,d=l?a:a+s*h,f=Tt(r,n,c,d),p=Tt(r,n,i,d),m=l?a-s*h:a,g=Tt(r,n,c*Math.cos(h*Ub),m);return{center:f,circleTangency:p,lineTangency:g,theta:h}},jq=function(e){var r=e.cx,n=e.cy,i=e.innerRadius,a=e.outerRadius,s=e.startAngle,o=e.endAngle,u=T_e(s,o),l=s+u,c=Tt(r,n,a,s),h=Tt(r,n,a,l),d="M ".concat(c.x,",").concat(c.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(u)>180),",").concat(+(s>l),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(i>0){var f=Tt(r,n,i,s),p=Tt(r,n,i,l);d+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(u)>180),",").concat(+(s<=l),`,
            `).concat(f.x,",").concat(f.y," Z")}else d+="L ".concat(r,",").concat(n," Z");return d},k_e=function(e){var r=e.cx,n=e.cy,i=e.innerRadius,a=e.outerRadius,s=e.cornerRadius,o=e.forceCornerRadius,u=e.cornerIsExternal,l=e.startAngle,c=e.endAngle,h=Sn(c-l),d=ky({cx:r,cy:n,radius:a,angle:l,sign:h,cornerRadius:s,cornerIsExternal:u}),f=d.circleTangency,p=d.lineTangency,m=d.theta,g=ky({cx:r,cy:n,radius:a,angle:c,sign:-h,cornerRadius:s,cornerIsExternal:u}),v=g.circleTangency,y=g.lineTangency,b=g.theta,w=u?Math.abs(l-c):Math.abs(l-c)-m-b;if(w<0)return o?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):jq({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:l,endAngle:c});var _="M ".concat(p.x,",").concat(p.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(h<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(w>180),",").concat(+(h<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(h<0),",").concat(y.x,",").concat(y.y,`
  `);if(i>0){var O=ky({cx:r,cy:n,radius:i,angle:l,sign:h,isExternal:!0,cornerRadius:s,cornerIsExternal:u}),P=O.circleTangency,x=O.lineTangency,j=O.theta,k=ky({cx:r,cy:n,radius:i,angle:c,sign:-h,isExternal:!0,cornerRadius:s,cornerIsExternal:u}),R=k.circleTangency,F=k.lineTangency,z=k.theta,N=u?Math.abs(l-c):Math.abs(l-c)-j-z;if(N<0&&s===0)return"".concat(_,"L").concat(r,",").concat(n,"Z");_+="L".concat(F.x,",").concat(F.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(h<0),",").concat(R.x,",").concat(R.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(N>180),",").concat(+(h>0),",").concat(P.x,",").concat(P.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(h<0),",").concat(x.x,",").concat(x.y,"Z")}else _+="L".concat(r,",").concat(n,"Z");return _},C_e={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Rq=function(e){var r=cM(cM({},C_e),e),n=r.cx,i=r.cy,a=r.innerRadius,s=r.outerRadius,o=r.cornerRadius,u=r.forceCornerRadius,l=r.cornerIsExternal,c=r.startAngle,h=r.endAngle,d=r.className;if(s<a||c===h)return null;var f=ze("recharts-sector",d),p=s-a,m=Pn(o,p,0,!0),g;return m>0&&Math.abs(c-h)<360?g=k_e({cx:n,cy:i,innerRadius:a,outerRadius:s,cornerRadius:Math.min(m,p/2),forceCornerRadius:u,cornerIsExternal:l,startAngle:c,endAngle:h}):g=jq({cx:n,cy:i,innerRadius:a,outerRadius:s,startAngle:c,endAngle:h}),$.createElement("path",aE({},$e(r,!0),{className:f,d:g,role:"img"}))};function om(t){return om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},om(t)}function sE(){return sE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},sE.apply(this,arguments)}function hM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function dM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hM(Object(r),!0).forEach(function(n){I_e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function I_e(t,e,r){return e=$_e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $_e(t){var e=j_e(t,"string");return om(e)=="symbol"?e:String(e)}function j_e(t,e){if(om(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(om(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fM={curveBasisClosed:qoe,curveBasisOpen:Koe,curveBasis:Boe,curveBumpX:Toe,curveBumpY:koe,curveLinearClosed:Voe,curveLinear:c_,curveMonotoneX:Hoe,curveMonotoneY:Woe,curveNatural:Goe,curveStep:Yoe,curveStepAfter:Zoe,curveStepBefore:Joe},Cy=function(e){return e.x===+e.x&&e.y===+e.y},_f=function(e){return e.x},xf=function(e){return e.y},R_e=function(e,r){if(Ne(e))return e;var n="curve".concat(u_(e));return(n==="curveMonotone"||n==="curveBump")&&r?fM["".concat(n).concat(r==="vertical"?"Y":"X")]:fM[n]||c_},N_e=function(e){var r=e.type,n=r===void 0?"linear":r,i=e.points,a=i===void 0?[]:i,s=e.baseLine,o=e.layout,u=e.connectNulls,l=u===void 0?!1:u,c=R_e(n,o),h=l?a.filter(function(m){return Cy(m)}):a,d;if(Array.isArray(s)){var f=l?s.filter(function(m){return Cy(m)}):s,p=h.map(function(m,g){return dM(dM({},m),{},{base:f[g]})});return o==="vertical"?d=wy().y(xf).x1(_f).x0(function(m){return m.base.x}):d=wy().x(_f).y1(xf).y0(function(m){return m.base.y}),d.defined(Cy).curve(c),d(p)}return o==="vertical"&&fe(s)?d=wy().y(xf).x1(_f).x0(s):fe(s)?d=wy().x(_f).y1(xf).y0(s):d=kz().x(_f).y(xf),d.defined(Cy).curve(c),d(h)},oh=function(e){var r=e.className,n=e.points,i=e.path,a=e.pathRef;if((!n||!n.length)&&!i)return null;var s=n&&n.length?N_e(e):i;return $.createElement("path",sE({},$e(e,!1),fb(e),{className:ze("recharts-curve",r),d:s,ref:a}))},Nq={exports:{}},M_e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",D_e=M_e,L_e=D_e;function Mq(){}function Dq(){}Dq.resetWarningCache=Mq;var F_e=function(){function t(n,i,a,s,o,u){if(u!==L_e){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}t.isRequired=t;function e(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Dq,resetWarningCache:Mq};return r.PropTypes=r,r};Nq.exports=F_e();var U_e=Nq.exports;const Fe=Ze(U_e);var z_e=Object.getOwnPropertyNames,B_e=Object.getOwnPropertySymbols,q_e=Object.prototype.hasOwnProperty;function pM(t,e){return function(n,i,a){return t(n,i,a)&&e(n,i,a)}}function Iy(t){return function(r,n,i){if(!r||!n||typeof r!="object"||typeof n!="object")return t(r,n,i);var a=i.cache,s=a.get(r),o=a.get(n);if(s&&o)return s===n&&o===r;a.set(r,n),a.set(n,r);var u=t(r,n,i);return a.delete(r),a.delete(n),u}}function mM(t){return z_e(t).concat(B_e(t))}var Lq=Object.hasOwn||function(t,e){return q_e.call(t,e)};function Ad(t,e){return t||e?t===e:t===e||t!==t&&e!==e}var Fq="_owner",gM=Object.getOwnPropertyDescriptor,yM=Object.keys;function K_e(t,e,r){var n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(!r.equals(t[n],e[n],n,n,t,e,r))return!1;return!0}function V_e(t,e){return Ad(t.getTime(),e.getTime())}function vM(t,e,r){if(t.size!==e.size)return!1;for(var n={},i=t.entries(),a=0,s,o;(s=i.next())&&!s.done;){for(var u=e.entries(),l=!1,c=0;(o=u.next())&&!o.done;){var h=s.value,d=h[0],f=h[1],p=o.value,m=p[0],g=p[1];!l&&!n[c]&&(l=r.equals(d,m,a,c,t,e,r)&&r.equals(f,g,d,m,t,e,r))&&(n[c]=!0),c++}if(!l)return!1;a++}return!0}function H_e(t,e,r){var n=yM(t),i=n.length;if(yM(e).length!==i)return!1;for(var a;i-- >0;)if(a=n[i],a===Fq&&(t.$$typeof||e.$$typeof)&&t.$$typeof!==e.$$typeof||!Lq(e,a)||!r.equals(t[a],e[a],a,a,t,e,r))return!1;return!0}function Of(t,e,r){var n=mM(t),i=n.length;if(mM(e).length!==i)return!1;for(var a,s,o;i-- >0;)if(a=n[i],a===Fq&&(t.$$typeof||e.$$typeof)&&t.$$typeof!==e.$$typeof||!Lq(e,a)||!r.equals(t[a],e[a],a,a,t,e,r)||(s=gM(t,a),o=gM(e,a),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function W_e(t,e){return Ad(t.valueOf(),e.valueOf())}function G_e(t,e){return t.source===e.source&&t.flags===e.flags}function bM(t,e,r){if(t.size!==e.size)return!1;for(var n={},i=t.values(),a,s;(a=i.next())&&!a.done;){for(var o=e.values(),u=!1,l=0;(s=o.next())&&!s.done;)!u&&!n[l]&&(u=r.equals(a.value,s.value,a.value,s.value,t,e,r))&&(n[l]=!0),l++;if(!u)return!1}return!0}function Y_e(t,e){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(t[r]!==e[r])return!1;return!0}var J_e="[object Arguments]",Z_e="[object Boolean]",X_e="[object Date]",Q_e="[object Map]",e1e="[object Number]",t1e="[object Object]",r1e="[object RegExp]",n1e="[object Set]",i1e="[object String]",a1e=Array.isArray,wM=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,_M=Object.assign,s1e=Object.prototype.toString.call.bind(Object.prototype.toString);function o1e(t){var e=t.areArraysEqual,r=t.areDatesEqual,n=t.areMapsEqual,i=t.areObjectsEqual,a=t.arePrimitiveWrappersEqual,s=t.areRegExpsEqual,o=t.areSetsEqual,u=t.areTypedArraysEqual;return function(c,h,d){if(c===h)return!0;if(c==null||h==null||typeof c!="object"||typeof h!="object")return c!==c&&h!==h;var f=c.constructor;if(f!==h.constructor)return!1;if(f===Object)return i(c,h,d);if(a1e(c))return e(c,h,d);if(wM!=null&&wM(c))return u(c,h,d);if(f===Date)return r(c,h,d);if(f===RegExp)return s(c,h,d);if(f===Map)return n(c,h,d);if(f===Set)return o(c,h,d);var p=s1e(c);return p===X_e?r(c,h,d):p===r1e?s(c,h,d):p===Q_e?n(c,h,d):p===n1e?o(c,h,d):p===t1e?typeof c.then!="function"&&typeof h.then!="function"&&i(c,h,d):p===J_e?i(c,h,d):p===Z_e||p===e1e||p===i1e?a(c,h,d):!1}}function u1e(t){var e=t.circular,r=t.createCustomConfig,n=t.strict,i={areArraysEqual:n?Of:K_e,areDatesEqual:V_e,areMapsEqual:n?pM(vM,Of):vM,areObjectsEqual:n?Of:H_e,arePrimitiveWrappersEqual:W_e,areRegExpsEqual:G_e,areSetsEqual:n?pM(bM,Of):bM,areTypedArraysEqual:n?Of:Y_e};if(r&&(i=_M({},i,r(i))),e){var a=Iy(i.areArraysEqual),s=Iy(i.areMapsEqual),o=Iy(i.areObjectsEqual),u=Iy(i.areSetsEqual);i=_M({},i,{areArraysEqual:a,areMapsEqual:s,areObjectsEqual:o,areSetsEqual:u})}return i}function l1e(t){return function(e,r,n,i,a,s,o){return t(e,r,o)}}function c1e(t){var e=t.circular,r=t.comparator,n=t.createState,i=t.equals,a=t.strict;if(n)return function(u,l){var c=n(),h=c.cache,d=h===void 0?e?new WeakMap:void 0:h,f=c.meta;return r(u,l,{cache:d,equals:i,meta:f,strict:a})};if(e)return function(u,l){return r(u,l,{cache:new WeakMap,equals:i,meta:void 0,strict:a})};var s={cache:void 0,equals:i,meta:void 0,strict:a};return function(u,l){return r(u,l,s)}}var h1e=Pu();Pu({strict:!0});Pu({circular:!0});Pu({circular:!0,strict:!0});Pu({createInternalComparator:function(){return Ad}});Pu({strict:!0,createInternalComparator:function(){return Ad}});Pu({circular:!0,createInternalComparator:function(){return Ad}});Pu({circular:!0,createInternalComparator:function(){return Ad},strict:!0});function Pu(t){t===void 0&&(t={});var e=t.circular,r=e===void 0?!1:e,n=t.createInternalComparator,i=t.createState,a=t.strict,s=a===void 0?!1:a,o=u1e(t),u=o1e(o),l=n?n(u):l1e(u);return c1e({circular:r,comparator:u,createState:i,equals:l,strict:s})}function d1e(t){typeof requestAnimationFrame<"u"&&requestAnimationFrame(t)}function xM(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function i(a){r<0&&(r=a),a-r>e?(t(a),r=-1):d1e(i)};requestAnimationFrame(n)}function oE(t){return oE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oE(t)}function f1e(t){return y1e(t)||g1e(t)||m1e(t)||p1e()}function p1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m1e(t,e){if(t){if(typeof t=="string")return OM(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OM(t,e)}}function OM(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function g1e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function y1e(t){if(Array.isArray(t))return t}function v1e(){var t={},e=function(){return null},r=!1,n=function i(a){if(!r){if(Array.isArray(a)){if(!a.length)return;var s=a,o=f1e(s),u=o[0],l=o.slice(1);if(typeof u=="number"){xM(i.bind(null,l),u);return}i(u),xM(i.bind(null,l));return}oE(a)==="object"&&(t=a,e(t)),typeof a=="function"&&a()}};return{stop:function(){r=!0},start:function(a){r=!1,n(a)},subscribe:function(a){return e=a,function(){e=function(){return null}}}}}function um(t){return um=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},um(t)}function SM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function PM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?SM(Object(r),!0).forEach(function(n){Uq(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):SM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Uq(t,e,r){return e=b1e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b1e(t){var e=w1e(t,"string");return um(e)==="symbol"?e:String(e)}function w1e(t,e){if(um(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(um(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _1e=function(e,r){return[Object.keys(e),Object.keys(r)].reduce(function(n,i){return n.filter(function(a){return i.includes(a)})})},x1e=function(e){return e},O1e=function(e){return e.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},lp=function(e,r){return Object.keys(r).reduce(function(n,i){return PM(PM({},n),{},Uq({},i,e(i,r[i])))},{})},EM=function(e,r,n){return e.map(function(i){return"".concat(O1e(i)," ").concat(r,"ms ").concat(n)}).join(",")};function S1e(t,e){return A1e(t)||E1e(t,e)||zq(t,e)||P1e()}function P1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E1e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw i}}return o}}function A1e(t){if(Array.isArray(t))return t}function T1e(t){return I1e(t)||C1e(t)||zq(t)||k1e()}function k1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zq(t,e){if(t){if(typeof t=="string")return uE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uE(t,e)}}function C1e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function I1e(t){if(Array.isArray(t))return uE(t)}function uE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Bb=1e-4,Bq=function(e,r){return[0,3*e,3*r-6*e,3*e-3*r+1]},qq=function(e,r){return e.map(function(n,i){return n*Math.pow(r,i)}).reduce(function(n,i){return n+i})},AM=function(e,r){return function(n){var i=Bq(e,r);return qq(i,n)}},$1e=function(e,r){return function(n){var i=Bq(e,r),a=[].concat(T1e(i.map(function(s,o){return s*o}).slice(1)),[0]);return qq(a,n)}},TM=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r[0],a=r[1],s=r[2],o=r[3];if(r.length===1)switch(r[0]){case"linear":i=0,a=0,s=1,o=1;break;case"ease":i=.25,a=.1,s=.25,o=1;break;case"ease-in":i=.42,a=0,s=1,o=1;break;case"ease-out":i=.42,a=0,s=.58,o=1;break;case"ease-in-out":i=0,a=0,s=.58,o=1;break;default:{var u=r[0].split("(");if(u[0]==="cubic-bezier"&&u[1].split(")")[0].split(",").length===4){var l=u[1].split(")")[0].split(",").map(function(g){return parseFloat(g)}),c=S1e(l,4);i=c[0],a=c[1],s=c[2],o=c[3]}}}var h=AM(i,s),d=AM(a,o),f=$1e(i,s),p=function(v){return v>1?1:v<0?0:v},m=function(v){for(var y=v>1?1:v,b=y,w=0;w<8;++w){var _=h(b)-y,O=f(b);if(Math.abs(_-y)<Bb||O<Bb)return d(b);b=p(b-_/O)}return d(b)};return m.isStepper=!1,m},j1e=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.stiff,n=r===void 0?100:r,i=e.damping,a=i===void 0?8:i,s=e.dt,o=s===void 0?17:s,u=function(c,h,d){var f=-(c-h)*n,p=d*a,m=d+(f-p)*o/1e3,g=d*o/1e3+c;return Math.abs(g-h)<Bb&&Math.abs(m)<Bb?[h,0]:[g,m]};return u.isStepper=!0,u.dt=o,u},R1e=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r[0];if(typeof i=="string")switch(i){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return TM(i);case"spring":return j1e();default:if(i.split("(")[0]==="cubic-bezier")return TM(i)}return typeof i=="function"?i:null};function lm(t){return lm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lm(t)}function kM(t){return D1e(t)||M1e(t)||Kq(t)||N1e()}function N1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M1e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function D1e(t){if(Array.isArray(t))return cE(t)}function CM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Vr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?CM(Object(r),!0).forEach(function(n){lE(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):CM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function lE(t,e,r){return e=L1e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L1e(t){var e=F1e(t,"string");return lm(e)==="symbol"?e:String(e)}function F1e(t,e){if(lm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(lm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function U1e(t,e){return q1e(t)||B1e(t,e)||Kq(t,e)||z1e()}function z1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kq(t,e){if(t){if(typeof t=="string")return cE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cE(t,e)}}function cE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function B1e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw i}}return o}}function q1e(t){if(Array.isArray(t))return t}var qb=function(e,r,n){return e+(r-e)*n},hE=function(e){var r=e.from,n=e.to;return r!==n},K1e=function t(e,r,n){var i=lp(function(a,s){if(hE(s)){var o=e(s.from,s.to,s.velocity),u=U1e(o,2),l=u[0],c=u[1];return Vr(Vr({},s),{},{from:l,velocity:c})}return s},r);return n<1?lp(function(a,s){return hE(s)?Vr(Vr({},s),{},{velocity:qb(s.velocity,i[a].velocity,n),from:qb(s.from,i[a].from,n)}):s},r):t(e,i,n-1)};const V1e=function(t,e,r,n,i){var a=_1e(t,e),s=a.reduce(function(g,v){return Vr(Vr({},g),{},lE({},v,[t[v],e[v]]))},{}),o=a.reduce(function(g,v){return Vr(Vr({},g),{},lE({},v,{from:t[v],velocity:0,to:e[v]}))},{}),u=-1,l,c,h=function(){return null},d=function(){return lp(function(v,y){return y.from},o)},f=function(){return!Object.values(o).filter(hE).length},p=function(v){l||(l=v);var y=v-l,b=y/r.dt;o=K1e(r,o,b),i(Vr(Vr(Vr({},t),e),d())),l=v,f()||(u=requestAnimationFrame(h))},m=function(v){c||(c=v);var y=(v-c)/n,b=lp(function(_,O){return qb.apply(void 0,kM(O).concat([r(y)]))},s);if(i(Vr(Vr(Vr({},t),e),b)),y<1)u=requestAnimationFrame(h);else{var w=lp(function(_,O){return qb.apply(void 0,kM(O).concat([r(1)]))},s);i(Vr(Vr(Vr({},t),e),w))}};return h=r.isStepper?p:m,function(){return requestAnimationFrame(h),function(){cancelAnimationFrame(u)}}};function Mh(t){return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mh(t)}var H1e=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function W1e(t,e){if(t==null)return{};var r=G1e(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function G1e(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function Hx(t){return X1e(t)||Z1e(t)||J1e(t)||Y1e()}function Y1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J1e(t,e){if(t){if(typeof t=="string")return dE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dE(t,e)}}function Z1e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function X1e(t){if(Array.isArray(t))return dE(t)}function dE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function IM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Yi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?IM(Object(r),!0).forEach(function(n){Nf(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):IM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Nf(t,e,r){return e=Vq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Q1e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $M(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vq(n.key),n)}}function exe(t,e,r){return e&&$M(t.prototype,e),r&&$M(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Vq(t){var e=txe(t,"string");return Mh(e)==="symbol"?e:String(e)}function txe(t,e){if(Mh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fE(t,e)}function fE(t,e){return fE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fE(t,e)}function nxe(t){var e=ixe();return function(){var n=Kb(t),i;if(e){var a=Kb(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pE(this,i)}}function pE(t,e){if(e&&(Mh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mE(t)}function mE(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ixe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kb(t){return Kb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kb(t)}var ls=function(t){rxe(r,t);var e=nxe(r);function r(n,i){var a;Q1e(this,r),a=e.call(this,n,i);var s=a.props,o=s.isActive,u=s.attributeName,l=s.from,c=s.to,h=s.steps,d=s.children,f=s.duration;if(a.handleStyleChange=a.handleStyleChange.bind(mE(a)),a.changeStyle=a.changeStyle.bind(mE(a)),!o||f<=0)return a.state={style:{}},typeof d=="function"&&(a.state={style:c}),pE(a);if(h&&h.length)a.state={style:h[0].style};else if(l){if(typeof d=="function")return a.state={style:l},pE(a);a.state={style:u?Nf({},u,l):l}}else a.state={style:{}};return a}return exe(r,[{key:"componentDidMount",value:function(){var i=this.props,a=i.isActive,s=i.canBegin;this.mounted=!0,!(!a||!s)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(i){var a=this.props,s=a.isActive,o=a.canBegin,u=a.attributeName,l=a.shouldReAnimate,c=a.to,h=a.from,d=this.state.style;if(o){if(!s){var f={style:u?Nf({},u,c):c};this.state&&d&&(u&&d[u]!==c||!u&&d!==c)&&this.setState(f);return}if(!(h1e(i.to,c)&&i.canBegin&&i.isActive)){var p=!i.canBegin||!i.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var m=p||l?h:i.to;if(this.state&&d){var g={style:u?Nf({},u,m):m};(u&&d[u]!==m||!u&&d!==m)&&this.setState(g)}this.runAnimation(Yi(Yi({},this.props),{},{from:m,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var i=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),i&&i()}},{key:"handleStyleChange",value:function(i){this.changeStyle(i)}},{key:"changeStyle",value:function(i){this.mounted&&this.setState({style:i})}},{key:"runJSAnimation",value:function(i){var a=this,s=i.from,o=i.to,u=i.duration,l=i.easing,c=i.begin,h=i.onAnimationEnd,d=i.onAnimationStart,f=V1e(s,o,R1e(l),u,this.changeStyle),p=function(){a.stopJSAnimation=f()};this.manager.start([d,c,p,u,h])}},{key:"runStepAnimation",value:function(i){var a=this,s=i.steps,o=i.begin,u=i.onAnimationStart,l=s[0],c=l.style,h=l.duration,d=h===void 0?0:h,f=function(m,g,v){if(v===0)return m;var y=g.duration,b=g.easing,w=b===void 0?"ease":b,_=g.style,O=g.properties,P=g.onAnimationEnd,x=v>0?s[v-1]:g,j=O||Object.keys(_);if(typeof w=="function"||w==="spring")return[].concat(Hx(m),[a.runJSAnimation.bind(a,{from:x.style,to:_,duration:y,easing:w}),y]);var k=EM(j,y,w),R=Yi(Yi(Yi({},x.style),_),{},{transition:k});return[].concat(Hx(m),[R,y,P]).filter(x1e)};return this.manager.start([u].concat(Hx(s.reduce(f,[c,Math.max(d,o)])),[i.onAnimationEnd]))}},{key:"runAnimation",value:function(i){this.manager||(this.manager=v1e());var a=i.begin,s=i.duration,o=i.attributeName,u=i.to,l=i.easing,c=i.onAnimationStart,h=i.onAnimationEnd,d=i.steps,f=i.children,p=this.manager;if(this.unSubscribe=p.subscribe(this.handleStyleChange),typeof l=="function"||typeof f=="function"||l==="spring"){this.runJSAnimation(i);return}if(d.length>1){this.runStepAnimation(i);return}var m=o?Nf({},o,u):u,g=EM(Object.keys(m),s,l);p.start([c,a,Yi(Yi({},m),{},{transition:g}),s,h])}},{key:"render",value:function(){var i=this.props,a=i.children;i.begin;var s=i.duration;i.attributeName,i.easing;var o=i.isActive;i.steps,i.from,i.to,i.canBegin,i.onAnimationEnd,i.shouldReAnimate,i.onAnimationReStart;var u=W1e(i,H1e),l=I.Children.count(a),c=this.state.style;if(typeof a=="function")return a(c);if(!o||l===0||s<=0)return a;var h=function(f){var p=f.props,m=p.style,g=m===void 0?{}:m,v=p.className,y=I.cloneElement(f,Yi(Yi({},u),{},{style:Yi(Yi({},g),c),className:v}));return y};return l===1?h(I.Children.only(a)):$.createElement("div",null,I.Children.map(a,function(d){return h(d)}))}}]),r}(I.PureComponent);ls.displayName="Animate";ls.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};ls.propTypes={from:Fe.oneOfType([Fe.object,Fe.string]),to:Fe.oneOfType([Fe.object,Fe.string]),attributeName:Fe.string,duration:Fe.number,begin:Fe.number,easing:Fe.oneOfType([Fe.string,Fe.func]),steps:Fe.arrayOf(Fe.shape({duration:Fe.number.isRequired,style:Fe.object.isRequired,easing:Fe.oneOfType([Fe.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Fe.func]),properties:Fe.arrayOf("string"),onAnimationEnd:Fe.func})),children:Fe.oneOfType([Fe.node,Fe.func]),isActive:Fe.bool,canBegin:Fe.bool,onAnimationEnd:Fe.func,shouldReAnimate:Fe.bool,onAnimationStart:Fe.func,onAnimationReStart:Fe.func};Fe.object,Fe.object,Fe.object,Fe.element;Fe.object,Fe.object,Fe.object,Fe.oneOfType([Fe.array,Fe.element]),Fe.any;function cm(t){return cm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cm(t)}function Vb(){return Vb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Vb.apply(this,arguments)}function axe(t,e){return lxe(t)||uxe(t,e)||oxe(t,e)||sxe()}function sxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oxe(t,e){if(t){if(typeof t=="string")return jM(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jM(t,e)}}function jM(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function uxe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw i}}return o}}function lxe(t){if(Array.isArray(t))return t}function RM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function NM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?RM(Object(r),!0).forEach(function(n){cxe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):RM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cxe(t,e,r){return e=hxe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hxe(t){var e=dxe(t,"string");return cm(e)=="symbol"?e:String(e)}function dxe(t,e){if(cm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(cm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var MM=function(e,r,n,i,a){var s=Math.min(Math.abs(n)/2,Math.abs(i)/2),o=i>=0?1:-1,u=n>=0?1:-1,l=i>=0&&n>=0||i<0&&n<0?1:0,c;if(s>0&&a instanceof Array){for(var h=[0,0,0,0],d=0,f=4;d<f;d++)h[d]=a[d]>s?s:a[d];c="M".concat(e,",").concat(r+o*h[0]),h[0]>0&&(c+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(l,",").concat(e+u*h[0],",").concat(r)),c+="L ".concat(e+n-u*h[1],",").concat(r),h[1]>0&&(c+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(l,`,
        `).concat(e+n,",").concat(r+o*h[1])),c+="L ".concat(e+n,",").concat(r+i-o*h[2]),h[2]>0&&(c+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(l,`,
        `).concat(e+n-u*h[2],",").concat(r+i)),c+="L ".concat(e+u*h[3],",").concat(r+i),h[3]>0&&(c+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(l,`,
        `).concat(e,",").concat(r+i-o*h[3])),c+="Z"}else if(s>0&&a===+a&&a>0){var p=Math.min(s,a);c="M ".concat(e,",").concat(r+o*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(e+u*p,",").concat(r,`
            L `).concat(e+n-u*p,",").concat(r,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(e+n,",").concat(r+o*p,`
            L `).concat(e+n,",").concat(r+i-o*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(e+n-u*p,",").concat(r+i,`
            L `).concat(e+u*p,",").concat(r+i,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(e,",").concat(r+i-o*p," Z")}else c="M ".concat(e,",").concat(r," h ").concat(n," v ").concat(i," h ").concat(-n," Z");return c},fxe=function(e,r){if(!e||!r)return!1;var n=e.x,i=e.y,a=r.x,s=r.y,o=r.width,u=r.height;if(Math.abs(o)>0&&Math.abs(u)>0){var l=Math.min(a,a+o),c=Math.max(a,a+o),h=Math.min(s,s+u),d=Math.max(s,s+u);return n>=l&&n<=c&&i>=h&&i<=d}return!1},pxe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Hk=function(e){var r=NM(NM({},pxe),e),n=I.useRef(),i=I.useState(-1),a=axe(i,2),s=a[0],o=a[1];I.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&o(w)}catch{}},[]);var u=r.x,l=r.y,c=r.width,h=r.height,d=r.radius,f=r.className,p=r.animationEasing,m=r.animationDuration,g=r.animationBegin,v=r.isAnimationActive,y=r.isUpdateAnimationActive;if(u!==+u||l!==+l||c!==+c||h!==+h||c===0||h===0)return null;var b=ze("recharts-rectangle",f);return y?$.createElement(ls,{canBegin:s>0,from:{width:c,height:h,x:u,y:l},to:{width:c,height:h,x:u,y:l},duration:m,animationEasing:p,isActive:y},function(w){var _=w.width,O=w.height,P=w.x,x=w.y;return $.createElement(ls,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:m,isActive:v,easing:p},$.createElement("path",Vb({},$e(r,!0),{className:b,d:MM(P,x,_,O,d),ref:n})))}):$.createElement("path",Vb({},$e(r,!0),{className:b,d:MM(u,l,c,h,d)}))},mxe=["points","className","baseLinePoints","connectNulls"];function Uc(){return Uc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Uc.apply(this,arguments)}function gxe(t,e){if(t==null)return{};var r=yxe(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function yxe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function DM(t){return _xe(t)||wxe(t)||bxe(t)||vxe()}function vxe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bxe(t,e){if(t){if(typeof t=="string")return gE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gE(t,e)}}function wxe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function _xe(t){if(Array.isArray(t))return gE(t)}function gE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var LM=function(e){return e&&e.x===+e.x&&e.y===+e.y},xxe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return e.forEach(function(n){LM(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),LM(e[0])&&r[r.length-1].push(e[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},cp=function(e,r){var n=xxe(e);r&&(n=[n.reduce(function(a,s){return[].concat(DM(a),DM(s))},[])]);var i=n.map(function(a){return a.reduce(function(s,o,u){return"".concat(s).concat(u===0?"M":"L").concat(o.x,",").concat(o.y)},"")}).join("");return n.length===1?"".concat(i,"Z"):i},Oxe=function(e,r,n){var i=cp(e,n);return"".concat(i.slice(-1)==="Z"?i.slice(0,-1):i,"L").concat(cp(r.reverse(),n).slice(1))},Sxe=function(e){var r=e.points,n=e.className,i=e.baseLinePoints,a=e.connectNulls,s=gxe(e,mxe);if(!r||!r.length)return null;var o=ze("recharts-polygon",n);if(i&&i.length){var u=s.stroke&&s.stroke!=="none",l=Oxe(r,i,a);return $.createElement("g",{className:o},$.createElement("path",Uc({},$e(s,!0),{fill:l.slice(-1)==="Z"?s.fill:"none",stroke:"none",d:l})),u?$.createElement("path",Uc({},$e(s,!0),{fill:"none",d:cp(r,a)})):null,u?$.createElement("path",Uc({},$e(s,!0),{fill:"none",d:cp(i,a)})):null)}var c=cp(r,a);return $.createElement("path",Uc({},$e(s,!0),{fill:c.slice(-1)==="Z"?s.fill:"none",className:o,d:c}))};function yE(){return yE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yE.apply(this,arguments)}var A_=function(e){var r=e.cx,n=e.cy,i=e.r,a=e.className,s=ze("recharts-dot",a);return r===+r&&n===+n&&i===+i?$.createElement("circle",yE({},$e(e,!1),fb(e),{className:s,cx:r,cy:n,r:i})):null};function hm(t){return hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hm(t)}var Pxe=["x","y","top","left","width","height","className"];function vE(){return vE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},vE.apply(this,arguments)}function FM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Exe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?FM(Object(r),!0).forEach(function(n){Axe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):FM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Axe(t,e,r){return e=Txe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Txe(t){var e=kxe(t,"string");return hm(e)=="symbol"?e:String(e)}function kxe(t,e){if(hm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(hm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cxe(t,e){if(t==null)return{};var r=Ixe(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Ixe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}var $xe=function(e,r,n,i,a,s){return"M".concat(e,",").concat(a,"v").concat(i,"M").concat(s,",").concat(r,"h").concat(n)},jxe=function(e){var r=e.x,n=r===void 0?0:r,i=e.y,a=i===void 0?0:i,s=e.top,o=s===void 0?0:s,u=e.left,l=u===void 0?0:u,c=e.width,h=c===void 0?0:c,d=e.height,f=d===void 0?0:d,p=e.className,m=Cxe(e,Pxe),g=Exe({x:n,y:a,top:o,left:l,width:h,height:f},m);return!fe(n)||!fe(a)||!fe(h)||!fe(f)||!fe(o)||!fe(l)?null:$.createElement("path",vE({},$e(g,!0),{className:ze("recharts-cross",p),d:$xe(n,a,h,f,o,l)}))},Rxe=x_,Nxe=aq,Mxe=ys;function Dxe(t,e){return t&&t.length?Rxe(t,Mxe(e),Nxe):void 0}var Lxe=Dxe;const Fxe=Ze(Lxe);var Uxe=x_,zxe=ys,Bxe=sq;function qxe(t,e){return t&&t.length?Uxe(t,zxe(e),Bxe):void 0}var Kxe=qxe;const Vxe=Ze(Kxe);var Hxe=["cx","cy","angle","ticks","axisLine"],Wxe=["ticks","tick","angle","tickFormatter","stroke"];function Dh(t){return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dh(t)}function hp(){return hp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},hp.apply(this,arguments)}function UM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function $u(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?UM(Object(r),!0).forEach(function(n){T_(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):UM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function zM(t,e){if(t==null)return{};var r=Gxe(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Gxe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function Yxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BM(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wq(n.key),n)}}function Jxe(t,e,r){return e&&BM(t.prototype,e),r&&BM(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zxe(t,e,r){return e=Hb(e),Xxe(t,Hq()?Reflect.construct(e,r||[],Hb(t).constructor):e.apply(t,r))}function Xxe(t,e){if(e&&(Dh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qxe(t)}function Qxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Hq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Hq=function(){return!!t})()}function Hb(t){return Hb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hb(t)}function eOe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bE(t,e)}function bE(t,e){return bE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bE(t,e)}function T_(t,e,r){return e=Wq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wq(t){var e=tOe(t,"string");return Dh(e)=="symbol"?e:String(e)}function tOe(t,e){if(Dh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Dh(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var k_=function(t){eOe(e,t);function e(){return Yxe(this,e),Zxe(this,e,arguments)}return Jxe(e,[{key:"getTickValueCoord",value:function(n){var i=n.coordinate,a=this.props,s=a.angle,o=a.cx,u=a.cy;return Tt(o,u,i,s)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,i;switch(n){case"left":i="end";break;case"right":i="start";break;default:i="middle";break}return i}},{key:"getViewBox",value:function(){var n=this.props,i=n.cx,a=n.cy,s=n.angle,o=n.ticks,u=Fxe(o,function(c){return c.coordinate||0}),l=Vxe(o,function(c){return c.coordinate||0});return{cx:i,cy:a,startAngle:s,endAngle:s,innerRadius:l.coordinate||0,outerRadius:u.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.cx,a=n.cy,s=n.angle,o=n.ticks,u=n.axisLine,l=zM(n,Hxe),c=o.reduce(function(p,m){return[Math.min(p[0],m.coordinate),Math.max(p[1],m.coordinate)]},[1/0,-1/0]),h=Tt(i,a,c[0],s),d=Tt(i,a,c[1],s),f=$u($u($u({},$e(l,!1)),{},{fill:"none"},$e(u,!1)),{},{x1:h.x,y1:h.y,x2:d.x,y2:d.y});return $.createElement("line",hp({className:"recharts-polar-radius-axis-line"},f))}},{key:"renderTicks",value:function(){var n=this,i=this.props,a=i.ticks,s=i.tick,o=i.angle,u=i.tickFormatter,l=i.stroke,c=zM(i,Wxe),h=this.getTickTextAnchor(),d=$e(c,!1),f=$e(s,!1),p=a.map(function(m,g){var v=n.getTickValueCoord(m),y=$u($u($u($u({textAnchor:h,transform:"rotate(".concat(90-o,", ").concat(v.x,", ").concat(v.y,")")},d),{},{stroke:"none",fill:l},f),{},{index:g},v),{},{payload:m});return $.createElement(Ye,hp({className:ze("recharts-polar-radius-axis-tick",Iq(s)),key:"tick-".concat(m.coordinate)},Pl(n.props,m,g)),e.renderTickItem(s,y,u?u(m.value,g):m.value))});return $.createElement(Ye,{className:"recharts-polar-radius-axis-ticks"},p)}},{key:"render",value:function(){var n=this.props,i=n.ticks,a=n.axisLine,s=n.tick;return!i||!i.length?null:$.createElement(Ye,{className:ze("recharts-polar-radius-axis",this.props.className)},a&&this.renderAxisLine(),s&&this.renderTicks(),Ir.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,i,a){var s;return $.isValidElement(n)?s=$.cloneElement(n,i):Ne(n)?s=n(i):s=$.createElement(El,hp({},i,{className:"recharts-polar-radius-axis-tick-value"}),a),s}}]),e}(I.PureComponent);T_(k_,"displayName","PolarRadiusAxis");T_(k_,"axisType","radiusAxis");T_(k_,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Lh(t){return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lh(t)}function Vu(){return Vu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Vu.apply(this,arguments)}function qM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ju(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qM(Object(r),!0).forEach(function(n){C_(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function rOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function KM(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Yq(n.key),n)}}function nOe(t,e,r){return e&&KM(t.prototype,e),r&&KM(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function iOe(t,e,r){return e=Wb(e),aOe(t,Gq()?Reflect.construct(e,r||[],Wb(t).constructor):e.apply(t,r))}function aOe(t,e){if(e&&(Lh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sOe(t)}function sOe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Gq=function(){return!!t})()}function Wb(t){return Wb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wb(t)}function oOe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wE(t,e)}function wE(t,e){return wE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wE(t,e)}function C_(t,e,r){return e=Yq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yq(t){var e=uOe(t,"string");return Lh(e)=="symbol"?e:String(e)}function uOe(t,e){if(Lh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Lh(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lOe=Math.PI/180,VM=1e-5,I_=function(t){oOe(e,t);function e(){return rOe(this,e),iOe(this,e,arguments)}return nOe(e,[{key:"getTickLineCoord",value:function(n){var i=this.props,a=i.cx,s=i.cy,o=i.radius,u=i.orientation,l=i.tickSize,c=l||8,h=Tt(a,s,o,n.coordinate),d=Tt(a,s,o+(u==="inner"?-1:1)*c,n.coordinate);return{x1:h.x,y1:h.y,x2:d.x,y2:d.y}}},{key:"getTickTextAnchor",value:function(n){var i=this.props.orientation,a=Math.cos(-n.coordinate*lOe),s;return a>VM?s=i==="outer"?"start":"end":a<-VM?s=i==="outer"?"end":"start":s="middle",s}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.cx,a=n.cy,s=n.radius,o=n.axisLine,u=n.axisLineType,l=ju(ju({},$e(this.props,!1)),{},{fill:"none"},$e(o,!1));if(u==="circle")return $.createElement(A_,Vu({className:"recharts-polar-angle-axis-line"},l,{cx:i,cy:a,r:s}));var c=this.props.ticks,h=c.map(function(d){return Tt(i,a,s,d.coordinate)});return $.createElement(Sxe,Vu({className:"recharts-polar-angle-axis-line"},l,{points:h}))}},{key:"renderTicks",value:function(){var n=this,i=this.props,a=i.ticks,s=i.tick,o=i.tickLine,u=i.tickFormatter,l=i.stroke,c=$e(this.props,!1),h=$e(s,!1),d=ju(ju({},c),{},{fill:"none"},$e(o,!1)),f=a.map(function(p,m){var g=n.getTickLineCoord(p),v=n.getTickTextAnchor(p),y=ju(ju(ju({textAnchor:v},c),{},{stroke:"none",fill:l},h),{},{index:m,payload:p,x:g.x2,y:g.y2});return $.createElement(Ye,Vu({className:ze("recharts-polar-angle-axis-tick",Iq(s)),key:"tick-".concat(p.coordinate)},Pl(n.props,p,m)),o&&$.createElement("line",Vu({className:"recharts-polar-angle-axis-tick-line"},d,g)),s&&e.renderTickItem(s,y,u?u(p.value,m):p.value))});return $.createElement(Ye,{className:"recharts-polar-angle-axis-ticks"},f)}},{key:"render",value:function(){var n=this.props,i=n.ticks,a=n.radius,s=n.axisLine;return a<=0||!i||!i.length?null:$.createElement(Ye,{className:ze("recharts-polar-angle-axis",this.props.className)},s&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,i,a){var s;return $.isValidElement(n)?s=$.cloneElement(n,i):Ne(n)?s=n(i):s=$.createElement(El,Vu({},i,{className:"recharts-polar-angle-axis-tick-value"}),a),s}}]),e}(I.PureComponent);C_(I_,"displayName","PolarAngleAxis");C_(I_,"axisType","angleAxis");C_(I_,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var cOe=Qz,hOe=cOe(Object.getPrototypeOf,Object),dOe=hOe,fOe=co,pOe=dOe,mOe=ho,gOe="[object Object]",yOe=Function.prototype,vOe=Object.prototype,Jq=yOe.toString,bOe=vOe.hasOwnProperty,wOe=Jq.call(Object);function _Oe(t){if(!mOe(t)||fOe(t)!=gOe)return!1;var e=pOe(t);if(e===null)return!0;var r=bOe.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&Jq.call(r)==wOe}var xOe=_Oe;const OOe=Ze(xOe);var SOe=co,POe=ho,EOe="[object Boolean]";function AOe(t){return t===!0||t===!1||POe(t)&&SOe(t)==EOe}var TOe=AOe;const kOe=Ze(TOe);function dm(t){return dm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dm(t)}function Gb(){return Gb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Gb.apply(this,arguments)}function COe(t,e){return ROe(t)||jOe(t,e)||$Oe(t,e)||IOe()}function IOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Oe(t,e){if(t){if(typeof t=="string")return HM(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HM(t,e)}}function HM(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function jOe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw i}}return o}}function ROe(t){if(Array.isArray(t))return t}function WM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function GM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?WM(Object(r),!0).forEach(function(n){NOe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):WM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function NOe(t,e,r){return e=MOe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MOe(t){var e=DOe(t,"string");return dm(e)=="symbol"?e:String(e)}function DOe(t,e){if(dm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(dm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var YM=function(e,r,n,i,a){var s=n-i,o;return o="M ".concat(e,",").concat(r),o+="L ".concat(e+n,",").concat(r),o+="L ".concat(e+n-s/2,",").concat(r+a),o+="L ".concat(e+n-s/2-i,",").concat(r+a),o+="L ".concat(e,",").concat(r," Z"),o},LOe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},FOe=function(e){var r=GM(GM({},LOe),e),n=I.useRef(),i=I.useState(-1),a=COe(i,2),s=a[0],o=a[1];I.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var b=n.current.getTotalLength();b&&o(b)}catch{}},[]);var u=r.x,l=r.y,c=r.upperWidth,h=r.lowerWidth,d=r.height,f=r.className,p=r.animationEasing,m=r.animationDuration,g=r.animationBegin,v=r.isUpdateAnimationActive;if(u!==+u||l!==+l||c!==+c||h!==+h||d!==+d||c===0&&h===0||d===0)return null;var y=ze("recharts-trapezoid",f);return v?$.createElement(ls,{canBegin:s>0,from:{upperWidth:0,lowerWidth:0,height:d,x:u,y:l},to:{upperWidth:c,lowerWidth:h,height:d,x:u,y:l},duration:m,animationEasing:p,isActive:v},function(b){var w=b.upperWidth,_=b.lowerWidth,O=b.height,P=b.x,x=b.y;return $.createElement(ls,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:m,easing:p},$.createElement("path",Gb({},$e(r,!0),{className:y,d:YM(P,x,w,_,O),ref:n})))}):$.createElement("g",null,$.createElement("path",Gb({},$e(r,!0),{className:y,d:YM(u,l,c,h,d)})))},UOe=["option","shapeType","propTransformer","activeClassName","isActive"];function fm(t){return fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fm(t)}function zOe(t,e){if(t==null)return{};var r=BOe(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function BOe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function JM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Yb(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?JM(Object(r),!0).forEach(function(n){qOe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):JM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qOe(t,e,r){return e=KOe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KOe(t){var e=VOe(t,"string");return fm(e)=="symbol"?e:String(e)}function VOe(t,e){if(fm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HOe(t,e){return Yb(Yb({},e),t)}function WOe(t,e){return t==="symbols"}function ZM(t){var e=t.shapeType,r=t.elementProps;switch(e){case"rectangle":return $.createElement(Hk,r);case"trapezoid":return $.createElement(FOe,r);case"sector":return $.createElement(Rq,r);case"symbols":if(WOe(e))return $.createElement(hk,r);break;default:return null}}function GOe(t){return I.isValidElement(t)?t.props:t}function Zq(t){var e=t.option,r=t.shapeType,n=t.propTransformer,i=n===void 0?HOe:n,a=t.activeClassName,s=a===void 0?"recharts-active-shape":a,o=t.isActive,u=zOe(t,UOe),l;if(I.isValidElement(e))l=I.cloneElement(e,Yb(Yb({},u),GOe(e)));else if(Ne(e))l=e(u);else if(OOe(e)&&!kOe(e)){var c=i(e,u);l=$.createElement(ZM,{shapeType:r,elementProps:c})}else{var h=u;l=$.createElement(ZM,{shapeType:r,elementProps:h})}return o?$.createElement(Ye,{className:s},l):l}function $_(t,e){return e!=null&&"trapezoids"in t.props}function j_(t,e){return e!=null&&"sectors"in t.props}function pm(t,e){return e!=null&&"points"in t.props}function YOe(t,e){var r,n,i=t.x===(e==null||(r=e.labelViewBox)===null||r===void 0?void 0:r.x)||t.x===e.x,a=t.y===(e==null||(n=e.labelViewBox)===null||n===void 0?void 0:n.y)||t.y===e.y;return i&&a}function JOe(t,e){var r=t.endAngle===e.endAngle,n=t.startAngle===e.startAngle;return r&&n}function ZOe(t,e){var r=t.x===e.x,n=t.y===e.y,i=t.z===e.z;return r&&n&&i}function XOe(t,e){var r;return $_(t,e)?r=YOe:j_(t,e)?r=JOe:pm(t,e)&&(r=ZOe),r}function QOe(t,e){var r;return $_(t,e)?r="trapezoids":j_(t,e)?r="sectors":pm(t,e)&&(r="points"),r}function eSe(t,e){if($_(t,e)){var r;return(r=e.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(j_(t,e)){var n;return(n=e.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return pm(t,e)?e.payload:{}}function tSe(t){var e=t.activeTooltipItem,r=t.graphicalItem,n=t.itemData,i=QOe(r,e),a=eSe(r,e),s=n.filter(function(u,l){var c=Nh(a,u),h=r.props[i].filter(function(p){var m=XOe(r,e);return m(p,e)}),d=r.props[i].indexOf(h[h.length-1]),f=l===d;return c&&f}),o=n.indexOf(s[s.length-1]);return o}var gv;function Fh(t){return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fh(t)}function zc(){return zc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zc.apply(this,arguments)}function XM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Nt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XM(Object(r),!0).forEach(function(n){Ri(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XM(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function rSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QM(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qq(n.key),n)}}function nSe(t,e,r){return e&&QM(t.prototype,e),r&&QM(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function iSe(t,e,r){return e=Jb(e),aSe(t,Xq()?Reflect.construct(e,r||[],Jb(t).constructor):e.apply(t,r))}function aSe(t,e){if(e&&(Fh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wc(t)}function Xq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xq=function(){return!!t})()}function Jb(t){return Jb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jb(t)}function wc(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sSe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_E(t,e)}function _E(t,e){return _E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_E(t,e)}function Ri(t,e,r){return e=Qq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qq(t){var e=oSe(t,"string");return Fh(e)=="symbol"?e:String(e)}function oSe(t,e){if(Fh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Fh(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var po=function(t){sSe(e,t);function e(r){var n;return rSe(this,e),n=iSe(this,e,[r]),Ri(wc(n),"pieRef",null),Ri(wc(n),"sectorRefs",[]),Ri(wc(n),"id",wd("recharts-pie-")),Ri(wc(n),"handleAnimationEnd",function(){var i=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Ne(i)&&i()}),Ri(wc(n),"handleAnimationStart",function(){var i=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Ne(i)&&i()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return nSe(e,[{key:"isActiveIndex",value:function(n){var i=this.props.activeIndex;return Array.isArray(i)?i.indexOf(n)!==-1:n===i}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var a=this.props,s=a.label,o=a.labelLine,u=a.dataKey,l=a.valueKey,c=$e(this.props,!1),h=$e(s,!1),d=$e(o,!1),f=s&&s.offsetRadius||20,p=n.map(function(m,g){var v=(m.startAngle+m.endAngle)/2,y=Tt(m.cx,m.cy,m.outerRadius+f,v),b=Nt(Nt(Nt(Nt({},c),m),{},{stroke:"none"},h),{},{index:g,textAnchor:e.getTextAnchor(y.x,m.cx)},y),w=Nt(Nt(Nt(Nt({},c),m),{},{fill:"none",stroke:m.fill},d),{},{index:g,points:[Tt(m.cx,m.cy,m.outerRadius,v),y],key:"line"}),_=u;return De(u)&&De(l)?_="value":De(u)&&(_=l),$.createElement(Ye,{key:"label-".concat(m.startAngle,"-").concat(m.endAngle,"-").concat(m.midAngle,"-").concat(g)},o&&e.renderLabelLineItem(o,w),e.renderLabelItem(s,b,gr(m,_)))});return $.createElement(Ye,{className:"recharts-pie-labels"},p)}},{key:"renderSectorsStatically",value:function(n){var i=this,a=this.props,s=a.activeShape,o=a.blendStroke,u=a.inactiveShape;return n.map(function(l,c){if((l==null?void 0:l.startAngle)===0&&(l==null?void 0:l.endAngle)===0&&n.length!==1)return null;var h=i.isActiveIndex(c),d=u&&i.hasActiveIndex()?u:null,f=h?s:d,p=Nt(Nt({},l),{},{stroke:o?l.fill:l.stroke,tabIndex:-1});return $.createElement(Ye,zc({ref:function(g){g&&!i.sectorRefs.includes(g)&&i.sectorRefs.push(g)},tabIndex:-1,className:"recharts-pie-sector"},Pl(i.props,l,c),{key:"sector-".concat(l==null?void 0:l.startAngle,"-").concat(l==null?void 0:l.endAngle,"-").concat(l.midAngle,"-").concat(c)}),$.createElement(Zq,zc({option:f,isActive:h,shapeType:"sector"},p)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,i=this.props,a=i.sectors,s=i.isAnimationActive,o=i.animationBegin,u=i.animationDuration,l=i.animationEasing,c=i.animationId,h=this.state,d=h.prevSectors,f=h.prevIsAnimationActive;return $.createElement(ls,{begin:o,duration:u,isActive:s,easing:l,from:{t:0},to:{t:1},key:"pie-".concat(c,"-").concat(f),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(p){var m=p.t,g=[],v=a&&a[0],y=v.startAngle;return a.forEach(function(b,w){var _=d&&d[w],O=w>0?di(b,"paddingAngle",0):0;if(_){var P=Un(_.endAngle-_.startAngle,b.endAngle-b.startAngle),x=Nt(Nt({},b),{},{startAngle:y+O,endAngle:y+P(m)+O});g.push(x),y=x.endAngle}else{var j=b.endAngle,k=b.startAngle,R=Un(0,j-k),F=R(m),z=Nt(Nt({},b),{},{startAngle:y+O,endAngle:y+F+O});g.push(z),y=z.endAngle}}),$.createElement(Ye,null,n.renderSectorsStatically(g))})}},{key:"attachKeyboardHandlers",value:function(n){var i=this;n.onkeydown=function(a){if(!a.altKey)switch(a.key){case"ArrowLeft":{var s=++i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[s].focus(),i.setState({sectorToFocus:s});break}case"ArrowRight":{var o=--i.state.sectorToFocus<0?i.sectorRefs.length-1:i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[o].focus(),i.setState({sectorToFocus:o});break}case"Escape":{i.sectorRefs[i.state.sectorToFocus].blur(),i.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,i=n.sectors,a=n.isAnimationActive,s=this.state.prevSectors;return a&&i&&i.length&&(!s||!Nh(s,i))?this.renderSectorsWithAnimation():this.renderSectorsStatically(i)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,i=this.props,a=i.hide,s=i.sectors,o=i.className,u=i.label,l=i.cx,c=i.cy,h=i.innerRadius,d=i.outerRadius,f=i.isAnimationActive,p=this.state.isAnimationFinished;if(a||!s||!s.length||!fe(l)||!fe(c)||!fe(h)||!fe(d))return null;var m=ze("recharts-pie",o);return $.createElement(Ye,{tabIndex:this.props.rootTabIndex,className:m,ref:function(v){n.pieRef=v}},this.renderSectors(),u&&this.renderLabels(s),Ir.renderCallByParent(this.props,null,!1),(!f||p)&&Hs.renderCallByParent(this.props,s,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return i.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:i.curSectors,isAnimationFinished:!0}:n.sectors!==i.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,i){return n>i?"start":n<i?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,i){if($.isValidElement(n))return $.cloneElement(n,i);if(Ne(n))return n(i);var a=ze("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return $.createElement(oh,zc({},i,{type:"linear",className:a}))}},{key:"renderLabelItem",value:function(n,i,a){if($.isValidElement(n))return $.cloneElement(n,i);var s=a;if(Ne(n)&&(s=n(i),$.isValidElement(s)))return s;var o=ze("recharts-pie-label-text",typeof n!="boolean"&&!Ne(n)?n.className:"");return $.createElement(El,zc({},i,{alignmentBaseline:"middle",className:o}),s)}}]),e}(I.PureComponent);gv=po;Ri(po,"displayName","Pie");Ri(po,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!ts.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Ri(po,"parseDeltaAngle",function(t,e){var r=Sn(e-t),n=Math.min(Math.abs(e-t),360);return r*n});Ri(po,"getRealPieData",function(t){var e=t.props,r=e.data,n=e.children,i=$e(t.props,!1),a=Fi(n,m_);return r&&r.length?r.map(function(s,o){return Nt(Nt(Nt({payload:s},i),s),a&&a[o]&&a[o].props)}):a&&a.length?a.map(function(s){return Nt(Nt({},i),s.props)}):[]});Ri(po,"parseCoordinateOfPie",function(t,e){var r=e.top,n=e.left,i=e.width,a=e.height,s=Cq(i,a),o=n+Pn(t.props.cx,i,i/2),u=r+Pn(t.props.cy,a,a/2),l=Pn(t.props.innerRadius,s,0),c=Pn(t.props.outerRadius,s,s*.8),h=t.props.maxRadius||Math.sqrt(i*i+a*a)/2;return{cx:o,cy:u,innerRadius:l,outerRadius:c,maxRadius:h}});Ri(po,"getComposedData",function(t){var e=t.item,r=t.offset,n=gv.getRealPieData(e);if(!n||!n.length)return null;var i=e.props,a=i.cornerRadius,s=i.startAngle,o=i.endAngle,u=i.paddingAngle,l=i.dataKey,c=i.nameKey,h=i.valueKey,d=i.tooltipType,f=Math.abs(e.props.minAngle),p=gv.parseCoordinateOfPie(e,r),m=gv.parseDeltaAngle(s,o),g=Math.abs(m),v=l;De(l)&&De(h)?(wa(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),v="value"):De(l)&&(wa(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),v=h);var y=n.filter(function(x){return gr(x,v,0)!==0}).length,b=(g>=360?y:y-1)*u,w=g-y*f-b,_=n.reduce(function(x,j){var k=gr(j,v,0);return x+(fe(k)?k:0)},0),O;if(_>0){var P;O=n.map(function(x,j){var k=gr(x,v,0),R=gr(x,c,j),F=(fe(k)?k:0)/_,z;j?z=P.endAngle+Sn(m)*u*(k!==0?1:0):z=s;var N=z+Sn(m)*((k!==0?f:0)+F*w),L=(z+N)/2,D=(p.innerRadius+p.outerRadius)/2,q=[{name:R,value:k,payload:x,dataKey:v,type:d}],M=Tt(p.cx,p.cy,D,L);return P=Nt(Nt(Nt({percent:F,cornerRadius:a,name:R,tooltipPayload:q,midAngle:L,middleRadius:D,tooltipPosition:M},x),p),{},{value:gr(x,v),startAngle:z,endAngle:N,payload:x,paddingAngle:Sn(m)*u}),P})}return Nt(Nt({},p),{},{sectors:O,data:n})});var uSe=Math.ceil,lSe=Math.max;function cSe(t,e,r,n){for(var i=-1,a=lSe(uSe((e-t)/(r||1)),0),s=Array(a);a--;)s[n?a:++i]=t,t+=r;return s}var hSe=cSe,dSe=bB,eD=1/0,fSe=17976931348623157e292;function pSe(t){if(!t)return t===0?t:0;if(t=dSe(t),t===eD||t===-eD){var e=t<0?-1:1;return e*fSe}return t===t?t:0}var e9=pSe,mSe=hSe,gSe=p_,Wx=e9;function ySe(t){return function(e,r,n){return n&&typeof n!="number"&&gSe(e,r,n)&&(r=n=void 0),e=Wx(e),r===void 0?(r=e,e=0):r=Wx(r),n=n===void 0?e<r?1:-1:Wx(n),mSe(e,r,n,t)}}var vSe=ySe,bSe=vSe,wSe=bSe(),_Se=wSe;const Zb=Ze(_Se);function mm(t){return mm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mm(t)}function tD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function rD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tD(Object(r),!0).forEach(function(n){t9(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function t9(t,e,r){return e=xSe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xSe(t){var e=OSe(t,"string");return mm(e)=="symbol"?e:String(e)}function OSe(t,e){if(mm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(mm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var SSe=["Webkit","Moz","O","ms"],PSe=function(e,r){if(!e)return null;var n=e.replace(/(\w)/,function(a){return a.toUpperCase()}),i=SSe.reduce(function(a,s){return rD(rD({},a),{},t9({},s+n,r))},{});return i[e]=r,i};function Uh(t){return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uh(t)}function Xb(){return Xb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Xb.apply(this,arguments)}function nD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Gx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nD(Object(r),!0).forEach(function(n){ii(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ESe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n9(n.key),n)}}function ASe(t,e,r){return e&&iD(t.prototype,e),r&&iD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function TSe(t,e,r){return e=Qb(e),kSe(t,r9()?Reflect.construct(e,r||[],Qb(t).constructor):e.apply(t,r))}function kSe(t,e){if(e&&(Uh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Na(t)}function r9(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(r9=function(){return!!t})()}function Qb(t){return Qb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qb(t)}function Na(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function CSe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xE(t,e)}function xE(t,e){return xE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},xE(t,e)}function ii(t,e,r){return e=n9(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n9(t){var e=ISe(t,"string");return Uh(e)=="symbol"?e:String(e)}function ISe(t,e){if(Uh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Uh(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $Se=function(e){var r=e.data,n=e.startIndex,i=e.endIndex,a=e.x,s=e.width,o=e.travellerWidth;if(!r||!r.length)return{};var u=r.length,l=op().domain(Zb(0,u)).range([a,a+s-o]),c=l.domain().map(function(h){return l(h)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:l(n),endX:l(i),scale:l,scaleValues:c}},aD=function(e){return e.changedTouches&&!!e.changedTouches.length},zh=function(t){CSe(e,t);function e(r){var n;return ESe(this,e),n=TSe(this,e,[r]),ii(Na(n),"handleDrag",function(i){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(i):n.state.isSlideMoving&&n.handleSlideDrag(i)}),ii(Na(n),"handleTouchMove",function(i){i.changedTouches!=null&&i.changedTouches.length>0&&n.handleDrag(i.changedTouches[0])}),ii(Na(n),"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var i=n.props,a=i.endIndex,s=i.onDragEnd,o=i.startIndex;s==null||s({endIndex:a,startIndex:o})}),n.detachDragEndListener()}),ii(Na(n),"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),ii(Na(n),"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),ii(Na(n),"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),ii(Na(n),"handleSlideDragStart",function(i){var a=aD(i)?i.changedTouches[0]:i;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:a.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(Na(n),"startX"),endX:n.handleTravellerDragStart.bind(Na(n),"endX")},n.state={},n}return ASe(e,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var i=n.startX,a=n.endX,s=this.state.scaleValues,o=this.props,u=o.gap,l=o.data,c=l.length-1,h=Math.min(i,a),d=Math.max(i,a),f=e.getIndexInRange(s,h),p=e.getIndexInRange(s,d);return{startIndex:f-f%u,endIndex:p===c?c:p-p%u}}},{key:"getTextOfTick",value:function(n){var i=this.props,a=i.data,s=i.tickFormatter,o=i.dataKey,u=gr(a[n],o,n);return Ne(s)?s(u,n):u}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var i=this.state,a=i.slideMoveStartX,s=i.startX,o=i.endX,u=this.props,l=u.x,c=u.width,h=u.travellerWidth,d=u.startIndex,f=u.endIndex,p=u.onChange,m=n.pageX-a;m>0?m=Math.min(m,l+c-h-o,l+c-h-s):m<0&&(m=Math.max(m,l-s,l-o));var g=this.getIndex({startX:s+m,endX:o+m});(g.startIndex!==d||g.endIndex!==f)&&p&&p(g),this.setState({startX:s+m,endX:o+m,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,i){var a=aD(i)?i.changedTouches[0]:i;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:a.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var i=this.state,a=i.brushMoveStartX,s=i.movingTravellerId,o=i.endX,u=i.startX,l=this.state[s],c=this.props,h=c.x,d=c.width,f=c.travellerWidth,p=c.onChange,m=c.gap,g=c.data,v={startX:this.state.startX,endX:this.state.endX},y=n.pageX-a;y>0?y=Math.min(y,h+d-f-l):y<0&&(y=Math.max(y,h-l)),v[s]=l+y;var b=this.getIndex(v),w=b.startIndex,_=b.endIndex,O=function(){var x=g.length-1;return s==="startX"&&(o>u?w%m===0:_%m===0)||o<u&&_===x||s==="endX"&&(o>u?_%m===0:w%m===0)||o>u&&_===x};this.setState(ii(ii({},s,l+y),"brushMoveStartX",n.pageX),function(){p&&O()&&p(b)})}},{key:"handleTravellerMoveKeyboard",value:function(n,i){var a=this,s=this.state,o=s.scaleValues,u=s.startX,l=s.endX,c=this.state[i],h=o.indexOf(c);if(h!==-1){var d=h+n;if(!(d===-1||d>=o.length)){var f=o[d];i==="startX"&&f>=l||i==="endX"&&f<=u||this.setState(ii({},i,f),function(){a.props.onChange(a.getIndex({startX:a.state.startX,endX:a.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,i=n.x,a=n.y,s=n.width,o=n.height,u=n.fill,l=n.stroke;return $.createElement("rect",{stroke:l,fill:u,x:i,y:a,width:s,height:o})}},{key:"renderPanorama",value:function(){var n=this.props,i=n.x,a=n.y,s=n.width,o=n.height,u=n.data,l=n.children,c=n.padding,h=I.Children.only(l);return h?$.cloneElement(h,{x:i,y:a,width:s,height:o,margin:c,compact:!0,data:u}):null}},{key:"renderTravellerLayer",value:function(n,i){var a,s,o=this,u=this.props,l=u.y,c=u.travellerWidth,h=u.height,d=u.traveller,f=u.ariaLabel,p=u.data,m=u.startIndex,g=u.endIndex,v=Math.max(n,this.props.x),y=Gx(Gx({},$e(this.props,!1)),{},{x:v,y:l,width:c,height:h}),b=f||"Min value: ".concat((a=p[m])===null||a===void 0?void 0:a.name,", Max value: ").concat((s=p[g])===null||s===void 0?void 0:s.name);return $.createElement(Ye,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[i],onTouchStart:this.travellerDragStartHandlers[i],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),o.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,i))},onFocus:function(){o.setState({isTravellerFocused:!0})},onBlur:function(){o.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},e.renderTraveller(d,y))}},{key:"renderSlide",value:function(n,i){var a=this.props,s=a.y,o=a.height,u=a.stroke,l=a.travellerWidth,c=Math.min(n,i)+l,h=Math.max(Math.abs(i-n)-l,0);return $.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:u,fillOpacity:.2,x:c,y:s,width:h,height:o})}},{key:"renderText",value:function(){var n=this.props,i=n.startIndex,a=n.endIndex,s=n.y,o=n.height,u=n.travellerWidth,l=n.stroke,c=this.state,h=c.startX,d=c.endX,f=5,p={pointerEvents:"none",fill:l};return $.createElement(Ye,{className:"recharts-brush-texts"},$.createElement(El,Xb({textAnchor:"end",verticalAnchor:"middle",x:Math.min(h,d)-f,y:s+o/2},p),this.getTextOfTick(i)),$.createElement(El,Xb({textAnchor:"start",verticalAnchor:"middle",x:Math.max(h,d)+u+f,y:s+o/2},p),this.getTextOfTick(a)))}},{key:"render",value:function(){var n=this.props,i=n.data,a=n.className,s=n.children,o=n.x,u=n.y,l=n.width,c=n.height,h=n.alwaysShowText,d=this.state,f=d.startX,p=d.endX,m=d.isTextActive,g=d.isSlideMoving,v=d.isTravellerMoving,y=d.isTravellerFocused;if(!i||!i.length||!fe(o)||!fe(u)||!fe(l)||!fe(c)||l<=0||c<=0)return null;var b=ze("recharts-brush",a),w=$.Children.count(s)===1,_=PSe("userSelect","none");return $.createElement(Ye,{className:b,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:_},this.renderBackground(),w&&this.renderPanorama(),this.renderSlide(f,p),this.renderTravellerLayer(f,"startX"),this.renderTravellerLayer(p,"endX"),(m||g||v||y||h)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var i=n.x,a=n.y,s=n.width,o=n.height,u=n.stroke,l=Math.floor(a+o/2)-1;return $.createElement($.Fragment,null,$.createElement("rect",{x:i,y:a,width:s,height:o,fill:u,stroke:"none"}),$.createElement("line",{x1:i+1,y1:l,x2:i+s-1,y2:l,fill:"none",stroke:"#fff"}),$.createElement("line",{x1:i+1,y1:l+2,x2:i+s-1,y2:l+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,i){var a;return $.isValidElement(n)?a=$.cloneElement(n,i):Ne(n)?a=n(i):a=e.renderDefaultTraveller(i),a}},{key:"getDerivedStateFromProps",value:function(n,i){var a=n.data,s=n.width,o=n.x,u=n.travellerWidth,l=n.updateId,c=n.startIndex,h=n.endIndex;if(a!==i.prevData||l!==i.prevUpdateId)return Gx({prevData:a,prevTravellerWidth:u,prevUpdateId:l,prevX:o,prevWidth:s},a&&a.length?$Se({data:a,width:s,x:o,travellerWidth:u,startIndex:c,endIndex:h}):{scale:null,scaleValues:null});if(i.scale&&(s!==i.prevWidth||o!==i.prevX||u!==i.prevTravellerWidth)){i.scale.range([o,o+s-u]);var d=i.scale.domain().map(function(f){return i.scale(f)});return{prevData:a,prevTravellerWidth:u,prevUpdateId:l,prevX:o,prevWidth:s,startX:i.scale(n.startIndex),endX:i.scale(n.endIndex),scaleValues:d}}return null}},{key:"getIndexInRange",value:function(n,i){for(var a=n.length,s=0,o=a-1;o-s>1;){var u=Math.floor((s+o)/2);n[u]>i?o=u:s=u}return i>=n[o]?o:s}}]),e}(I.PureComponent);ii(zh,"displayName","Brush");ii(zh,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var jSe=vk;function RSe(t,e){var r;return jSe(t,function(n,i,a){return r=e(n,i,a),!r}),!!r}var NSe=RSe,MSe=Vz,DSe=ys,LSe=NSe,FSe=Xn,USe=p_;function zSe(t,e,r){var n=FSe(t)?MSe:LSe;return r&&USe(t,e,r)&&(e=void 0),n(t,DSe(e))}var BSe=zSe;const qSe=Ze(BSe);var ns=function(e,r){var n=e.alwaysShow,i=e.ifOverflow;return n&&(i="extendDomain"),i===r},sD=pB;function KSe(t,e,r){e=="__proto__"&&sD?sD(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var VSe=KSe,HSe=VSe,WSe=dB,GSe=ys;function YSe(t,e){var r={};return e=GSe(e),WSe(t,function(n,i,a){HSe(r,i,e(n,i,a))}),r}var JSe=YSe;const ZSe=Ze(JSe);function XSe(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0}var QSe=XSe,ePe=vk;function tPe(t,e){var r=!0;return ePe(t,function(n,i,a){return r=!!e(n,i,a),r}),r}var rPe=tPe,nPe=QSe,iPe=rPe,aPe=ys,sPe=Xn,oPe=p_;function uPe(t,e,r){var n=sPe(t)?nPe:iPe;return r&&oPe(t,e,r)&&(e=void 0),n(t,aPe(e))}var lPe=uPe;const i9=Ze(lPe);var cPe=["x","y"];function gm(t){return gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gm(t)}function OE(){return OE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},OE.apply(this,arguments)}function oD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Sf(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oD(Object(r),!0).forEach(function(n){hPe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hPe(t,e,r){return e=dPe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dPe(t){var e=fPe(t,"string");return gm(e)=="symbol"?e:String(e)}function fPe(t,e){if(gm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(gm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pPe(t,e){if(t==null)return{};var r=mPe(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function mPe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function gPe(t,e){var r=t.x,n=t.y,i=pPe(t,cPe),a="".concat(r),s=parseInt(a,10),o="".concat(n),u=parseInt(o,10),l="".concat(e.height||i.height),c=parseInt(l,10),h="".concat(e.width||i.width),d=parseInt(h,10);return Sf(Sf(Sf(Sf(Sf({},e),i),s?{x:s}:{}),u?{y:u}:{}),{},{height:c,width:d,name:e.name,radius:e.radius})}function uD(t){return $.createElement(Zq,OE({shapeType:"rectangle",propTransformer:gPe,activeClassName:"recharts-active-bar"},t))}var yPe=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,i){if(typeof e=="number")return e;var a=typeof n=="number";return a?e(n,i):(a||Tl(!1),r)}},vPe=["value","background"],a9;function Bh(t){return Bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bh(t)}function bPe(t,e){if(t==null)return{};var r=wPe(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function wPe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function ew(){return ew=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ew.apply(this,arguments)}function lD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ar(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lD(Object(r),!0).forEach(function(n){Ho(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _Pe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,o9(n.key),n)}}function xPe(t,e,r){return e&&cD(t.prototype,e),r&&cD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function OPe(t,e,r){return e=tw(e),SPe(t,s9()?Reflect.construct(e,r||[],tw(t).constructor):e.apply(t,r))}function SPe(t,e){if(e&&(Bh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mf(t)}function s9(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(s9=function(){return!!t})()}function tw(t){return tw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tw(t)}function Mf(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PPe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&SE(t,e)}function SE(t,e){return SE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},SE(t,e)}function Ho(t,e,r){return e=o9(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o9(t){var e=EPe(t,"string");return Bh(e)=="symbol"?e:String(e)}function EPe(t,e){if(Bh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Bh(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _g=function(t){PPe(e,t);function e(){var r;_Pe(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return r=OPe(this,e,[].concat(i)),Ho(Mf(r),"state",{isAnimationFinished:!1}),Ho(Mf(r),"id",wd("recharts-bar-")),Ho(Mf(r),"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),s&&s()}),Ho(Mf(r),"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),s&&s()}),r}return xPe(e,[{key:"renderRectanglesStatically",value:function(n){var i=this,a=this.props,s=a.shape,o=a.dataKey,u=a.activeIndex,l=a.activeBar,c=$e(this.props,!1);return n&&n.map(function(h,d){var f=d===u,p=f?l:s,m=Ar(Ar(Ar({},c),h),{},{isActive:f,option:p,index:d,dataKey:o,onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd});return $.createElement(Ye,ew({className:"recharts-bar-rectangle"},Pl(i.props,h,d),{key:"rectangle-".concat(h==null?void 0:h.x,"-").concat(h==null?void 0:h.y,"-").concat(h==null?void 0:h.value)}),$.createElement(uD,m))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,i=this.props,a=i.data,s=i.layout,o=i.isAnimationActive,u=i.animationBegin,l=i.animationDuration,c=i.animationEasing,h=i.animationId,d=this.state.prevData;return $.createElement(ls,{begin:u,duration:l,isActive:o,easing:c,from:{t:0},to:{t:1},key:"bar-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(f){var p=f.t,m=a.map(function(g,v){var y=d&&d[v];if(y){var b=Un(y.x,g.x),w=Un(y.y,g.y),_=Un(y.width,g.width),O=Un(y.height,g.height);return Ar(Ar({},g),{},{x:b(p),y:w(p),width:_(p),height:O(p)})}if(s==="horizontal"){var P=Un(0,g.height),x=P(p);return Ar(Ar({},g),{},{y:g.y+g.height-x,height:x})}var j=Un(0,g.width),k=j(p);return Ar(Ar({},g),{},{width:k})});return $.createElement(Ye,null,n.renderRectanglesStatically(m))})}},{key:"renderRectangles",value:function(){var n=this.props,i=n.data,a=n.isAnimationActive,s=this.state.prevData;return a&&i&&i.length&&(!s||!Nh(s,i))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(i)}},{key:"renderBackground",value:function(){var n=this,i=this.props,a=i.data,s=i.dataKey,o=i.activeIndex,u=$e(this.props.background,!1);return a.map(function(l,c){l.value;var h=l.background,d=bPe(l,vPe);if(!h)return null;var f=Ar(Ar(Ar(Ar(Ar({},d),{},{fill:"#eee"},h),u),Pl(n.props,l,c)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:s,index:c,key:"background-bar-".concat(c),className:"recharts-bar-background-rectangle"});return $.createElement(uD,ew({option:n.props.background,isActive:c===o},f))})}},{key:"renderErrorBar",value:function(n,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var a=this.props,s=a.data,o=a.xAxis,u=a.yAxis,l=a.layout,c=a.children,h=Fi(c,E_);if(!h)return null;var d=l==="vertical"?s[0].height/2:s[0].width/2,f=function(g,v){var y=Array.isArray(g.value)?g.value[1]:g.value;return{x:g.x,y:g.y,value:y,errorVal:gr(g,v)}},p={clipPath:n?"url(#clipPath-".concat(i,")"):null};return $.createElement(Ye,p,h.map(function(m){return $.cloneElement(m,{key:"error-bar-".concat(i,"-").concat(m.props.dataKey),data:s,xAxis:o,yAxis:u,layout:l,offset:d,dataPointFormatter:f})}))}},{key:"render",value:function(){var n=this.props,i=n.hide,a=n.data,s=n.className,o=n.xAxis,u=n.yAxis,l=n.left,c=n.top,h=n.width,d=n.height,f=n.isAnimationActive,p=n.background,m=n.id;if(i||!a||!a.length)return null;var g=this.state.isAnimationFinished,v=ze("recharts-bar",s),y=o&&o.allowDataOverflow,b=u&&u.allowDataOverflow,w=y||b,_=De(m)?this.id:m;return $.createElement(Ye,{className:v},y||b?$.createElement("defs",null,$.createElement("clipPath",{id:"clipPath-".concat(_)},$.createElement("rect",{x:y?l:l-h/2,y:b?c:c-d/2,width:y?h:h*2,height:b?d:d*2}))):null,$.createElement(Ye,{className:"recharts-bar-rectangles",clipPath:w?"url(#clipPath-".concat(_,")"):null},p?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(w,_),(!f||g)&&Hs.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:i.curData}:n.data!==i.curData?{curData:n.data}:null}}]),e}(I.PureComponent);a9=_g;Ho(_g,"displayName","Bar");Ho(_g,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!ts.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Ho(_g,"getComposedData",function(t){var e=t.props,r=t.item,n=t.barPosition,i=t.bandSize,a=t.xAxis,s=t.yAxis,o=t.xAxisTicks,u=t.yAxisTicks,l=t.stackedData,c=t.dataStartIndex,h=t.displayedData,d=t.offset,f=w0e(n,r);if(!f)return null;var p=e.layout,m=r.props,g=m.dataKey,v=m.children,y=m.minPointSize,b=p==="horizontal"?s:a,w=l?b.scale.domain():null,_=A0e({numericAxis:b}),O=Fi(v,m_),P=h.map(function(x,j){var k,R,F,z,N,L;l?k=_0e(l[c+j],w):(k=gr(x,g),Array.isArray(k)||(k=[_,k]));var D=yPe(y,a9.defaultProps.minPointSize)(k[1],j);if(p==="horizontal"){var q,M=[s.scale(k[0]),s.scale(k[1])],V=M[0],G=M[1];R=X2({axis:a,ticks:o,bandSize:i,offset:f.offset,entry:x,index:j}),F=(q=G??V)!==null&&q!==void 0?q:void 0,z=f.size;var re=V-G;if(N=Number.isNaN(re)?0:re,L={x:R,y:s.y,width:z,height:s.height},Math.abs(D)>0&&Math.abs(N)<Math.abs(D)){var K=Sn(N||D)*(Math.abs(D)-Math.abs(N));F-=K,N+=K}}else{var J=[a.scale(k[0]),a.scale(k[1])],ie=J[0],oe=J[1];if(R=ie,F=X2({axis:s,ticks:u,bandSize:i,offset:f.offset,entry:x,index:j}),z=oe-ie,N=f.size,L={x:a.x,y:F,width:a.width,height:N},Math.abs(D)>0&&Math.abs(z)<Math.abs(D)){var S=Sn(z||D)*(Math.abs(D)-Math.abs(z));z+=S}}return Ar(Ar(Ar({},x),{},{x:R,y:F,width:z,height:N,value:l?k:k[1],payload:x,background:L},O&&O[j]&&O[j].props),{},{tooltipPayload:[Tq(r,x)],tooltipPosition:{x:R+z/2,y:F+N/2}})});return Ar({data:P,layout:p},d)});function ym(t){return ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ym(t)}function APe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u9(n.key),n)}}function TPe(t,e,r){return e&&hD(t.prototype,e),r&&hD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ca(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dD(Object(r),!0).forEach(function(n){R_(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function R_(t,e,r){return e=u9(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u9(t){var e=kPe(t,"string");return ym(e)=="symbol"?e:String(e)}function kPe(t,e){if(ym(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ym(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var CPe=function(e,r,n,i,a){var s=e.width,o=e.height,u=e.layout,l=e.children,c=Object.keys(r),h={left:n.left,leftMirror:n.left,right:s-n.right,rightMirror:s-n.right,top:n.top,topMirror:n.top,bottom:o-n.bottom,bottomMirror:o-n.bottom},d=!!si(l,_g);return c.reduce(function(f,p){var m=r[p],g=m.orientation,v=m.domain,y=m.padding,b=y===void 0?{}:y,w=m.mirror,_=m.reversed,O="".concat(g).concat(w?"Mirror":""),P,x,j,k,R;if(m.type==="number"&&(m.padding==="gap"||m.padding==="no-gap")){var F=v[1]-v[0],z=1/0,N=m.categoricalDomain.sort();if(N.forEach(function(ie,oe){oe>0&&(z=Math.min((ie||0)-(N[oe-1]||0),z))}),Number.isFinite(z)){var L=z/F,D=m.layout==="vertical"?n.height:n.width;if(m.padding==="gap"&&(P=L*D/2),m.padding==="no-gap"){var q=Pn(e.barCategoryGap,L*D),M=L*D/2;P=M-q-(M-q)/D*q}}}i==="xAxis"?x=[n.left+(b.left||0)+(P||0),n.left+n.width-(b.right||0)-(P||0)]:i==="yAxis"?x=u==="horizontal"?[n.top+n.height-(b.bottom||0),n.top+(b.top||0)]:[n.top+(b.top||0)+(P||0),n.top+n.height-(b.bottom||0)-(P||0)]:x=m.range,_&&(x=[x[1],x[0]]);var V=Sq(m,a,d),G=V.scale,re=V.realScaleType;G.domain(v).range(x),Pq(G);var K=Eq(G,ca(ca({},m),{},{realScaleType:re}));i==="xAxis"?(R=g==="top"&&!w||g==="bottom"&&w,j=n.left,k=h[O]-R*m.height):i==="yAxis"&&(R=g==="left"&&!w||g==="right"&&w,j=h[O]-R*m.width,k=n.top);var J=ca(ca(ca({},m),K),{},{realScaleType:re,x:j,y:k,scale:G,width:i==="xAxis"?n.width:m.width,height:i==="yAxis"?n.height:m.height});return J.bandSize=Fb(J,K),!m.hide&&i==="xAxis"?h[O]+=(R?-1:1)*J.height:m.hide||(h[O]+=(R?-1:1)*J.width),ca(ca({},f),{},R_({},p,J))},{})},l9=function(e,r){var n=e.x,i=e.y,a=r.x,s=r.y;return{x:Math.min(n,a),y:Math.min(i,s),width:Math.abs(a-n),height:Math.abs(s-i)}},IPe=function(e){var r=e.x1,n=e.y1,i=e.x2,a=e.y2;return l9({x:r,y:n},{x:i,y:a})},c9=function(){function t(e){APe(this,t),this.scale=e}return TPe(t,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.bandAware,a=n.position;if(r!==void 0){if(a)switch(a){case"start":return this.scale(r);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+s}case"end":{var o=this.bandwidth?this.bandwidth():0;return this.scale(r)+o}default:return this.scale(r)}if(i){var u=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+u}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),i=n[0],a=n[n.length-1];return i<=a?r>=i&&r<=a:r>=a&&r<=i}}],[{key:"create",value:function(r){return new t(r)}}]),t}();R_(c9,"EPS",1e-4);var Wk=function(e){var r=Object.keys(e).reduce(function(n,i){return ca(ca({},n),{},R_({},i,c9.create(e[i])))},{});return ca(ca({},r),{},{apply:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=a.bandAware,o=a.position;return ZSe(i,function(u,l){return r[l].apply(u,{bandAware:s,position:o})})},isInRange:function(i){return i9(i,function(a,s){return r[s].isInRange(a)})}})};function $Pe(t){return(t%180+180)%180}var jPe=function(e){var r=e.width,n=e.height,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=$Pe(i),s=a*Math.PI/180,o=Math.atan(n/r),u=s>o&&s<Math.PI-o?n/Math.sin(s):r/Math.cos(s);return Math.abs(u)},RPe=ys,NPe=gg,MPe=d_;function DPe(t){return function(e,r,n){var i=Object(e);if(!NPe(e)){var a=RPe(r);e=MPe(e),r=function(o){return a(i[o],o,i)}}var s=t(e,r,n);return s>-1?i[a?e[s]:s]:void 0}}var LPe=DPe,FPe=e9;function UPe(t){var e=FPe(t),r=e%1;return e===e?r?e-r:e:0}var zPe=UPe,BPe=aB,qPe=ys,KPe=zPe,VPe=Math.max;function HPe(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=r==null?0:KPe(r);return i<0&&(i=VPe(n+i,0)),BPe(t,qPe(e),i)}var WPe=HPe,GPe=LPe,YPe=WPe,JPe=GPe(YPe),ZPe=JPe;const XPe=Ze(ZPe);var QPe=xae(function(t){return{x:t.left,y:t.top,width:t.width,height:t.height}},function(t){return["l",t.left,"t",t.top,"w",t.width,"h",t.height].join("")}),Gk=I.createContext(void 0),Yk=I.createContext(void 0),h9=I.createContext(void 0),d9=I.createContext({}),f9=I.createContext(void 0),p9=I.createContext(0),m9=I.createContext(0),fD=function(e){var r=e.state,n=r.xAxisMap,i=r.yAxisMap,a=r.offset,s=e.clipPathId,o=e.children,u=e.width,l=e.height,c=QPe(a);return $.createElement(Gk.Provider,{value:n},$.createElement(Yk.Provider,{value:i},$.createElement(d9.Provider,{value:a},$.createElement(h9.Provider,{value:c},$.createElement(f9.Provider,{value:s},$.createElement(p9.Provider,{value:l},$.createElement(m9.Provider,{value:u},o)))))))},eEe=function(){return I.useContext(f9)},g9=function(e){var r=I.useContext(Gk);r==null&&Tl(!1);var n=r[e];return n==null&&Tl(!1),n},tEe=function(){var e=I.useContext(Gk);return Uo(e)},rEe=function(){var e=I.useContext(Yk),r=XPe(e,function(n){return i9(n.domain,Number.isFinite)});return r||Uo(e)},y9=function(e){var r=I.useContext(Yk);r==null&&Tl(!1);var n=r[e];return n==null&&Tl(!1),n},nEe=function(){var e=I.useContext(h9);return e},iEe=function(){return I.useContext(d9)},Jk=function(){return I.useContext(m9)},Zk=function(){return I.useContext(p9)};function vm(t){return vm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vm(t)}function pD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function mD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pD(Object(r),!0).forEach(function(n){aEe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function aEe(t,e,r){return e=sEe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sEe(t){var e=oEe(t,"string");return vm(e)=="symbol"?e:String(e)}function oEe(t,e){if(vm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(vm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uEe(t,e){return dEe(t)||hEe(t,e)||cEe(t,e)||lEe()}function lEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cEe(t,e){if(t){if(typeof t=="string")return gD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gD(t,e)}}function gD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function hEe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw i}}return o}}function dEe(t){if(Array.isArray(t))return t}function PE(){return PE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},PE.apply(this,arguments)}var fEe=function(e,r){var n;return $.isValidElement(e)?n=$.cloneElement(e,r):Ne(e)?n=e(r):n=$.createElement("line",PE({},r,{className:"recharts-reference-line-line"})),n},pEe=function(e,r,n,i,a,s,o,u,l){var c=a.x,h=a.y,d=a.width,f=a.height;if(n){var p=l.y,m=e.y.apply(p,{position:s});if(ns(l,"discard")&&!e.y.isInRange(m))return null;var g=[{x:c+d,y:m},{x:c,y:m}];return u==="left"?g.reverse():g}if(r){var v=l.x,y=e.x.apply(v,{position:s});if(ns(l,"discard")&&!e.x.isInRange(y))return null;var b=[{x:y,y:h+f},{x:y,y:h}];return o==="top"?b.reverse():b}if(i){var w=l.segment,_=w.map(function(O){return e.apply(O,{position:s})});return ns(l,"discard")&&qSe(_,function(O){return!e.isInRange(O)})?null:_}return null};function Xk(t){var e=t.x,r=t.y,n=t.segment,i=t.xAxisId,a=t.yAxisId,s=t.shape,o=t.className,u=t.alwaysShow,l=eEe(),c=g9(i),h=y9(a),d=nEe();if(!l||!d)return null;wa(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=Wk({x:c.scale,y:h.scale}),p=vr(e),m=vr(r),g=n&&n.length===2,v=pEe(f,p,m,g,d,t.position,c.orientation,h.orientation,t);if(!v)return null;var y=uEe(v,2),b=y[0],w=b.x,_=b.y,O=y[1],P=O.x,x=O.y,j=ns(t,"hidden")?"url(#".concat(l,")"):void 0,k=mD(mD({clipPath:j},$e(t,!0)),{},{x1:w,y1:_,x2:P,y2:x});return $.createElement(Ye,{className:ze("recharts-reference-line",o)},fEe(s,k),Ir.renderCallByParent(t,IPe({x1:w,y1:_,x2:P,y2:x})))}Xk.displayName="ReferenceLine";Xk.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"};function bm(t){return bm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bm(t)}function EE(){return EE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},EE.apply(this,arguments)}function yD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function vD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yD(Object(r),!0).forEach(function(n){mEe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mEe(t,e,r){return e=gEe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gEe(t){var e=yEe(t,"string");return bm(e)=="symbol"?e:String(e)}function yEe(t,e){if(bm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(bm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vEe=function(e){var r=e.x,n=e.y,i=e.xAxis,a=e.yAxis,s=Wk({x:i.scale,y:a.scale}),o=s.apply({x:r,y:n},{bandAware:!0});return ns(e,"discard")&&!s.isInRange(o)?null:o};function xg(t){var e=t.x,r=t.y,n=t.r,i=t.alwaysShow,a=t.clipPathId,s=vr(e),o=vr(r);if(wa(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!s||!o)return null;var u=vEe(t);if(!u)return null;var l=u.x,c=u.y,h=t.shape,d=t.className,f=ns(t,"hidden")?"url(#".concat(a,")"):void 0,p=vD(vD({clipPath:f},$e(t,!0)),{},{cx:l,cy:c});return $.createElement(Ye,{className:ze("recharts-reference-dot",d)},xg.renderDot(h,p),Ir.renderCallByParent(t,{x:l-n,y:c-n,width:2*n,height:2*n}))}xg.displayName="ReferenceDot";xg.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1};xg.renderDot=function(t,e){var r;return $.isValidElement(t)?r=$.cloneElement(t,e):Ne(t)?r=t(e):r=$.createElement(A_,EE({},e,{cx:e.cx,cy:e.cy,className:"recharts-reference-dot-dot"})),r};function wm(t){return wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wm(t)}function AE(){return AE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},AE.apply(this,arguments)}function bD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function wD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bD(Object(r),!0).forEach(function(n){bEe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bEe(t,e,r){return e=wEe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wEe(t){var e=_Ee(t,"string");return wm(e)=="symbol"?e:String(e)}function _Ee(t,e){if(wm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(wm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xEe=function(e,r,n,i,a){var s=a.x1,o=a.x2,u=a.y1,l=a.y2,c=a.xAxis,h=a.yAxis;if(!c||!h)return null;var d=Wk({x:c.scale,y:h.scale}),f={x:e?d.x.apply(s,{position:"start"}):d.x.rangeMin,y:n?d.y.apply(u,{position:"start"}):d.y.rangeMin},p={x:r?d.x.apply(o,{position:"end"}):d.x.rangeMax,y:i?d.y.apply(l,{position:"end"}):d.y.rangeMax};return ns(a,"discard")&&(!d.isInRange(f)||!d.isInRange(p))?null:l9(f,p)};function Og(t){var e=t.x1,r=t.x2,n=t.y1,i=t.y2,a=t.className,s=t.alwaysShow,o=t.clipPathId;wa(s===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var u=vr(e),l=vr(r),c=vr(n),h=vr(i),d=t.shape;if(!u&&!l&&!c&&!h&&!d)return null;var f=xEe(u,l,c,h,t);if(!f&&!d)return null;var p=ns(t,"hidden")?"url(#".concat(o,")"):void 0;return $.createElement(Ye,{className:ze("recharts-reference-area",a)},Og.renderRect(d,wD(wD({clipPath:p},$e(t,!0)),f)),Ir.renderCallByParent(t,f))}Og.displayName="ReferenceArea";Og.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1};Og.renderRect=function(t,e){var r;return $.isValidElement(t)?r=$.cloneElement(t,e):Ne(t)?r=t(e):r=$.createElement(Hk,AE({},e,{className:"recharts-reference-area-rect"})),r};function v9(t,e,r){if(e<1)return[];if(e===1&&r===void 0)return t;for(var n=[],i=0;i<t.length;i+=e)if(r===void 0||r(t[i])===!0)n.push(t[i]);else return;return n}function OEe(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return jPe(n,r)}function SEe(t,e,r){var n=r==="width",i=t.x,a=t.y,s=t.width,o=t.height;return e===1?{start:n?i:a,end:n?i+s:a+o}:{start:n?i+s:a+o,end:n?i:a}}function rw(t,e,r,n,i){if(t*e<t*n||t*e>t*i)return!1;var a=r();return t*(e-t*a/2-n)>=0&&t*(e+t*a/2-i)<=0}function PEe(t,e){return v9(t,e+1)}function EEe(t,e,r,n,i){for(var a=(n||[]).slice(),s=e.start,o=e.end,u=0,l=1,c=s,h=function(){var p=n==null?void 0:n[u];if(p===void 0)return{v:v9(n,l)};var m=u,g,v=function(){return g===void 0&&(g=r(p,m)),g},y=p.coordinate,b=u===0||rw(t,y,v,c,o);b||(u=0,c=s,l+=1),b&&(c=y+t*(v()/2+i),u+=l)},d;l<=a.length;)if(d=h(),d)return d.v;return[]}function _m(t){return _m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_m(t)}function _D(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function an(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_D(Object(r),!0).forEach(function(n){AEe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_D(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function AEe(t,e,r){return e=TEe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TEe(t){var e=kEe(t,"string");return _m(e)=="symbol"?e:String(e)}function kEe(t,e){if(_m(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(_m(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CEe(t,e,r,n,i){for(var a=(n||[]).slice(),s=a.length,o=e.start,u=e.end,l=function(d){var f=a[d],p,m=function(){return p===void 0&&(p=r(f,d)),p};if(d===s-1){var g=t*(f.coordinate+t*m()/2-u);a[d]=f=an(an({},f),{},{tickCoord:g>0?f.coordinate-g*t:f.coordinate})}else a[d]=f=an(an({},f),{},{tickCoord:f.coordinate});var v=rw(t,f.tickCoord,m,o,u);v&&(u=f.tickCoord-t*(m()/2+i),a[d]=an(an({},f),{},{isShow:!0}))},c=s-1;c>=0;c--)l(c);return a}function IEe(t,e,r,n,i,a){var s=(n||[]).slice(),o=s.length,u=e.start,l=e.end;if(a){var c=n[o-1],h=r(c,o-1),d=t*(c.coordinate+t*h/2-l);s[o-1]=c=an(an({},c),{},{tickCoord:d>0?c.coordinate-d*t:c.coordinate});var f=rw(t,c.tickCoord,function(){return h},u,l);f&&(l=c.tickCoord-t*(h/2+i),s[o-1]=an(an({},c),{},{isShow:!0}))}for(var p=a?o-1:o,m=function(y){var b=s[y],w,_=function(){return w===void 0&&(w=r(b,y)),w};if(y===0){var O=t*(b.coordinate-t*_()/2-u);s[y]=b=an(an({},b),{},{tickCoord:O<0?b.coordinate-O*t:b.coordinate})}else s[y]=b=an(an({},b),{},{tickCoord:b.coordinate});var P=rw(t,b.tickCoord,_,u,l);P&&(u=b.tickCoord+t*(_()/2+i),s[y]=an(an({},b),{},{isShow:!0}))},g=0;g<p;g++)m(g);return s}function Qk(t,e,r){var n=t.tick,i=t.ticks,a=t.viewBox,s=t.minTickGap,o=t.orientation,u=t.interval,l=t.tickFormatter,c=t.unit,h=t.angle;if(!i||!i.length||!n)return[];if(fe(u)||ts.isSsr)return PEe(i,typeof u=="number"&&fe(u)?u:0);var d=[],f=o==="top"||o==="bottom"?"width":"height",p=c&&f==="width"?sp(c,{fontSize:e,letterSpacing:r}):{width:0,height:0},m=function(b,w){var _=Ne(l)?l(b.value,w):b.value;return f==="width"?OEe(sp(_,{fontSize:e,letterSpacing:r}),p,h):sp(_,{fontSize:e,letterSpacing:r})[f]},g=i.length>=2?Sn(i[1].coordinate-i[0].coordinate):1,v=SEe(a,g,f);return u==="equidistantPreserveStart"?EEe(g,v,m,i,s):(u==="preserveStart"||u==="preserveStartEnd"?d=IEe(g,v,m,i,s,u==="preserveStartEnd"):d=CEe(g,v,m,i,s),d.filter(function(y){return y.isShow}))}var $Ee=["viewBox"],jEe=["viewBox"],REe=["ticks"];function qh(t){return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qh(t)}function Bc(){return Bc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Bc.apply(this,arguments)}function xD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function yn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xD(Object(r),!0).forEach(function(n){eC(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Yx(t,e){if(t==null)return{};var r=NEe(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function NEe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function MEe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,w9(n.key),n)}}function DEe(t,e,r){return e&&OD(t.prototype,e),r&&OD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function LEe(t,e,r){return e=nw(e),FEe(t,b9()?Reflect.construct(e,r||[],nw(t).constructor):e.apply(t,r))}function FEe(t,e){if(e&&(qh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UEe(t)}function UEe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b9(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(b9=function(){return!!t})()}function nw(t){return nw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nw(t)}function zEe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&TE(t,e)}function TE(t,e){return TE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TE(t,e)}function eC(t,e,r){return e=w9(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function w9(t){var e=BEe(t,"string");return qh(e)=="symbol"?e:String(e)}function BEe(t,e){if(qh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qh(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Td=function(t){zEe(e,t);function e(r){var n;return MEe(this,e),n=LEe(this,e,[r]),n.state={fontSize:"",letterSpacing:""},n}return DEe(e,[{key:"shouldComponentUpdate",value:function(n,i){var a=n.viewBox,s=Yx(n,$Ee),o=this.props,u=o.viewBox,l=Yx(o,jEe);return!ih(a,u)||!ih(s,l)||!ih(i,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var i=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];i&&this.setState({fontSize:window.getComputedStyle(i).fontSize,letterSpacing:window.getComputedStyle(i).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var i=this.props,a=i.x,s=i.y,o=i.width,u=i.height,l=i.orientation,c=i.tickSize,h=i.mirror,d=i.tickMargin,f,p,m,g,v,y,b=h?-1:1,w=n.tickSize||c,_=fe(n.tickCoord)?n.tickCoord:n.coordinate;switch(l){case"top":f=p=n.coordinate,g=s+ +!h*u,m=g-b*w,y=m-b*d,v=_;break;case"left":m=g=n.coordinate,p=a+ +!h*o,f=p-b*w,v=f-b*d,y=_;break;case"right":m=g=n.coordinate,p=a+ +h*o,f=p+b*w,v=f+b*d,y=_;break;default:f=p=n.coordinate,g=s+ +h*u,m=g+b*w,y=m+b*d,v=_;break}return{line:{x1:f,y1:m,x2:p,y2:g},tick:{x:v,y}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,i=n.orientation,a=n.mirror,s;switch(i){case"left":s=a?"start":"end";break;case"right":s=a?"end":"start";break;default:s="middle";break}return s}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,i=n.orientation,a=n.mirror,s="end";switch(i){case"left":case"right":s="middle";break;case"top":s=a?"start":"end";break;default:s=a?"end":"start";break}return s}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.x,a=n.y,s=n.width,o=n.height,u=n.orientation,l=n.mirror,c=n.axisLine,h=yn(yn(yn({},$e(this.props,!1)),$e(c,!1)),{},{fill:"none"});if(u==="top"||u==="bottom"){var d=+(u==="top"&&!l||u==="bottom"&&l);h=yn(yn({},h),{},{x1:i,y1:a+d*o,x2:i+s,y2:a+d*o})}else{var f=+(u==="left"&&!l||u==="right"&&l);h=yn(yn({},h),{},{x1:i+f*s,y1:a,x2:i+f*s,y2:a+o})}return $.createElement("line",Bc({},h,{className:ze("recharts-cartesian-axis-line",di(c,"className"))}))}},{key:"renderTicks",value:function(n,i,a){var s=this,o=this.props,u=o.tickLine,l=o.stroke,c=o.tick,h=o.tickFormatter,d=o.unit,f=Qk(yn(yn({},this.props),{},{ticks:n}),i,a),p=this.getTickTextAnchor(),m=this.getTickVerticalAnchor(),g=$e(this.props,!1),v=$e(c,!1),y=yn(yn({},g),{},{fill:"none"},$e(u,!1)),b=f.map(function(w,_){var O=s.getTickLineCoord(w),P=O.line,x=O.tick,j=yn(yn(yn(yn({textAnchor:p,verticalAnchor:m},g),{},{stroke:"none",fill:l},v),x),{},{index:_,payload:w,visibleTicksCount:f.length,tickFormatter:h});return $.createElement(Ye,Bc({className:"recharts-cartesian-axis-tick",key:"tick-".concat(w.value,"-").concat(w.coordinate,"-").concat(w.tickCoord)},Pl(s.props,w,_)),u&&$.createElement("line",Bc({},y,P,{className:ze("recharts-cartesian-axis-tick-line",di(u,"className"))})),c&&e.renderTickItem(c,j,"".concat(Ne(h)?h(w.value,_):w.value).concat(d||"")))});return $.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var n=this,i=this.props,a=i.axisLine,s=i.width,o=i.height,u=i.ticksGenerator,l=i.className,c=i.hide;if(c)return null;var h=this.props,d=h.ticks,f=Yx(h,REe),p=d;return Ne(u)&&(p=d&&d.length>0?u(this.props):u(f)),s<=0||o<=0||!p||!p.length?null:$.createElement(Ye,{className:ze("recharts-cartesian-axis",l),ref:function(g){n.layerReference=g}},a&&this.renderAxisLine(),this.renderTicks(p,this.state.fontSize,this.state.letterSpacing),Ir.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,i,a){var s;return $.isValidElement(n)?s=$.cloneElement(n,i):Ne(n)?s=n(i):s=$.createElement(El,Bc({},i,{className:"recharts-cartesian-axis-tick-value"}),a),s}}]),e}(I.Component);eC(Td,"displayName","CartesianAxis");eC(Td,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var qEe=["x1","y1","x2","y2","key"],KEe=["offset"];function kl(t){return kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kl(t)}function SD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function on(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?SD(Object(r),!0).forEach(function(n){VEe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):SD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function VEe(t,e,r){return e=HEe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HEe(t){var e=WEe(t,"string");return kl(e)=="symbol"?e:String(e)}function WEe(t,e){if(kl(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(kl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nl(){return nl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},nl.apply(this,arguments)}function PD(t,e){if(t==null)return{};var r=GEe(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function GEe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}var YEe=function(e){var r=e.fill;if(!r||r==="none")return null;var n=e.fillOpacity,i=e.x,a=e.y,s=e.width,o=e.height;return $.createElement("rect",{x:i,y:a,width:s,height:o,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function _9(t,e){var r;if($.isValidElement(t))r=$.cloneElement(t,e);else if(Ne(t))r=t(e);else{var n=e.x1,i=e.y1,a=e.x2,s=e.y2,o=e.key,u=PD(e,qEe),l=$e(u,!1);l.offset;var c=PD(l,KEe);r=$.createElement("line",nl({},c,{x1:n,y1:i,x2:a,y2:s,fill:"none",key:o}))}return r}function JEe(t){var e=t.x,r=t.width,n=t.horizontal,i=n===void 0?!0:n,a=t.horizontalPoints;if(!i||!a||!a.length)return null;var s=a.map(function(o,u){var l=on(on({},t),{},{x1:e,y1:o,x2:e+r,y2:o,key:"line-".concat(u),index:u});return _9(i,l)});return $.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function ZEe(t){var e=t.y,r=t.height,n=t.vertical,i=n===void 0?!0:n,a=t.verticalPoints;if(!i||!a||!a.length)return null;var s=a.map(function(o,u){var l=on(on({},t),{},{x1:o,y1:e,x2:o,y2:e+r,key:"line-".concat(u),index:u});return _9(i,l)});return $.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function XEe(t){var e=t.horizontalFill,r=t.fillOpacity,n=t.x,i=t.y,a=t.width,s=t.height,o=t.horizontalPoints,u=t.horizontal,l=u===void 0?!0:u;if(!l||!e||!e.length)return null;var c=o.map(function(d){return Math.round(d+i-i)}).sort(function(d,f){return d-f});i!==c[0]&&c.unshift(0);var h=c.map(function(d,f){var p=!c[f+1],m=p?i+s-d:c[f+1]-d;if(m<=0)return null;var g=f%e.length;return $.createElement("rect",{key:"react-".concat(f),y:d,x:n,height:m,width:a,stroke:"none",fill:e[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return $.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function QEe(t){var e=t.vertical,r=e===void 0?!0:e,n=t.verticalFill,i=t.fillOpacity,a=t.x,s=t.y,o=t.width,u=t.height,l=t.verticalPoints;if(!r||!n||!n.length)return null;var c=l.map(function(d){return Math.round(d+a-a)}).sort(function(d,f){return d-f});a!==c[0]&&c.unshift(0);var h=c.map(function(d,f){var p=!c[f+1],m=p?a+o-d:c[f+1]-d;if(m<=0)return null;var g=f%n.length;return $.createElement("rect",{key:"react-".concat(f),x:d,y:s,width:m,height:u,stroke:"none",fill:n[g],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return $.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var eAe=function(e,r){var n=e.xAxis,i=e.width,a=e.height,s=e.offset;return Oq(Qk(on(on(on({},Td.defaultProps),n),{},{ticks:Us(n,!0),viewBox:{x:0,y:0,width:i,height:a}})),s.left,s.left+s.width,r)},tAe=function(e,r){var n=e.yAxis,i=e.width,a=e.height,s=e.offset;return Oq(Qk(on(on(on({},Td.defaultProps),n),{},{ticks:Us(n,!0),viewBox:{x:0,y:0,width:i,height:a}})),s.top,s.top+s.height,r)},lc={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function x9(t){var e,r,n,i,a,s,o=Jk(),u=Zk(),l=iEe(),c=on(on({},t),{},{stroke:(e=t.stroke)!==null&&e!==void 0?e:lc.stroke,fill:(r=t.fill)!==null&&r!==void 0?r:lc.fill,horizontal:(n=t.horizontal)!==null&&n!==void 0?n:lc.horizontal,horizontalFill:(i=t.horizontalFill)!==null&&i!==void 0?i:lc.horizontalFill,vertical:(a=t.vertical)!==null&&a!==void 0?a:lc.vertical,verticalFill:(s=t.verticalFill)!==null&&s!==void 0?s:lc.verticalFill,x:fe(t.x)?t.x:l.left,y:fe(t.y)?t.y:l.top,width:fe(t.width)?t.width:l.width,height:fe(t.height)?t.height:l.height}),h=c.x,d=c.y,f=c.width,p=c.height,m=c.syncWithTicks,g=c.horizontalValues,v=c.verticalValues,y=tEe(),b=rEe();if(!fe(f)||f<=0||!fe(p)||p<=0||!fe(h)||h!==+h||!fe(d)||d!==+d)return null;var w=c.verticalCoordinatesGenerator||eAe,_=c.horizontalCoordinatesGenerator||tAe,O=c.horizontalPoints,P=c.verticalPoints;if((!O||!O.length)&&Ne(_)){var x=g&&g.length,j=_({yAxis:b?on(on({},b),{},{ticks:x?g:b.ticks}):void 0,width:o,height:u,offset:l},x?!0:m);wa(Array.isArray(j),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(kl(j),"]")),Array.isArray(j)&&(O=j)}if((!P||!P.length)&&Ne(w)){var k=v&&v.length,R=w({xAxis:y?on(on({},y),{},{ticks:k?v:y.ticks}):void 0,width:o,height:u,offset:l},k?!0:m);wa(Array.isArray(R),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(kl(R),"]")),Array.isArray(R)&&(P=R)}return $.createElement("g",{className:"recharts-cartesian-grid"},$.createElement(YEe,{fill:c.fill,fillOpacity:c.fillOpacity,x:c.x,y:c.y,width:c.width,height:c.height}),$.createElement(JEe,nl({},c,{offset:l,horizontalPoints:O,xAxis:y,yAxis:b})),$.createElement(ZEe,nl({},c,{offset:l,verticalPoints:P,xAxis:y,yAxis:b})),$.createElement(XEe,nl({},c,{horizontalPoints:O})),$.createElement(QEe,nl({},c,{verticalPoints:P})))}x9.displayName="CartesianGrid";var rAe=["layout","type","stroke","connectNulls","isRange","ref"],O9;function Kh(t){return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kh(t)}function nAe(t,e){if(t==null)return{};var r=iAe(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function iAe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function il(){return il=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},il.apply(this,arguments)}function ED(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ko(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ED(Object(r),!0).forEach(function(n){Ya(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ED(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function aAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,P9(n.key),n)}}function sAe(t,e,r){return e&&AD(t.prototype,e),r&&AD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function oAe(t,e,r){return e=iw(e),uAe(t,S9()?Reflect.construct(e,r||[],iw(t).constructor):e.apply(t,r))}function uAe(t,e){if(e&&(Kh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Df(t)}function S9(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(S9=function(){return!!t})()}function iw(t){return iw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iw(t)}function Df(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kE(t,e)}function kE(t,e){return kE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},kE(t,e)}function Ya(t,e,r){return e=P9(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P9(t){var e=cAe(t,"string");return Kh(e)=="symbol"?e:String(e)}function cAe(t,e){if(Kh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Kh(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ro=function(t){lAe(e,t);function e(){var r;aAe(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return r=oAe(this,e,[].concat(i)),Ya(Df(r),"state",{isAnimationFinished:!0}),Ya(Df(r),"id",wd("recharts-area-")),Ya(Df(r),"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Ne(s)&&s()}),Ya(Df(r),"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Ne(s)&&s()}),r}return sAe(e,[{key:"renderDots",value:function(n,i,a){var s=this.props.isAnimationActive,o=this.state.isAnimationFinished;if(s&&!o)return null;var u=this.props,l=u.dot,c=u.points,h=u.dataKey,d=$e(this.props,!1),f=$e(l,!0),p=c.map(function(g,v){var y=ko(ko(ko({key:"dot-".concat(v),r:3},d),f),{},{index:v,cx:g.x,cy:g.y,dataKey:h,value:g.value,payload:g.payload,points:c});return e.renderDotItem(l,y)}),m={clipPath:n?"url(#clipPath-".concat(i?"":"dots-").concat(a,")"):null};return $.createElement(Ye,il({className:"recharts-area-dots"},m),p)}},{key:"renderHorizontalRect",value:function(n){var i=this.props,a=i.baseLine,s=i.points,o=i.strokeWidth,u=s[0].x,l=s[s.length-1].x,c=n*Math.abs(u-l),h=Vo(s.map(function(d){return d.y||0}));return fe(a)&&typeof a=="number"?h=Math.max(a,h):a&&Array.isArray(a)&&a.length&&(h=Math.max(Vo(a.map(function(d){return d.y||0})),h)),fe(h)?$.createElement("rect",{x:u<l?u:u-c,y:0,width:c,height:Math.floor(h+(o?parseInt("".concat(o),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var i=this.props,a=i.baseLine,s=i.points,o=i.strokeWidth,u=s[0].y,l=s[s.length-1].y,c=n*Math.abs(u-l),h=Vo(s.map(function(d){return d.x||0}));return fe(a)&&typeof a=="number"?h=Math.max(a,h):a&&Array.isArray(a)&&a.length&&(h=Math.max(Vo(a.map(function(d){return d.x||0})),h)),fe(h)?$.createElement("rect",{x:0,y:u<l?u:u-c,width:h+(o?parseInt("".concat(o),10):1),height:Math.floor(c)}):null}},{key:"renderClipRect",value:function(n){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,i,a,s){var o=this.props,u=o.layout,l=o.type,c=o.stroke,h=o.connectNulls,d=o.isRange;o.ref;var f=nAe(o,rAe);return $.createElement(Ye,{clipPath:a?"url(#clipPath-".concat(s,")"):null},$.createElement(oh,il({},$e(f,!0),{points:n,connectNulls:h,type:l,baseLine:i,layout:u,stroke:"none",className:"recharts-area-area"})),c!=="none"&&$.createElement(oh,il({},$e(this.props,!1),{className:"recharts-area-curve",layout:u,type:l,connectNulls:h,fill:"none",points:n})),c!=="none"&&d&&$.createElement(oh,il({},$e(this.props,!1),{className:"recharts-area-curve",layout:u,type:l,connectNulls:h,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(n,i){var a=this,s=this.props,o=s.points,u=s.baseLine,l=s.isAnimationActive,c=s.animationBegin,h=s.animationDuration,d=s.animationEasing,f=s.animationId,p=this.state,m=p.prevPoints,g=p.prevBaseLine;return $.createElement(ls,{begin:c,duration:h,isActive:l,easing:d,from:{t:0},to:{t:1},key:"area-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(v){var y=v.t;if(m){var b=m.length/o.length,w=o.map(function(x,j){var k=Math.floor(j*b);if(m[k]){var R=m[k],F=Un(R.x,x.x),z=Un(R.y,x.y);return ko(ko({},x),{},{x:F(y),y:z(y)})}return x}),_;if(fe(u)&&typeof u=="number"){var O=Un(g,u);_=O(y)}else if(De(u)||bd(u)){var P=Un(g,0);_=P(y)}else _=u.map(function(x,j){var k=Math.floor(j*b);if(g[k]){var R=g[k],F=Un(R.x,x.x),z=Un(R.y,x.y);return ko(ko({},x),{},{x:F(y),y:z(y)})}return x});return a.renderAreaStatically(w,_,n,i)}return $.createElement(Ye,null,$.createElement("defs",null,$.createElement("clipPath",{id:"animationClipPath-".concat(i)},a.renderClipRect(y))),$.createElement(Ye,{clipPath:"url(#animationClipPath-".concat(i,")")},a.renderAreaStatically(o,u,n,i)))})}},{key:"renderArea",value:function(n,i){var a=this.props,s=a.points,o=a.baseLine,u=a.isAnimationActive,l=this.state,c=l.prevPoints,h=l.prevBaseLine,d=l.totalLength;return u&&s&&s.length&&(!c&&d>0||!Nh(c,s)||!Nh(h,o))?this.renderAreaWithAnimation(n,i):this.renderAreaStatically(s,o,n,i)}},{key:"render",value:function(){var n,i=this.props,a=i.hide,s=i.dot,o=i.points,u=i.className,l=i.top,c=i.left,h=i.xAxis,d=i.yAxis,f=i.width,p=i.height,m=i.isAnimationActive,g=i.id;if(a||!o||!o.length)return null;var v=this.state.isAnimationFinished,y=o.length===1,b=ze("recharts-area",u),w=h&&h.allowDataOverflow,_=d&&d.allowDataOverflow,O=w||_,P=De(g)?this.id:g,x=(n=$e(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},j=x.r,k=j===void 0?3:j,R=x.strokeWidth,F=R===void 0?2:R,z=Pse(s)?s:{},N=z.clipDot,L=N===void 0?!0:N,D=k*2+F;return $.createElement(Ye,{className:b},w||_?$.createElement("defs",null,$.createElement("clipPath",{id:"clipPath-".concat(P)},$.createElement("rect",{x:w?c:c-f/2,y:_?l:l-p/2,width:w?f:f*2,height:_?p:p*2})),!L&&$.createElement("clipPath",{id:"clipPath-dots-".concat(P)},$.createElement("rect",{x:c-D/2,y:l-D/2,width:f+D,height:p+D}))):null,y?null:this.renderArea(O,P),(s||y)&&this.renderDots(O,L,P),(!m||v)&&Hs.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:n.points!==i.curPoints||n.baseLine!==i.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}]),e}(I.PureComponent);O9=ro;Ya(ro,"displayName","Area");Ya(ro,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!ts.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Ya(ro,"getBaseValue",function(t,e,r,n){var i=t.layout,a=t.baseValue,s=e.props.baseValue,o=s??a;if(fe(o)&&typeof o=="number")return o;var u=i==="horizontal"?n:r,l=u.scale.domain();if(u.type==="number"){var c=Math.max(l[0],l[1]),h=Math.min(l[0],l[1]);return o==="dataMin"?h:o==="dataMax"||c<0?c:Math.max(Math.min(l[0],l[1]),0)}return o==="dataMin"?l[0]:o==="dataMax"?l[1]:l[0]});Ya(ro,"getComposedData",function(t){var e=t.props,r=t.item,n=t.xAxis,i=t.yAxis,a=t.xAxisTicks,s=t.yAxisTicks,o=t.bandSize,u=t.dataKey,l=t.stackedData,c=t.dataStartIndex,h=t.displayedData,d=t.offset,f=e.layout,p=l&&l.length,m=O9.getBaseValue(e,r,n,i),g=f==="horizontal",v=!1,y=h.map(function(w,_){var O;p?O=l[c+_]:(O=gr(w,u),Array.isArray(O)?v=!0:O=[m,O]);var P=O[1]==null||p&&gr(w,u)==null;return g?{x:Z2({axis:n,ticks:a,bandSize:o,entry:w,index:_}),y:P?null:i.scale(O[1]),value:O,payload:w}:{x:P?null:n.scale(O[1]),y:Z2({axis:i,ticks:s,bandSize:o,entry:w,index:_}),value:O,payload:w}}),b;return p||v?b=y.map(function(w){var _=Array.isArray(w.value)?w.value[0]:null;return g?{x:w.x,y:_!=null&&w.y!=null?i.scale(_):null}:{x:_!=null?n.scale(_):null,y:w.y}}):b=g?i.scale(m):n.scale(m),ko({points:y,baseLine:b,layout:f,isRange:v},d)});Ya(ro,"renderDotItem",function(t,e){var r;if($.isValidElement(t))r=$.cloneElement(t,e);else if(Ne(t))r=t(e);else{var n=ze("recharts-area-dot",typeof t!="boolean"?t.className:"");r=$.createElement(A_,il({},e,{className:n}))}return r});function CE(){return CE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},CE.apply(this,arguments)}var N_=function(e){var r=e.xAxisId,n=Jk(),i=Zk(),a=g9(r);return a==null?null:$.createElement(Td,CE({},a,{className:ze("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:i},ticksGenerator:function(o){return Us(o,!0)}}))};N_.displayName="XAxis";N_.defaultProps={allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0};function IE(){return IE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},IE.apply(this,arguments)}var M_=function(e){var r=e.yAxisId,n=Jk(),i=Zk(),a=y9(r);return a==null?null:$.createElement(Td,IE({},a,{className:ze("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:i},ticksGenerator:function(o){return Us(o,!0)}}))};M_.displayName="YAxis";M_.defaultProps={allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1};function TD(t){return pAe(t)||fAe(t)||dAe(t)||hAe()}function hAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dAe(t,e){if(t){if(typeof t=="string")return $E(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $E(t,e)}}function fAe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function pAe(t){if(Array.isArray(t))return $E(t)}function $E(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var jE=function(e,r,n,i,a){var s=Fi(e,Xk),o=Fi(e,xg),u=[].concat(TD(s),TD(o)),l=Fi(e,Og),c="".concat(i,"Id"),h=i[0],d=r;if(u.length&&(d=u.reduce(function(m,g){if(g.props[c]===n&&ns(g.props,"extendDomain")&&fe(g.props[h])){var v=g.props[h];return[Math.min(m[0],v),Math.max(m[1],v)]}return m},d)),l.length){var f="".concat(h,"1"),p="".concat(h,"2");d=l.reduce(function(m,g){if(g.props[c]===n&&ns(g.props,"extendDomain")&&fe(g.props[f])&&fe(g.props[p])){var v=g.props[f],y=g.props[p];return[Math.min(m[0],v,y),Math.max(m[1],v,y)]}return m},d)}return a&&a.length&&(d=a.reduce(function(m,g){return fe(g)?[Math.min(m[0],g),Math.max(m[1],g)]:m},d)),d},E9={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(u,l,c){this.fn=u,this.context=l,this.once=c||!1}function a(u,l,c,h,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new i(c,h||u,d),p=r?r+l:l;return u._events[p]?u._events[p].fn?u._events[p]=[u._events[p],f]:u._events[p].push(f):(u._events[p]=f,u._eventsCount++),u}function s(u,l){--u._eventsCount===0?u._events=new n:delete u._events[l]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],c,h;if(this._eventsCount===0)return l;for(h in c=this._events)e.call(c,h)&&l.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},o.prototype.listeners=function(l){var c=r?r+l:l,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,f=h.length,p=new Array(f);d<f;d++)p[d]=h[d].fn;return p},o.prototype.listenerCount=function(l){var c=r?r+l:l,h=this._events[c];return h?h.fn?1:h.length:0},o.prototype.emit=function(l,c,h,d,f,p){var m=r?r+l:l;if(!this._events[m])return!1;var g=this._events[m],v=arguments.length,y,b;if(g.fn){switch(g.once&&this.removeListener(l,g.fn,void 0,!0),v){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,c),!0;case 3:return g.fn.call(g.context,c,h),!0;case 4:return g.fn.call(g.context,c,h,d),!0;case 5:return g.fn.call(g.context,c,h,d,f),!0;case 6:return g.fn.call(g.context,c,h,d,f,p),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];g.fn.apply(g.context,y)}else{var w=g.length,_;for(b=0;b<w;b++)switch(g[b].once&&this.removeListener(l,g[b].fn,void 0,!0),v){case 1:g[b].fn.call(g[b].context);break;case 2:g[b].fn.call(g[b].context,c);break;case 3:g[b].fn.call(g[b].context,c,h);break;case 4:g[b].fn.call(g[b].context,c,h,d);break;default:if(!y)for(_=1,y=new Array(v-1);_<v;_++)y[_-1]=arguments[_];g[b].fn.apply(g[b].context,y)}}return!0},o.prototype.on=function(l,c,h){return a(this,l,c,h,!1)},o.prototype.once=function(l,c,h){return a(this,l,c,h,!0)},o.prototype.removeListener=function(l,c,h,d){var f=r?r+l:l;if(!this._events[f])return this;if(!c)return s(this,f),this;var p=this._events[f];if(p.fn)p.fn===c&&(!d||p.once)&&(!h||p.context===h)&&s(this,f);else{for(var m=0,g=[],v=p.length;m<v;m++)(p[m].fn!==c||d&&!p[m].once||h&&p[m].context!==h)&&g.push(p[m]);g.length?this._events[f]=g.length===1?g[0]:g:s(this,f)}return this},o.prototype.removeAllListeners=function(l){var c;return l?(c=r?r+l:l,this._events[c]&&s(this,c)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,t.exports=o})(E9);var A9=E9.exports;const mAe=Ze(A9);var Jx=new mAe,Zx="recharts.syncMouseEvents";function xm(t){return xm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xm(t)}function gAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,T9(n.key),n)}}function yAe(t,e,r){return e&&kD(t.prototype,e),r&&kD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Xx(t,e,r){return e=T9(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T9(t){var e=vAe(t,"string");return xm(e)=="symbol"?e:String(e)}function vAe(t,e){if(xm(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(xm(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bAe=function(){function t(){gAe(this,t),Xx(this,"activeIndex",0),Xx(this,"coordinateList",[]),Xx(this,"layout","horizontal")}return yAe(t,[{key:"setDetails",value:function(r){var n,i=r.coordinateList,a=i===void 0?null:i,s=r.container,o=s===void 0?null:s,u=r.layout,l=u===void 0?null:u,c=r.offset,h=c===void 0?null:c,d=r.mouseHandlerCallback,f=d===void 0?null:d;this.coordinateList=(n=a??this.coordinateList)!==null&&n!==void 0?n:[],this.container=o??this.container,this.layout=l??this.layout,this.offset=h??this.offset,this.mouseHandlerCallback=f??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var i=this.container.getBoundingClientRect(),a=i.x,s=i.y,o=i.height,u=this.coordinateList[this.activeIndex].coordinate,l=((r=window)===null||r===void 0?void 0:r.scrollX)||0,c=((n=window)===null||n===void 0?void 0:n.scrollY)||0,h=a+u+l,d=s+this.offset.top+o/2+c;this.mouseHandlerCallback({pageX:h,pageY:d})}}}]),t}();function wAe(t,e,r){if(r==="number"&&e===!0&&Array.isArray(t)){var n=t==null?void 0:t[0],i=t==null?void 0:t[1];if(n&&i&&fe(n)&&fe(i))return!0}return!1}function _Ae(t,e,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-i:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-i,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function k9(t){var e=t.cx,r=t.cy,n=t.radius,i=t.startAngle,a=t.endAngle,s=Tt(e,r,n,i),o=Tt(e,r,n,a);return{points:[s,o],cx:e,cy:r,radius:n,startAngle:i,endAngle:a}}function xAe(t,e,r){var n,i,a,s;if(t==="horizontal")n=e.x,a=n,i=r.top,s=r.top+r.height;else if(t==="vertical")i=e.y,s=i,n=r.left,a=r.left+r.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var o=e.cx,u=e.cy,l=e.innerRadius,c=e.outerRadius,h=e.angle,d=Tt(o,u,l,h),f=Tt(o,u,c,h);n=d.x,i=d.y,a=f.x,s=f.y}else return k9(e);return[{x:n,y:i},{x:a,y:s}]}function Om(t){return Om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Om(t)}function CD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function $y(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?CD(Object(r),!0).forEach(function(n){OAe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):CD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function OAe(t,e,r){return e=SAe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SAe(t){var e=PAe(t,"string");return Om(e)=="symbol"?e:String(e)}function PAe(t,e){if(Om(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Om(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EAe(t){var e=t.element,r=t.tooltipEventType,n=t.isActive,i=t.activeCoordinate,a=t.activePayload,s=t.offset,o=t.activeTooltipIndex,u=t.tooltipAxisBandSize,l=t.layout,c=t.chartName;if(!e||!e.props.cursor||!n||!i||c!=="ScatterChart"&&r!=="axis")return null;var h,d=oh;if(c==="ScatterChart")h=i,d=jxe;else if(c==="BarChart")h=_Ae(l,i,s,u),d=Hk;else if(l==="radial"){var f=k9(i),p=f.cx,m=f.cy,g=f.radius,v=f.startAngle,y=f.endAngle;h={cx:p,cy:m,startAngle:v,endAngle:y,innerRadius:g,outerRadius:g},d=Rq}else h={points:xAe(l,i,s)},d=oh;var b=$y($y($y($y({stroke:"#ccc",pointerEvents:"none"},s),h),$e(e.props.cursor,!1)),{},{payload:a,payloadIndex:o,className:ze("recharts-tooltip-cursor",e.props.cursor.className)});return I.isValidElement(e.props.cursor)?I.cloneElement(e.props.cursor,b):I.createElement(d,b)}var AAe=["item"],TAe=["children","className","width","height","style","compact","title","desc"];function Vh(t){return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vh(t)}function dp(){return dp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},dp.apply(this,arguments)}function ID(t,e){return IAe(t)||CAe(t,e)||I9(t,e)||kAe()}function kAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CAe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw i}}return o}}function IAe(t){if(Array.isArray(t))return t}function $D(t,e){if(t==null)return{};var r=$Ae(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function $Ae(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function jAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$9(n.key),n)}}function RAe(t,e,r){return e&&jD(t.prototype,e),r&&jD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function NAe(t,e,r){return e=aw(e),MAe(t,C9()?Reflect.construct(e,r||[],aw(t).constructor):e.apply(t,r))}function MAe(t,e){if(e&&(Vh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xe(t)}function C9(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(C9=function(){return!!t})()}function aw(t){return aw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},aw(t)}function Xe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function DAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&RE(t,e)}function RE(t,e){return RE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},RE(t,e)}function Hh(t){return UAe(t)||FAe(t)||I9(t)||LAe()}function LAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I9(t,e){if(t){if(typeof t=="string")return NE(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NE(t,e)}}function FAe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function UAe(t){if(Array.isArray(t))return NE(t)}function NE(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function RD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function te(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?RD(Object(r),!0).forEach(function(n){je(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):RD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function je(t,e,r){return e=$9(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $9(t){var e=zAe(t,"string");return Vh(e)=="symbol"?e:String(e)}function zAe(t,e){if(Vh(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Vh(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var BAe={xAxis:["bottom","top"],yAxis:["left","right"]},qAe={width:"100%",height:"100%"},j9={x:0,y:0};function jy(t){return t}var KAe=function(e,r){return r==="horizontal"?e.x:r==="vertical"?e.y:r==="centric"?e.angle:e.radius},VAe=function(e,r,n,i){var a=r.find(function(c){return c&&c.index===n});if(a){if(e==="horizontal")return{x:a.coordinate,y:i.y};if(e==="vertical")return{x:i.x,y:a.coordinate};if(e==="centric"){var s=a.coordinate,o=i.radius;return te(te(te({},i),Tt(i.cx,i.cy,o,s)),{},{angle:s,radius:o})}var u=a.coordinate,l=i.angle;return te(te(te({},i),Tt(i.cx,i.cy,u,l)),{},{angle:l,radius:u})}return j9},D_=function(e,r){var n=r.graphicalItems,i=r.dataStartIndex,a=r.dataEndIndex,s=(n??[]).reduce(function(o,u){var l=u.props.data;return l&&l.length?[].concat(Hh(o),Hh(l)):o},[]);return s.length>0?s:e&&e.length&&fe(i)&&fe(a)?e.slice(i,a+1):[]};function R9(t){return t==="number"?[0,"auto"]:void 0}var ME=function(e,r,n,i){var a=e.graphicalItems,s=e.tooltipAxis,o=D_(r,e);return n<0||!a||!a.length||n>=o.length?null:a.reduce(function(u,l){var c,h=(c=l.props.data)!==null&&c!==void 0?c:r;h&&e.dataStartIndex+e.dataEndIndex!==0&&(h=h.slice(e.dataStartIndex,e.dataEndIndex+1));var d;if(s.dataKey&&!s.allowDuplicatedCategory){var f=h===void 0?o:h;d=db(f,s.dataKey,i)}else d=h&&h[n]||o[n];return d?[].concat(Hh(u),[Tq(l,d)]):u},[])},ND=function(e,r,n,i){var a=i||{x:e.chartX,y:e.chartY},s=KAe(a,n),o=e.orderedTooltipTicks,u=e.tooltipAxis,l=e.tooltipTicks,c=p0e(s,o,l,u);if(c>=0&&l){var h=l[c]&&l[c].value,d=ME(e,r,c,h),f=VAe(n,o,c,a);return{activeTooltipIndex:c,activeLabel:h,activePayload:d,activeCoordinate:f}}return null},HAe=function(e,r){var n=r.axes,i=r.graphicalItems,a=r.axisType,s=r.axisIdKey,o=r.stackGroups,u=r.dataStartIndex,l=r.dataEndIndex,c=e.layout,h=e.children,d=e.stackOffset,f=xq(c,a);return n.reduce(function(p,m){var g,v=m.props,y=v.type,b=v.dataKey,w=v.allowDataOverflow,_=v.allowDuplicatedCategory,O=v.scale,P=v.ticks,x=v.includeHidden,j=m.props[s];if(p[j])return p;var k=D_(e.data,{graphicalItems:i.filter(function(K){return K.props[s]===j}),dataStartIndex:u,dataEndIndex:l}),R=k.length,F,z,N;wAe(m.props.domain,w,y)&&(F=rE(m.props.domain,null,w),f&&(y==="number"||O!=="auto")&&(N=up(k,b,"category")));var L=R9(y);if(!F||F.length===0){var D,q=(D=m.props.domain)!==null&&D!==void 0?D:L;if(b){if(F=up(k,b,y),y==="category"&&f){var M=gse(F);_&&M?(z=F,F=Zb(0,R)):_||(F=tM(q,F,m).reduce(function(K,J){return K.indexOf(J)>=0?K:[].concat(Hh(K),[J])},[]))}else if(y==="category")_?F=F.filter(function(K){return K!==""&&!De(K)}):F=tM(q,F,m).reduce(function(K,J){return K.indexOf(J)>=0||J===""||De(J)?K:[].concat(Hh(K),[J])},[]);else if(y==="number"){var V=b0e(k,i.filter(function(K){return K.props[s]===j&&(x||!K.props.hide)}),b,a,c);V&&(F=V)}f&&(y==="number"||O!=="auto")&&(N=up(k,b,"category"))}else f?F=Zb(0,R):o&&o[j]&&o[j].hasStack&&y==="number"?F=d==="expand"?[0,1]:Aq(o[j].stackGroups,u,l):F=_q(k,i.filter(function(K){return K.props[s]===j&&(x||!K.props.hide)}),y,c,!0);if(y==="number")F=jE(h,F,j,a,P),q&&(F=rE(q,F,w));else if(y==="category"&&q){var G=q,re=F.every(function(K){return G.indexOf(K)>=0});re&&(F=G)}}return te(te({},p),{},je({},j,te(te({},m.props),{},{axisType:a,domain:F,categoricalDomain:N,duplicateDomain:z,originalDomain:(g=m.props.domain)!==null&&g!==void 0?g:L,isCategorical:f,layout:c})))},{})},WAe=function(e,r){var n=r.graphicalItems,i=r.Axis,a=r.axisType,s=r.axisIdKey,o=r.stackGroups,u=r.dataStartIndex,l=r.dataEndIndex,c=e.layout,h=e.children,d=D_(e.data,{graphicalItems:n,dataStartIndex:u,dataEndIndex:l}),f=d.length,p=xq(c,a),m=-1;return n.reduce(function(g,v){var y=v.props[s],b=R9("number");if(!g[y]){m++;var w;return p?w=Zb(0,f):o&&o[y]&&o[y].hasStack?(w=Aq(o[y].stackGroups,u,l),w=jE(h,w,y,a)):(w=rE(b,_q(d,n.filter(function(_){return _.props[s]===y&&!_.props.hide}),"number",c),i.defaultProps.allowDataOverflow),w=jE(h,w,y,a)),te(te({},g),{},je({},y,te(te({axisType:a},i.defaultProps),{},{hide:!0,orientation:di(BAe,"".concat(a,".").concat(m%2),null),domain:w,originalDomain:b,isCategorical:p,layout:c})))}return g},{})},GAe=function(e,r){var n=r.axisType,i=n===void 0?"xAxis":n,a=r.AxisComp,s=r.graphicalItems,o=r.stackGroups,u=r.dataStartIndex,l=r.dataEndIndex,c=e.children,h="".concat(i,"Id"),d=Fi(c,a),f={};return d&&d.length?f=HAe(e,{axes:d,graphicalItems:s,axisType:i,axisIdKey:h,stackGroups:o,dataStartIndex:u,dataEndIndex:l}):s&&s.length&&(f=WAe(e,{Axis:a,graphicalItems:s,axisType:i,axisIdKey:h,stackGroups:o,dataStartIndex:u,dataEndIndex:l})),f},YAe=function(e){var r=Uo(e),n=Us(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:bk(n,function(i){return i.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Fb(r,n)}},MD=function(e){var r=e.children,n=e.defaultShowTooltip,i=si(r,zh),a=0,s=0;return e.data&&e.data.length!==0&&(s=e.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(a=i.props.startIndex),i.props.endIndex>=0&&(s=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:s,activeTooltipIndex:-1,isTooltipActive:!!n}},JAe=function(e){return!e||!e.length?!1:e.some(function(r){var n=Ks(r&&r.type);return n&&n.indexOf("Bar")>=0})},DD=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},ZAe=function(e,r){var n=e.props,i=e.graphicalItems,a=e.xAxisMap,s=a===void 0?{}:a,o=e.yAxisMap,u=o===void 0?{}:o,l=n.width,c=n.height,h=n.children,d=n.margin||{},f=si(h,zh),p=si(h,kh),m=Object.keys(u).reduce(function(_,O){var P=u[O],x=P.orientation;return!P.mirror&&!P.hide?te(te({},_),{},je({},x,_[x]+P.width)):_},{left:d.left||0,right:d.right||0}),g=Object.keys(s).reduce(function(_,O){var P=s[O],x=P.orientation;return!P.mirror&&!P.hide?te(te({},_),{},je({},x,di(_,"".concat(x))+P.height)):_},{top:d.top||0,bottom:d.bottom||0}),v=te(te({},g),m),y=v.bottom;f&&(v.bottom+=f.props.height||zh.defaultProps.height),p&&r&&(v=y0e(v,i,n,r));var b=l-v.left-v.right,w=c-v.top-v.bottom;return te(te({brushBottom:y},v),{},{width:Math.max(b,0),height:Math.max(w,0)})},XAe=function(e,r){if(r==="xAxis")return e[r].width;if(r==="yAxis")return e[r].height},N9=function(e){var r,n=e.chartName,i=e.GraphicalChild,a=e.defaultTooltipEventType,s=a===void 0?"axis":a,o=e.validateTooltipEventTypes,u=o===void 0?["axis"]:o,l=e.axisComponents,c=e.legendContent,h=e.formatAxisMap,d=e.defaultProps,f=function(g,v){var y=v.graphicalItems,b=v.stackGroups,w=v.offset,_=v.updateId,O=v.dataStartIndex,P=v.dataEndIndex,x=g.barSize,j=g.layout,k=g.barGap,R=g.barCategoryGap,F=g.maxBarSize,z=DD(j),N=z.numericAxisName,L=z.cateAxisName,D=JAe(y),q=[];return y.forEach(function(M,V){var G=D_(g.data,{graphicalItems:[M],dataStartIndex:O,dataEndIndex:P}),re=M.props,K=re.dataKey,J=re.maxBarSize,ie=M.props["".concat(N,"Id")],oe=M.props["".concat(L,"Id")],S={},E=l.reduce(function(W,ae){var ne=v["".concat(ae.axisType,"Map")],le=M.props["".concat(ae.axisType,"Id")];ne&&ne[le]||ae.axisType==="zAxis"||Tl(!1);var X=ne[le];return te(te({},W),{},je(je({},ae.axisType,X),"".concat(ae.axisType,"Ticks"),Us(X)))},S),U=E[L],T=E["".concat(L,"Ticks")],ee=b&&b[ie]&&b[ie].hasStack&&T0e(M,b[ie].stackGroups),se=Ks(M.type).indexOf("Bar")>=0,H=Fb(U,T),Oe=[],be=D&&m0e({barSize:x,stackGroups:b,totalSize:XAe(E,L)});if(se){var xe,C,B=De(J)?F:J,Y=(xe=(C=Fb(U,T,!0))!==null&&C!==void 0?C:B)!==null&&xe!==void 0?xe:0;Oe=g0e({barGap:k,barCategoryGap:R,bandSize:Y!==H?Y:H,sizeList:be[oe],maxBarSize:B}),Y!==H&&(Oe=Oe.map(function(W){return te(te({},W),{},{position:te(te({},W.position),{},{offset:W.position.offset-Y/2})})}))}var me=M&&M.type&&M.type.getComposedData;me&&q.push({props:te(te({},me(te(te({},E),{},{displayedData:G,props:g,dataKey:K,item:M,bandSize:H,barPosition:Oe,offset:w,stackedData:ee,layout:j,dataStartIndex:O,dataEndIndex:P}))),{},je(je(je({key:M.key||"item-".concat(V)},N,E[N]),L,E[L]),"animationId",_)),childIndex:Tse(M,g.children),item:M})}),q},p=function(g,v){var y=g.props,b=g.dataStartIndex,w=g.dataEndIndex,_=g.updateId;if(!VR({props:y}))return null;var O=y.children,P=y.layout,x=y.stackOffset,j=y.data,k=y.reverseStackOrder,R=DD(P),F=R.numericAxisName,z=R.cateAxisName,N=Fi(O,i),L=E0e(j,N,"".concat(F,"Id"),"".concat(z,"Id"),x,k),D=l.reduce(function(re,K){var J="".concat(K.axisType,"Map");return te(te({},re),{},je({},J,GAe(y,te(te({},K),{},{graphicalItems:N,stackGroups:K.axisType===F&&L,dataStartIndex:b,dataEndIndex:w}))))},{}),q=ZAe(te(te({},D),{},{props:y,graphicalItems:N}),v==null?void 0:v.legendBBox);Object.keys(D).forEach(function(re){D[re]=h(y,D[re],q,re.replace("Map",""),n)});var M=D["".concat(z,"Map")],V=YAe(M),G=f(y,te(te({},D),{},{dataStartIndex:b,dataEndIndex:w,updateId:_,graphicalItems:N,stackGroups:L,offset:q}));return te(te({formattedGraphicalItems:G,graphicalItems:N,offset:q,stackGroups:L},V),D)};return r=function(m){DAe(g,m);function g(v){var y,b,w;return jAe(this,g),w=NAe(this,g,[v]),je(Xe(w),"eventEmitterSymbol",Symbol("rechartsEventEmitter")),je(Xe(w),"accessibilityManager",new bAe),je(Xe(w),"handleLegendBBoxUpdate",function(_){if(_){var O=w.state,P=O.dataStartIndex,x=O.dataEndIndex,j=O.updateId;w.setState(te({legendBBox:_},p({props:w.props,dataStartIndex:P,dataEndIndex:x,updateId:j},te(te({},w.state),{},{legendBBox:_}))))}}),je(Xe(w),"handleReceiveSyncEvent",function(_,O,P){if(w.props.syncId===_){if(P===w.eventEmitterSymbol&&typeof w.props.syncMethod!="function")return;w.applySyncEvent(O)}}),je(Xe(w),"handleBrushChange",function(_){var O=_.startIndex,P=_.endIndex;if(O!==w.state.dataStartIndex||P!==w.state.dataEndIndex){var x=w.state.updateId;w.setState(function(){return te({dataStartIndex:O,dataEndIndex:P},p({props:w.props,dataStartIndex:O,dataEndIndex:P,updateId:x},w.state))}),w.triggerSyncEvent({dataStartIndex:O,dataEndIndex:P})}}),je(Xe(w),"handleMouseEnter",function(_){var O=w.getMouseInfo(_);if(O){var P=te(te({},O),{},{isTooltipActive:!0});w.setState(P),w.triggerSyncEvent(P);var x=w.props.onMouseEnter;Ne(x)&&x(P,_)}}),je(Xe(w),"triggeredAfterMouseMove",function(_){var O=w.getMouseInfo(_),P=O?te(te({},O),{},{isTooltipActive:!0}):{isTooltipActive:!1};w.setState(P),w.triggerSyncEvent(P);var x=w.props.onMouseMove;Ne(x)&&x(P,_)}),je(Xe(w),"handleItemMouseEnter",function(_){w.setState(function(){return{isTooltipActive:!0,activeItem:_,activePayload:_.tooltipPayload,activeCoordinate:_.tooltipPosition||{x:_.cx,y:_.cy}}})}),je(Xe(w),"handleItemMouseLeave",function(){w.setState(function(){return{isTooltipActive:!1}})}),je(Xe(w),"handleMouseMove",function(_){_.persist(),w.throttleTriggeredAfterMouseMove(_)}),je(Xe(w),"handleMouseLeave",function(_){w.throttleTriggeredAfterMouseMove.cancel();var O={isTooltipActive:!1};w.setState(O),w.triggerSyncEvent(O);var P=w.props.onMouseLeave;Ne(P)&&P(O,_)}),je(Xe(w),"handleOuterEvent",function(_){var O=Ase(_),P=di(w.props,"".concat(O));if(O&&Ne(P)){var x,j;/.*touch.*/i.test(O)?j=w.getMouseInfo(_.changedTouches[0]):j=w.getMouseInfo(_),P((x=j)!==null&&x!==void 0?x:{},_)}}),je(Xe(w),"handleClick",function(_){var O=w.getMouseInfo(_);if(O){var P=te(te({},O),{},{isTooltipActive:!0});w.setState(P),w.triggerSyncEvent(P);var x=w.props.onClick;Ne(x)&&x(P,_)}}),je(Xe(w),"handleMouseDown",function(_){var O=w.props.onMouseDown;if(Ne(O)){var P=w.getMouseInfo(_);O(P,_)}}),je(Xe(w),"handleMouseUp",function(_){var O=w.props.onMouseUp;if(Ne(O)){var P=w.getMouseInfo(_);O(P,_)}}),je(Xe(w),"handleTouchMove",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&w.throttleTriggeredAfterMouseMove(_.changedTouches[0])}),je(Xe(w),"handleTouchStart",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&w.handleMouseDown(_.changedTouches[0])}),je(Xe(w),"handleTouchEnd",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&w.handleMouseUp(_.changedTouches[0])}),je(Xe(w),"triggerSyncEvent",function(_){w.props.syncId!==void 0&&Jx.emit(Zx,w.props.syncId,_,w.eventEmitterSymbol)}),je(Xe(w),"applySyncEvent",function(_){var O=w.props,P=O.layout,x=O.syncMethod,j=w.state.updateId,k=_.dataStartIndex,R=_.dataEndIndex;if(_.dataStartIndex!==void 0||_.dataEndIndex!==void 0)w.setState(te({dataStartIndex:k,dataEndIndex:R},p({props:w.props,dataStartIndex:k,dataEndIndex:R,updateId:j},w.state)));else if(_.activeTooltipIndex!==void 0){var F=_.chartX,z=_.chartY,N=_.activeTooltipIndex,L=w.state,D=L.offset,q=L.tooltipTicks;if(!D)return;if(typeof x=="function")N=x(q,_);else if(x==="value"){N=-1;for(var M=0;M<q.length;M++)if(q[M].value===_.activeLabel){N=M;break}}var V=te(te({},D),{},{x:D.left,y:D.top}),G=Math.min(F,V.x+V.width),re=Math.min(z,V.y+V.height),K=q[N]&&q[N].value,J=ME(w.state,w.props.data,N),ie=q[N]?{x:P==="horizontal"?q[N].coordinate:G,y:P==="horizontal"?re:q[N].coordinate}:j9;w.setState(te(te({},_),{},{activeLabel:K,activeCoordinate:ie,activePayload:J,activeTooltipIndex:N}))}else w.setState(_)}),je(Xe(w),"renderCursor",function(_){var O,P=w.state,x=P.isTooltipActive,j=P.activeCoordinate,k=P.activePayload,R=P.offset,F=P.activeTooltipIndex,z=P.tooltipAxisBandSize,N=w.getTooltipEventType(),L=(O=_.props.active)!==null&&O!==void 0?O:x,D=w.props.layout,q=_.key||"_recharts-cursor";return $.createElement(EAe,{key:q,activeCoordinate:j,activePayload:k,activeTooltipIndex:F,chartName:n,element:_,isActive:L,layout:D,offset:R,tooltipAxisBandSize:z,tooltipEventType:N})}),je(Xe(w),"renderPolarAxis",function(_,O,P){var x=di(_,"type.axisType"),j=di(w.state,"".concat(x,"Map")),k=j&&j[_.props["".concat(x,"Id")]];return I.cloneElement(_,te(te({},k),{},{className:ze(x,k.className),key:_.key||"".concat(O,"-").concat(P),ticks:Us(k,!0)}))}),je(Xe(w),"renderPolarGrid",function(_){var O=_.props,P=O.radialLines,x=O.polarAngles,j=O.polarRadius,k=w.state,R=k.radiusAxisMap,F=k.angleAxisMap,z=Uo(R),N=Uo(F),L=N.cx,D=N.cy,q=N.innerRadius,M=N.outerRadius;return I.cloneElement(_,{polarAngles:Array.isArray(x)?x:Us(N,!0).map(function(V){return V.coordinate}),polarRadius:Array.isArray(j)?j:Us(z,!0).map(function(V){return V.coordinate}),cx:L,cy:D,innerRadius:q,outerRadius:M,key:_.key||"polar-grid",radialLines:P})}),je(Xe(w),"renderLegend",function(){var _=w.state.formattedGraphicalItems,O=w.props,P=O.children,x=O.width,j=O.height,k=w.props.margin||{},R=x-(k.left||0)-(k.right||0),F=bq({children:P,formattedGraphicalItems:_,legendWidth:R,legendContent:c});if(!F)return null;var z=F.item,N=$D(F,AAe);return I.cloneElement(z,te(te({},N),{},{chartWidth:x,chartHeight:j,margin:k,onBBoxUpdate:w.handleLegendBBoxUpdate}))}),je(Xe(w),"renderTooltip",function(){var _,O=w.props,P=O.children,x=O.accessibilityLayer,j=si(P,la);if(!j)return null;var k=w.state,R=k.isTooltipActive,F=k.activeCoordinate,z=k.activePayload,N=k.activeLabel,L=k.offset,D=(_=j.props.active)!==null&&_!==void 0?_:R;return I.cloneElement(j,{viewBox:te(te({},L),{},{x:L.left,y:L.top}),active:D,label:N,payload:D?z:[],coordinate:F,accessibilityLayer:x})}),je(Xe(w),"renderBrush",function(_){var O=w.props,P=O.margin,x=O.data,j=w.state,k=j.offset,R=j.dataStartIndex,F=j.dataEndIndex,z=j.updateId;return I.cloneElement(_,{key:_.key||"_recharts-brush",onChange:Ty(w.handleBrushChange,_.props.onChange),data:x,x:fe(_.props.x)?_.props.x:k.left,y:fe(_.props.y)?_.props.y:k.top+k.height+k.brushBottom-(P.bottom||0),width:fe(_.props.width)?_.props.width:k.width,startIndex:R,endIndex:F,updateId:"brush-".concat(z)})}),je(Xe(w),"renderReferenceElement",function(_,O,P){if(!_)return null;var x=Xe(w),j=x.clipPathId,k=w.state,R=k.xAxisMap,F=k.yAxisMap,z=k.offset,N=_.props,L=N.xAxisId,D=N.yAxisId;return I.cloneElement(_,{key:_.key||"".concat(O,"-").concat(P),xAxis:R[L],yAxis:F[D],viewBox:{x:z.left,y:z.top,width:z.width,height:z.height},clipPathId:j})}),je(Xe(w),"renderActivePoints",function(_){var O=_.item,P=_.activePoint,x=_.basePoint,j=_.childIndex,k=_.isRange,R=[],F=O.props.key,z=O.item.props,N=z.activeDot,L=z.dataKey,D=te(te({index:j,dataKey:L,cx:P.x,cy:P.y,r:4,fill:Vk(O.item),strokeWidth:2,stroke:"#fff",payload:P.payload,value:P.value,key:"".concat(F,"-activePoint-").concat(j)},$e(N,!1)),fb(N));return R.push(g.renderActiveDot(N,D)),x?R.push(g.renderActiveDot(N,te(te({},D),{},{cx:x.x,cy:x.y,key:"".concat(F,"-basePoint-").concat(j)}))):k&&R.push(null),R}),je(Xe(w),"renderGraphicChild",function(_,O,P){var x=w.filterFormatItem(_,O,P);if(!x)return null;var j=w.getTooltipEventType(),k=w.state,R=k.isTooltipActive,F=k.tooltipAxis,z=k.activeTooltipIndex,N=k.activeLabel,L=w.props.children,D=si(L,la),q=x.props,M=q.points,V=q.isRange,G=q.baseLine,re=x.item.props,K=re.activeDot,J=re.hide,ie=re.activeBar,oe=re.activeShape,S=!!(!J&&R&&D&&(K||ie||oe)),E={};j!=="axis"&&D&&D.props.trigger==="click"?E={onClick:Ty(w.handleItemMouseEnter,_.props.onClick)}:j!=="axis"&&(E={onMouseLeave:Ty(w.handleItemMouseLeave,_.props.onMouseLeave),onMouseEnter:Ty(w.handleItemMouseEnter,_.props.onMouseEnter)});var U=I.cloneElement(_,te(te({},x.props),E));function T(ae){return typeof F.dataKey=="function"?F.dataKey(ae.payload):null}if(S)if(z>=0){var ee,se;if(F.dataKey&&!F.allowDuplicatedCategory){var H=typeof F.dataKey=="function"?T:"payload.".concat(F.dataKey.toString());ee=db(M,H,N),se=V&&G&&db(G,H,N)}else ee=M==null?void 0:M[z],se=V&&G&&G[z];if(oe||ie){var Oe=_.props.activeIndex!==void 0?_.props.activeIndex:z;return[I.cloneElement(_,te(te(te({},x.props),E),{},{activeIndex:Oe})),null,null]}if(!De(ee))return[U].concat(Hh(w.renderActivePoints({item:x,activePoint:ee,basePoint:se,childIndex:z,isRange:V})))}else{var be,xe=(be=w.getItemByXY(w.state.activeCoordinate))!==null&&be!==void 0?be:{graphicalItem:U},C=xe.graphicalItem,B=C.item,Y=B===void 0?_:B,me=C.childIndex,W=te(te(te({},x.props),E),{},{activeIndex:me});return[I.cloneElement(Y,W),null,null]}return V?[U,null,null]:[U,null]}),je(Xe(w),"renderCustomized",function(_,O,P){return I.cloneElement(_,te(te({key:"recharts-customized-".concat(P)},w.props),w.state))}),je(Xe(w),"renderMap",{CartesianGrid:{handler:jy,once:!0},ReferenceArea:{handler:w.renderReferenceElement},ReferenceLine:{handler:jy},ReferenceDot:{handler:w.renderReferenceElement},XAxis:{handler:jy},YAxis:{handler:jy},Brush:{handler:w.renderBrush,once:!0},Bar:{handler:w.renderGraphicChild},Line:{handler:w.renderGraphicChild},Area:{handler:w.renderGraphicChild},Radar:{handler:w.renderGraphicChild},RadialBar:{handler:w.renderGraphicChild},Scatter:{handler:w.renderGraphicChild},Pie:{handler:w.renderGraphicChild},Funnel:{handler:w.renderGraphicChild},Tooltip:{handler:w.renderCursor,once:!0},PolarGrid:{handler:w.renderPolarGrid,once:!0},PolarAngleAxis:{handler:w.renderPolarAxis},PolarRadiusAxis:{handler:w.renderPolarAxis},Customized:{handler:w.renderCustomized}}),w.clipPathId="".concat((y=v.id)!==null&&y!==void 0?y:wd("recharts"),"-clip"),w.throttleTriggeredAfterMouseMove=wB(w.triggeredAfterMouseMove,(b=v.throttleDelay)!==null&&b!==void 0?b:1e3/60),w.state={},w}return RAe(g,[{key:"componentDidMount",value:function(){var y,b;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(y=this.props.margin.left)!==null&&y!==void 0?y:0,top:(b=this.props.margin.top)!==null&&b!==void 0?b:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var y=this.props,b=y.children,w=y.data,_=y.height,O=y.layout,P=si(b,la);if(P){var x=P.props.defaultIndex;if(!(typeof x!="number"||x<0||x>this.state.tooltipTicks.length)){var j=this.state.tooltipTicks[x]&&this.state.tooltipTicks[x].value,k=ME(this.state,w,x,j),R=this.state.tooltipTicks[x].coordinate,F=(this.state.offset.top+_)/2,z=O==="horizontal",N=z?{x:R,y:F}:{y:R,x:F},L=this.state.formattedGraphicalItems.find(function(q){var M=q.item;return M.type.name==="Scatter"});L&&(N=te(te({},N),L.props.points[x].tooltipPosition),k=L.props.points[x].tooltipPayload);var D={activeTooltipIndex:x,isTooltipActive:!0,activeLabel:j,activePayload:k,activeCoordinate:N};this.setState(D),this.renderCursor(P),this.accessibilityManager.setIndex(x)}}}},{key:"getSnapshotBeforeUpdate",value:function(y,b){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==b.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==y.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==y.margin){var w,_;this.accessibilityManager.setDetails({offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(_=this.props.margin.top)!==null&&_!==void 0?_:0}})}return null}},{key:"componentDidUpdate",value:function(y){yP([si(y.children,la)],[si(this.props.children,la)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var y=si(this.props.children,la);if(y&&typeof y.props.shared=="boolean"){var b=y.props.shared?"axis":"item";return u.indexOf(b)>=0?b:s}return s}},{key:"getMouseInfo",value:function(y){if(!this.container)return null;var b=this.container,w=b.getBoundingClientRect(),_=Yge(w),O={chartX:Math.round(y.pageX-_.left),chartY:Math.round(y.pageY-_.top)},P=w.width/b.offsetWidth||1,x=this.inRange(O.chartX,O.chartY,P);if(!x)return null;var j=this.state,k=j.xAxisMap,R=j.yAxisMap,F=this.getTooltipEventType();if(F!=="axis"&&k&&R){var z=Uo(k).scale,N=Uo(R).scale,L=z&&z.invert?z.invert(O.chartX):null,D=N&&N.invert?N.invert(O.chartY):null;return te(te({},O),{},{xValue:L,yValue:D})}var q=ND(this.state,this.props.data,this.props.layout,x);return q?te(te({},O),q):null}},{key:"inRange",value:function(y,b){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,_=this.props.layout,O=y/w,P=b/w;if(_==="horizontal"||_==="vertical"){var x=this.state.offset,j=O>=x.left&&O<=x.left+x.width&&P>=x.top&&P<=x.top+x.height;return j?{x:O,y:P}:null}var k=this.state,R=k.angleAxisMap,F=k.radiusAxisMap;if(R&&F){var z=Uo(R);return iM({x:O,y:P},z)}return null}},{key:"parseEventsOfWrapper",value:function(){var y=this.props.children,b=this.getTooltipEventType(),w=si(y,la),_={};w&&b==="axis"&&(w.props.trigger==="click"?_={onClick:this.handleClick}:_={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var O=fb(this.props,this.handleOuterEvent);return te(te({},O),_)}},{key:"addListener",value:function(){Jx.on(Zx,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){Jx.removeListener(Zx,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(y,b,w){for(var _=this.state.formattedGraphicalItems,O=0,P=_.length;O<P;O++){var x=_[O];if(x.item===y||x.props.key===y.key||b===Ks(x.item.type)&&w===x.childIndex)return x}return null}},{key:"renderClipPath",value:function(){var y=this.clipPathId,b=this.state.offset,w=b.left,_=b.top,O=b.height,P=b.width;return $.createElement("defs",null,$.createElement("clipPath",{id:y},$.createElement("rect",{x:w,y:_,height:O,width:P})))}},{key:"getXScales",value:function(){var y=this.state.xAxisMap;return y?Object.entries(y).reduce(function(b,w){var _=ID(w,2),O=_[0],P=_[1];return te(te({},b),{},je({},O,P.scale))},{}):null}},{key:"getYScales",value:function(){var y=this.state.yAxisMap;return y?Object.entries(y).reduce(function(b,w){var _=ID(w,2),O=_[0],P=_[1];return te(te({},b),{},je({},O,P.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(y){var b;return(b=this.state.xAxisMap)===null||b===void 0||(b=b[y])===null||b===void 0?void 0:b.scale}},{key:"getYScaleByAxisId",value:function(y){var b;return(b=this.state.yAxisMap)===null||b===void 0||(b=b[y])===null||b===void 0?void 0:b.scale}},{key:"getItemByXY",value:function(y){var b=this.state,w=b.formattedGraphicalItems,_=b.activeItem;if(w&&w.length)for(var O=0,P=w.length;O<P;O++){var x=w[O],j=x.props,k=x.item,R=Ks(k.type);if(R==="Bar"){var F=(j.data||[]).find(function(D){return fxe(y,D)});if(F)return{graphicalItem:x,payload:F}}else if(R==="RadialBar"){var z=(j.data||[]).find(function(D){return iM(y,D)});if(z)return{graphicalItem:x,payload:z}}else if($_(x,_)||j_(x,_)||pm(x,_)){var N=tSe({graphicalItem:x,activeTooltipItem:_,itemData:k.props.data}),L=k.props.activeIndex===void 0?N:k.props.activeIndex;return{graphicalItem:te(te({},x),{},{childIndex:L}),payload:pm(x,_)?k.props.data[N]:x.props.data[N]}}}return null}},{key:"render",value:function(){var y=this;if(!VR(this))return null;var b=this.props,w=b.children,_=b.className,O=b.width,P=b.height,x=b.style,j=b.compact,k=b.title,R=b.desc,F=$D(b,TAe),z=$e(F,!1);if(j)return $.createElement(fD,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},$.createElement(bP,dp({},z,{width:O,height:P,title:k,desc:R}),this.renderClipPath(),WR(w,this.renderMap)));if(this.props.accessibilityLayer){var N,L;z.tabIndex=(N=this.props.tabIndex)!==null&&N!==void 0?N:0,z.role=(L=this.props.role)!==null&&L!==void 0?L:"application",z.onKeyDown=function(q){y.accessibilityManager.keyboardEvent(q)},z.onFocus=function(){y.accessibilityManager.focus()}}var D=this.parseEventsOfWrapper();return $.createElement(fD,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},$.createElement("div",dp({className:ze("recharts-wrapper",_),style:te({position:"relative",cursor:"default",width:O,height:P},x)},D,{ref:function(M){y.container=M}}),$.createElement(bP,dp({},z,{width:O,height:P,title:k,desc:R,style:qAe}),this.renderClipPath(),WR(w,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}]),g}(I.Component),je(r,"displayName",n),je(r,"defaultProps",te({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},d)),je(r,"getDerivedStateFromProps",function(m,g){var v=m.dataKey,y=m.data,b=m.children,w=m.width,_=m.height,O=m.layout,P=m.stackOffset,x=m.margin,j=g.dataStartIndex,k=g.dataEndIndex;if(g.updateId===void 0){var R=MD(m);return te(te(te({},R),{},{updateId:0},p(te(te({props:m},R),{},{updateId:0}),g)),{},{prevDataKey:v,prevData:y,prevWidth:w,prevHeight:_,prevLayout:O,prevStackOffset:P,prevMargin:x,prevChildren:b})}if(v!==g.prevDataKey||y!==g.prevData||w!==g.prevWidth||_!==g.prevHeight||O!==g.prevLayout||P!==g.prevStackOffset||!ih(x,g.prevMargin)){var F=MD(m),z={chartX:g.chartX,chartY:g.chartY,isTooltipActive:g.isTooltipActive},N=te(te({},ND(g,y,O)),{},{updateId:g.updateId+1}),L=te(te(te({},F),z),N);return te(te(te({},L),p(te({props:m},L),g)),{},{prevDataKey:v,prevData:y,prevWidth:w,prevHeight:_,prevLayout:O,prevStackOffset:P,prevMargin:x,prevChildren:b})}if(!yP(b,g.prevChildren)){var D,q,M,V,G=si(b,zh),re=G&&(D=(q=G.props)===null||q===void 0?void 0:q.startIndex)!==null&&D!==void 0?D:j,K=G&&(M=(V=G.props)===null||V===void 0?void 0:V.endIndex)!==null&&M!==void 0?M:k,J=re!==j||K!==k,ie=!De(y),oe=ie&&!J?g.updateId:g.updateId+1;return te(te({updateId:oe},p(te(te({props:m},g),{},{updateId:oe,dataStartIndex:re,dataEndIndex:K}),g)),{},{prevChildren:b,dataStartIndex:re,dataEndIndex:K})}return null}),je(r,"renderActiveDot",function(m,g){var v;return I.isValidElement(m)?v=I.cloneElement(m,g):Ne(m)?v=m(g):v=$.createElement(A_,g),$.createElement(Ye,{className:"recharts-active-dot",key:g.key},v)}),r},QAe=N9({chartName:"PieChart",GraphicalChild:po,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:I_},{axisType:"radiusAxis",AxisComp:k_}],formatAxisMap:L0e,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),eTe=N9({chartName:"AreaChart",GraphicalChild:ro,axisComponents:[{axisType:"xAxis",AxisComp:N_},{axisType:"yAxis",AxisComp:M_}],formatAxisMap:CPe});function tTe(t,e){const[r,n]=I.useState(function(){const i=localStorage.getItem(e);return i?JSON.parse(i):t});return I.useEffect(function(){localStorage.setItem(e,JSON.stringify(r))},[r,e]),[r,n]}const M9=I.createContext();function rTe({children:t}){const[e,r]=tTe(window.matchMedia("(prefers-color-scheme: dark)").matches,"isDarkMode");I.useEffect(function(){e?(document.documentElement.classList.add("dark-mode"),document.documentElement.classList.remove("light-mode")):(document.documentElement.classList.add("light-mode"),document.documentElement.classList.remove("dark-mode"))},[e]);function n(){r(i=>!i)}return A(M9.Provider,{value:{isDarkMode:e,toggleDarkMode:n},children:t})}function L_(){const t=I.useContext(M9);if(t===void 0)throw new Error("DarkModeContext was used outside of DarkModeProvider");return t}const nTe=ue(Fre)`
  grid-column: 1 / -1;

  /* Hack to change grid line colors */
  & .recharts-cartesian-grid-horizontal line,
  & .recharts-cartesian-grid-vertical line {
    stroke: var(--color-grey-300);
  }
`;function iTe({bookings:t,numDays:e}){const{isDarkMode:r}=L_(),n=bX({start:KT(new Date,e-1),end:new Date}),i=n.map(s=>({label:au(s,"MMM dd"),totalSales:t.filter(o=>uP(s,new Date(o.created_at))).reduce((o,u)=>o+u.totalPrice,0),extrasSales:t.filter(o=>uP(s,new Date(o.created_at))).reduce((o,u)=>o+u.extrasPrice,0)})),a=r?{totalSales:{stroke:"#4f46e5",fill:"#4f46e5"},extrasSales:{stroke:"#22c55e",fill:"#22c55e"},text:"#e5e7eb",background:"#18212f"}:{totalSales:{stroke:"#4f46e5",fill:"#c7d2fe"},extrasSales:{stroke:"#16a34a",fill:"#dcfce7"},text:"#374151",background:"#fff"};return Q(nTe,{children:[Q(Jr,{as:"h2",children:["Sales from ",au(n.at(0),"MMM dd yyyy")," —"," ",au(n.at(-1),"MMM dd yyyy")," "]}),A(_B,{height:300,width:"100%",children:Q(eTe,{data:i,children:[A(N_,{dataKey:"label",tick:{fill:a.text},tickLine:{stroke:a.text}}),A(M_,{unit:"$",tick:{fill:a.text},tickLine:{stroke:a.text}}),A(x9,{strokeDasharray:"4"}),A(la,{contentStyle:{backgroundColor:a.background}}),A(ro,{dataKey:"totalSales",type:"monotone",stroke:a.totalSales.stroke,fill:a.totalSales.fill,strokeWidth:2,name:"Total sales",unit:"$"}),A(ro,{dataKey:"extrasSales",type:"monotone",stroke:a.extrasSales.stroke,fill:a.extrasSales.fill,strokeWidth:2,name:"Extras sales",unit:"$"})]})})]})}const aTe=ue.div`
  /* Box */
  background-color: var(--color-grey-0);
  border: 1px solid var(--color-grey-100);
  border-radius: var(--border-radius-md);

  padding: 2.4rem 3.2rem;
  grid-column: 3 / span 2;

  & > *:first-child {
    margin-bottom: 1.6rem;
  }

  & .recharts-pie-label-text {
    font-weight: 600;
  }
`,sTe=[{duration:"1 night",value:0,color:"#ef4444"},{duration:"2 nights",value:0,color:"#f97316"},{duration:"3 nights",value:0,color:"#eab308"},{duration:"4-5 nights",value:0,color:"#84cc16"},{duration:"6-7 nights",value:0,color:"#22c55e"},{duration:"8-14 nights",value:0,color:"#14b8a6"},{duration:"15-21 nights",value:0,color:"#3b82f6"},{duration:"21+ nights",value:0,color:"#a855f7"}],oTe=[{duration:"1 night",value:0,color:"#b91c1c"},{duration:"2 nights",value:0,color:"#c2410c"},{duration:"3 nights",value:0,color:"#a16207"},{duration:"4-5 nights",value:0,color:"#4d7c0f"},{duration:"6-7 nights",value:0,color:"#15803d"},{duration:"8-14 nights",value:0,color:"#0f766e"},{duration:"15-21 nights",value:0,color:"#1d4ed8"},{duration:"21+ nights",value:0,color:"#7e22ce"}];function uTe(t,e){function r(i,a){return i.map(s=>s.duration===a?{...s,value:s.value+1}:s)}return e.reduce((i,a)=>{const s=a.numNights;return s===1?r(i,"1 night"):s===2?r(i,"2 nights"):s===3?r(i,"3 nights"):[4,5].includes(s)?r(i,"4-5 nights"):[6,7].includes(s)?r(i,"6-7 nights"):s>=8&&s<=14?r(i,"8-14 nights"):s>=15&&s<=21?r(i,"15-21 nights"):s>=21?r(i,"21+ nights"):i},t).filter(i=>i.value>0)}function lTe({confirmedStays:t}){const{isDarkMode:e}=L_(),n=uTe(e?oTe:sTe,t);return Q(aTe,{children:[A(Jr,{as:"h2",children:"Stay duration summary"}),A(_B,{width:"100%",height:240,children:Q(QAe,{children:[A(po,{data:n,nameKey:"duration",dataKey:"value",innerRadius:85,outerRadius:110,cx:"40%",cy:"50%",paddingAngle:3,children:n.map(i=>A(m_,{fill:i.color,stroke:i.color},i.duration))}),A(la,{}),A(kh,{verticalAlign:"middle",align:"right",width:"30%",layout:"vertical",iconSize:15,iconType:"circle"})]})})]})}const Sa=ue.div`
  display: flex;

  ${t=>t.type==="horizontal"&&$r`
      justify-content: space-between;
      align-items: center;
    `}

  ${t=>t.type==="vertical"&&$r`
      flex-direction: column;
      gap: 1.6rem;
    `}
`;Sa.defaultProps={type:"vertical"};function cTe(){const{isLoading:t,data:e}=lo({queryFn:rre,queryKey:["today-activity"]});return{activities:e,isLoading:t}}const sw=ue.span`
  width: fit-content;
  text-transform: uppercase;
  font-size: 1.1rem;
  font-weight: 600;
  padding: 0.4rem 1.2rem;
  border-radius: 100px;

  /* Make these dynamic, based on the received prop */
  color: var(--color-${t=>t.type}-700);
  background-color: var(--color-${t=>t.type}-100);
`,D9=ue.img`
  max-width: 2rem;
  border-radius: var(--border-radius-tiny);
  display: block;
  border: 1px solid var(--color-grey-100);
`,hTe={small:$r`
    font-size: 1.2rem;
    padding: 0.4rem 0.8rem;
    text-transform: uppercase;
    font-weight: 600;
    text-align: center;
  `,medium:$r`
    font-size: 1.4rem;
    padding: 1.2rem 1.6rem;
    font-weight: 500;
  `,large:$r`
    font-size: 1.6rem;
    padding: 1.2rem 2.4rem;
    font-weight: 500;
  `},dTe={primary:$r`
    color: var(--color-brand-50);
    background-color: var(--color-brand-600);

    &:hover {
      background-color: var(--color-brand-700);
    }
  `,secondary:$r`
    color: var(--color-grey-600);
    background: var(--color-grey-0);
    border: 1px solid var(--color-grey-200);

    &:hover {
      background-color: var(--color-grey-50);
    }
  `,danger:$r`
    color: var(--color-red-100);
    background-color: var(--color-red-700);

    &:hover {
      background-color: var(--color-red-800);
    }
  `},qt=ue.button`
  border: none;
  border-radius: var(--border-radius-sm);
  box-shadow: var(--shadow-sm);

  ${t=>hTe[t.size]}
  ${t=>dTe[t.variation]}
`;qt.defaultProps={variation:"primary",size:"medium"};function tC(){const t=vi(),{mutate:e,isLoading:r}=ka({mutationFn:n=>XU(n,{status:"checked-out"}),onSuccess:n=>{ut.success(`Booking #${n.id} successfully checked out`),t.invalidateQueries({active:!0})},onError:()=>ut.error("There was an error while checking out")});return{checkout:e,isCheckingOut:r}}function fTe({bookingId:t}){const{checkout:e,isCheckingOut:r}=tC();return A(qt,{variation:"primary",size:"small",onClick:()=>e(t),disabled:r,children:"Check out"})}const pTe=ue.li`
  display: grid;
  grid-template-columns: 9rem 2rem 1fr 7rem 9rem;
  gap: 1.2rem;
  align-items: center;

  font-size: 1.4rem;
  padding: 0.8rem 0;
  border-bottom: 1px solid var(--color-grey-100);

  &:first-child {
    border-top: 1px solid var(--color-grey-100);
  }
`,mTe=ue.div`
  font-weight: 500;
`;function gTe({activity:t}){const{id:e,status:r,guests:n,numNights:i}=t;return Q(pTe,{children:[r==="unconfirmed"&&A(sw,{type:"green",children:"Arriving"}),r==="checked-in"&&A(sw,{type:"blue",children:"Departing"}),A(D9,{src:n.countryFlag,alt:`Flag of ${n.country}`}),A(mTe,{children:n.fullName}),Q("div",{children:[i," nights"]}),r==="unconfirmed"&&A(qt,{size:"small",variation:"primary",as:L4,to:`/checkin/${e}`,children:"Check in"}),r==="checked-in"&&A(fTe,{bookingId:e})]})}const yTe=ue.div`
  /* Box */
  background-color: var(--color-grey-0);
  border: 1px solid var(--color-grey-100);
  border-radius: var(--border-radius-md);

  padding: 3.2rem;
  display: flex;
  flex-direction: column;
  gap: 2.4rem;
  grid-column: 1 / span 2;
  padding-top: 2.4rem;
`,vTe=ue.ul`
  overflow: scroll;
  overflow-x: hidden;

  /* Removing scrollbars for webkit, firefox, and ms, respectively */
  &::-webkit-scrollbar {
    width: 0 !important;
  }
  scrollbar-width: none;
  -ms-overflow-style: none;
`,bTe=ue.p`
  text-align: center;
  font-size: 1.8rem;
  font-weight: 500;
  margin-top: 0.8rem;
`;function wTe(){const{activities:t,isLoading:e}=cTe();return Q(yTe,{children:[A(Sa,{type:"horizontal",children:A(Jr,{as:"h2",children:"Today"})}),e?A(ms,{}):(t==null?void 0:t.length)>0?A(vTe,{children:t.map(r=>A(gTe,{activity:r},r.id))}):A(bTe,{children:"No activity today..."})]})}const _Te=ue.div`
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr;
  grid-template-rows: auto 34rem auto;
  gap: 2.4rem;
`;function xTe(){const{bookings:t,isLoading:e}=are(),{confirmedStays:r,isLoading:n,numDays:i}=ire(),{cabins:a,isLoading:s}=ZT();return e||n||s?A(ms,{}):Q(_Te,{children:[A(Mre,{bookings:t,confirmedStays:r,numDays:i,cabinCount:a.length}),A(wTe,{}),A(lTe,{confirmedStays:r}),A(iTe,{bookings:t,numDays:i})]})}const OTe=ue.div`
  border: 1px solid var(--color-grey-100);
  background-color: var(--color-grey-0);
  box-shadow: var(--shadow-sm);
  border-radius: var(--border-radius-sm);
  padding: 0.4rem;
  display: flex;
  gap: 0.4rem;
`,STe=ue.button`
  background-color: var(--color-grey-0);
  border: none;

  ${t=>t.active&&$r`
      background-color: var(--color-brand-600);
      color: var(--color-brand-50);
    `}

  border-radius: var(--border-radius-sm);
  font-weight: 500;
  font-size: 1.4rem;
  /* To give the same height as select */
  padding: 0.44rem 0.8rem;
  transition: all 0.3s;

  &:hover:not(:disabled) {
    background-color: var(--color-brand-600);
    color: var(--color-brand-50);
  }
`;function rC({filterField:t,options:e}){const[r,n]=ql(),i=r.get(t)||e.at(0).value;function a(s){r.set(t,s),r.get("page")&&r.set("page",1),n(r)}return A(OTe,{children:e.map(s=>A(STe,{onClick:()=>a(s.value),active:s.value===i,disabled:s.value===i,children:s.label},s.value))})}function PTe(){return A(rC,{filterField:"last",options:[{value:"7",label:"Last 7 days"},{value:"30",label:"Last 30 days"},{value:"90",label:"Last 90 days"}]})}function ETe(){return Q(fs,{children:[Q(Sa,{type:"horizontal",children:[A(Jr,{as:"h1",children:"Dashboard"}),A(PTe,{})]}),A(xTe,{})]})}const ATe=ue.div`
  border: 1px solid var(--color-grey-200);

  font-size: 1.4rem;
  background-color: var(--color-grey-0);
  border-radius: 7px;
  overflow: hidden;
`,L9=ue.div`
  display: grid;
  grid-template-columns: ${t=>t.columns};
  column-gap: 2.4rem;
  align-items: center;
  transition: none;
`,TTe=ue(L9)`
  padding: 1.6rem 2.4rem;

  background-color: var(--color-grey-50);
  border-bottom: 1px solid var(--color-grey-100);
  text-transform: uppercase;
  letter-spacing: 0.4px;
  font-weight: 600;
  color: var(--color-grey-600);
`,kTe=ue(L9)`
  padding: 1.2rem 2.4rem;

  &:not(:last-child) {
    border-bottom: 1px solid var(--color-grey-100);
  }
`,CTe=ue.section`
  margin: 0.4rem 0;
`,ITe=ue.footer`
  background-color: var(--color-grey-50);
  display: flex;
  justify-content: center;
  padding: 1.2rem;

  /* This will hide the footer when it contains no child elements. Possible thanks to the parent selector :has 🎉 */
  &:not(:has(*)) {
    display: none;
  }
`,$Te=ue.p`
  font-size: 1.6rem;
  font-weight: 500;
  text-align: center;
  margin: 2.4rem;
`,nC=I.createContext();function ci({columns:t,children:e}){return A(nC.Provider,{value:{columns:t},children:A(ATe,{role:"table",children:e})})}function jTe({children:t}){const{columns:e}=I.useContext(nC);return A(TTe,{role:"row",columns:e,as:"header",children:t})}function RTe({children:t}){const{columns:e}=I.useContext(nC);return A(kTe,{role:"row",columns:e,children:t})}function NTe({data:t,render:e}){return t.length?A(CTe,{children:t.map(e)}):A($Te,{children:"No data to show at the moment"})}ci.Header=jTe;ci.Body=NTe;ci.Row=RTe;ci.Footer=ITe;function F9(t,e=!0){const r=I.useRef();return I.useEffect(function(){function n(i){r.current&&!r.current.contains(i.target)&&t()}return document.addEventListener("click",n,e),()=>document.removeEventListener("click",n,e)},[t,e]),r}const MTe=ue.div`
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: var(--color-grey-0);
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-lg);
  padding: 3.2rem 4rem;
  transition: all 0.5s;
`,DTe=ue.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;
  background-color: var(--backdrop-color);
  backdrop-filter: blur(4px);
  z-index: 1000;
  transition: all 0.5s;
`,LTe=ue.button`
  background: none;
  border: none;
  padding: 0.4rem;
  border-radius: var(--border-radius-sm);
  transform: translateX(0.8rem);
  transition: all 0.2s;
  position: absolute;
  top: 1.2rem;
  right: 1.9rem;

  &:hover {
    background-color: var(--color-grey-100);
  }

  & svg {
    width: 2.4rem;
    height: 2.4rem;
    /* Sometimes we need both */
    /* fill: var(--color-grey-500);
    stroke: var(--color-grey-500); */
    color: var(--color-grey-500);
  }
`,iC=I.createContext();function un({children:t}){const[e,r]=I.useState(""),n=()=>r(""),i=r;return A(iC.Provider,{value:{openName:e,close:n,open:i},children:t})}function FTe({children:t,opens:e}){const{open:r}=I.useContext(iC);return I.cloneElement(t,{onClick:()=>r(e)})}function UTe({children:t,name:e}){const{openName:r,close:n}=I.useContext(iC),i=F9(n);return e!==r?null:ET.createPortal(A(DTe,{children:Q(MTe,{ref:i,children:[A(LTe,{onClick:n,children:A(vre,{})}),A("div",{children:I.cloneElement(t,{onCloseModal:n})})]})}),document.body)}un.Open=FTe;un.Window=UTe;const zTe=ue.div`
  display: flex;
  align-items: center;
  justify-content: flex-end;
`,BTe=ue.button`
  background: none;
  border: none;
  padding: 0.4rem;
  border-radius: var(--border-radius-sm);
  transform: translateX(0.8rem);
  transition: all 0.2s;

  &:hover {
    background-color: var(--color-grey-100);
  }

  & svg {
    width: 2.4rem;
    height: 2.4rem;
    color: var(--color-grey-700);
  }
`,qTe=ue.ul`
  position: fixed;

  background-color: var(--color-grey-0);
  box-shadow: var(--shadow-md);
  border-radius: var(--border-radius-md);

  right: ${t=>t.position.x}px;
  top: ${t=>t.position.y}px;
`,KTe=ue.button`
  width: 100%;
  text-align: left;
  background: none;
  border: none;
  padding: 1.2rem 2.4rem;
  font-size: 1.4rem;
  transition: all 0.2s;

  display: flex;
  align-items: center;
  gap: 1.6rem;

  &:hover {
    background-color: var(--color-grey-50);
  }

  & svg {
    width: 1.6rem;
    height: 1.6rem;
    color: var(--color-grey-400);
    transition: all 0.3s;
  }
`,F_=I.createContext();function pr({children:t}){const[e,r]=I.useState(""),[n,i]=I.useState(null),a=()=>r(""),s=r;return A(F_.Provider,{value:{openId:e,close:a,open:s,position:n,setPosition:i},children:t})}function VTe({id:t}){const{openId:e,close:r,open:n,setPosition:i}=I.useContext(F_);function a(s){s.stopPropagation();const o=s.target.closest("button").getBoundingClientRect();i({x:window.innerWidth-o.width-o.x,y:o.y+o.height+8}),e===""||e!==t?n(t):r()}return A(BTe,{onClick:a,children:A(fre,{})})}function HTe({id:t,children:e}){const{openId:r,position:n,close:i}=I.useContext(F_),a=F9(i,!1);return r!==t?null:ET.createPortal(A(qTe,{position:n,ref:a,children:e}),document.body)}function WTe({children:t,icon:e,onClick:r}){const{close:n}=I.useContext(F_);function i(){r==null||r(),n()}return A("li",{children:Q(KTe,{onClick:i,children:[e,A("span",{children:t})]})})}pr.Menu=zTe;pr.Toggle=VTe;pr.List=HTe;pr.Button=WTe;const GTe=ue.div`
  width: 40rem;
  display: flex;
  flex-direction: column;
  gap: 1.2rem;

  & p {
    color: var(--color-grey-500);
    margin-bottom: 1.2rem;
  }

  & div {
    display: flex;
    justify-content: flex-end;
    gap: 1.2rem;
  }
`;function aC({resourceName:t,onConfirm:e,disabled:r,onCloseModal:n}){return Q(GTe,{children:[Q(Jr,{as:"h3",children:["Delete ",t]}),Q("p",{children:["Are you sure you want to delete this ",t," permanently? This action cannot be undone."]}),Q("div",{children:[A(qt,{variation:"secondary",disabled:r,onClick:n,children:"Cancel"}),A(qt,{variation:"danger",disabled:r,onClick:e,children:"Delete"})]})]})}function U9(){const t=vi(),{isLoading:e,mutate:r}=ka({mutationFn:nre,onSuccess:()=>{ut.success("Booking successfully deleted"),t.invalidateQueries({queryKey:["bookings"]})},onError:n=>ut.error(n.message)});return{isDeleting:e,deleteBooking:r}}const YTe=ue.div`
  font-size: 1.6rem;
  font-weight: 600;
  color: var(--color-grey-600);
  font-family: "Sono";
`,LD=ue.div`
  display: flex;
  flex-direction: column;
  gap: 0.2rem;

  & span:first-child {
    font-weight: 500;
  }

  & span:last-child {
    color: var(--color-grey-500);
    font-size: 1.2rem;
  }
`,JTe=ue.div`
  font-family: "Sono";
  font-weight: 500;
`;function ZTe({booking:{id:t,created_at:e,startDate:r,endDate:n,numNights:i,numGuests:a,totalPrice:s,status:o,guests:{fullName:u,email:l},cabins:{name:c}}}){const h=Ta(),{checkout:d,isCheckingOut:f}=tC(),{deleteBooking:p,isDeleting:m}=U9(),g={unconfirmed:"blue","checked-in":"green","checked-out":"silver"};return Q(ci.Row,{children:[A(YTe,{children:c}),Q(LD,{children:[A("span",{children:u}),A("span",{children:l})]}),Q(LD,{children:[Q("span",{children:[AU(new Date(r))?"Today":kU(r)," ","→ ",i," night stay"]}),Q("span",{children:[au(new Date(r),"MMM dd yyyy")," —"," ",au(new Date(n),"MMM dd yyyy")]})]}),A(sw,{type:g[o],children:o.replace("-"," ")}),A(JTe,{children:$i(s)}),Q(un,{children:[Q(pr.Menu,{children:[A(pr.Toggle,{id:t}),Q(pr.List,{id:t,children:[A(pr.Button,{icon:A(pre,{}),onClick:()=>h(`/bookings/${t}`),children:"See details"}),o==="unconfirmed"&&A(pr.Button,{icon:A(lre,{}),onClick:()=>h(`/checkin/${t}`),children:"Check in"}),o==="checked-in"&&A(pr.Button,{icon:A(tz,{}),onClick:()=>d(t),disabled:f,children:"Check out"}),A(un.Open,{opens:"delete",children:A(pr.Button,{icon:A(rz,{}),children:"Delete booking"})})]})]}),A(un.Window,{name:"delete",children:A(aC,{resourceName:"booking",disabled:m,onConfirm:()=>p(t)})})]})]})}function sC({resourceName:t}){return Q("p",{children:["No ",t," could be found."]})}function XTe(){const t=vi(),[e]=ql(),r=e.get("status"),n=!r||r==="all"?null:{field:"status",value:r},i=e.get("sortBy")||"startDate-desc",[a,s]=i.split("-"),o={field:a,direction:s},u=e.get("page")?Number(e.get("page")):1,{isLoading:l,data:{data:c,count:h}={},error:d}=lo({queryKey:["bookings",n,o,u],queryFn:()=>xx({filter:n,sortBy:o,page:u})}),f=Math.ceil(h/nh);return u<f&&t.prefetchQuery({queryKey:["bookings",n,o,u+1],queryFn:()=>xx({filter:n,sortBy:o,page:u+1})}),u>1&&t.prefetchQuery({queryKey:["bookings",n,o,u-1],queryFn:()=>xx({filter:n,sortBy:o,page:u-1})}),{isLoading:l,error:d,bookings:c,count:h}}const QTe=ue.div`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
`,eke=ue.p`
  font-size: 1.4rem;
  margin-left: 0.8rem;

  & span {
    font-weight: 600;
  }
`,tke=ue.div`
  display: flex;
  gap: 0.6rem;
`,FD=ue.button`
  background-color: ${t=>t.active?" var(--color-brand-600)":"var(--color-grey-50)"};
  color: ${t=>t.active?" var(--color-brand-50)":"inherit"};
  border: none;
  border-radius: var(--border-radius-sm);
  font-weight: 500;
  font-size: 1.4rem;

  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.4rem;
  padding: 0.6rem 1.2rem;
  transition: all 0.3s;

  &:has(span:last-child) {
    padding-left: 0.4rem;
  }

  &:has(span:first-child) {
    padding-right: 0.4rem;
  }

  & svg {
    height: 1.8rem;
    width: 1.8rem;
  }

  &:hover:not(:disabled) {
    background-color: var(--color-brand-600);
    color: var(--color-brand-50);
  }
`;function rke({count:t}){const[e,r]=ql(),n=e.get("page")?Number(e.get("page")):1,i=Math.ceil(t/nh);function a(){const o=n===i?n:n+1;e.set("page",o),r(e)}function s(){const o=n===1?n:n-1;e.set("page",o),r(e)}return i<=1?null:Q(QTe,{children:[Q(eke,{children:["Showing ",A("span",{children:(n-1)*nh+1})," to"," ",A("span",{children:n===i?t:n*nh})," ","of ",A("span",{children:t})," results"]}),Q(tke,{children:[Q(FD,{onClick:s,disabled:n===1,children:[A(hre,{})," ",A("span",{children:"Previous"})]}),Q(FD,{onClick:a,disabled:n===i,children:[A("span",{children:"Next"}),A(dre,{})]})]})]})}function nke(){const{bookings:t,isLoading:e,count:r}=XTe();return e?A(ms,{}):t.length?A(pr,{children:Q(ci,{columns:"0.6fr 2fr 2.4fr 1.4fr 1fr 3.2rem",children:[Q(ci.Header,{children:[A("div",{children:"Cabin"}),A("div",{children:"Guest"}),A("div",{children:"Dates"}),A("div",{children:"Status"}),A("div",{children:"Amount"}),A("div",{})]}),A(ci.Body,{data:t,render:n=>A(ZTe,{booking:n},n.id)}),A(ci.Footer,{children:A(rke,{count:r})})]})}):A(sC,{resourceName:"bookings"})}const ike=ue.select`
  font-size: 1.4rem;
  padding: 0.8rem 1.2rem;
  border: 1px solid
    ${t=>t.type==="white"?"var(--color-grey-100)":"var(--color-grey-300)"};
  border-radius: var(--border-radius-sm);
  background-color: var(--color-grey-0);
  font-weight: 500;
  box-shadow: var(--shadow-sm);
`;function ake({options:t,value:e,onChange:r,...n}){return A(ike,{value:e,onChange:r,...n,children:t.map(i=>A("option",{value:i.value,children:i.label},i.value))})}function z9({options:t}){const[e,r]=ql(),n=e.get("sortBy")||"";function i(a){e.set("sortBy",a.target.value),r(e)}return A(ake,{options:t,type:"white",value:n,onChange:i})}const B9=ue.div`
  display: flex;
  align-items: center;
  gap: 1.6rem;
`;function ske(){return Q(B9,{children:[A(rC,{filterField:"status",options:[{value:"all",label:"All"},{value:"checked-out",label:"Checked out"},{value:"checked-in",label:"Checked in"},{value:"unconfirmed",label:"Unconfirmed"}]}),A(z9,{options:[{value:"startDate-desc",label:"Sort by date (recent first)"},{value:"startDate-asc",label:"Sort by date (earlier first)"},{value:"totalPrice-desc",label:"Sort by amount (high first)"},{value:"totalPrice-asc",label:"Sort by amount (low first)"}]})]})}function oke(){return Q(fs,{children:[Q(Sa,{type:"horizontal",children:[A(Jr,{as:"h1",children:"All bookings"}),A(ske,{})]}),A(nke,{})]})}var Sg=t=>t.type==="checkbox",qc=t=>t instanceof Date,_n=t=>t==null;const q9=t=>typeof t=="object";var xr=t=>!_n(t)&&!Array.isArray(t)&&q9(t)&&!qc(t),uke=t=>xr(t)&&t.target?Sg(t.target)?t.target.checked:t.target.value:t,lke=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,cke=(t,e)=>t.has(lke(e)),hke=t=>{const e=t.constructor&&t.constructor.prototype;return xr(e)&&e.hasOwnProperty("isPrototypeOf")},oC=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function qu(t){let e;const r=Array.isArray(t);if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set(t);else if(!(oC&&(t instanceof Blob||t instanceof FileList))&&(r||xr(t)))if(e=r?[]:{},!Array.isArray(t)&&!hke(t))e=t;else for(const n in t)e[n]=qu(t[n]);else return t;return e}var Pg=t=>Array.isArray(t)?t.filter(Boolean):[],sr=t=>t===void 0,Ee=(t,e,r)=>{if(!e||!xr(t))return r;const n=Pg(e.split(/[,[\].]+?/)).reduce((i,a)=>_n(i)?i:i[a],t);return sr(n)||n===t?sr(t[e])?r:t[e]:n};const UD={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},pa={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ps={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};$.createContext(null);var dke=(t,e,r,n=!0)=>{const i={defaultValues:e._defaultValues};for(const a in t)Object.defineProperty(i,a,{get:()=>{const s=a;return e._proxyFormState[s]!==pa.all&&(e._proxyFormState[s]=!n||pa.all),r&&(r[s]=!0),t[s]}});return i},Ai=t=>xr(t)&&!Object.keys(t).length,fke=(t,e,r,n)=>{r(t);const{name:i,...a}=t;return Ai(a)||Object.keys(a).length>=Object.keys(e).length||Object.keys(a).find(s=>e[s]===(!n||pa.all))},Qx=t=>Array.isArray(t)?t:[t];function pke(t){const e=$.useRef(t);e.current=t,$.useEffect(()=>{const r=!t.disabled&&e.current.subject&&e.current.subject.subscribe({next:e.current.next});return()=>{r&&r.unsubscribe()}},[t.disabled])}var Ja=t=>typeof t=="string",mke=(t,e,r,n,i)=>Ja(t)?(n&&e.watch.add(t),Ee(r,t,i)):Array.isArray(t)?t.map(a=>(n&&e.watch.add(a),Ee(r,a))):(n&&(e.watchAll=!0),r),uC=t=>/^\w*$/.test(t),K9=t=>Pg(t.replace(/["|']|\]/g,"").split(/\.|\[/));function Rt(t,e,r){let n=-1;const i=uC(e)?[e]:K9(e),a=i.length,s=a-1;for(;++n<a;){const o=i[n];let u=r;if(n!==s){const l=t[o];u=xr(l)||Array.isArray(l)?l:isNaN(+i[n+1])?{}:[]}t[o]=u,t=t[o]}return t}var gke=(t,e,r,n,i)=>e?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[n]:i||!0}}:{};const DE=(t,e,r)=>{for(const n of r||Object.keys(t)){const i=Ee(t,n);if(i){const{_f:a,...s}=i;if(a&&e(a.name)){if(a.ref.focus){a.ref.focus();break}else if(a.refs&&a.refs[0].focus){a.refs[0].focus();break}}else xr(s)&&DE(s,e)}}};var zD=t=>({isOnSubmit:!t||t===pa.onSubmit,isOnBlur:t===pa.onBlur,isOnChange:t===pa.onChange,isOnAll:t===pa.all,isOnTouch:t===pa.onTouched}),BD=(t,e,r)=>!r&&(e.watchAll||e.watch.has(t)||[...e.watch].some(n=>t.startsWith(n)&&/^\.\w+/.test(t.slice(n.length)))),yke=(t,e,r)=>{const n=Pg(Ee(t,r));return Rt(n,"root",e[r]),Rt(t,r,n),t},uh=t=>typeof t=="boolean",lC=t=>t.type==="file",Wo=t=>typeof t=="function",ow=t=>{if(!oC)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},yv=t=>Ja(t),cC=t=>t.type==="radio",uw=t=>t instanceof RegExp;const qD={value:!1,isValid:!1},KD={value:!0,isValid:!0};var V9=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!sr(t[0].attributes.value)?sr(t[0].value)||t[0].value===""?KD:{value:t[0].value,isValid:!0}:KD:qD}return qD};const VD={isValid:!1,value:null};var H9=t=>Array.isArray(t)?t.reduce((e,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:e,VD):VD;function HD(t,e,r="validate"){if(yv(t)||Array.isArray(t)&&t.every(yv)||uh(t)&&!t)return{type:r,message:yv(t)?t:"",ref:e}}var cc=t=>xr(t)&&!uw(t)?t:{value:t,message:""},WD=async(t,e,r,n,i)=>{const{ref:a,refs:s,required:o,maxLength:u,minLength:l,min:c,max:h,pattern:d,validate:f,name:p,valueAsNumber:m,mount:g,disabled:v}=t._f,y=Ee(e,p);if(!g||v)return{};const b=s?s[0]:a,w=F=>{n&&b.reportValidity&&(b.setCustomValidity(uh(F)?"":F||""),b.reportValidity())},_={},O=cC(a),P=Sg(a),x=O||P,j=(m||lC(a))&&sr(a.value)&&sr(y)||ow(a)&&a.value===""||y===""||Array.isArray(y)&&!y.length,k=gke.bind(null,p,r,_),R=(F,z,N,L=Ps.maxLength,D=Ps.minLength)=>{const q=F?z:N;_[p]={type:F?L:D,message:q,ref:a,...k(F?L:D,q)}};if(i?!Array.isArray(y)||!y.length:o&&(!x&&(j||_n(y))||uh(y)&&!y||P&&!V9(s).isValid||O&&!H9(s).isValid)){const{value:F,message:z}=yv(o)?{value:!!o,message:o}:cc(o);if(F&&(_[p]={type:Ps.required,message:z,ref:b,...k(Ps.required,z)},!r))return w(z),_}if(!j&&(!_n(c)||!_n(h))){let F,z;const N=cc(h),L=cc(c);if(!_n(y)&&!isNaN(y)){const D=a.valueAsNumber||y&&+y;_n(N.value)||(F=D>N.value),_n(L.value)||(z=D<L.value)}else{const D=a.valueAsDate||new Date(y),q=G=>new Date(new Date().toDateString()+" "+G),M=a.type=="time",V=a.type=="week";Ja(N.value)&&y&&(F=M?q(y)>q(N.value):V?y>N.value:D>new Date(N.value)),Ja(L.value)&&y&&(z=M?q(y)<q(L.value):V?y<L.value:D<new Date(L.value))}if((F||z)&&(R(!!F,N.message,L.message,Ps.max,Ps.min),!r))return w(_[p].message),_}if((u||l)&&!j&&(Ja(y)||i&&Array.isArray(y))){const F=cc(u),z=cc(l),N=!_n(F.value)&&y.length>+F.value,L=!_n(z.value)&&y.length<+z.value;if((N||L)&&(R(N,F.message,z.message),!r))return w(_[p].message),_}if(d&&!j&&Ja(y)){const{value:F,message:z}=cc(d);if(uw(F)&&!y.match(F)&&(_[p]={type:Ps.pattern,message:z,ref:a,...k(Ps.pattern,z)},!r))return w(z),_}if(f){if(Wo(f)){const F=await f(y,e),z=HD(F,b);if(z&&(_[p]={...z,...k(Ps.validate,z.message)},!r))return w(z.message),_}else if(xr(f)){let F={};for(const z in f){if(!Ai(F)&&!r)break;const N=HD(await f[z](y,e),b,z);N&&(F={...N,...k(z,N.message)},w(N.message),r&&(_[p]=F))}if(!Ai(F)&&(_[p]={ref:b,...F},!r))return _}}return w(!0),_};function vke(t,e){const r=e.slice(0,-1).length;let n=0;for(;n<r;)t=sr(t)?n++:t[e[n++]];return t}function bke(t){for(const e in t)if(!sr(t[e]))return!1;return!0}function Kr(t,e){const r=Array.isArray(e)?e:uC(e)?[e]:K9(e),n=r.length===1?t:vke(t,r),i=r.length-1,a=r[i];return n&&delete n[a],i!==0&&(xr(n)&&Ai(n)||Array.isArray(n)&&bke(n))&&Kr(t,r.slice(0,-1)),t}function eO(){let t=[];return{get observers(){return t},next:i=>{for(const a of t)a.next&&a.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(a=>a!==i)}}),unsubscribe:()=>{t=[]}}}var lw=t=>_n(t)||!q9(t);function al(t,e){if(lw(t)||lw(e))return t===e;if(qc(t)&&qc(e))return t.getTime()===e.getTime();const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(const i of r){const a=t[i];if(!n.includes(i))return!1;if(i!=="ref"){const s=e[i];if(qc(a)&&qc(s)||xr(a)&&xr(s)||Array.isArray(a)&&Array.isArray(s)?!al(a,s):a!==s)return!1}}return!0}var W9=t=>t.type==="select-multiple",wke=t=>cC(t)||Sg(t),tO=t=>ow(t)&&t.isConnected,G9=t=>{for(const e in t)if(Wo(t[e]))return!0;return!1};function cw(t,e={}){const r=Array.isArray(t);if(xr(t)||r)for(const n in t)Array.isArray(t[n])||xr(t[n])&&!G9(t[n])?(e[n]=Array.isArray(t[n])?[]:{},cw(t[n],e[n])):_n(t[n])||(e[n]=!0);return e}function Y9(t,e,r){const n=Array.isArray(t);if(xr(t)||n)for(const i in t)Array.isArray(t[i])||xr(t[i])&&!G9(t[i])?sr(e)||lw(r[i])?r[i]=Array.isArray(t[i])?cw(t[i],[]):{...cw(t[i])}:Y9(t[i],_n(e)?{}:e[i],r[i]):r[i]=!al(t[i],e[i]);return r}var rO=(t,e)=>Y9(t,e,cw(e)),J9=(t,{valueAsNumber:e,valueAsDate:r,setValueAs:n})=>sr(t)?t:e?t===""?NaN:t&&+t:r&&Ja(t)?new Date(t):n?n(t):t;function nO(t){const e=t.ref;if(!(t.refs?t.refs.every(r=>r.disabled):e.disabled))return lC(e)?e.files:cC(e)?H9(t.refs).value:W9(e)?[...e.selectedOptions].map(({value:r})=>r):Sg(e)?V9(t.refs).value:J9(sr(e.value)?t.ref.value:e.value,t)}var _ke=(t,e,r,n)=>{const i={};for(const a of t){const s=Ee(e,a);s&&Rt(i,a,s._f)}return{criteriaMode:r,names:[...t],fields:i,shouldUseNativeValidation:n}},Pf=t=>sr(t)?t:uw(t)?t.source:xr(t)?uw(t.value)?t.value.source:t.value:t,xke=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate);function GD(t,e,r){const n=Ee(t,r);if(n||uC(r))return{error:n,name:r};const i=r.split(".");for(;i.length;){const a=i.join("."),s=Ee(e,a),o=Ee(t,a);if(s&&!Array.isArray(s)&&r!==a)return{name:r};if(o&&o.type)return{name:a,error:o};i.pop()}return{name:r}}var Oke=(t,e,r,n,i)=>i.isOnAll?!1:!r&&i.isOnTouch?!(e||t):(r?n.isOnBlur:i.isOnBlur)?!t:(r?n.isOnChange:i.isOnChange)?t:!0,Ske=(t,e)=>!Pg(Ee(t,e)).length&&Kr(t,e);const Pke={mode:pa.onSubmit,reValidateMode:pa.onChange,shouldFocusError:!0};function Eke(t={},e){let r={...Pke,...t},n={submitCount:0,isDirty:!1,isLoading:Wo(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},i={},a=xr(r.defaultValues)||xr(r.values)?qu(r.defaultValues||r.values)||{}:{},s=r.shouldUnregister?{}:qu(a),o={action:!1,mount:!1,watch:!1},u={mount:new Set,unMount:new Set,array:new Set,watch:new Set},l,c=0;const h={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},d={values:eO(),array:eO(),state:eO()},f=t.resetOptions&&t.resetOptions.keepDirtyValues,p=zD(r.mode),m=zD(r.reValidateMode),g=r.criteriaMode===pa.all,v=C=>B=>{clearTimeout(c),c=setTimeout(C,B)},y=async C=>{if(h.isValid||C){const B=r.resolver?Ai((await j()).errors):await R(i,!0);B!==n.isValid&&d.state.next({isValid:B})}},b=C=>h.isValidating&&d.state.next({isValidating:C}),w=(C,B=[],Y,me,W=!0,ae=!0)=>{if(me&&Y){if(o.action=!0,ae&&Array.isArray(Ee(i,C))){const ne=Y(Ee(i,C),me.argA,me.argB);W&&Rt(i,C,ne)}if(ae&&Array.isArray(Ee(n.errors,C))){const ne=Y(Ee(n.errors,C),me.argA,me.argB);W&&Rt(n.errors,C,ne),Ske(n.errors,C)}if(h.touchedFields&&ae&&Array.isArray(Ee(n.touchedFields,C))){const ne=Y(Ee(n.touchedFields,C),me.argA,me.argB);W&&Rt(n.touchedFields,C,ne)}h.dirtyFields&&(n.dirtyFields=rO(a,s)),d.state.next({name:C,isDirty:z(C,B),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Rt(s,C,B)},_=(C,B)=>{Rt(n.errors,C,B),d.state.next({errors:n.errors})},O=(C,B,Y,me)=>{const W=Ee(i,C);if(W){const ae=Ee(s,C,sr(Y)?Ee(a,C):Y);sr(ae)||me&&me.defaultChecked||B?Rt(s,C,B?ae:nO(W._f)):D(C,ae),o.mount&&y()}},P=(C,B,Y,me,W)=>{let ae=!1,ne=!1;const le={name:C};if(!Y||me){h.isDirty&&(ne=n.isDirty,n.isDirty=le.isDirty=z(),ae=ne!==le.isDirty);const X=al(Ee(a,C),B);ne=Ee(n.dirtyFields,C),X?Kr(n.dirtyFields,C):Rt(n.dirtyFields,C,!0),le.dirtyFields=n.dirtyFields,ae=ae||h.dirtyFields&&ne!==!X}if(Y){const X=Ee(n.touchedFields,C);X||(Rt(n.touchedFields,C,Y),le.touchedFields=n.touchedFields,ae=ae||h.touchedFields&&X!==Y)}return ae&&W&&d.state.next(le),ae?le:{}},x=(C,B,Y,me)=>{const W=Ee(n.errors,C),ae=h.isValid&&uh(B)&&n.isValid!==B;if(t.delayError&&Y?(l=v(()=>_(C,Y)),l(t.delayError)):(clearTimeout(c),l=null,Y?Rt(n.errors,C,Y):Kr(n.errors,C)),(Y?!al(W,Y):W)||!Ai(me)||ae){const ne={...me,...ae&&uh(B)?{isValid:B}:{},errors:n.errors,name:C};n={...n,...ne},d.state.next(ne)}b(!1)},j=async C=>r.resolver(s,r.context,_ke(C||u.mount,i,r.criteriaMode,r.shouldUseNativeValidation)),k=async C=>{const{errors:B}=await j();if(C)for(const Y of C){const me=Ee(B,Y);me?Rt(n.errors,Y,me):Kr(n.errors,Y)}else n.errors=B;return B},R=async(C,B,Y={valid:!0})=>{for(const me in C){const W=C[me];if(W){const{_f:ae,...ne}=W;if(ae){const le=u.array.has(ae.name),X=await WD(W,s,g,r.shouldUseNativeValidation&&!B,le);if(X[ae.name]&&(Y.valid=!1,B))break;!B&&(Ee(X,ae.name)?le?yke(n.errors,X,ae.name):Rt(n.errors,ae.name,X[ae.name]):Kr(n.errors,ae.name))}ne&&await R(ne,B,Y)}}return Y.valid},F=()=>{for(const C of u.unMount){const B=Ee(i,C);B&&(B._f.refs?B._f.refs.every(Y=>!tO(Y)):!tO(B._f.ref))&&S(C)}u.unMount=new Set},z=(C,B)=>(C&&B&&Rt(s,C,B),!al(re(),a)),N=(C,B,Y)=>mke(C,u,{...o.mount?s:sr(B)?a:Ja(C)?{[C]:B}:B},Y,B),L=C=>Pg(Ee(o.mount?s:a,C,t.shouldUnregister?Ee(a,C,[]):[])),D=(C,B,Y={})=>{const me=Ee(i,C);let W=B;if(me){const ae=me._f;ae&&(!ae.disabled&&Rt(s,C,J9(B,ae)),W=ow(ae.ref)&&_n(B)?"":B,W9(ae.ref)?[...ae.ref.options].forEach(ne=>ne.selected=W.includes(ne.value)):ae.refs?Sg(ae.ref)?ae.refs.length>1?ae.refs.forEach(ne=>(!ne.defaultChecked||!ne.disabled)&&(ne.checked=Array.isArray(W)?!!W.find(le=>le===ne.value):W===ne.value)):ae.refs[0]&&(ae.refs[0].checked=!!W):ae.refs.forEach(ne=>ne.checked=ne.value===W):lC(ae.ref)?ae.ref.value="":(ae.ref.value=W,ae.ref.type||d.values.next({name:C,values:{...s}})))}(Y.shouldDirty||Y.shouldTouch)&&P(C,W,Y.shouldTouch,Y.shouldDirty,!0),Y.shouldValidate&&G(C)},q=(C,B,Y)=>{for(const me in B){const W=B[me],ae=`${C}.${me}`,ne=Ee(i,ae);(u.array.has(C)||!lw(W)||ne&&!ne._f)&&!qc(W)?q(ae,W,Y):D(ae,W,Y)}},M=(C,B,Y={})=>{const me=Ee(i,C),W=u.array.has(C),ae=qu(B);Rt(s,C,ae),W?(d.array.next({name:C,values:{...s}}),(h.isDirty||h.dirtyFields)&&Y.shouldDirty&&d.state.next({name:C,dirtyFields:rO(a,s),isDirty:z(C,ae)})):me&&!me._f&&!_n(ae)?q(C,ae,Y):D(C,ae,Y),BD(C,u)&&d.state.next({...n}),d.values.next({name:C,values:{...s}}),!o.mount&&e()},V=async C=>{const B=C.target;let Y=B.name,me=!0;const W=Ee(i,Y),ae=()=>B.type?nO(W._f):uke(C);if(W){let ne,le;const X=ae(),ce=C.type===UD.BLUR||C.type===UD.FOCUS_OUT,pe=!xke(W._f)&&!r.resolver&&!Ee(n.errors,Y)&&!W._f.deps||Oke(ce,Ee(n.touchedFields,Y),n.isSubmitted,m,p),Ie=BD(Y,u,ce);Rt(s,Y,X),ce?(W._f.onBlur&&W._f.onBlur(C),l&&l(0)):W._f.onChange&&W._f.onChange(C);const Se=P(Y,X,ce,!1),Qr=!Ai(Se)||Ie;if(!ce&&d.values.next({name:Y,type:C.type,values:{...s}}),pe)return h.isValid&&y(),Qr&&d.state.next({name:Y,...Ie?{}:Se});if(!ce&&Ie&&d.state.next({...n}),b(!0),r.resolver){const{errors:ef}=await j([Y]),Gg=GD(n.errors,i,Y),x$=GD(ef,i,Gg.name||Y);ne=x$.error,Y=x$.name,le=Ai(ef)}else ne=(await WD(W,s,g,r.shouldUseNativeValidation))[Y],me=isNaN(X)||X===Ee(s,Y,X),me&&(ne?le=!1:h.isValid&&(le=await R(i,!0)));me&&(W._f.deps&&G(W._f.deps),x(Y,le,ne,Se))}},G=async(C,B={})=>{let Y,me;const W=Qx(C);if(b(!0),r.resolver){const ae=await k(sr(C)?C:W);Y=Ai(ae),me=C?!W.some(ne=>Ee(ae,ne)):Y}else C?(me=(await Promise.all(W.map(async ae=>{const ne=Ee(i,ae);return await R(ne&&ne._f?{[ae]:ne}:ne)}))).every(Boolean),!(!me&&!n.isValid)&&y()):me=Y=await R(i);return d.state.next({...!Ja(C)||h.isValid&&Y!==n.isValid?{}:{name:C},...r.resolver||!C?{isValid:Y}:{},errors:n.errors,isValidating:!1}),B.shouldFocus&&!me&&DE(i,ae=>ae&&Ee(n.errors,ae),C?W:u.mount),me},re=C=>{const B={...a,...o.mount?s:{}};return sr(C)?B:Ja(C)?Ee(B,C):C.map(Y=>Ee(B,Y))},K=(C,B)=>({invalid:!!Ee((B||n).errors,C),isDirty:!!Ee((B||n).dirtyFields,C),isTouched:!!Ee((B||n).touchedFields,C),error:Ee((B||n).errors,C)}),J=C=>{C&&Qx(C).forEach(B=>Kr(n.errors,B)),d.state.next({errors:C?n.errors:{}})},ie=(C,B,Y)=>{const me=(Ee(i,C,{_f:{}})._f||{}).ref;Rt(n.errors,C,{...B,ref:me}),d.state.next({name:C,errors:n.errors,isValid:!1}),Y&&Y.shouldFocus&&me&&me.focus&&me.focus()},oe=(C,B)=>Wo(C)?d.values.subscribe({next:Y=>C(N(void 0,B),Y)}):N(C,B,!0),S=(C,B={})=>{for(const Y of C?Qx(C):u.mount)u.mount.delete(Y),u.array.delete(Y),B.keepValue||(Kr(i,Y),Kr(s,Y)),!B.keepError&&Kr(n.errors,Y),!B.keepDirty&&Kr(n.dirtyFields,Y),!B.keepTouched&&Kr(n.touchedFields,Y),!r.shouldUnregister&&!B.keepDefaultValue&&Kr(a,Y);d.values.next({values:{...s}}),d.state.next({...n,...B.keepDirty?{isDirty:z()}:{}}),!B.keepIsValid&&y()},E=(C,B={})=>{let Y=Ee(i,C);const me=uh(B.disabled);return Rt(i,C,{...Y||{},_f:{...Y&&Y._f?Y._f:{ref:{name:C}},name:C,mount:!0,...B}}),u.mount.add(C),Y?me&&Rt(s,C,B.disabled?void 0:Ee(s,C,nO(Y._f))):O(C,!0,B.value),{...me?{disabled:B.disabled}:{},...r.shouldUseNativeValidation?{required:!!B.required,min:Pf(B.min),max:Pf(B.max),minLength:Pf(B.minLength),maxLength:Pf(B.maxLength),pattern:Pf(B.pattern)}:{},name:C,onChange:V,onBlur:V,ref:W=>{if(W){E(C,B),Y=Ee(i,C);const ae=sr(W.value)&&W.querySelectorAll&&W.querySelectorAll("input,select,textarea")[0]||W,ne=wke(ae),le=Y._f.refs||[];if(ne?le.find(X=>X===ae):ae===Y._f.ref)return;Rt(i,C,{_f:{...Y._f,...ne?{refs:[...le.filter(tO),ae,...Array.isArray(Ee(a,C))?[{}]:[]],ref:{type:ae.type,name:C}}:{ref:ae}}}),O(C,!1,void 0,ae)}else Y=Ee(i,C,{}),Y._f&&(Y._f.mount=!1),(r.shouldUnregister||B.shouldUnregister)&&!(cke(u.array,C)&&o.action)&&u.unMount.add(C)}}},U=()=>r.shouldFocusError&&DE(i,C=>C&&Ee(n.errors,C),u.mount),T=(C,B)=>async Y=>{Y&&(Y.preventDefault&&Y.preventDefault(),Y.persist&&Y.persist());let me=qu(s);if(d.state.next({isSubmitting:!0}),r.resolver){const{errors:W,values:ae}=await j();n.errors=W,me=ae}else await R(i);Kr(n.errors,"root"),Ai(n.errors)?(d.state.next({errors:{}}),await C(me,Y)):(B&&await B({...n.errors},Y),U(),setTimeout(U)),d.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Ai(n.errors),submitCount:n.submitCount+1,errors:n.errors})},ee=(C,B={})=>{Ee(i,C)&&(sr(B.defaultValue)?M(C,Ee(a,C)):(M(C,B.defaultValue),Rt(a,C,B.defaultValue)),B.keepTouched||Kr(n.touchedFields,C),B.keepDirty||(Kr(n.dirtyFields,C),n.isDirty=B.defaultValue?z(C,Ee(a,C)):z()),B.keepError||(Kr(n.errors,C),h.isValid&&y()),d.state.next({...n}))},se=(C,B={})=>{const Y=C||a,me=qu(Y),W=C&&!Ai(C)?me:a;if(B.keepDefaultValues||(a=Y),!B.keepValues){if(B.keepDirtyValues||f)for(const ae of u.mount)Ee(n.dirtyFields,ae)?Rt(W,ae,Ee(s,ae)):M(ae,Ee(W,ae));else{if(oC&&sr(C))for(const ae of u.mount){const ne=Ee(i,ae);if(ne&&ne._f){const le=Array.isArray(ne._f.refs)?ne._f.refs[0]:ne._f.ref;if(ow(le)){const X=le.closest("form");if(X){X.reset();break}}}}i={}}s=t.shouldUnregister?B.keepDefaultValues?qu(a):{}:me,d.array.next({values:{...W}}),d.values.next({values:{...W}})}u={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!o.mount&&e(),o.mount=!h.isValid||!!B.keepIsValid,o.watch=!!t.shouldUnregister,d.state.next({submitCount:B.keepSubmitCount?n.submitCount:0,isDirty:B.keepDirty?n.isDirty:!!(B.keepDefaultValues&&!al(C,a)),isSubmitted:B.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:B.keepDirtyValues?n.dirtyFields:B.keepDefaultValues&&C?rO(a,C):{},touchedFields:B.keepTouched?n.touchedFields:{},errors:B.keepErrors?n.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})},H=(C,B)=>se(Wo(C)?C(s):C,B);return{control:{register:E,unregister:S,getFieldState:K,_executeSchema:j,_getWatch:N,_getDirty:z,_updateValid:y,_removeUnmounted:F,_updateFieldArray:w,_getFieldArray:L,_reset:se,_resetDefaultValues:()=>Wo(r.defaultValues)&&r.defaultValues().then(C=>{H(C,r.resetOptions),d.state.next({isLoading:!1})}),_updateFormState:C=>{n={...n,...C}},_subjects:d,_proxyFormState:h,get _fields(){return i},get _formValues(){return s},get _state(){return o},set _state(C){o=C},get _defaultValues(){return a},get _names(){return u},set _names(C){u=C},get _formState(){return n},set _formState(C){n=C},get _options(){return r},set _options(C){r={...r,...C}}},trigger:G,register:E,handleSubmit:T,watch:oe,setValue:M,getValues:re,reset:H,resetField:ee,clearErrors:J,unregister:S,setError:ie,setFocus:(C,B={})=>{const Y=Ee(i,C),me=Y&&Y._f;if(me){const W=me.refs?me.refs[0]:me.ref;W.focus&&(W.focus(),B.shouldSelect&&W.select())}},getFieldState:K}}function hC(t={}){const e=$.useRef(),[r,n]=$.useState({isDirty:!1,isValidating:!1,isLoading:Wo(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:Wo(t.defaultValues)?void 0:t.defaultValues});e.current||(e.current={...Eke(t,()=>n(a=>({...a}))),formState:r});const i=e.current.control;return i._options=t,pke({subject:i._subjects.state,next:a=>{fke(a,i._proxyFormState,i._updateFormState,!0)&&n({...i._formState})}}),$.useEffect(()=>{t.values&&!al(t.values,i._defaultValues)?i._reset(t.values,i._options.resetOptions):i._resetDefaultValues()},[t.values,i]),$.useEffect(()=>{i._state.mount||(i._updateValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=dke(r,i),e.current}const jr=ue.input`
  border: 1px solid var(--color-grey-300);
  background-color: var(--color-grey-0);
  border-radius: var(--border-radius-sm);
  padding: 0.8rem 1.2rem;
  box-shadow: var(--shadow-sm);
  //    WIDTH: 900PX;
`,Eu=ue.form`
  ${t=>t.type==="regular"&&$r`
      padding: 2.4rem 4rem;

      /* Box */
      background-color: var(--color-grey-0);
      border: 1px solid var(--color-grey-100);
      border-radius: var(--border-radius-md);
    `}

  ${t=>t.type==="modal"&&$r`
      width: 80rem;
    `}
    
  overflow: hidden;
  font-size: 1.4rem;
`;Eu.defaultProps={type:"regular"};const Z9=ue.input.attrs({type:"file"})`
  font-size: 1.4rem;
  border-radius: var(--border-radius-sm);

  &::file-selector-button {
    font: inherit;
    font-weight: 500;
    padding: 0.8rem 1.2rem;
    margin-right: 1.2rem;
    border-radius: var(--border-radius-sm);
    border: none;
    color: var(--color-brand-50);
    background-color: var(--color-brand-600);
    cursor: pointer;
    transition: color 0.2s, background-color 0.2s;

    &:hover {
      background-color: var(--color-brand-700);
    }
  }
`,Ake=ue.textarea`
  padding: 0.8rem 1.2rem;
  border: 1px solid var(--color-grey-300);
  border-radius: 5px;
  background-color: var(--color-grey-0);
  box-shadow: var(--shadow-sm);
  width: 100%;
  height: 8rem;
`,Tke=ue.div`
  display: grid;
  align-items: center;
  grid-template-columns: 24rem 1fr 1.2fr;
  gap: 2.4rem;

  padding: 1.2rem 0;

  &:first-child {
    padding-top: 0;
  }

  &:last-child {
    padding-bottom: 0;
  }

  &:not(:last-child) {
    border-bottom: 1px solid var(--color-grey-100);
  }

  &:has(button) {
    display: flex;
    justify-content: flex-end;
    gap: 1.2rem;
  }
`,kke=ue.label`
  font-weight: 500;
`,Cke=ue.span`
  font-size: 1.4rem;
  color: var(--color-red-700);
`;function Bt({label:t,error:e,children:r}){return Q(Tke,{children:[t&&A(kke,{htmlFor:r.props.id,children:t}),r,e&&A(Cke,{children:e})]})}function X9(){const t=vi(),{mutate:e,isLoading:r}=ka({mutationFn:az,onSuccess:()=>{ut.success("New cabin successfully created"),t.invalidateQueries({queryKey:["cabins"]})},onError:n=>ut.error(n.message)});return{isCreating:r,createCabin:e}}function Ike(){const t=vi(),{mutate:e,isLoading:r}=ka({mutationFn:({newCabinData:n,id:i})=>az(n,i),onSuccess:()=>{ut.success("Cabin successfully edited"),t.invalidateQueries({queryKey:["cabins"]})},onError:n=>ut.error(n.message)});return{isEditing:r,editCabin:e}}function Q9({cabinToEdit:t={},onCloseModal:e}){var y,b,w,_,O;const{isCreating:r,createCabin:n}=X9(),{isEditing:i,editCabin:a}=Ike(),s=r||i,{id:o,...u}=t,l=!!o,{register:c,handleSubmit:h,reset:d,getValues:f,formState:p}=hC({defaultValues:l?u:{}}),{errors:m}=p;function g(P){const x=typeof P.image=="string"?P.image:P.image[0];l?a({newCabinData:{...P,image:x},id:o},{onSuccess:j=>{d(),e==null||e()}}):n({...P,image:x},{onSuccess:j=>{d(),e==null||e()}})}function v(P){}return Q(Eu,{onSubmit:h(g,v),type:e?"modal":"regular",children:[A(Bt,{label:"Cabin name",error:(y=m==null?void 0:m.name)==null?void 0:y.message,children:A(jr,{type:"text",id:"name",disabled:s,...c("name",{required:"This field is required"})})}),A(Bt,{label:"Maximum capacity",error:(b=m==null?void 0:m.maxCapacity)==null?void 0:b.message,children:A(jr,{type:"number",id:"maxCapacity",disabled:s,...c("maxCapacity",{required:"This field is required",min:{value:1,message:"Capacity should be at least 1"}})})}),A(Bt,{label:"Regular price",error:(w=m==null?void 0:m.regularPrice)==null?void 0:w.message,children:A(jr,{type:"number",id:"regularPrice",disabled:s,...c("regularPrice",{required:"This field is required",min:{value:1,message:"Capacity should be at least 1"}})})}),A(Bt,{label:"Discount",error:(_=m==null?void 0:m.discount)==null?void 0:_.message,children:A(jr,{type:"number",id:"discount",disabled:s,defaultValue:0,...c("discount",{required:"This field is required",validate:P=>P<=f().regularPrice||"Discount should be less than regular price"})})}),A(Bt,{label:"Description for website",error:(O=m==null?void 0:m.description)==null?void 0:O.message,children:A(Ake,{type:"number",id:"description",defaultValue:"",disabled:s,...c("description",{required:"This field is required"})})}),A(Bt,{label:"Cabin photo",children:A(Z9,{id:"image",accept:"image/*",...c("image",{required:l?!1:"This field is required"})})}),Q(Bt,{children:[A(qt,{variation:"secondary",type:"reset",onClick:()=>e==null?void 0:e(),children:"Cancel"}),A(qt,{disabled:s,children:l?"Edit cabin":"Create new cabin"})]})]})}function $ke(){const t=vi(),{isLoading:e,mutate:r}=ka({mutationFn:Lre,onSuccess:()=>{ut.success("Cabin successfully deleted"),t.invalidateQueries({queryKey:["cabins"]})},onError:n=>ut.error(n.message)});return{isDeleting:e,deleteCabin:r}}const jke=ue.img`
  display: block;
  width: 6.4rem;
  aspect-ratio: 3 / 2;
  object-fit: cover;
  object-position: center;
  transform: scale(1.5) translateX(-7px);
`,Rke=ue.div`
  font-size: 1.6rem;
  font-weight: 600;
  color: var(--color-grey-600);
  font-family: "Sono";
`,Nke=ue.div`
  font-family: "Sono";
  font-weight: 600;
`,Mke=ue.div`
  font-family: "Sono";
  font-weight: 500;
  color: var(--color-green-700);
`;function Dke({cabin:t}){const{isDeleting:e,deleteCabin:r}=$ke(),{isCreating:n,createCabin:i}=X9(),{id:a,name:s,maxCapacity:o,regularPrice:u,discount:l,image:c,description:h}=t;function d(){i({name:`Copy of ${s}`,maxCapacity:o,regularPrice:u,discount:l,image:c,description:h})}return Q(ci.Row,{children:[A(jke,{src:c}),A(Rke,{children:s}),Q("div",{children:["Fits up to ",o," guests"]}),A(Nke,{children:$i(u)}),l?A(Mke,{children:$i(l)}):A("span",{children:"—"}),A("div",{children:A(un,{children:Q(pr.Menu,{children:[A(pr.Toggle,{id:a}),Q(pr.List,{id:a,children:[A(pr.Button,{icon:A(yre,{}),onClick:d,disabled:n,children:"Duplicate"}),A(un.Open,{opens:"edit",children:A(pr.Button,{icon:A(gre,{}),children:"Edit"})}),A(un.Open,{opens:"delete",children:A(pr.Button,{icon:A(rz,{}),children:"Delete"})})]}),A(un.Window,{name:"edit",children:A(Q9,{cabinToEdit:t})}),A(un.Window,{name:"delete",children:A(aC,{resourceName:"cabins",disabled:e,onConfirm:()=>r(a)})})]})})})]})}function Lke(){const{isLoading:t,cabins:e}=ZT(),[r]=ql();if(t)return A(ms,{});if(!e.length)return A(sC,{resourceName:"cabins"});const n=r.get("discount")||"all";let i;n==="all"&&(i=e),n==="no-discount"&&(i=e.filter(c=>c.discount===0)),n==="with-discount"&&(i=e.filter(c=>c.discount>0));const a=r.get("sortBy")||"startDate-asc",[s,o]=a.split("-"),u=o==="asc"?1:-1,l=i.sort((c,h)=>(c[s]-h[s])*u);return A(pr,{children:Q(ci,{columns:"0.6fr 1.8fr 2.2fr 1fr 1fr 1fr",children:[Q(ci.Header,{children:[A("div",{}),A("div",{children:"Cabin"}),A("div",{children:"Capacity"}),A("div",{children:"Price"}),A("div",{children:"Discount"}),A("div",{})]}),A(ci.Body,{data:l,render:c=>A(Dke,{cabin:c},c.id)})]})})}function Fke(){return A("div",{children:Q(un,{children:[A(un.Open,{opens:"cabin-form",children:A(qt,{children:"Add new cabin"})}),A(un.Window,{name:"cabin-form",children:A(Q9,{})})]})})}function Uke(){return Q(B9,{children:[A(rC,{filterField:"discount",options:[{value:"all",label:"All"},{value:"no-discount",label:"No discount"},{value:"with-discount",label:"With discount"}]}),A(z9,{options:[{value:"name-asc",label:"Sort by name (A-Z)"},{value:"name-desc",label:"Sort by name (Z-A)"},{value:"regularPrice-asc",label:"Sort by price (low first)"},{value:"regularPrice-desc",label:"Sort by price (high first)"},{value:"maxCapacity-asc",label:"Sort by capacity (low first)"},{value:"maxCapacity-desc",label:"Sort by capacity (high first)"}]})]})}function zke(){return Q(fs,{children:[Q(Sa,{type:"horizontal",children:[A(Jr,{as:"h1",children:"All cabins"}),A(Uke,{})]}),Q(Sa,{children:[A(Lke,{}),A(Fke,{})]})]})}async function Bke({fullName:t,email:e,password:r}){const{data:n,error:i}=await Vt.auth.signUp({email:e,password:r,options:{data:{fullName:t,avatar:""}}});if(i)throw new Error(i.message);return n}async function qke({email:t,password:e}){const{data:r,error:n}=await Vt.auth.signInWithPassword({email:t,password:e});if(n)throw new Error(n.message);return r}async function Kke(){const{data:t}=await Vt.auth.getSession();if(!t.session)return null;const{data:e,error:r}=await Vt.auth.getUser();if(r)throw new Error(r.message);return e==null?void 0:e.user}async function Vke(){const{error:t}=await Vt.auth.signOut();if(t)throw new Error(t.message)}async function Hke({password:t,fullName:e,avatar:r}){let n;t&&(n={password:t}),e&&(n={data:{fullName:e}});const{data:i,error:a}=await Vt.auth.updateUser(n);if(a)throw new Error(a.message);if(!r)return i;const s=`avatar-${i.user.id}-${Math.random()}`,{error:o}=await Vt.storage.from("avatars").upload(s,r);if(o)throw new Error(o.message);const{data:u,error:l}=await Vt.auth.updateUser({data:{avatar:`${hb}/storage/v1/object/public/avatars/${s}`}});if(l)throw new Error(l.message);return u}function Wke(){const{mutate:t,isLoading:e}=ka({mutationFn:Bke,onSuccess:r=>{ut.success("Account successfully created! Please verufy the new account from the user's email address.")}});return{signup:t,isLoading:e}}function Gke(){var l,c,h,d;const{signup:t,isLoading:e}=Wke(),{register:r,formState:n,getValues:i,handleSubmit:a,reset:s}=hC(),{errors:o}=n;function u({fullName:f,email:p,password:m}){t({fullName:f,email:p,password:m},{onSettled:()=>s()})}return Q(Eu,{onSubmit:a(u),children:[A(Bt,{label:"Full name",error:(l=o==null?void 0:o.fullName)==null?void 0:l.message,children:A(jr,{type:"text",id:"fullName",disabled:e,...r("fullName",{required:"This field is required"})})}),A(Bt,{label:"Email address",error:(c=o==null?void 0:o.email)==null?void 0:c.message,children:A(jr,{type:"email",id:"email",disabled:e,...r("email",{required:"This field is required",pattern:{value:/\S+@\S+\.\S+/,message:"Please provide a valid email address"}})})}),A(Bt,{label:"Password (min 8 characters)",error:(h=o==null?void 0:o.password)==null?void 0:h.message,children:A(jr,{type:"password",id:"password",disabled:e,...r("password",{required:"This field is required",minLength:{value:8,message:"Password needs a minimum of 8 characters"}})})}),A(Bt,{label:"Repeat password",error:(d=o==null?void 0:o.passwordConfirm)==null?void 0:d.message,children:A(jr,{type:"password",id:"passwordConfirm",disabled:e,...r("passwordConfirm",{required:"This field is required",validate:f=>f===i().password||"Passwords need to match"})})}),Q(Bt,{children:[A(qt,{variation:"secondary",type:"reset",disabled:e,onClick:s,children:"Cancel"}),A(qt,{disabled:e,children:"Create new user"})]})]})}function Yke(){return Q(fs,{children:[A(Jr,{as:"h1",children:"Create a new user"}),A(Gke,{})]})}async function Jke(){const{data:t,error:e}=await Vt.from("settings").select("*").single();if(e)throw console.error(e),new Error("Settings could not be loaded");return t}async function Zke(t){const{data:e,error:r}=await Vt.from("settings").update(t).eq("id",1).single();if(r)throw console.error(r),new Error("Settings could not be updated");return e}function e6(){const{isLoading:t,error:e,data:r}=lo({queryKey:["settings"],queryFn:Jke});return{isLoading:t,error:e,settings:r}}function Xke(){const t=vi(),{mutate:e,isLoading:r}=ka({mutationFn:Zke,onSuccess:()=>{ut.success("Setting successfully edited"),t.invalidateQueries({queryKey:["settings"]})},onError:n=>ut.error(n.message)});return{isUpdating:r,updateSetting:e}}function Qke(){const{isLoading:t,settings:{minBookingLength:e,maxBookingLength:r,maxGuestsPerBooking:n,breakfastPrice:i}={}}=e6(),{isUpdating:a,updateSetting:s}=Xke();if(t)return A(ms,{});function o(u,l){const{value:c}=u.target;c&&s({[l]:c})}return Q(Eu,{children:[A(Bt,{label:"Minimum nights/booking",children:A(jr,{type:"number",id:"min-nights",defaultValue:e,disabled:a,onBlur:u=>o(u,"minBookingLength")})}),A(Bt,{label:"Maximum nights/booking",children:A(jr,{type:"number",id:"max-nights",defaultValue:r,disabled:a,onBlur:u=>o(u,"maxBookingLength")})}),A(Bt,{label:"Maximum guests/booking",children:A(jr,{type:"number",id:"max-guests",defaultValue:n,disabled:a,onBlur:u=>o(u,"maxGuestsPerBooking")})}),A(Bt,{label:"Breakfast price",children:A(jr,{type:"number",id:"breakfast-price",defaultValue:i,disabled:a,onBlur:u=>o(u,"breakfastPrice")})})]})}function eCe(){return Q(Sa,{children:[A(Jr,{as:"h1",children:"Update hotel settings"}),A(Qke,{})]})}function t6(){const t=vi(),{mutate:e,isLoading:r}=ka({mutationFn:Hke,onSuccess:({user:n})=>{ut.success("User account successfully updated"),t.setQueryData(["user"],n)},onError:n=>ut.error(n.message)});return{updateUser:e,isUpdating:r}}function tCe(){var l,c;const{register:t,handleSubmit:e,formState:r,getValues:n,reset:i}=hC(),{errors:a}=r,{updateUser:s,isUpdating:o}=t6();function u({password:h}){s({password:h},{onSuccess:i})}return Q(Eu,{onSubmit:e(u),children:[A(Bt,{label:"New password (min 8 chars)",error:(l=a==null?void 0:a.password)==null?void 0:l.message,children:A(jr,{type:"password",id:"password",autoComplete:"current-password",disabled:o,...t("password",{required:"This field is required",minLength:{value:8,message:"Password needs a minimum of 8 characters"}})})}),A(Bt,{label:"Confirm password",error:(c=a==null?void 0:a.passwordConfirm)==null?void 0:c.message,children:A(jr,{type:"password",autoComplete:"new-password",id:"passwordConfirm",disabled:o,...t("passwordConfirm",{required:"This field is required",validate:h=>n().password===h||"Passwords need to match"})})}),Q(Bt,{children:[A(qt,{onClick:i,type:"reset",variation:"secondary",children:"Cancel"}),A(qt,{disabled:o,children:"Update password"})]})]})}function dC(){const{isLoading:t,data:e}=lo({queryKey:["user"],queryFn:Kke});return{isLoading:t,user:e,isAuthenticated:(e==null?void 0:e.role)==="authenticated"}}function rCe(){const{user:{email:t,user_metadata:{fullName:e}}}=dC(),{updateUser:r,isUpdating:n}=t6(),[i,a]=I.useState(e),[s,o]=I.useState(null);function u(c){c.preventDefault(),i&&r({fullName:i,avatar:s},{onSuccess:()=>{o(null),c.target.reset()}})}function l(){a(e),o(null)}return Q(Eu,{onSubmit:u,children:[A(Bt,{label:"Email address",children:A(jr,{value:t,disabled:!0})}),A(Bt,{label:"Full name",children:A(jr,{type:"text",value:i,onChange:c=>a(c.target.value),id:"fullName",disabled:n})}),A(Bt,{label:"Avatar image",children:A(Z9,{id:"avatar",accept:"image/*",onChange:c=>o(c.target.files[0]),disabled:n})}),Q(Bt,{children:[A(qt,{type:"reset",variation:"secondary",disabled:n,onClick:l,children:"Cancel"}),A(qt,{disabled:n,children:"Update account"})]})]})}function nCe(){return Q(fs,{children:[A(Jr,{as:"h1",children:"Update your account"}),Q(Sa,{children:[A(Jr,{as:"h3",children:"Update user data"}),A(rCe,{})]}),Q(Sa,{children:[A(Jr,{as:"h3",children:"Update password"}),A(tCe,{})]})]})}const iCe=ue.div`
  display: flex;
  flex-direction: column;
  gap: 0.8rem;
  padding: 1.2rem 0;
`,aCe=ue.label`
  font-weight: 500;
`,sCe=ue.span`
  font-size: 1.4rem;
  color: var(--color-red-700);
`;function iO({label:t,error:e,children:r}){return Q(iCe,{children:[t&&A(aCe,{htmlFor:r.props.id,children:t}),r,e&&A(sCe,{children:e})]})}function oCe(){const t=vi(),e=Ta(),{mutate:r,isLoading:n}=ka({mutationFn:({email:i,password:a})=>qke({email:i,password:a}),onSuccess:i=>{t.setQueryData(["user"],i.user),e("/dashboard",{replace:!0})},onError:i=>{console.log("ERROR",i),ut.error("Provided email or password are incorrect")}});return{login:r,isLoading:n}}function uCe(t){return wt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"}}]})(t)}const lCe=vU`
  to {
    transform: rotate(1turn)
  }
`,r6=ue(uCe)`
  width: 2.4rem;
  height: 2.4rem;
  animation: ${lCe} 1.5s infinite linear;
`;function cCe(){const[t,e]=I.useState(""),[r,n]=I.useState(""),{login:i,isLoading:a}=oCe();function s(o){o.preventDefault(),!(!t||!r)&&i({email:t,password:r},{onSettled:()=>{e(""),n("")}})}return Q(Eu,{onSubmit:s,children:[A(iO,{label:"Email address",children:A(jr,{type:"email",id:"email",autoComplete:"username",value:t,onChange:o=>e(o.target.value),disabled:a})}),A(iO,{label:"Password",children:A(jr,{type:"password",id:"password",autoComplete:"current-password",value:r,onChange:o=>n(o.target.value),disabled:a})}),A(iO,{children:A(qt,{size:"large",disabled:a,children:a?A(r6,{}):"Log in"})})]})}const hCe=ue.div`
  text-align: center;
`,dCe=ue.img`
  height: 9.6rem;
  width: auto;
`;function n6(){const{isDarkMode:t}=L_();return A(hCe,{children:A(dCe,{src:t?"/logo-dark.png":"/logo-light.png",alt:"Logo"})})}const fCe=ue.main`
  min-height: 100vh;
  display: grid;
  grid-template-columns: 48rem;
  align-content: center;
  justify-content: center;
  gap: 3.2rem;
  background-color: var(--color-grey-50);
`;function pCe(){return Q(fCe,{children:[A(n6,{}),A(Jr,{as:"h4",children:"Log in to your account"}),A(cCe,{})]})}function fC(){const t=Ta();return()=>t(-1)}const mCe=ue.main`
  height: 100vh;
  background-color: var(--color-grey-50);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4.8rem;
`,gCe=ue.div`
  /* box */
  background-color: var(--color-grey-0);
  border: 1px solid var(--color-grey-100);
  border-radius: var(--border-radius-md);

  padding: 4.8rem;
  flex: 0 1 96rem;
  text-align: center;

  & h1 {
    margin-bottom: 3.2rem;
  }
`;function yCe(){const t=fC();return A(mCe,{children:Q(gCe,{children:[A(Jr,{as:"h1",children:"The page you are looking for could not be found 😢"}),A("button",{onClick:t,size:"large",children:"← Go back"})]})})}const vCe=ue.ul`
  display: flex;
  flex-direction: column;
  gap: 0.8rem;
`,hc=ue(kY)`
  &:link,
  &:visited {
    display: flex;
    align-items: center;
    gap: 1.2rem;

    color: var(--color-grey-600);
    font-size: 1.6rem;
    font-weight: 500;
    padding: 1.2rem 2.4rem;
    transition: all 0.3s;
  }

  /* This works because react-router places the active class on the active NavLink */
  &:hover,
  &:active,
  &.active:link,
  &.active:visited {
    color: var(--color-grey-800);
    background-color: var(--color-grey-50);
    border-radius: var(--border-radius-sm);
  }

  & svg {
    width: 2.4rem;
    height: 2.4rem;
    color: var(--color-grey-400);
    transition: all 0.3s;
  }

  &:hover svg,
  &:active svg,
  &.active:link svg,
  &.active:visited svg {
    color: var(--color-brand-600);
  }
`;function bCe(){return A("nav",{children:Q(vCe,{children:[A("li",{children:Q(hc,{to:"/dashboard",children:[A(Ere,{}),A("span",{children:"Home"})]})}),A("li",{children:Q(hc,{to:"/bookings",children:[A(nz,{}),A("span",{children:"Bookings"})]})}),A("li",{children:Q(hc,{to:"/cabins",children:[A(iz,{}),A("span",{children:"Cabins"})]})}),A("li",{children:Q(hc,{to:"/users",children:[A(Ire,{}),A("span",{children:"Users"})]})}),A("li",{children:Q(hc,{to:"/settings",children:[A(Sre,{}),A("span",{children:"Settings"})]})}),A("li",{children:Q(hc,{to:"/ai",children:[A(Tre,{}),A("span",{children:"Ai Assistant"})]})})]})})}const wCe=ue.aside`
  background-color: var(--color-grey-0);
  padding: 3.2rem 2.4rem;
  border-right: 1px solid var(--color-grey-100);

  grid-row: 1 / -1;
  display: flex;
  flex-direction: column;
  gap: 3.2rem;
`;function _Ce(){return Q(wCe,{children:[A(n6,{}),A(bCe,{})]})}const pC=ue.button`
  background: none;
  border: none;
  padding: 0.6rem;
  border-radius: var(--border-radius-sm);
  transition: all 0.2s;

  &:hover {
    background-color: var(--color-grey-100);
  }

  & svg {
    width: 2.2rem;
    height: 2.2rem;
    color: var(--color-brand-600);
  }
`;function xCe(){const t=Ta(),e=vi(),{mutate:r,isLoading:n}=ka({mutationFn:Vke,onSuccess:()=>{e.removeQueries(),t("/login",{replace:!0})}});return{logout:r,isLoading:n}}function OCe(){const{logout:t,isLoading:e}=xCe();return A(pC,{disabled:e,onClick:t,children:e?A(r6,{}):A(cre,{})})}function SCe(){const{isDarkMode:t,toggleDarkMode:e}=L_();return A(pC,{onClick:e,children:t?A(kre,{}):A(Are,{})})}const PCe=ue.ul`
  display: flex;
  gap: 0.4rem;
`;function ECe(){const t=Ta();return Q(PCe,{children:[A("li",{children:A(pC,{onClick:()=>t("/account"),children:A(Cre,{})})}),A("li",{children:A(SCe,{})}),A("li",{children:A(OCe,{})})]})}const ACe=ue.div`
  display: flex;
  gap: 1.2rem;
  align-items: center;
  font-weight: 500;
  font-size: 1.4rem;
  color: var(--color-grey-600);
`,TCe=ue.img`
  display: block;
  width: 4rem;
  width: 3.6rem;
  aspect-ratio: 1;
  object-fit: cover;
  object-position: center;
  border-radius: 50%;
  outline: 2px solid var(--color-grey-100);
`;function kCe(){const{user:t}=dC(),{fullName:e,avatar:r}=t.user_metadata;return Q(ACe,{children:[A(TCe,{src:r||"default-user.jpg",alt:`Avatar of ${e}`}),A("span",{children:e})]})}const CCe=ue.header`
  background-color: var(--color-grey-0);
  padding: 1.2rem 4.8rem;
  border-bottom: 1px solid var(--color-grey-100);

  display: flex;
  gap: 2.4rem;
  align-items: center;
  justify-content: flex-end;
`;function ICe(){return Q(CCe,{children:[A(kCe,{}),A(ECe,{})]})}const $Ce=ue.div`
  display: grid;
  grid-template-columns: 26rem 1fr;
  grid-template-rows: auto 1fr;
  height: 100vh;
`,jCe=ue.main`
  background-color: var(--color-grey-50);
  padding: 4rem 4.8rem 6.4rem;
  overflow: scroll;
`,RCe=ue.div`
  max-width: 120rem;
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  gap: 3.2rem;
`;function NCe(){return Q($Ce,{children:[A(ICe,{}),A(_Ce,{}),A(jCe,{children:A(RCe,{children:A(vY,{})})})]})}const MCe=ue.div`
  display: flex;
  align-items: center;
  gap: 1.6rem;
  padding: 0.8rem 0;
`,DCe=ue.span`
  display: flex;
  align-items: center;
  gap: 0.8rem;
  font-weight: 500;

  & svg {
    width: 2rem;
    height: 2rem;
    color: var(--color-brand-600);
  }
`;function aO({icon:t,label:e,children:r}){return Q(MCe,{children:[Q(DCe,{children:[t,A("span",{children:e})]}),r]})}const LCe=ue.section`
  /* Box */
  background-color: var(--color-grey-0);
  border: 1px solid var(--color-grey-100);
  border-radius: var(--border-radius-md);

  overflow: hidden;
`,FCe=ue.header`
  background-color: var(--color-brand-500);
  padding: 2rem 4rem;
  color: #e0e7ff;
  font-size: 1.8rem;
  font-weight: 500;
  display: flex;
  align-items: center;
  justify-content: space-between;

  svg {
    height: 3.2rem;
    width: 3.2rem;
  }

  & div:first-child {
    display: flex;
    align-items: center;
    gap: 1.6rem;
    font-weight: 600;
    font-size: 1.8rem;
  }

  & span {
    font-family: "Sono";
    font-size: 2rem;
    margin-left: 4px;
  }
`,UCe=ue.section`
  padding: 3.2rem 4rem 1.2rem;
`,zCe=ue.div`
  display: flex;
  align-items: center;
  gap: 1.2rem;
  margin-bottom: 1.6rem;
  color: var(--color-grey-500);

  & p:first-of-type {
    font-weight: 500;
    color: var(--color-grey-700);
  }
`,BCe=ue.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1.6rem 3.2rem;
  border-radius: var(--border-radius-sm);
  margin-top: 2.4rem;

  background-color: ${t=>t.isPaid?"var(--color-green-100)":"var(--color-yellow-100)"};
  color: ${t=>t.isPaid?"var(--color-green-700)":"var(--color-yellow-700)"};

  & p:last-child {
    text-transform: uppercase;
    font-size: 1.4rem;
    font-weight: 600;
  }

  svg {
    height: 2.4rem;
    width: 2.4rem;
    color: currentColor !important;
  }
`,qCe=ue.footer`
  padding: 1.6rem 4rem;
  font-size: 1.2rem;
  color: var(--color-grey-500);
  text-align: right;
`;function i6({booking:t}){const{created_at:e,startDate:r,endDate:n,numNights:i,numGuests:a,cabinPrice:s,extrasPrice:o,totalPrice:u,hasBreakfast:l,observations:c,isPaid:h,guests:{fullName:d,email:f,country:p,countryFlag:m,nationalID:g},cabins:{name:v}}=t;return Q(LCe,{children:[Q(FCe,{children:[Q("div",{children:[A(iz,{}),Q("p",{children:[i," nights in Cabin ",A("span",{children:v})]})]}),Q("p",{children:[au(new Date(r),"EEE, MMM dd yyyy")," (",AU(new Date(r))?"Today":kU(r),") — ",au(new Date(n),"EEE, MMM dd yyyy")]})]}),Q(UCe,{children:[Q(zCe,{children:[m&&A(D9,{src:m,alt:`Flag of ${p}`}),Q("p",{children:[d," ",a>1?`+ ${a-1} guests`:""]}),A("span",{children:"•"}),A("p",{children:f}),A("span",{children:"•"}),Q("p",{children:["National ID ",g]})]}),c&&A(aO,{icon:A(xre,{}),label:"Observations",children:c}),A(aO,{icon:A(Ore,{}),label:"Breakfast included?",children:l?"Yes":"No"}),Q(BCe,{isPaid:h,children:[Q(aO,{icon:A(Pre,{}),label:"Total price",children:[$i(u),l&&` (${$i(s)} cabin + ${$i(o)} breakfast)`]}),A("p",{children:h?"Paid":"Will pay at property"})]})]}),A(qCe,{children:Q("p",{children:["Booked ",au(new Date(e),"EEE, MMM dd yyyy, p")]})})]})}const a6=ue.div`
  display: flex;
  gap: 1.2rem;
  justify-content: flex-end;
`,s6=ue.button`
  color: var(--color-brand-600);
  font-weight: 500;
  text-align: center;
  transition: all 0.3s;
  background: none;
  border: none;
  border-radius: var(--border-radius-sm);

  &:hover,
  &:active {
    color: var(--color-brand-700);
  }
`;function o6(){const{bookingId:t}=iY(),{isLoading:e,data:r,error:n}=lo({queryKey:["booking",t],queryFn:()=>Qte(t),retry:!1});return{isLoading:e,error:n,booking:r}}const KCe=ue.div`
  display: flex;
  gap: 2.4rem;
  align-items: center;
`;function VCe(){const{booking:t,isLoading:e}=o6(),{checkout:r,isCheckingOut:n}=tC(),{deleteBooking:i,isDeleting:a}=U9(),s=fC(),o=Ta();if(e)return A(ms,{});if(!t)return A(sC,{resourceName:"booking"});const{status:u,id:l}=t;return Q(fs,{children:[Q(Sa,{type:"horizontal",children:[Q(KCe,{children:[Q(Jr,{as:"h1",children:["Booking #",l]}),A(sw,{type:{unconfirmed:"blue","checked-in":"green","checked-out":"silver"}[u],children:u.replace("-"," ")})]}),A(s6,{onClick:s,children:"← Back"})]}),A(i6,{booking:t}),Q(a6,{children:[u==="unconfirmed"&&A(qt,{onClick:()=>o(`/checkin/${l}`),children:"Check in"}),u==="checked-in"&&A(qt,{icon:A(tz,{}),onClick:()=>r(l),disabled:n,children:"Check out"}),Q(un,{children:[A(un.Open,{opens:"delete",children:A(qt,{variation:"danger",children:"Delete booking"})}),A(un.Window,{name:"delete",children:A(aC,{resourceName:"booking",disabled:a,onConfirm:()=>i(l,{onSettled:()=>o(-1)})})})]}),A(qt,{variation:"secondary",onClick:s,children:"Back"})]})]})}function HCe(){return A(VCe,{})}const WCe=ue.div`
  display: flex;
  gap: 1.6rem;

  & input[type="checkbox"] {
    height: 2.4rem;
    width: 2.4rem;
    outline-offset: 2px;
    transform-origin: 0;
    accent-color: var(--color-brand-600);
  }

  & input[type="checkbox"]:disabled {
    accent-color: var(--color-brand-600);
  }

  & label {
    flex: 1;

    display: flex;
    align-items: center;
    gap: 0.8rem;
  }
`;function YD({checked:t,onChange:e,disabled:r=!1,id:n,children:i}){return Q(WCe,{children:[A("input",{type:"checkbox",id:n,checked:t,onChange:e,disabled:r}),A("label",{htmlFor:r?"":n,children:i})]})}function GCe(){const t=vi(),e=Ta(),{mutate:r,isLoading:n}=ka({mutationFn:({bookingId:i,breakfast:a})=>XU(i,{status:"checked-in",isPaid:!0,...a}),onSuccess:i=>{ut.success(`Booking #${i.id} successfully checked in`),t.invalidateQueries({active:!0}),e("/")},onError:()=>ut.error("There was an error while checking in")});return{checkin:r,isCheckingIn:n}}const JD=ue.div`
  /* Box */
  background-color: var(--color-grey-0);
  border: 1px solid var(--color-grey-100);
  border-radius: var(--border-radius-md);
  padding: 2.4rem 4rem;
`;function YCe(){const[t,e]=I.useState(!1),[r,n]=I.useState(!1),{booking:i,isLoading:a}=o6(),{settings:s,isLoading:o}=e6();I.useEffect(()=>e((i==null?void 0:i.isPaid)??!1),[i]);const u=fC(),{checkin:l,isCheckingIn:c}=GCe();if(a||o)return A(ms,{});const{id:h,guests:d,totalPrice:f,numGuests:p,hasBreakfast:m,numNights:g}=i,v=s.breakfastPrice*g*p;function y(){t&&l(r?{bookingId:h,breakfast:{hasBreakfast:!0,extrasPrice:v,totalPrice:f+v}}:{bookingId:h,breakfast:{}})}return Q(fs,{children:[Q(Sa,{type:"horizontal",children:[Q(Jr,{as:"h1",children:["Check in booking #",h]}),A(s6,{onClick:u,children:"← Back"})]}),A(i6,{booking:i}),!m&&A(JD,{children:Q(YD,{checked:r,onChange:()=>{n(b=>!b),e(!1)},id:"breakfast",children:["Want to add breakfast for ",$i(v),"?"]})}),A(JD,{children:Q(YD,{checked:t,onChange:()=>e(b=>!b),disabled:t||c,id:"confirm",children:["I confirm that ",d.fullName," has paid the total amount of"," ",r?`${$i(f+v)} (${$i(f)} + ${$i(v)})`:$i(f)]})}),Q(a6,{children:[Q(qt,{onClick:y,disabled:!t||c,children:["Check in booking #",h]}),A(qt,{variation:"secondary",onClick:u,children:"Back"})]})]})}function JCe(){return A(YCe,{})}const ZCe=ue.div`
  height: 100vh;
  background-color: var(--color-grey-50);
  display: flex;
  align-items: center;
  justify-content: center;
`;function XCe({children:t}){const e=Ta(),{isLoading:r,isAuthenticated:n}=dC();if(I.useEffect(function(){!n&&!r&&e("/login")},[n,r,e]),r)return A(ZCe,{children:A(ms,{})});if(n)return t}const QCe=ue.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 0.8rem;
  padding: 1.2rem 0;
`;function eIe({children:t}){return A(QCe,{children:t})}const tIe=ue.input`
  border: 1px solid var(--color-grey-300);
  background-color: var(--color-grey-0);
  border-radius: var(--border-radius-sm);
  padding: 0.8rem 1.2rem;
  box-shadow: var(--shadow-sm);
  width: 900px;
`;function rIe({setChatInput:t}){const[e,r]=I.useState("");return A(Eu,{onSubmit:i=>{i.preventDefault(),e.trim()&&(t(e),r(""))},children:Q(eIe,{children:[A(tIe,{type:"text",value:e,onChange:i=>r(i.target.value),placeholder:"Type your message here..."}),A(qt,{type:"submit ",children:A(mre,{})})]})})}function LE(t,e=Wh){t=t.trim();const r=/```(json)?(.*)```/s.exec(t);return e(r?r[2]:t)}function Wh(t){if(typeof t>"u")return null;try{return JSON.parse(t)}catch{}let e="";const r=[];let n=!1,i=!1;for(let a of t){if(n)a==='"'&&!i?n=!1:a===`
`&&!i?a="\\n":a==="\\"?i=!i:i=!1;else if(a==='"')n=!0,i=!1;else if(a==="{")r.push("}");else if(a==="[")r.push("]");else if(a==="}"||a==="]")if(r&&r[r.length-1]===a)r.pop();else return null;e+=a}n&&(e+='"');for(let a=r.length-1;a>=0;a-=1)e+=r[a];try{return JSON.parse(e)}catch{return null}}var nIe=function(t,e){if(typeof t!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,t.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()};const iIe=Ze(nIe);var mC={exports:{}};const aIe=/[\p{Lu}]/u,sIe=/[\p{Ll}]/u,ZD=/^[\p{Lu}](?![\p{Lu}])/gu,u6=/([\p{Alpha}\p{N}_]|$)/u,l6=/[_.\- ]+/,oIe=new RegExp("^"+l6.source),XD=new RegExp(l6.source+u6.source,"gu"),QD=new RegExp("\\d+"+u6.source,"gu"),uIe=(t,e,r)=>{let n=!1,i=!1,a=!1;for(let s=0;s<t.length;s++){const o=t[s];n&&aIe.test(o)?(t=t.slice(0,s)+"-"+t.slice(s),n=!1,a=i,i=!0,s++):i&&a&&sIe.test(o)?(t=t.slice(0,s-1)+"-"+t.slice(s-1),a=i,i=!1,n=!0):(n=e(o)===o&&r(o)!==o,a=i,i=r(o)===o&&e(o)!==o)}return t},lIe=(t,e)=>(ZD.lastIndex=0,t.replace(ZD,r=>e(r))),cIe=(t,e)=>(XD.lastIndex=0,QD.lastIndex=0,t.replace(XD,(r,n)=>e(n)).replace(QD,r=>e(r))),c6=(t,e)=>{if(!(typeof t=="string"||Array.isArray(t)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(t)?t=t.map(a=>a.trim()).filter(a=>a.length).join("-"):t=t.trim(),t.length===0)return"";const r=e.locale===!1?a=>a.toLowerCase():a=>a.toLocaleLowerCase(e.locale),n=e.locale===!1?a=>a.toUpperCase():a=>a.toLocaleUpperCase(e.locale);return t.length===1?e.pascalCase?n(t):r(t):(t!==r(t)&&(t=uIe(t,r,n)),t=t.replace(oIe,""),e.preserveConsecutiveUppercase?t=lIe(t,r):t=r(t),e.pascalCase&&(t=n(t.charAt(0))+t.slice(1)),cIe(t,n))};mC.exports=c6;mC.exports.default=c6;var hIe=mC.exports;const dIe=Ze(hIe);function fIe(t,e){return(e==null?void 0:e[t])||iIe(t)}function pIe(t,e){return(e==null?void 0:e[t])||dIe(t)}function h6(t,e,r){const n={};for(const i in t)Object.hasOwn(t,i)&&(n[e(i,r)]=t[i]);return n}function eL(t){return Array.isArray(t)?[...t]:{...t}}function mIe(t,e){const r=eL(t);for(const[n,i]of Object.entries(e)){const[a,...s]=n.split(".").reverse();let o=r;for(const u of s.reverse()){if(o[u]===void 0)break;o[u]=eL(o[u]),o=o[u]}o[a]!==void 0&&(o[a]={lc:1,type:"secret",id:[i]})}return r}function U_(t){const e=Object.getPrototypeOf(t);return typeof t.lc_name=="function"&&(typeof e.lc_name!="function"||t.lc_name()!==e.lc_name())?t.lc_name():t.name}class Or{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,U_(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e,...r){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_kwargs=e||{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof Or||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},r={},n=Object.keys(this.lc_kwargs).reduce((i,a)=>(i[a]=a in this?this[a]:this.lc_kwargs[a],i),{});for(let i=Object.getPrototypeOf(this);i;i=Object.getPrototypeOf(i))Object.assign(e,Reflect.get(i,"lc_aliases",this)),Object.assign(r,Reflect.get(i,"lc_secrets",this)),Object.assign(n,Reflect.get(i,"lc_attributes",this));return Object.keys(r).forEach(i=>{let a=this,s=n;const[o,...u]=i.split(".").reverse();for(const l of u.reverse()){if(!(l in a)||a[l]===void 0)return;(!(l in s)||s[l]===void 0)&&(typeof a[l]=="object"&&a[l]!=null?s[l]={}:Array.isArray(a[l])&&(s[l]=[])),a=a[l],s=s[l]}o in a&&a[o]!==void 0&&(s[o]=s[o]||a[o])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:h6(Object.keys(r).length?mIe(n,r):n,fIe,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}const gIe=Object.freeze(Object.defineProperty({__proto__:null,Serializable:Or,get_lc_unique_name:U_},Symbol.toStringTag,{value:"Module"}));function Yl(t,e){return typeof t=="string"?typeof e=="string"?t+e:[{type:"text",text:t},...e]:Array.isArray(e)?Eg(t,e)??[...t,...e]:[...t,{type:"text",text:e}]}function d6(t,e){return t==="error"||e==="error"?"error":"success"}function yIe(t,e){function r(n,i){if(typeof n!="object"||n===null||n===void 0)return n;if(i>=e)return Array.isArray(n)?"[Array]":"[Object]";if(Array.isArray(n))return n.map(s=>r(s,i+1));const a={};for(const s of Object.keys(n))a[s]=r(n[s],i+1);return a}return JSON.stringify(r(t,0),null,2)}class Wn extends Or{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:""}constructor(e,r){typeof e=="string"&&(e={content:e,additional_kwargs:r,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const r=yIe(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${r}`}}function vIe(t){return Array.isArray(t)&&t.every(e=>typeof e.index=="number")}function fn(t,e){const r={...t};for(const[n,i]of Object.entries(e))if(r[n]==null)r[n]=i;else{if(i==null)continue;if(typeof r[n]!=typeof i||Array.isArray(r[n])!==Array.isArray(i))throw new Error(`field[${n}] already exists in the message chunk, but with a different type.`);if(typeof r[n]=="string"){if(n==="type")continue;r[n]+=i}else if(typeof r[n]=="object"&&!Array.isArray(r[n]))r[n]=fn(r[n],i);else if(Array.isArray(r[n]))r[n]=Eg(r[n],i);else{if(r[n]===i)continue;console.warn(`field[${n}] already exists in this message chunk and value has unsupported type.`)}}return r}function Eg(t,e){if(!(t===void 0&&e===void 0)){if(t===void 0||e===void 0)return t||e;{const r=[...t];for(const n of e)if(typeof n=="object"&&"index"in n&&typeof n.index=="number"){const i=r.findIndex(a=>a.index===n.index);i!==-1?r[i]=fn(r[i],n):r.push(n)}else{if(typeof n=="object"&&"text"in n&&n.text==="")continue;r.push(n)}return r}}}function f6(t,e){if(!t&&!e)throw new Error("Cannot merge two undefined objects.");if(!t||!e)return t||e;if(typeof t!=typeof e)throw new Error(`Cannot merge objects of different types.
Left ${typeof t}
Right ${typeof e}`);if(typeof t=="string"&&typeof e=="string")return t+e;if(Array.isArray(t)&&Array.isArray(e))return Eg(t,e);if(typeof t=="object"&&typeof e=="object")return fn(t,e);if(t===e)return t;throw new Error(`Can not merge objects of different types.
Left ${t}
Right ${e}`)}class mo extends Wn{}function An(t){return typeof(t==null?void 0:t._getType)=="function"}function p6(t){return An(t)&&typeof t.concat=="function"}class Pa extends Wn{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,r,n){typeof e=="string"&&(e={content:e,name:n,tool_call_id:r}),super(e),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}class go extends mo{constructor(e){super(e),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}static lc_name(){return"ToolMessageChunk"}_getType(){return"tool"}concat(e){return new go({content:Yl(this.content,e.content),additional_kwargs:fn(this.additional_kwargs,e.additional_kwargs),response_metadata:fn(this.response_metadata,e.response_metadata),artifact:f6(this.artifact,e.artifact),tool_call_id:this.tool_call_id,id:this.id??e.id,status:d6(this.status,e.status)})}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function bIe(t){const e=[],r=[];for(const n of t)if(n.function){const i=n.function.name;try{const a=JSON.parse(n.function.arguments),s={name:i||"",args:a||{},id:n.id};e.push(s)}catch{r.push({name:i,args:n.function.arguments,id:n.id,error:"Malformed args."})}}else continue;return[e,r]}class pt extends Wn{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,r){var i;let n;if(typeof e=="string")n={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:r??{}};else{n=e;const a=(i=n.additional_kwargs)==null?void 0:i.tool_calls,s=n.tool_calls;a!=null&&a.length>0&&(s===void 0||s.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(a!=null&&s===void 0){const[o,u]=bIe(a);n.tool_calls=o??[],n.invalid_tool_calls=u??[]}else n.tool_calls=n.tool_calls??[],n.invalid_tool_calls=n.invalid_tool_calls??[]}catch{n.tool_calls=[],n.invalid_tool_calls=[]}}super(n),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof n!="string"&&(this.tool_calls=n.tool_calls??this.tool_calls,this.invalid_tool_calls=n.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=n.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}function gC(t){return t._getType()==="ai"}class Mr extends mo{constructor(e){let r;if(typeof e=="string")r={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)r={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[]};else{const n=[],i=[];for(const a of e.tool_call_chunks){let s={};try{if(s=Wh(a.args??"{}")??{},typeof s!="object"||Array.isArray(s))throw new Error("Malformed tool call chunk args.");n.push({name:a.name??"",args:s,id:a.id,type:"tool_call"})}catch{i.push({name:a.name,args:a.args,id:a.id,error:"Malformed args.",type:"invalid_tool_call"})}}r={...e,tool_calls:n,invalid_tool_calls:i}}super(r),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=r.tool_call_chunks??this.tool_call_chunks,this.tool_calls=r.tool_calls??this.tool_calls,this.invalid_tool_calls=r.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=r.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){const r={content:Yl(this.content,e.content),additional_kwargs:fn(this.additional_kwargs,e.additional_kwargs),response_metadata:fn(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const n=Eg(this.tool_call_chunks,e.tool_call_chunks);n!==void 0&&n.length>0&&(r.tool_call_chunks=n)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){const n=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},i=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},a={input_tokens:n.input_tokens+i.input_tokens,output_tokens:n.output_tokens+i.output_tokens,total_tokens:n.total_tokens+i.total_tokens};r.usage_metadata=a}return new Mr(r)}}class gn extends Wn{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return gn}constructor(e,r){typeof e=="string"&&(e={content:e,role:r}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}}class vs extends mo{static lc_name(){return"ChatMessageChunk"}constructor(e,r){typeof e=="string"&&(e={content:e,role:r}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new vs({content:Yl(this.content,e.content),additional_kwargs:fn(this.additional_kwargs,e.additional_kwargs),response_metadata:fn(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}class yo extends Wn{static lc_name(){return"FunctionMessage"}constructor(e,r){typeof e=="string"&&(e={content:e,name:r}),super(e)}_getType(){return"function"}}class bs extends mo{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new bs({content:Yl(this.content,e.content),additional_kwargs:fn(this.additional_kwargs,e.additional_kwargs),response_metadata:fn(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}}class Wt extends Wn{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class ws extends mo{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(e){return new ws({content:Yl(this.content,e.content),additional_kwargs:fn(this.additional_kwargs,e.additional_kwargs),response_metadata:fn(this.response_metadata,e.response_metadata),id:this.id??e.id})}}class Gn extends Wn{static lc_name(){return"SystemMessage"}_getType(){return"system"}}class _s extends mo{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(e){return new _s({content:Yl(this.content,e.content),additional_kwargs:fn(this.additional_kwargs,e.additional_kwargs),response_metadata:fn(this.response_metadata,e.response_metadata),id:this.id??e.id})}}function tL(t){const{type:e,...r}=t;if(e==="human"||e==="user")return new Wt(r);if(e==="ai"||e==="assistant")return new pt(r);if(e==="system")return new Gn(r);throw new Error("Unable to coerce message from array: only human, AI, or system message coercion is currently supported.")}function zs(t){if(typeof t=="string")return new Wt(t);if(An(t))return t;if(Array.isArray(t)){const[e,r]=t;return tL({type:e,content:r})}else return tL(t)}function Nr(t,e="Human",r="AI"){const n=[];for(const i of t){let a;if(i._getType()==="human")a=e;else if(i._getType()==="ai")a=r;else if(i._getType()==="system")a="System";else if(i._getType()==="function")a="Function";else if(i._getType()==="tool")a="Tool";else if(i._getType()==="generic")a=i.role;else throw new Error(`Got unsupported message type: ${i._getType()}`);const s=i.name?`${i.name}, `:"",o=typeof i.content=="string"?i.content:JSON.stringify(i.content,null,2);n.push(`${a}: ${s}${o}`)}return n.join(`
`)}function wIe(t){if(t.data!==void 0)return t;{const e=t;return{type:e.type,data:{content:e.text,role:e.role,name:void 0,tool_call_id:void 0}}}}function yC(t){const e=wIe(t);switch(e.type){case"human":return new Wt(e.data);case"ai":return new pt(e.data);case"system":return new Gn(e.data);case"function":if(e.data.name===void 0)throw new Error("Name must be defined for function messages");return new yo(e.data);case"tool":if(e.data.tool_call_id===void 0)throw new Error("Tool call ID must be defined for tool messages");return new Pa(e.data);case"generic":{if(e.data.role===void 0)throw new Error("Role must be defined for chat messages");return new gn(e.data)}default:throw new Error(`Got unexpected type: ${e.type}`)}}function m6(t){return t.map(yC)}function _Ie(t){return t.map(e=>e.toDict())}function hw(t){var r;const e=t._getType();if(e==="human")return new ws({...t});if(e==="ai"){let n={...t};return"tool_calls"in n&&(n={...n,tool_call_chunks:(r=n.tool_calls)==null?void 0:r.map(i=>({...i,type:"tool_call_chunk",index:void 0,args:JSON.stringify(i.args)}))}),new Mr({...n})}else{if(e==="system")return new _s({...t});if(e==="function")return new bs({...t});if(gn.isInstance(t))return new vs({...t});throw new Error("Unknown message type.")}}var Ge;(function(t){t.assertEqual=i=>i;function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{const a={};for(const s of i)a[s]=s;return a},t.getValidEnumValues=i=>{const a=t.objectKeys(i).filter(o=>typeof i[i[o]]!="number"),s={};for(const o of a)s[o]=i[o];return t.objectValues(s)},t.objectValues=i=>t.objectKeys(i).map(function(a){return i[a]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const a=[];for(const s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.push(s);return a},t.find=(i,a)=>{for(const s of i)if(a(s))return s},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function n(i,a=" | "){return i.map(s=>typeof s=="string"?`'${s}'`:s).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(i,a)=>typeof a=="bigint"?a.toString():a})(Ge||(Ge={}));var FE;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(FE||(FE={}));const ye=Ge.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),zo=t=>{switch(typeof t){case"undefined":return ye.undefined;case"string":return ye.string;case"number":return isNaN(t)?ye.nan:ye.number;case"boolean":return ye.boolean;case"function":return ye.function;case"bigint":return ye.bigint;case"symbol":return ye.symbol;case"object":return Array.isArray(t)?ye.array:t===null?ye.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ye.promise:typeof Map<"u"&&t instanceof Map?ye.map:typeof Set<"u"&&t instanceof Set?ye.set:typeof Date<"u"&&t instanceof Date?ye.date:ye.object;default:return ye.unknown}},de=Ge.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),xIe=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class fi extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(const s of a.issues)if(s.code==="invalid_union")s.unionErrors.map(i);else if(s.code==="invalid_return_type")i(s.returnTypeError);else if(s.code==="invalid_arguments")i(s.argumentsError);else if(s.path.length===0)n._errors.push(r(s));else{let o=n,u=0;for(;u<s.path.length;){const l=s.path[u];u===s.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(r(s))):o[l]=o[l]||{_errors:[]},o=o[l],u++}}};return i(this),n}static assert(e){if(!(e instanceof fi))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ge.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},n=[];for(const i of this.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}fi.create=t=>new fi(t);const Gh=(t,e)=>{let r;switch(t.code){case de.invalid_type:t.received===ye.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case de.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,Ge.jsonStringifyReplacer)}`;break;case de.unrecognized_keys:r=`Unrecognized key(s) in object: ${Ge.joinValues(t.keys,", ")}`;break;case de.invalid_union:r="Invalid input";break;case de.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Ge.joinValues(t.options)}`;break;case de.invalid_enum_value:r=`Invalid enum value. Expected ${Ge.joinValues(t.options)}, received '${t.received}'`;break;case de.invalid_arguments:r="Invalid function arguments";break;case de.invalid_return_type:r="Invalid function return type";break;case de.invalid_date:r="Invalid date";break;case de.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:Ge.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case de.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case de.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case de.custom:r="Invalid input";break;case de.invalid_intersection_types:r="Intersection results could not be merged";break;case de.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case de.not_finite:r="Number must be finite";break;default:r=e.defaultError,Ge.assertNever(t)}return{message:r}};let g6=Gh;function OIe(t){g6=t}function dw(){return g6}const fw=t=>{const{data:e,path:r,errorMaps:n,issueData:i}=t,a=[...r,...i.path||[]],s={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let o="";const u=n.filter(l=>!!l).slice().reverse();for(const l of u)o=l(s,{data:e,defaultError:o}).message;return{...i,path:a,message:o}},SIe=[];function ge(t,e){const r=dw(),n=fw({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===Gh?void 0:Gh].filter(i=>!!i)});t.common.issues.push(n)}class pn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const n=[];for(const i of r){if(i.status==="aborted")return Re;i.status==="dirty"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){const n=[];for(const i of r){const a=await i.key,s=await i.value;n.push({key:a,value:s})}return pn.mergeObjectSync(e,n)}static mergeObjectSync(e,r){const n={};for(const i of r){const{key:a,value:s}=i;if(a.status==="aborted"||s.status==="aborted")return Re;a.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof s.value<"u"||i.alwaysSet)&&(n[a.value]=s.value)}return{status:e.value,value:n}}}const Re=Object.freeze({status:"aborted"}),Kc=t=>({status:"dirty",value:t}),kn=t=>({status:"valid",value:t}),UE=t=>t.status==="aborted",zE=t=>t.status==="dirty",Sm=t=>t.status==="valid",Pm=t=>typeof Promise<"u"&&t instanceof Promise;function pw(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)}function y6(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r}var Te;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Te||(Te={}));var Lf,Ff;class cs{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const rL=(t,e)=>{if(Sm(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new fi(t.common.issues);return this._error=r,this._error}}};function Le(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(s,o)=>{var u,l;const{message:c}=t;return s.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(u=c??n)!==null&&u!==void 0?u:o.defaultError}:s.code!=="invalid_type"?{message:o.defaultError}:{message:(l=c??r)!==null&&l!==void 0?l:o.defaultError}},description:i}}class Be{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return zo(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:zo(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new pn,ctx:{common:e.parent.common,data:e.data,parsedType:zo(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(Pm(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){var n;const i={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:zo(e)},a=this._parseSync({data:e,path:i.path,parent:i});return rL(i,a)}async parseAsync(e,r){const n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:zo(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(Pm(i)?i:Promise.resolve(i));return rL(n,a)}refine(e,r){const n=i=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(i):r;return this._refinement((i,a)=>{const s=e(i),o=()=>a.addIssue({code:de.custom,...n(i)});return typeof Promise<"u"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r=="function"?r(n,i):r),!1))}_refinement(e){return new Ea({schema:this,typeName:Z.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return is.create(this,this._def)}nullable(){return pu.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return _a.create(this,this._def)}promise(){return Jh.create(this,this._def)}or(e){return km.create([this,e],this._def)}and(e){return Cm.create(this,e,this._def)}transform(e){return new Ea({...Le(this._def),schema:this,typeName:Z.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new Nm({...Le(this._def),innerType:this,defaultValue:r,typeName:Z.ZodDefault})}brand(){return new vC({typeName:Z.ZodBranded,type:this,...Le(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new Mm({...Le(this._def),innerType:this,catchValue:r,typeName:Z.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Ag.create(this,e)}readonly(){return Dm.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const PIe=/^c[^\s-]{8,}$/i,EIe=/^[0-9a-z]+$/,AIe=/^[0-9A-HJKMNP-TV-Z]{26}$/,TIe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,kIe=/^[a-z0-9_-]{21}$/i,CIe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,IIe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$Ie="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let sO;const jIe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,RIe=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,NIe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,v6="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",MIe=new RegExp(`^${v6}$`);function b6(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function DIe(t){return new RegExp(`^${b6(t)}$`)}function w6(t){let e=`${v6}T${b6(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function LIe(t,e){return!!((e==="v4"||!e)&&jIe.test(t)||(e==="v6"||!e)&&RIe.test(t))}class ma extends Be{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ye.string){const a=this._getOrReturnCtx(e);return ge(a,{code:de.invalid_type,expected:ye.string,received:a.parsedType}),Re}const n=new pn;let i;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(i=this._getOrReturnCtx(e,i),ge(i,{code:de.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")e.data.length>a.value&&(i=this._getOrReturnCtx(e,i),ge(i,{code:de.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){const s=e.data.length>a.value,o=e.data.length<a.value;(s||o)&&(i=this._getOrReturnCtx(e,i),s?ge(i,{code:de.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&ge(i,{code:de.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")IIe.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"email",code:de.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")sO||(sO=new RegExp($Ie,"u")),sO.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"emoji",code:de.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")TIe.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"uuid",code:de.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")kIe.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"nanoid",code:de.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")PIe.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"cuid",code:de.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")EIe.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"cuid2",code:de.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")AIe.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"ulid",code:de.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),ge(i,{validation:"url",code:de.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"regex",code:de.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(e,i),ge(i,{code:de.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(i=this._getOrReturnCtx(e,i),ge(i,{code:de.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(i=this._getOrReturnCtx(e,i),ge(i,{code:de.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?w6(a).test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{code:de.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?MIe.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{code:de.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?DIe(a).test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{code:de.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?CIe.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"duration",code:de.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?LIe(e.data,a.version)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"ip",code:de.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?NIe.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"base64",code:de.invalid_string,message:a.message}),n.dirty()):Ge.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:de.invalid_string,...Te.errToObj(n)})}_addCheck(e){return new ma({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Te.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Te.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Te.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Te.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Te.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Te.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Te.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Te.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Te.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Te.errToObj(e)})}datetime(e){var r,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(r=e==null?void 0:e.offset)!==null&&r!==void 0?r:!1,local:(n=e==null?void 0:e.local)!==null&&n!==void 0?n:!1,...Te.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Te.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Te.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...Te.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r==null?void 0:r.position,...Te.errToObj(r==null?void 0:r.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...Te.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...Te.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...Te.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...Te.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...Te.errToObj(r)})}nonempty(e){return this.min(1,Te.errToObj(e))}trim(){return new ma({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ma({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ma({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}ma.create=t=>{var e;return new ma({checks:[],typeName:Z.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Le(t)})};function FIe(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=r>n?r:n,a=parseInt(t.toFixed(i).replace(".","")),s=parseInt(e.toFixed(i).replace(".",""));return a%s/Math.pow(10,i)}class hu extends Be{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ye.number){const a=this._getOrReturnCtx(e);return ge(a,{code:de.invalid_type,expected:ye.number,received:a.parsedType}),Re}let n;const i=new pn;for(const a of this._def.checks)a.kind==="int"?Ge.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),ge(n,{code:de.invalid_type,expected:"integer",received:"float",message:a.message}),i.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),ge(n,{code:de.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),ge(n,{code:de.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="multipleOf"?FIe(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),ge(n,{code:de.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),ge(n,{code:de.not_finite,message:a.message}),i.dirty()):Ge.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,Te.toString(r))}gt(e,r){return this.setLimit("min",e,!1,Te.toString(r))}lte(e,r){return this.setLimit("max",e,!0,Te.toString(r))}lt(e,r){return this.setLimit("max",e,!1,Te.toString(r))}setLimit(e,r,n,i){return new hu({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:Te.toString(i)}]})}_addCheck(e){return new hu({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Te.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Te.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Te.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Te.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Te.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:Te.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:Te.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Te.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Te.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ge.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}}hu.create=t=>new hu({checks:[],typeName:Z.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Le(t)});class du extends Be{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ye.bigint){const a=this._getOrReturnCtx(e);return ge(a,{code:de.invalid_type,expected:ye.bigint,received:a.parsedType}),Re}let n;const i=new pn;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),ge(n,{code:de.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),ge(n,{code:de.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),ge(n,{code:de.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):Ge.assertNever(a);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,Te.toString(r))}gt(e,r){return this.setLimit("min",e,!1,Te.toString(r))}lte(e,r){return this.setLimit("max",e,!0,Te.toString(r))}lt(e,r){return this.setLimit("max",e,!1,Te.toString(r))}setLimit(e,r,n,i){return new du({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:Te.toString(i)}]})}_addCheck(e){return new du({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Te.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Te.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Te.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Te.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:Te.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}du.create=t=>{var e;return new du({checks:[],typeName:Z.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Le(t)})};class Em extends Be{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ye.boolean){const n=this._getOrReturnCtx(e);return ge(n,{code:de.invalid_type,expected:ye.boolean,received:n.parsedType}),Re}return kn(e.data)}}Em.create=t=>new Em({typeName:Z.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Le(t)});class Cl extends Be{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ye.date){const a=this._getOrReturnCtx(e);return ge(a,{code:de.invalid_type,expected:ye.date,received:a.parsedType}),Re}if(isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return ge(a,{code:de.invalid_date}),Re}const n=new pn;let i;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(i=this._getOrReturnCtx(e,i),ge(i,{code:de.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),n.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(i=this._getOrReturnCtx(e,i),ge(i,{code:de.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),n.dirty()):Ge.assertNever(a);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Cl({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:Te.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:Te.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}Cl.create=t=>new Cl({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Z.ZodDate,...Le(t)});class mw extends Be{_parse(e){if(this._getType(e)!==ye.symbol){const n=this._getOrReturnCtx(e);return ge(n,{code:de.invalid_type,expected:ye.symbol,received:n.parsedType}),Re}return kn(e.data)}}mw.create=t=>new mw({typeName:Z.ZodSymbol,...Le(t)});class Am extends Be{_parse(e){if(this._getType(e)!==ye.undefined){const n=this._getOrReturnCtx(e);return ge(n,{code:de.invalid_type,expected:ye.undefined,received:n.parsedType}),Re}return kn(e.data)}}Am.create=t=>new Am({typeName:Z.ZodUndefined,...Le(t)});class Tm extends Be{_parse(e){if(this._getType(e)!==ye.null){const n=this._getOrReturnCtx(e);return ge(n,{code:de.invalid_type,expected:ye.null,received:n.parsedType}),Re}return kn(e.data)}}Tm.create=t=>new Tm({typeName:Z.ZodNull,...Le(t)});class Yh extends Be{constructor(){super(...arguments),this._any=!0}_parse(e){return kn(e.data)}}Yh.create=t=>new Yh({typeName:Z.ZodAny,...Le(t)});class fl extends Be{constructor(){super(...arguments),this._unknown=!0}_parse(e){return kn(e.data)}}fl.create=t=>new fl({typeName:Z.ZodUnknown,...Le(t)});class no extends Be{_parse(e){const r=this._getOrReturnCtx(e);return ge(r,{code:de.invalid_type,expected:ye.never,received:r.parsedType}),Re}}no.create=t=>new no({typeName:Z.ZodNever,...Le(t)});class gw extends Be{_parse(e){if(this._getType(e)!==ye.undefined){const n=this._getOrReturnCtx(e);return ge(n,{code:de.invalid_type,expected:ye.void,received:n.parsedType}),Re}return kn(e.data)}}gw.create=t=>new gw({typeName:Z.ZodVoid,...Le(t)});class _a extends Be{_parse(e){const{ctx:r,status:n}=this._processInputParams(e),i=this._def;if(r.parsedType!==ye.array)return ge(r,{code:de.invalid_type,expected:ye.array,received:r.parsedType}),Re;if(i.exactLength!==null){const s=r.data.length>i.exactLength.value,o=r.data.length<i.exactLength.value;(s||o)&&(ge(r,{code:s?de.too_big:de.too_small,minimum:o?i.exactLength.value:void 0,maximum:s?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(i.minLength!==null&&r.data.length<i.minLength.value&&(ge(r,{code:de.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),i.maxLength!==null&&r.data.length>i.maxLength.value&&(ge(r,{code:de.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((s,o)=>i.type._parseAsync(new cs(r,s,r.path,o)))).then(s=>pn.mergeArray(n,s));const a=[...r.data].map((s,o)=>i.type._parseSync(new cs(r,s,r.path,o)));return pn.mergeArray(n,a)}get element(){return this._def.type}min(e,r){return new _a({...this._def,minLength:{value:e,message:Te.toString(r)}})}max(e,r){return new _a({...this._def,maxLength:{value:e,message:Te.toString(r)}})}length(e,r){return new _a({...this._def,exactLength:{value:e,message:Te.toString(r)}})}nonempty(e){return this.min(1,e)}}_a.create=(t,e)=>new _a({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Z.ZodArray,...Le(e)});function _c(t){if(t instanceof Ut){const e={};for(const r in t.shape){const n=t.shape[r];e[r]=is.create(_c(n))}return new Ut({...t._def,shape:()=>e})}else return t instanceof _a?new _a({...t._def,type:_c(t.element)}):t instanceof is?is.create(_c(t.unwrap())):t instanceof pu?pu.create(_c(t.unwrap())):t instanceof hs?hs.create(t.items.map(e=>_c(e))):t}class Ut extends Be{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=Ge.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==ye.object){const l=this._getOrReturnCtx(e);return ge(l,{code:de.invalid_type,expected:ye.object,received:l.parsedType}),Re}const{status:n,ctx:i}=this._processInputParams(e),{shape:a,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof no&&this._def.unknownKeys==="strip"))for(const l in i.data)s.includes(l)||o.push(l);const u=[];for(const l of s){const c=a[l],h=i.data[l];u.push({key:{status:"valid",value:l},value:c._parse(new cs(i,h,i.path,l)),alwaysSet:l in i.data})}if(this._def.catchall instanceof no){const l=this._def.unknownKeys;if(l==="passthrough")for(const c of o)u.push({key:{status:"valid",value:c},value:{status:"valid",value:i.data[c]}});else if(l==="strict")o.length>0&&(ge(i,{code:de.unrecognized_keys,keys:o}),n.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const c of o){const h=i.data[c];u.push({key:{status:"valid",value:c},value:l._parse(new cs(i,h,i.path,c)),alwaysSet:c in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const l=[];for(const c of u){const h=await c.key,d=await c.value;l.push({key:h,value:d,alwaysSet:c.alwaysSet})}return l}).then(l=>pn.mergeObjectSync(n,l)):pn.mergeObjectSync(n,u)}get shape(){return this._def.shape()}strict(e){return Te.errToObj,new Ut({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{var i,a,s,o;const u=(s=(a=(i=this._def).errorMap)===null||a===void 0?void 0:a.call(i,r,n).message)!==null&&s!==void 0?s:n.defaultError;return r.code==="unrecognized_keys"?{message:(o=Te.errToObj(e).message)!==null&&o!==void 0?o:u}:{message:u}}}:{}})}strip(){return new Ut({...this._def,unknownKeys:"strip"})}passthrough(){return new Ut({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ut({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ut({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Z.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new Ut({...this._def,catchall:e})}pick(e){const r={};return Ge.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new Ut({...this._def,shape:()=>r})}omit(e){const r={};return Ge.objectKeys(this.shape).forEach(n=>{e[n]||(r[n]=this.shape[n])}),new Ut({...this._def,shape:()=>r})}deepPartial(){return _c(this)}partial(e){const r={};return Ge.objectKeys(this.shape).forEach(n=>{const i=this.shape[n];e&&!e[n]?r[n]=i:r[n]=i.optional()}),new Ut({...this._def,shape:()=>r})}required(e){const r={};return Ge.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])r[n]=this.shape[n];else{let a=this.shape[n];for(;a instanceof is;)a=a._def.innerType;r[n]=a}}),new Ut({...this._def,shape:()=>r})}keyof(){return _6(Ge.objectKeys(this.shape))}}Ut.create=(t,e)=>new Ut({shape:()=>t,unknownKeys:"strip",catchall:no.create(),typeName:Z.ZodObject,...Le(e)});Ut.strictCreate=(t,e)=>new Ut({shape:()=>t,unknownKeys:"strict",catchall:no.create(),typeName:Z.ZodObject,...Le(e)});Ut.lazycreate=(t,e)=>new Ut({shape:t,unknownKeys:"strip",catchall:no.create(),typeName:Z.ZodObject,...Le(e)});class km extends Be{_parse(e){const{ctx:r}=this._processInputParams(e),n=this._def.options;function i(a){for(const o of a)if(o.result.status==="valid")return o.result;for(const o of a)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const s=a.map(o=>new fi(o.ctx.common.issues));return ge(r,{code:de.invalid_union,unionErrors:s}),Re}if(r.common.async)return Promise.all(n.map(async a=>{const s={...r,common:{...r.common,issues:[]},parent:null};return{result:await a._parseAsync({data:r.data,path:r.path,parent:s}),ctx:s}})).then(i);{let a;const s=[];for(const u of n){const l={...r,common:{...r.common,issues:[]},parent:null},c=u._parseSync({data:r.data,path:r.path,parent:l});if(c.status==="valid")return c;c.status==="dirty"&&!a&&(a={result:c,ctx:l}),l.common.issues.length&&s.push(l.common.issues)}if(a)return r.common.issues.push(...a.ctx.common.issues),a.result;const o=s.map(u=>new fi(u));return ge(r,{code:de.invalid_union,unionErrors:o}),Re}}get options(){return this._def.options}}km.create=(t,e)=>new km({options:t,typeName:Z.ZodUnion,...Le(e)});const Cs=t=>t instanceof $m?Cs(t.schema):t instanceof Ea?Cs(t.innerType()):t instanceof jm?[t.value]:t instanceof fu?t.options:t instanceof Rm?Ge.objectValues(t.enum):t instanceof Nm?Cs(t._def.innerType):t instanceof Am?[void 0]:t instanceof Tm?[null]:t instanceof is?[void 0,...Cs(t.unwrap())]:t instanceof pu?[null,...Cs(t.unwrap())]:t instanceof vC||t instanceof Dm?Cs(t.unwrap()):t instanceof Mm?Cs(t._def.innerType):[];class z_ extends Be{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==ye.object)return ge(r,{code:de.invalid_type,expected:ye.object,received:r.parsedType}),Re;const n=this.discriminator,i=r.data[n],a=this.optionsMap.get(i);return a?r.common.async?a._parseAsync({data:r.data,path:r.path,parent:r}):a._parseSync({data:r.data,path:r.path,parent:r}):(ge(r,{code:de.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Re)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){const i=new Map;for(const a of r){const s=Cs(a.shape[e]);if(!s.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of s){if(i.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);i.set(o,a)}}return new z_({typeName:Z.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:i,...Le(n)})}}function BE(t,e){const r=zo(t),n=zo(e);if(t===e)return{valid:!0,data:t};if(r===ye.object&&n===ye.object){const i=Ge.objectKeys(e),a=Ge.objectKeys(t).filter(o=>i.indexOf(o)!==-1),s={...t,...e};for(const o of a){const u=BE(t[o],e[o]);if(!u.valid)return{valid:!1};s[o]=u.data}return{valid:!0,data:s}}else if(r===ye.array&&n===ye.array){if(t.length!==e.length)return{valid:!1};const i=[];for(let a=0;a<t.length;a++){const s=t[a],o=e[a],u=BE(s,o);if(!u.valid)return{valid:!1};i.push(u.data)}return{valid:!0,data:i}}else return r===ye.date&&n===ye.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Cm extends Be{_parse(e){const{status:r,ctx:n}=this._processInputParams(e),i=(a,s)=>{if(UE(a)||UE(s))return Re;const o=BE(a.value,s.value);return o.valid?((zE(a)||zE(s))&&r.dirty(),{status:r.value,value:o.data}):(ge(n,{code:de.invalid_intersection_types}),Re)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([a,s])=>i(a,s)):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Cm.create=(t,e,r)=>new Cm({left:t,right:e,typeName:Z.ZodIntersection,...Le(r)});class hs extends Be{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ye.array)return ge(n,{code:de.invalid_type,expected:ye.array,received:n.parsedType}),Re;if(n.data.length<this._def.items.length)return ge(n,{code:de.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Re;!this._def.rest&&n.data.length>this._def.items.length&&(ge(n,{code:de.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const a=[...n.data].map((s,o)=>{const u=this._def.items[o]||this._def.rest;return u?u._parse(new cs(n,s,n.path,o)):null}).filter(s=>!!s);return n.common.async?Promise.all(a).then(s=>pn.mergeArray(r,s)):pn.mergeArray(r,a)}get items(){return this._def.items}rest(e){return new hs({...this._def,rest:e})}}hs.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new hs({items:t,typeName:Z.ZodTuple,rest:null,...Le(e)})};class Im extends Be{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ye.object)return ge(n,{code:de.invalid_type,expected:ye.object,received:n.parsedType}),Re;const i=[],a=this._def.keyType,s=this._def.valueType;for(const o in n.data)i.push({key:a._parse(new cs(n,o,n.path,o)),value:s._parse(new cs(n,n.data[o],n.path,o)),alwaysSet:o in n.data});return n.common.async?pn.mergeObjectAsync(r,i):pn.mergeObjectSync(r,i)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof Be?new Im({keyType:e,valueType:r,typeName:Z.ZodRecord,...Le(n)}):new Im({keyType:ma.create(),valueType:e,typeName:Z.ZodRecord,...Le(r)})}}class yw extends Be{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ye.map)return ge(n,{code:de.invalid_type,expected:ye.map,received:n.parsedType}),Re;const i=this._def.keyType,a=this._def.valueType,s=[...n.data.entries()].map(([o,u],l)=>({key:i._parse(new cs(n,o,n.path,[l,"key"])),value:a._parse(new cs(n,u,n.path,[l,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const u of s){const l=await u.key,c=await u.value;if(l.status==="aborted"||c.status==="aborted")return Re;(l.status==="dirty"||c.status==="dirty")&&r.dirty(),o.set(l.value,c.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const u of s){const l=u.key,c=u.value;if(l.status==="aborted"||c.status==="aborted")return Re;(l.status==="dirty"||c.status==="dirty")&&r.dirty(),o.set(l.value,c.value)}return{status:r.value,value:o}}}}yw.create=(t,e,r)=>new yw({valueType:e,keyType:t,typeName:Z.ZodMap,...Le(r)});class Il extends Be{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ye.set)return ge(n,{code:de.invalid_type,expected:ye.set,received:n.parsedType}),Re;const i=this._def;i.minSize!==null&&n.data.size<i.minSize.value&&(ge(n,{code:de.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),r.dirty()),i.maxSize!==null&&n.data.size>i.maxSize.value&&(ge(n,{code:de.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),r.dirty());const a=this._def.valueType;function s(u){const l=new Set;for(const c of u){if(c.status==="aborted")return Re;c.status==="dirty"&&r.dirty(),l.add(c.value)}return{status:r.value,value:l}}const o=[...n.data.values()].map((u,l)=>a._parse(new cs(n,u,n.path,l)));return n.common.async?Promise.all(o).then(u=>s(u)):s(o)}min(e,r){return new Il({...this._def,minSize:{value:e,message:Te.toString(r)}})}max(e,r){return new Il({...this._def,maxSize:{value:e,message:Te.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Il.create=(t,e)=>new Il({valueType:t,minSize:null,maxSize:null,typeName:Z.ZodSet,...Le(e)});class lh extends Be{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==ye.function)return ge(r,{code:de.invalid_type,expected:ye.function,received:r.parsedType}),Re;function n(o,u){return fw({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,dw(),Gh].filter(l=>!!l),issueData:{code:de.invalid_arguments,argumentsError:u}})}function i(o,u){return fw({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,dw(),Gh].filter(l=>!!l),issueData:{code:de.invalid_return_type,returnTypeError:u}})}const a={errorMap:r.common.contextualErrorMap},s=r.data;if(this._def.returns instanceof Jh){const o=this;return kn(async function(...u){const l=new fi([]),c=await o._def.args.parseAsync(u,a).catch(f=>{throw l.addIssue(n(u,f)),l}),h=await Reflect.apply(s,this,c);return await o._def.returns._def.type.parseAsync(h,a).catch(f=>{throw l.addIssue(i(h,f)),l})})}else{const o=this;return kn(function(...u){const l=o._def.args.safeParse(u,a);if(!l.success)throw new fi([n(u,l.error)]);const c=Reflect.apply(s,this,l.data),h=o._def.returns.safeParse(c,a);if(!h.success)throw new fi([i(c,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new lh({...this._def,args:hs.create(e).rest(fl.create())})}returns(e){return new lh({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new lh({args:e||hs.create([]).rest(fl.create()),returns:r||fl.create(),typeName:Z.ZodFunction,...Le(n)})}}class $m extends Be{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}$m.create=(t,e)=>new $m({getter:t,typeName:Z.ZodLazy,...Le(e)});class jm extends Be{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return ge(r,{received:r.data,code:de.invalid_literal,expected:this._def.value}),Re}return{status:"valid",value:e.data}}get value(){return this._def.value}}jm.create=(t,e)=>new jm({value:t,typeName:Z.ZodLiteral,...Le(e)});function _6(t,e){return new fu({values:t,typeName:Z.ZodEnum,...Le(e)})}class fu extends Be{constructor(){super(...arguments),Lf.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),n=this._def.values;return ge(r,{expected:Ge.joinValues(n),received:r.parsedType,code:de.invalid_type}),Re}if(pw(this,Lf,"f")||y6(this,Lf,new Set(this._def.values),"f"),!pw(this,Lf,"f").has(e.data)){const r=this._getOrReturnCtx(e),n=this._def.values;return ge(r,{received:r.data,code:de.invalid_enum_value,options:n}),Re}return kn(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return fu.create(e,{...this._def,...r})}exclude(e,r=this._def){return fu.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}}Lf=new WeakMap;fu.create=_6;class Rm extends Be{constructor(){super(...arguments),Ff.set(this,void 0)}_parse(e){const r=Ge.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==ye.string&&n.parsedType!==ye.number){const i=Ge.objectValues(r);return ge(n,{expected:Ge.joinValues(i),received:n.parsedType,code:de.invalid_type}),Re}if(pw(this,Ff,"f")||y6(this,Ff,new Set(Ge.getValidEnumValues(this._def.values)),"f"),!pw(this,Ff,"f").has(e.data)){const i=Ge.objectValues(r);return ge(n,{received:n.data,code:de.invalid_enum_value,options:i}),Re}return kn(e.data)}get enum(){return this._def.values}}Ff=new WeakMap;Rm.create=(t,e)=>new Rm({values:t,typeName:Z.ZodNativeEnum,...Le(e)});class Jh extends Be{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==ye.promise&&r.common.async===!1)return ge(r,{code:de.invalid_type,expected:ye.promise,received:r.parsedType}),Re;const n=r.parsedType===ye.promise?r.data:Promise.resolve(r.data);return kn(n.then(i=>this._def.type.parseAsync(i,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Jh.create=(t,e)=>new Jh({type:t,typeName:Z.ZodPromise,...Le(e)});class Ea extends Be{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Z.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:n}=this._processInputParams(e),i=this._def.effect||null,a={addIssue:s=>{ge(n,s),s.fatal?r.abort():r.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),i.type==="preprocess"){const s=i.transform(n.data,a);if(n.common.async)return Promise.resolve(s).then(async o=>{if(r.value==="aborted")return Re;const u=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return u.status==="aborted"?Re:u.status==="dirty"||r.value==="dirty"?Kc(u.value):u});{if(r.value==="aborted")return Re;const o=this._def.schema._parseSync({data:s,path:n.path,parent:n});return o.status==="aborted"?Re:o.status==="dirty"||r.value==="dirty"?Kc(o.value):o}}if(i.type==="refinement"){const s=o=>{const u=i.refinement(o,a);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?Re:(o.status==="dirty"&&r.dirty(),s(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?Re:(o.status==="dirty"&&r.dirty(),s(o.value).then(()=>({status:r.value,value:o.value}))))}if(i.type==="transform")if(n.common.async===!1){const s=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Sm(s))return s;const o=i.transform(s.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(s=>Sm(s)?Promise.resolve(i.transform(s.value,a)).then(o=>({status:r.value,value:o})):s);Ge.assertNever(i)}}Ea.create=(t,e,r)=>new Ea({schema:t,typeName:Z.ZodEffects,effect:e,...Le(r)});Ea.createWithPreprocess=(t,e,r)=>new Ea({schema:e,effect:{type:"preprocess",transform:t},typeName:Z.ZodEffects,...Le(r)});class is extends Be{_parse(e){return this._getType(e)===ye.undefined?kn(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}is.create=(t,e)=>new is({innerType:t,typeName:Z.ZodOptional,...Le(e)});class pu extends Be{_parse(e){return this._getType(e)===ye.null?kn(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}pu.create=(t,e)=>new pu({innerType:t,typeName:Z.ZodNullable,...Le(e)});class Nm extends Be{_parse(e){const{ctx:r}=this._processInputParams(e);let n=r.data;return r.parsedType===ye.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}Nm.create=(t,e)=>new Nm({innerType:t,typeName:Z.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Le(e)});class Mm extends Be{_parse(e){const{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Pm(i)?i.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new fi(n.common.issues)},input:n.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new fi(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Mm.create=(t,e)=>new Mm({innerType:t,typeName:Z.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Le(e)});class vw extends Be{_parse(e){if(this._getType(e)!==ye.nan){const n=this._getOrReturnCtx(e);return ge(n,{code:de.invalid_type,expected:ye.nan,received:n.parsedType}),Re}return{status:"valid",value:e.data}}}vw.create=t=>new vw({typeName:Z.ZodNaN,...Le(t)});const UIe=Symbol("zod_brand");class vC extends Be{_parse(e){const{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class Ag extends Be{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?Re:a.status==="dirty"?(r.dirty(),Kc(a.value)):this._def.out._parseAsync({data:a.value,path:n.path,parent:n})})();{const i=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Re:i.status==="dirty"?(r.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:n.path,parent:n})}}static create(e,r){return new Ag({in:e,out:r,typeName:Z.ZodPipeline})}}class Dm extends Be{_parse(e){const r=this._def.innerType._parse(e),n=i=>(Sm(i)&&(i.value=Object.freeze(i.value)),i);return Pm(r)?r.then(i=>n(i)):n(r)}unwrap(){return this._def.innerType}}Dm.create=(t,e)=>new Dm({innerType:t,typeName:Z.ZodReadonly,...Le(e)});function x6(t,e={},r){return t?Yh.create().superRefine((n,i)=>{var a,s;if(!t(n)){const o=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,u=(s=(a=o.fatal)!==null&&a!==void 0?a:r)!==null&&s!==void 0?s:!0,l=typeof o=="string"?{message:o}:o;i.addIssue({code:"custom",...l,fatal:u})}}):Yh.create()}const zIe={object:Ut.lazycreate};var Z;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Z||(Z={}));const BIe=(t,e={message:`Input not instance of ${t.name}`})=>x6(r=>r instanceof t,e),O6=ma.create,S6=hu.create,qIe=vw.create,KIe=du.create,P6=Em.create,VIe=Cl.create,HIe=mw.create,WIe=Am.create,GIe=Tm.create,YIe=Yh.create,JIe=fl.create,ZIe=no.create,XIe=gw.create,QIe=_a.create,e$e=Ut.create,t$e=Ut.strictCreate,r$e=km.create,n$e=z_.create,i$e=Cm.create,a$e=hs.create,s$e=Im.create,o$e=yw.create,u$e=Il.create,l$e=lh.create,c$e=$m.create,h$e=jm.create,d$e=fu.create,f$e=Rm.create,p$e=Jh.create,nL=Ea.create,m$e=is.create,g$e=pu.create,y$e=Ea.createWithPreprocess,v$e=Ag.create,b$e=()=>O6().optional(),w$e=()=>S6().optional(),_$e=()=>P6().optional(),x$e={string:t=>ma.create({...t,coerce:!0}),number:t=>hu.create({...t,coerce:!0}),boolean:t=>Em.create({...t,coerce:!0}),bigint:t=>du.create({...t,coerce:!0}),date:t=>Cl.create({...t,coerce:!0})},O$e=Re;var tt=Object.freeze({__proto__:null,defaultErrorMap:Gh,setErrorMap:OIe,getErrorMap:dw,makeIssue:fw,EMPTY_PATH:SIe,addIssueToContext:ge,ParseStatus:pn,INVALID:Re,DIRTY:Kc,OK:kn,isAborted:UE,isDirty:zE,isValid:Sm,isAsync:Pm,get util(){return Ge},get objectUtil(){return FE},ZodParsedType:ye,getParsedType:zo,ZodType:Be,datetimeRegex:w6,ZodString:ma,ZodNumber:hu,ZodBigInt:du,ZodBoolean:Em,ZodDate:Cl,ZodSymbol:mw,ZodUndefined:Am,ZodNull:Tm,ZodAny:Yh,ZodUnknown:fl,ZodNever:no,ZodVoid:gw,ZodArray:_a,ZodObject:Ut,ZodUnion:km,ZodDiscriminatedUnion:z_,ZodIntersection:Cm,ZodTuple:hs,ZodRecord:Im,ZodMap:yw,ZodSet:Il,ZodFunction:lh,ZodLazy:$m,ZodLiteral:jm,ZodEnum:fu,ZodNativeEnum:Rm,ZodPromise:Jh,ZodEffects:Ea,ZodTransformer:Ea,ZodOptional:is,ZodNullable:pu,ZodDefault:Nm,ZodCatch:Mm,ZodNaN:vw,BRAND:UIe,ZodBranded:vC,ZodPipeline:Ag,ZodReadonly:Dm,custom:x6,Schema:Be,ZodSchema:Be,late:zIe,get ZodFirstPartyTypeKind(){return Z},coerce:x$e,any:YIe,array:QIe,bigint:KIe,boolean:P6,date:VIe,discriminatedUnion:n$e,effect:nL,enum:d$e,function:l$e,instanceof:BIe,intersection:i$e,lazy:c$e,literal:h$e,map:o$e,nan:qIe,nativeEnum:f$e,never:ZIe,null:GIe,nullable:g$e,number:S6,object:e$e,oboolean:_$e,onumber:w$e,optional:m$e,ostring:b$e,pipeline:v$e,preprocess:y$e,promise:p$e,record:s$e,set:u$e,strictObject:t$e,string:O6,symbol:HIe,transformer:nL,tuple:a$e,undefined:WIe,union:r$e,unknown:JIe,void:XIe,NEVER:O$e,ZodIssueCode:de,quotelessJson:xIe,ZodError:fi}),B_={exports:{}},E6={};function Ki(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var S$e=Ki;Ki.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};Ki.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};Ki.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},r),this._options.unref&&this._timer.unref(),!0};Ki.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};Ki.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};Ki.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};Ki.prototype.start=Ki.prototype.try;Ki.prototype.errors=function(){return this._errors};Ki.prototype.attempts=function(){return this._attempts};Ki.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,n=0;n<this._errors.length;n++){var i=this._errors[n],a=i.message,s=(t[a]||0)+1;t[a]=s,s>=r&&(e=i,r=s)}return e};(function(t){var e=S$e;t.operation=function(r){var n=t.timeouts(r);return new e(n,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})},t.timeouts=function(r){if(r instanceof Array)return[].concat(r);var n={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var i in r)n[i]=r[i];if(n.minTimeout>n.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var a=[],s=0;s<n.retries;s++)a.push(this.createTimeout(s,n));return r&&r.forever&&!a.length&&a.push(this.createTimeout(s,n)),a.sort(function(o,u){return o-u}),a},t.createTimeout=function(r,n){var i=n.randomize?Math.random()+1:1,a=Math.round(i*Math.max(n.minTimeout,1)*Math.pow(n.factor,r));return a=Math.min(a,n.maxTimeout),a},t.wrap=function(r,n,i){if(n instanceof Array&&(i=n,n=null),!i){i=[];for(var a in r)typeof r[a]=="function"&&i.push(a)}for(var s=0;s<i.length;s++){var o=i[s],u=r[o];r[o]=function(c){var h=t.operation(n),d=Array.prototype.slice.call(arguments,1),f=d.pop();d.push(function(p){h.retry(p)||(p&&(arguments[0]=h.mainError()),f.apply(this,arguments))}),h.attempt(function(){c.apply(r,d)})}.bind(r,u),r[o].options=n}}})(E6);var P$e=E6;const E$e=P$e,A$e=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class A6 extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const T$e=(t,e,r)=>{const n=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=n,t},k$e=t=>A$e.includes(t),T6=(t,e)=>new Promise((r,n)=>{e={onFailedAttempt:()=>{},retries:10,...e};const i=E$e.operation(e);i.attempt(async a=>{try{r(await t(a))}catch(s){if(!(s instanceof Error)){n(new TypeError(`Non-error was thrown: "${s}". You should only throw errors.`));return}if(s instanceof A6)i.stop(),n(s.originalError);else if(s instanceof TypeError&&!k$e(s.message))i.stop(),n(s);else{T$e(s,a,e);try{await e.onFailedAttempt(s)}catch(o){n(o);return}i.retry(s)||n(i.mainError())}}})});B_.exports=T6;B_.exports.default=T6;B_.exports.AbortError=A6;var C$e=B_.exports;const bw=Ze(C$e),I$e=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function ww(t){return typeof t=="string"&&I$e.test(t)}function $$e(t){if(!ww(t))throw TypeError("Invalid UUID");var e,r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}var Br=[];for(var oO=0;oO<256;++oO)Br.push((oO+256).toString(16).slice(1));function k6(t,e=0){return(Br[t[e+0]]+Br[t[e+1]]+Br[t[e+2]]+Br[t[e+3]]+"-"+Br[t[e+4]]+Br[t[e+5]]+"-"+Br[t[e+6]]+Br[t[e+7]]+"-"+Br[t[e+8]]+Br[t[e+9]]+"-"+Br[t[e+10]]+Br[t[e+11]]+Br[t[e+12]]+Br[t[e+13]]+Br[t[e+14]]+Br[t[e+15]]).toLowerCase()}var Ry,j$e=new Uint8Array(16);function R$e(){if(!Ry&&(Ry=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ry))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ry(j$e)}function N$e(t){t=unescape(encodeURIComponent(t));for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}var M$e="6ba7b810-9dad-11d1-80b4-00c04fd430c8",D$e="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function L$e(t,e,r){function n(i,a,s,o){var u;if(typeof i=="string"&&(i=N$e(i)),typeof a=="string"&&(a=$$e(a)),((u=a)===null||u===void 0?void 0:u.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var l=new Uint8Array(16+i.length);if(l.set(a),l.set(i,a.length),l=r(l),l[6]=l[6]&15|e,l[8]=l[8]&63|128,s){o=o||0;for(var c=0;c<16;++c)s[o+c]=l[c];return s}return k6(l)}try{n.name=t}catch{}return n.DNS=M$e,n.URL=D$e,n}var F$e=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const iL={randomUUID:F$e};function Fa(t,e,r){if(iL.randomUUID&&!e&&!t)return iL.randomUUID();t=t||{};var n=t.random||(t.rng||R$e)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(var i=0;i<16;++i)e[r+i]=n[i];return e}return k6(n)}function U$e(t,e,r,n){switch(t){case 0:return e&r^~e&n;case 1:return e^r^n;case 2:return e&r^e&n^r&n;case 3:return e^r^n}}function uO(t,e){return t<<e|t>>>32-e}function z$e(t){var e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){var n=unescape(encodeURIComponent(t));t=[];for(var i=0;i<n.length;++i)t.push(n.charCodeAt(i))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var a=t.length/4+2,s=Math.ceil(a/16),o=new Array(s),u=0;u<s;++u){for(var l=new Uint32Array(16),c=0;c<16;++c)l[c]=t[u*64+c*4]<<24|t[u*64+c*4+1]<<16|t[u*64+c*4+2]<<8|t[u*64+c*4+3];o[u]=l}o[s-1][14]=(t.length-1)*8/Math.pow(2,32),o[s-1][14]=Math.floor(o[s-1][14]),o[s-1][15]=(t.length-1)*8&4294967295;for(var h=0;h<s;++h){for(var d=new Uint32Array(80),f=0;f<16;++f)d[f]=o[h][f];for(var p=16;p<80;++p)d[p]=uO(d[p-3]^d[p-8]^d[p-14]^d[p-16],1);for(var m=r[0],g=r[1],v=r[2],y=r[3],b=r[4],w=0;w<80;++w){var _=Math.floor(w/20),O=uO(m,5)+U$e(_,g,v,y)+b+e[_]+d[w]>>>0;b=y,y=v,v=uO(g,30)>>>0,g=m,m=O}r[0]=r[0]+m>>>0,r[1]=r[1]+g>>>0,r[2]=r[2]+v>>>0,r[3]=r[3]+y>>>0,r[4]=r[4]+b>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var B$e=L$e("v5",80,z$e);const aL=B$e;let q$e=class{getStore(){}run(e,r){return r()}};const lO=Symbol.for("ls:tracing_async_local_storage"),K$e=new q$e;let V$e=class{getInstance(){return globalThis[lO]??K$e}initializeGlobalInstance(e){globalThis[lO]===void 0&&(globalThis[lO]=e)}};const H$e=new V$e,W$e=()=>{const t=H$e.getInstance().getStore();if(t===void 0)throw new Error(["Could not get the current run tree.","","Please make sure you are calling this method within a traceable function or the tracing is enabled."].join(`
`));return t};function bC(t){return typeof t=="function"&&"langsmith:traceable"in t}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const G$e=Object.prototype.hasOwnProperty;function qE(t,e){return G$e.call(t,e)}function KE(t){if(Array.isArray(t)){const r=new Array(t.length);for(let n=0;n<r.length;n++)r[n]=""+n;return r}if(Object.keys)return Object.keys(t);let e=[];for(let r in t)qE(t,r)&&e.push(r);return e}function Za(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function VE(t){let e=0;const r=t.length;let n;for(;e<r;){if(n=t.charCodeAt(e),n>=48&&n<=57){e++;continue}return!1}return!0}function dc(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function Y$e(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function HE(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(HE(t[r]))return!0}else if(typeof t=="object"){const r=KE(t),n=r.length;for(var e=0;e<n;e++)if(HE(t[r[e]]))return!0}}return!1}function sL(t,e){const r=[t];for(const n in e){const i=typeof e[n]=="object"?JSON.stringify(e[n],null,2):e[n];typeof i<"u"&&r.push(`${n}: ${i}`)}return r.join(`
`)}class J$e extends Error{constructor(e,r,n,i,a){super(sL(e,{name:r,index:n,operation:i,tree:a})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.setPrototypeOf(this,new.target.prototype),this.message=sL(e,{name:r,index:n,operation:i,tree:a})}}const ar=J$e,Vc={add:function(t,e,r){return t[e]=this.value,{newDocument:r}},remove:function(t,e,r){var n=t[e];return delete t[e],{newDocument:r,removed:n}},replace:function(t,e,r){var n=t[e];return t[e]=this.value,{newDocument:r,removed:n}},move:function(t,e,r){let n=WE(r,this.path);n&&(n=Za(n));const i=fp(r,{op:"remove",path:this.from}).removed;return fp(r,{op:"add",path:this.path,value:i}),{newDocument:r,removed:n}},copy:function(t,e,r){const n=WE(r,this.from);return fp(r,{op:"add",path:this.path,value:Za(n)}),{newDocument:r}},test:function(t,e,r){return{newDocument:r,test:_w(t[e],this.value)}},_get:function(t,e,r){return this.value=t[e],{newDocument:r}}};var Z$e={add:function(t,e,r){return VE(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:r,index:e}},remove:function(t,e,r){var n=t.splice(e,1);return{newDocument:r,removed:n[0]}},replace:function(t,e,r){var n=t[e];return t[e]=this.value,{newDocument:r,removed:n}},move:Vc.move,copy:Vc.copy,test:Vc.test,_get:Vc._get};function WE(t,e){if(e=="")return t;var r={op:"_get",path:e};return fp(t,r),r.value}function fp(t,e,r=!1,n=!0,i=!0,a=0){if(r&&(typeof r=="function"?r(e,0,t,e.path):GE(e,0)),e.path===""){let s={newDocument:t};if(e.op==="add")return s.newDocument=e.value,s;if(e.op==="replace")return s.newDocument=e.value,s.removed=t,s;if(e.op==="move"||e.op==="copy")return s.newDocument=WE(t,e.from),e.op==="move"&&(s.removed=t),s;if(e.op==="test"){if(s.test=_w(t,e.value),s.test===!1)throw new ar("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return s.newDocument=t,s}else{if(e.op==="remove")return s.removed=t,s.newDocument=null,s;if(e.op==="_get")return e.value=t,s;if(r)throw new ar("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,e,t);return s}}else{n||(t=Za(t));const o=(e.path||"").split("/");let u=t,l=1,c=o.length,h,d,f;for(typeof r=="function"?f=r:f=GE;;){if(d=o[l],d&&d.indexOf("~")!=-1&&(d=Y$e(d)),i&&(d=="__proto__"||d=="prototype"&&l>0&&o[l-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(r&&h===void 0&&(u[d]===void 0?h=o.slice(0,l).join("/"):l==c-1&&(h=e.path),h!==void 0&&f(e,0,t,h)),l++,Array.isArray(u)){if(d==="-")d=u.length;else{if(r&&!VE(d))throw new ar("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,e,t);VE(d)&&(d=~~d)}if(l>=c){if(r&&e.op==="add"&&d>u.length)throw new ar("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,e,t);const p=Z$e[e.op].call(e,u,d,t);if(p.test===!1)throw new ar("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return p}}else if(l>=c){const p=Vc[e.op].call(e,u,d,t);if(p.test===!1)throw new ar("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return p}if(u=u[d],r&&l<c&&(!u||typeof u!="object"))throw new ar("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,e,t)}}}function Lm(t,e,r,n=!0,i=!0){if(r&&!Array.isArray(e))throw new ar("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(t=Za(t));const a=new Array(e.length);for(let s=0,o=e.length;s<o;s++)a[s]=fp(t,e[s],r,!0,i,s),t=a[s].newDocument;return a.newDocument=t,a}function GE(t,e,r,n){if(typeof t!="object"||t===null||Array.isArray(t))throw new ar("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,r);if(Vc[t.op]){if(typeof t.path!="string")throw new ar("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,r);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new ar('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,r);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new ar("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,r);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new ar("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,r);if((t.op==="add"||t.op==="replace"||t.op==="test")&&HE(t.value))throw new ar("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,r);if(r){if(t.op=="add"){var i=t.path.split("/").length,a=n.split("/").length;if(i!==a+1&&i!==a)throw new ar("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,r)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==n)throw new ar("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,r)}else if(t.op==="move"||t.op==="copy"){var s={op:"_get",path:t.from,value:void 0},o=X$e([s],r);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new ar("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,r)}}}else throw new ar("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,r)}function X$e(t,e,r){try{if(!Array.isArray(t))throw new ar("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)Lm(Za(e),Za(t),r||!0);else{r=r||GE;for(var n=0;n<t.length;n++)r(t[n],n,e,void 0)}}catch(i){if(i instanceof ar)return i;throw i}}function _w(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var r=Array.isArray(t),n=Array.isArray(e),i,a,s;if(r&&n){if(a=t.length,a!=e.length)return!1;for(i=a;i--!==0;)if(!_w(t[i],e[i]))return!1;return!0}if(r!=n)return!1;var o=Object.keys(t);if(a=o.length,a!==Object.keys(e).length)return!1;for(i=a;i--!==0;)if(!e.hasOwnProperty(o[i]))return!1;for(i=a;i--!==0;)if(s=o[i],!_w(t[s],e[s]))return!1;return!0}return t!==t&&e!==e}function C6(t,e,r,n,i){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var a=KE(e),s=KE(t),o=!1,u=s.length-1;u>=0;u--){var l=s[u],c=t[l];if(qE(e,l)&&!(e[l]===void 0&&c!==void 0&&Array.isArray(e)===!1)){var h=e[l];typeof c=="object"&&c!=null&&typeof h=="object"&&h!=null&&Array.isArray(c)===Array.isArray(h)?C6(c,h,r,n+"/"+dc(l),i):c!==h&&(i&&r.push({op:"test",path:n+"/"+dc(l),value:Za(c)}),r.push({op:"replace",path:n+"/"+dc(l),value:Za(h)}))}else Array.isArray(t)===Array.isArray(e)?(i&&r.push({op:"test",path:n+"/"+dc(l),value:Za(c)}),r.push({op:"remove",path:n+"/"+dc(l)}),o=!0):(i&&r.push({op:"test",path:n,value:t}),r.push({op:"replace",path:n,value:e}))}if(!(!o&&a.length==s.length))for(var u=0;u<a.length;u++){var l=a[u];!qE(t,l)&&e[l]!==void 0&&r.push({op:"add",path:n+"/"+dc(l),value:Za(e[l])})}}}function q_(t,e,r=!1){var n=[];return C6(t,e,n,"",r),n}const I6=()=>typeof window<"u"&&typeof window.document<"u",$6=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",j6=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),wC=()=>typeof Deno<"u",R6=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!wC(),N6=()=>{let t;return I6()?t="browser":R6()?t="node":$6()?t="webworker":j6()?t="jsdom":wC()?t="deno":t="other",t};let cO;async function M6(){return cO===void 0&&(cO={library:"langchain-js",runtime:N6()}),cO}function Me(t){var e;try{return typeof process<"u"?(e=process.env)==null?void 0:e[t]:void 0}catch{return}}const Q$e=Object.freeze(Object.defineProperty({__proto__:null,getEnv:N6,getEnvironmentVariable:Me,getRuntimeEnvironment:M6,isBrowser:I6,isDeno:wC,isJsDom:j6,isNode:R6,isWebWorker:$6},Symbol.toStringTag,{value:"Module"}));class eje{}class kd extends eje{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,U_(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:Me("LANGCHAIN_CALLBACKS_BACKGROUND")!=="true"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return Or.prototype.toJSON.call(this)}toJSONNotImplemented(){return Or.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class r extends kd{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Fa()}),Object.assign(this,e)}}return new r}}const tje=Object.freeze(Object.defineProperty({__proto__:null,BaseCallbackHandler:kd},Symbol.toStringTag,{value:"Module"}));function hO(t,e){return t&&!Array.isArray(t)&&typeof t=="object"?t:{[e]:t}}function rje(t){return t.replace(/[-:.]/g,"")}function nje(t,e,r){const n=r.toFixed(0).slice(0,3).padStart(3,"0");return rje(`${new Date(t).toISOString().slice(0,-1)}${n}Z`)+e}function xc(t){return typeof t._addRunToRunMap=="function"}class Wi extends kd{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e!=null&&e.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,r){e.child_runs.push(r)}_addRunToRunMap(e){const r=nje(e.start_time,e.id,e.execution_order),n={...e};if(n.parent_run_id!==void 0){const i=this.runMap.get(n.parent_run_id);i&&(this._addChildRun(i,n),i.child_execution_order=Math.max(i.child_execution_order,n.child_execution_order),n.trace_id=i.trace_id,i.dotted_order!==void 0&&(n.dotted_order=[i.dotted_order,r].join(".")))}else n.trace_id=n.id,n.dotted_order=r;return this.runMap.set(n.id,n),n}async _endTrace(e){var n;const r=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);r?r.child_execution_order=Math.max(r.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await((n=this.onRunUpdate)==null?void 0:n.call(this,e))}_getExecutionOrder(e){const r=e!==void 0&&this.runMap.get(e);return r?r.child_execution_order+1:1}_createRunForLLMStart(e,r,n,i,a,s,o,u){const l=this._getExecutionOrder(i),c=Date.now(),h=o?{...a,metadata:o}:a,d={id:n,name:u??e.id[e.id.length-1],parent_run_id:i,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{prompts:r},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:h??{},tags:s||[]};return this._addRunToRunMap(d)}async handleLLMStart(e,r,n,i,a,s,o,u){var c,h;const l=this.runMap.get(n)??this._createRunForLLMStart(e,r,n,i,a,s,o,u);return await((c=this.onRunCreate)==null?void 0:c.call(this,l)),await((h=this.onLLMStart)==null?void 0:h.call(this,l)),l}_createRunForChatModelStart(e,r,n,i,a,s,o,u){const l=this._getExecutionOrder(i),c=Date.now(),h=o?{...a,metadata:o}:a,d={id:n,name:u??e.id[e.id.length-1],parent_run_id:i,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{messages:r},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:h??{},tags:s||[]};return this._addRunToRunMap(d)}async handleChatModelStart(e,r,n,i,a,s,o,u){var c,h;const l=this.runMap.get(n)??this._createRunForChatModelStart(e,r,n,i,a,s,o,u);return await((c=this.onRunCreate)==null?void 0:c.call(this,l)),await((h=this.onLLMStart)==null?void 0:h.call(this,l)),l}async handleLLMEnd(e,r){var i;const n=this.runMap.get(r);if(!n||(n==null?void 0:n.run_type)!=="llm")throw new Error("No LLM run to end.");return n.end_time=Date.now(),n.outputs=e,n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await((i=this.onLLMEnd)==null?void 0:i.call(this,n)),await this._endTrace(n),n}async handleLLMError(e,r){var i;const n=this.runMap.get(r);if(!n||(n==null?void 0:n.run_type)!=="llm")throw new Error("No LLM run to end.");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await((i=this.onLLMError)==null?void 0:i.call(this,n)),await this._endTrace(n),n}_createRunForChainStart(e,r,n,i,a,s,o,u){const l=this._getExecutionOrder(i),c=Date.now(),h={id:n,name:u??e.id[e.id.length-1],parent_run_id:i,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:r,execution_order:l,child_execution_order:l,run_type:o??"chain",child_runs:[],extra:s?{metadata:s}:{},tags:a||[]};return this._addRunToRunMap(h)}async handleChainStart(e,r,n,i,a,s,o,u){var c,h;const l=this.runMap.get(n)??this._createRunForChainStart(e,r,n,i,a,s,o,u);return await((c=this.onRunCreate)==null?void 0:c.call(this,l)),await((h=this.onChainStart)==null?void 0:h.call(this,l)),l}async handleChainEnd(e,r,n,i,a){var o;const s=this.runMap.get(r);if(!s)throw new Error("No chain run to end.");return s.end_time=Date.now(),s.outputs=hO(e,"output"),s.events.push({name:"end",time:new Date(s.end_time).toISOString()}),(a==null?void 0:a.inputs)!==void 0&&(s.inputs=hO(a.inputs,"input")),await((o=this.onChainEnd)==null?void 0:o.call(this,s)),await this._endTrace(s),s}async handleChainError(e,r,n,i,a){var o;const s=this.runMap.get(r);if(!s)throw new Error("No chain run to end.");return s.end_time=Date.now(),s.error=this.stringifyError(e),s.events.push({name:"error",time:new Date(s.end_time).toISOString()}),(a==null?void 0:a.inputs)!==void 0&&(s.inputs=hO(a.inputs,"input")),await((o=this.onChainError)==null?void 0:o.call(this,s)),await this._endTrace(s),s}_createRunForToolStart(e,r,n,i,a,s,o){const u=this._getExecutionOrder(i),l=Date.now(),c={id:n,name:o??e.id[e.id.length-1],parent_run_id:i,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{input:r},execution_order:u,child_execution_order:u,run_type:"tool",child_runs:[],extra:s?{metadata:s}:{},tags:a||[]};return this._addRunToRunMap(c)}async handleToolStart(e,r,n,i,a,s,o){var l,c;const u=this.runMap.get(n)??this._createRunForToolStart(e,r,n,i,a,s,o);return await((l=this.onRunCreate)==null?void 0:l.call(this,u)),await((c=this.onToolStart)==null?void 0:c.call(this,u)),u}async handleToolEnd(e,r){var i;const n=this.runMap.get(r);if(!n||(n==null?void 0:n.run_type)!=="tool")throw new Error("No tool run to end");return n.end_time=Date.now(),n.outputs={output:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await((i=this.onToolEnd)==null?void 0:i.call(this,n)),await this._endTrace(n),n}async handleToolError(e,r){var i;const n=this.runMap.get(r);if(!n||(n==null?void 0:n.run_type)!=="tool")throw new Error("No tool run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await((i=this.onToolError)==null?void 0:i.call(this,n)),await this._endTrace(n),n}async handleAgentAction(e,r){var a;const n=this.runMap.get(r);if(!n||(n==null?void 0:n.run_type)!=="chain")return;const i=n;i.actions=i.actions||[],i.actions.push(e),i.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((a=this.onAgentAction)==null?void 0:a.call(this,n))}async handleAgentEnd(e,r){var i;const n=this.runMap.get(r);!n||(n==null?void 0:n.run_type)!=="chain"||(n.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((i=this.onAgentEnd)==null?void 0:i.call(this,n)))}_createRunForRetrieverStart(e,r,n,i,a,s,o){const u=this._getExecutionOrder(i),l=Date.now(),c={id:n,name:o??e.id[e.id.length-1],parent_run_id:i,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{query:r},execution_order:u,child_execution_order:u,run_type:"retriever",child_runs:[],extra:s?{metadata:s}:{},tags:a||[]};return this._addRunToRunMap(c)}async handleRetrieverStart(e,r,n,i,a,s,o){var l,c;const u=this.runMap.get(n)??this._createRunForRetrieverStart(e,r,n,i,a,s,o);return await((l=this.onRunCreate)==null?void 0:l.call(this,u)),await((c=this.onRetrieverStart)==null?void 0:c.call(this,u)),u}async handleRetrieverEnd(e,r){var i;const n=this.runMap.get(r);if(!n||(n==null?void 0:n.run_type)!=="retriever")throw new Error("No retriever run to end");return n.end_time=Date.now(),n.outputs={documents:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await((i=this.onRetrieverEnd)==null?void 0:i.call(this,n)),await this._endTrace(n),n}async handleRetrieverError(e,r){var i;const n=this.runMap.get(r);if(!n||(n==null?void 0:n.run_type)!=="retriever")throw new Error("No retriever run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await((i=this.onRetrieverError)==null?void 0:i.call(this,n)),await this._endTrace(n),n}async handleText(e,r){var i;const n=this.runMap.get(r);!n||(n==null?void 0:n.run_type)!=="chain"||(n.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((i=this.onText)==null?void 0:i.call(this,n)))}async handleLLMNewToken(e,r,n,i,a,s){var u;const o=this.runMap.get(n);if(!o||(o==null?void 0:o.run_type)!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return o.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:r,chunk:s==null?void 0:s.chunk}}),await((u=this.onLLMNewToken)==null?void 0:u.call(this,o,e,{chunk:s==null?void 0:s.chunk})),o}}const ije=Object.freeze(Object.defineProperty({__proto__:null,BaseTracer:Wi,isBaseTracer:xc},Symbol.toStringTag,{value:"Module"}));let Ny;const aje=new Uint8Array(16);function sje(){if(!Ny&&(Ny=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ny))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ny(aje)}const oje=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function uje(t){return typeof t=="string"&&oje.test(t)}const qr=[];for(let t=0;t<256;++t)qr.push((t+256).toString(16).slice(1));function lje(t,e=0){return qr[t[e+0]]+qr[t[e+1]]+qr[t[e+2]]+qr[t[e+3]]+"-"+qr[t[e+4]]+qr[t[e+5]]+"-"+qr[t[e+6]]+qr[t[e+7]]+"-"+qr[t[e+8]]+qr[t[e+9]]+"-"+qr[t[e+10]]+qr[t[e+11]]+qr[t[e+12]]+qr[t[e+13]]+qr[t[e+14]]+qr[t[e+15]]}const cje=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),oL={randomUUID:cje};function YE(t,e,r){if(oL.randomUUID&&!e&&!t)return oL.randomUUID();t=t||{};const n=t.random||(t.rng||sje)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let i=0;i<16;++i)e[r+i]=n[i];return e}return lje(n)}var D6={},K_={exports:{}},hje=(t,e)=>(e=e||(()=>{}),t.then(r=>new Promise(n=>{n(e())}).then(()=>r),r=>new Promise(n=>{n(e())}).then(()=>{throw r})));const dje=hje;class L6 extends Error{constructor(e){super(e),this.name="TimeoutError"}}const F6=(t,e,r)=>new Promise((n,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){n(t);return}const a=setTimeout(()=>{if(typeof r=="function"){try{n(r())}catch(u){i(u)}return}const s=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,o=r instanceof Error?r:new L6(s);typeof t.cancel=="function"&&t.cancel(),i(o)},e);dje(t.then(n,i),()=>{clearTimeout(a)})});K_.exports=F6;K_.exports.default=F6;K_.exports.TimeoutError=L6;var fje=K_.exports,_C={},xC={};Object.defineProperty(xC,"__esModule",{value:!0});function pje(t,e,r){let n=0,i=t.length;for(;i>0;){const a=i/2|0;let s=n+a;r(t[s],e)<=0?(n=++s,i-=a+1):i=a}return n}xC.default=pje;Object.defineProperty(_C,"__esModule",{value:!0});const mje=xC;class gje{constructor(){this._queue=[]}enqueue(e,r){r=Object.assign({priority:0},r);const n={priority:r.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=r.priority){this._queue.push(n);return}const i=mje.default(this._queue,n,(a,s)=>s.priority-a.priority);this._queue.splice(i,0,n)}dequeue(){const e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return this._queue.length}}_C.default=gje;Object.defineProperty(D6,"__esModule",{value:!0});const yje=A9,U6=fje,vje=_C,My=()=>{},bje=new U6.TimeoutError;class wje extends yje{constructor(e){var r,n,i,a;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=My,this._resolveIdle=My,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:vje.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(a=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=My,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=My,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const r=this._intervalEnd-e;if(r<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},r)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const r=this._queue.dequeue();return r?(this.emit("active"),r(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,r={}){return new Promise((n,i)=>{const a=async()=>{this._pendingCount++,this._intervalCount++;try{const s=this._timeout===void 0&&r.timeout===void 0?e():U6.default(Promise.resolve(e()),r.timeout===void 0?this._timeout:r.timeout,()=>{(r.throwOnTimeout===void 0?this._throwOnTimeout:r.throwOnTimeout)&&i(bje)});n(await s)}catch(s){i(s)}this._next()};this._queue.enqueue(a,r),this._tryToStartAnother(),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const r=this._resolveEmpty;this._resolveEmpty=()=>{r(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const r=this._resolveIdle;this._resolveIdle=()=>{r(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}var Ws=D6.default=wje;const _je=[400,401,403,404,405,406,407,408],xje=[409];let uL=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,"default"in Ws?this.queue=new Ws.default({concurrency:this.maxConcurrency}):this.queue=new Ws({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e==null?void 0:e.onFailedResponseHook}call(e,...r){const n=this.onFailedResponseHook;return this.queue.add(()=>bw(()=>e(...r).catch(i=>{throw i instanceof Error?i:new Error(i)}),{async onFailedAttempt(i){if(i.message.startsWith("Cancel")||i.message.startsWith("TimeoutError")||i.message.startsWith("AbortError")||(i==null?void 0:i.code)==="ECONNABORTED")throw i;const a=i==null?void 0:i.response,s=a==null?void 0:a.status;if(s){if(_je.includes(+s))throw i;if(xje.includes(+s))return;n&&await n(a)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,r,...n){return e.signal?Promise.race([this.call(r,...n),new Promise((i,a)=>{var s;(s=e.signal)==null||s.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(r,...n)}fetch(...e){return this.call(()=>fetch(...e).then(r=>r.ok?r:Promise.reject(r)))}};function lL(t){return typeof(t==null?void 0:t._getType)=="function"}function cL(t){const e={type:t._getType(),data:{content:t.content}};return t!=null&&t.additional_kwargs&&Object.keys(t.additional_kwargs).length>0&&(e.data.additional_kwargs={...t.additional_kwargs}),e}let Es;const Oje=()=>typeof window<"u"&&typeof window.document<"u",Sje=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",Pje=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),z6=()=>typeof Deno<"u",Eje=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!z6(),Aje=()=>Es||(Oje()?Es="browser":Eje()?Es="node":Sje()?Es="webworker":Pje()?Es="jsdom":z6()?Es="deno":Es="other",Es);let dO;async function B6(){if(dO===void 0){const t=Aje(),e=Cje();dO={library:"langsmith",runtime:t,sdk:"langsmith-js",sdk_version:X6,...e}}return dO}function Tje(){const t=kje()||{},e={},r=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION"];for(const[n,i]of Object.entries(t))n.startsWith("LANGCHAIN_")&&typeof i=="string"&&!r.includes(n)&&!n.toLowerCase().includes("key")&&!n.toLowerCase().includes("secret")&&!n.toLowerCase().includes("token")&&(n==="LANGCHAIN_REVISION_ID"?e.revision_id=i:e[n]=i);return e}function kje(){try{return typeof process<"u"&&process.env?Object.entries(process.env).reduce((t,[e,r])=>(t[e]=String(r),t),{}):void 0}catch{return}}function sl(t){var e;try{return typeof process<"u"?(e=process.env)==null?void 0:e[t]:void 0}catch{return}}function Hu(t){return sl(`LANGSMITH_${t}`)||sl(`LANGCHAIN_${t}`)}let fO;function Cje(){if(fO!==void 0)return fO;const t=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const r of t){const n=sl(r);n!==void 0&&(e[r]=n)}return fO=e,e}function _t(t){if(!uje(t))throw new Error(`Invalid UUID: ${t}`)}const hL={};function q6(t){hL[t]||(console.warn(t),hL[t]=!0)}var JE={exports:{}};const Ije="2.0.0",K6=256,$je=Number.MAX_SAFE_INTEGER||9007199254740991,jje=16,Rje=K6-6,Nje=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var V_={MAX_LENGTH:K6,MAX_SAFE_COMPONENT_LENGTH:jje,MAX_SAFE_BUILD_LENGTH:Rje,MAX_SAFE_INTEGER:$je,RELEASE_TYPES:Nje,SEMVER_SPEC_VERSION:Ije,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const Mje=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};var H_=Mje;(function(t,e){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:i}=V_,a=H_;e=t.exports={};const s=e.re=[],o=e.safeRe=[],u=e.src=[],l=e.t={};let c=0;const h="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",i],[h,n]],f=m=>{for(const[g,v]of d)m=m.split(`${g}*`).join(`${g}{0,${v}}`).split(`${g}+`).join(`${g}{1,${v}}`);return m},p=(m,g,v)=>{const y=f(g),b=c++;a(m,b,g),l[m]=b,u[b]=g,s[b]=new RegExp(g,v?"g":void 0),o[b]=new RegExp(y,v?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),p("MAINVERSION",`(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${u[l.NUMERICIDENTIFIER]}|${u[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${u[l.NUMERICIDENTIFIERLOOSE]}|${u[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${u[l.PRERELEASEIDENTIFIER]}(?:\\.${u[l.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${u[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[l.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${h}+`),p("BUILD",`(?:\\+(${u[l.BUILDIDENTIFIER]}(?:\\.${u[l.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${u[l.MAINVERSION]}${u[l.PRERELEASE]}?${u[l.BUILD]}?`),p("FULL",`^${u[l.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${u[l.MAINVERSIONLOOSE]}${u[l.PRERELEASELOOSE]}?${u[l.BUILD]}?`),p("LOOSE",`^${u[l.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${u[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${u[l.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:${u[l.PRERELEASE]})?${u[l.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:${u[l.PRERELEASELOOSE]})?${u[l.BUILD]}?)?)?`),p("XRANGE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),p("COERCE",`${u[l.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",u[l.COERCEPLAIN]+`(?:${u[l.PRERELEASE]})?(?:${u[l.BUILD]})?(?:$|[^\\d])`),p("COERCERTL",u[l.COERCE],!0),p("COERCERTLFULL",u[l.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${u[l.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",p("TILDE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${u[l.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",p("CARET",`^${u[l.LONECARET]}${u[l.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${u[l.LONECARET]}${u[l.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${u[l.GTLT]}\\s*(${u[l.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]}|${u[l.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${u[l.XRANGEPLAIN]})\\s+-\\s+(${u[l.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${u[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[l.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(JE,JE.exports);var Tg=JE.exports;const Dje=Object.freeze({loose:!0}),Lje=Object.freeze({}),Fje=t=>t?typeof t!="object"?Dje:t:Lje;var OC=Fje;const dL=/^[0-9]+$/,V6=(t,e)=>{const r=dL.test(t),n=dL.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1},Uje=(t,e)=>V6(e,t);var H6={compareIdentifiers:V6,rcompareIdentifiers:Uje};const Dy=H_,{MAX_LENGTH:fL,MAX_SAFE_INTEGER:Ly}=V_,{safeRe:pL,t:mL}=Tg,zje=OC,{compareIdentifiers:fc}=H6;let Bje=class Ma{constructor(e,r){if(r=zje(r),e instanceof Ma){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>fL)throw new TypeError(`version is longer than ${fL} characters`);Dy("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;const n=e.trim().match(r.loose?pL[mL.LOOSE]:pL[mL.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Ly||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Ly||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Ly||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const a=+i;if(a>=0&&a<Ly)return a}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Dy("SemVer.compare",this.version,this.options,e),!(e instanceof Ma)){if(typeof e=="string"&&e===this.version)return 0;e=new Ma(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof Ma||(e=new Ma(e,this.options)),fc(this.major,e.major)||fc(this.minor,e.minor)||fc(this.patch,e.patch)}comparePre(e){if(e instanceof Ma||(e=new Ma(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{const n=this.prerelease[r],i=e.prerelease[r];if(Dy("prerelease compare",r,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return fc(n,i)}while(++r)}compareBuild(e){e instanceof Ma||(e=new Ma(e,this.options));let r=0;do{const n=this.build[r],i=e.build[r];if(Dy("build compare",r,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return fc(n,i)}while(++r)}inc(e,r,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const i=Number(n)?1:0;if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let a=this.prerelease.length;for(;--a>=0;)typeof this.prerelease[a]=="number"&&(this.prerelease[a]++,a=-2);if(a===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(r){let a=[r,i];n===!1&&(a=[r]),fc(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var jn=Bje;const gL=jn,qje=(t,e,r=!1)=>{if(t instanceof gL)return t;try{return new gL(t,e)}catch(n){if(!r)return null;throw n}};var Cd=qje;const Kje=Cd,Vje=(t,e)=>{const r=Kje(t,e);return r?r.version:null};var Hje=Vje;const Wje=Cd,Gje=(t,e)=>{const r=Wje(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};var Yje=Gje;const yL=jn,Jje=(t,e,r,n,i)=>{typeof r=="string"&&(i=n,n=r,r=void 0);try{return new yL(t instanceof yL?t.version:t,r).inc(e,n,i).version}catch{return null}};var Zje=Jje;const vL=Cd,Xje=(t,e)=>{const r=vL(t,null,!0),n=vL(e,null,!0),i=r.compare(n);if(i===0)return null;const a=i>0,s=a?r:n,o=a?n:r,u=!!s.prerelease.length;if(!!o.prerelease.length&&!u)return!o.patch&&!o.minor?"major":s.patch?"patch":s.minor?"minor":"major";const c=u?"pre":"";return r.major!==n.major?c+"major":r.minor!==n.minor?c+"minor":r.patch!==n.patch?c+"patch":"prerelease"};var Qje=Xje;const eRe=jn,tRe=(t,e)=>new eRe(t,e).major;var rRe=tRe;const nRe=jn,iRe=(t,e)=>new nRe(t,e).minor;var aRe=iRe;const sRe=jn,oRe=(t,e)=>new sRe(t,e).patch;var uRe=oRe;const lRe=Cd,cRe=(t,e)=>{const r=lRe(t,e);return r&&r.prerelease.length?r.prerelease:null};var hRe=cRe;const bL=jn,dRe=(t,e,r)=>new bL(t,r).compare(new bL(e,r));var Ia=dRe;const fRe=Ia,pRe=(t,e,r)=>fRe(e,t,r);var mRe=pRe;const gRe=Ia,yRe=(t,e)=>gRe(t,e,!0);var vRe=yRe;const wL=jn,bRe=(t,e,r)=>{const n=new wL(t,r),i=new wL(e,r);return n.compare(i)||n.compareBuild(i)};var SC=bRe;const wRe=SC,_Re=(t,e)=>t.sort((r,n)=>wRe(r,n,e));var xRe=_Re;const ORe=SC,SRe=(t,e)=>t.sort((r,n)=>ORe(n,r,e));var PRe=SRe;const ERe=Ia,ARe=(t,e,r)=>ERe(t,e,r)>0;var W_=ARe;const TRe=Ia,kRe=(t,e,r)=>TRe(t,e,r)<0;var PC=kRe;const CRe=Ia,IRe=(t,e,r)=>CRe(t,e,r)===0;var W6=IRe;const $Re=Ia,jRe=(t,e,r)=>$Re(t,e,r)!==0;var G6=jRe;const RRe=Ia,NRe=(t,e,r)=>RRe(t,e,r)>=0;var EC=NRe;const MRe=Ia,DRe=(t,e,r)=>MRe(t,e,r)<=0;var AC=DRe;const LRe=W6,FRe=G6,URe=W_,zRe=EC,BRe=PC,qRe=AC,KRe=(t,e,r,n)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return LRe(t,r,n);case"!=":return FRe(t,r,n);case">":return URe(t,r,n);case">=":return zRe(t,r,n);case"<":return BRe(t,r,n);case"<=":return qRe(t,r,n);default:throw new TypeError(`Invalid operator: ${e}`)}};var Y6=KRe;const VRe=jn,HRe=Cd,{safeRe:Fy,t:Uy}=Tg,WRe=(t,e)=>{if(t instanceof VRe)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(e.includePrerelease?Fy[Uy.COERCEFULL]:Fy[Uy.COERCE]);else{const u=e.includePrerelease?Fy[Uy.COERCERTLFULL]:Fy[Uy.COERCERTL];let l;for(;(l=u.exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||l.index+l[0].length!==r.index+r[0].length)&&(r=l),u.lastIndex=l.index+l[1].length+l[2].length;u.lastIndex=-1}if(r===null)return null;const n=r[2],i=r[3]||"0",a=r[4]||"0",s=e.includePrerelease&&r[5]?`-${r[5]}`:"",o=e.includePrerelease&&r[6]?`+${r[6]}`:"";return HRe(`${n}.${i}.${a}${s}${o}`,e)};var GRe=WRe;class YRe{constructor(){this.max=1e3,this.map=new Map}get(e){const r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){const i=this.map.keys().next().value;this.delete(i)}this.map.set(e,r)}return this}}var JRe=YRe,pO,_L;function $a(){if(_L)return pO;_L=1;const t=/\s+/g;class e{constructor(L,D){if(D=i(D),L instanceof e)return L.loose===!!D.loose&&L.includePrerelease===!!D.includePrerelease?L:new e(L.raw,D);if(L instanceof a)return this.raw=L.value,this.set=[[L]],this.formatted=void 0,this;if(this.options=D,this.loose=!!D.loose,this.includePrerelease=!!D.includePrerelease,this.raw=L.trim().replace(t," "),this.set=this.raw.split("||").map(q=>this.parseRange(q.trim())).filter(q=>q.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const q=this.set[0];if(this.set=this.set.filter(M=>!m(M[0])),this.set.length===0)this.set=[q];else if(this.set.length>1){for(const M of this.set)if(M.length===1&&g(M[0])){this.set=[M];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let L=0;L<this.set.length;L++){L>0&&(this.formatted+="||");const D=this.set[L];for(let q=0;q<D.length;q++)q>0&&(this.formatted+=" "),this.formatted+=D[q].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(L){const q=((this.options.includePrerelease&&f)|(this.options.loose&&p))+":"+L,M=n.get(q);if(M)return M;const V=this.options.loose,G=V?u[l.HYPHENRANGELOOSE]:u[l.HYPHENRANGE];L=L.replace(G,F(this.options.includePrerelease)),s("hyphen replace",L),L=L.replace(u[l.COMPARATORTRIM],c),s("comparator trim",L),L=L.replace(u[l.TILDETRIM],h),s("tilde trim",L),L=L.replace(u[l.CARETTRIM],d),s("caret trim",L);let re=L.split(" ").map(oe=>y(oe,this.options)).join(" ").split(/\s+/).map(oe=>R(oe,this.options));V&&(re=re.filter(oe=>(s("loose invalid filter",oe,this.options),!!oe.match(u[l.COMPARATORLOOSE])))),s("range list",re);const K=new Map,J=re.map(oe=>new a(oe,this.options));for(const oe of J){if(m(oe))return[oe];K.set(oe.value,oe)}K.size>1&&K.has("")&&K.delete("");const ie=[...K.values()];return n.set(q,ie),ie}intersects(L,D){if(!(L instanceof e))throw new TypeError("a Range is required");return this.set.some(q=>v(q,D)&&L.set.some(M=>v(M,D)&&q.every(V=>M.every(G=>V.intersects(G,D)))))}test(L){if(!L)return!1;if(typeof L=="string")try{L=new o(L,this.options)}catch{return!1}for(let D=0;D<this.set.length;D++)if(z(this.set[D],L,this.options))return!0;return!1}}pO=e;const r=JRe,n=new r,i=OC,a=G_(),s=H_,o=jn,{safeRe:u,t:l,comparatorTrimReplace:c,tildeTrimReplace:h,caretTrimReplace:d}=Tg,{FLAG_INCLUDE_PRERELEASE:f,FLAG_LOOSE:p}=V_,m=N=>N.value==="<0.0.0-0",g=N=>N.value==="",v=(N,L)=>{let D=!0;const q=N.slice();let M=q.pop();for(;D&&q.length;)D=q.every(V=>M.intersects(V,L)),M=q.pop();return D},y=(N,L)=>(s("comp",N,L),N=O(N,L),s("caret",N),N=w(N,L),s("tildes",N),N=x(N,L),s("xrange",N),N=k(N,L),s("stars",N),N),b=N=>!N||N.toLowerCase()==="x"||N==="*",w=(N,L)=>N.trim().split(/\s+/).map(D=>_(D,L)).join(" "),_=(N,L)=>{const D=L.loose?u[l.TILDELOOSE]:u[l.TILDE];return N.replace(D,(q,M,V,G,re)=>{s("tilde",N,q,M,V,G,re);let K;return b(M)?K="":b(V)?K=`>=${M}.0.0 <${+M+1}.0.0-0`:b(G)?K=`>=${M}.${V}.0 <${M}.${+V+1}.0-0`:re?(s("replaceTilde pr",re),K=`>=${M}.${V}.${G}-${re} <${M}.${+V+1}.0-0`):K=`>=${M}.${V}.${G} <${M}.${+V+1}.0-0`,s("tilde return",K),K})},O=(N,L)=>N.trim().split(/\s+/).map(D=>P(D,L)).join(" "),P=(N,L)=>{s("caret",N,L);const D=L.loose?u[l.CARETLOOSE]:u[l.CARET],q=L.includePrerelease?"-0":"";return N.replace(D,(M,V,G,re,K)=>{s("caret",N,M,V,G,re,K);let J;return b(V)?J="":b(G)?J=`>=${V}.0.0${q} <${+V+1}.0.0-0`:b(re)?V==="0"?J=`>=${V}.${G}.0${q} <${V}.${+G+1}.0-0`:J=`>=${V}.${G}.0${q} <${+V+1}.0.0-0`:K?(s("replaceCaret pr",K),V==="0"?G==="0"?J=`>=${V}.${G}.${re}-${K} <${V}.${G}.${+re+1}-0`:J=`>=${V}.${G}.${re}-${K} <${V}.${+G+1}.0-0`:J=`>=${V}.${G}.${re}-${K} <${+V+1}.0.0-0`):(s("no pr"),V==="0"?G==="0"?J=`>=${V}.${G}.${re}${q} <${V}.${G}.${+re+1}-0`:J=`>=${V}.${G}.${re}${q} <${V}.${+G+1}.0-0`:J=`>=${V}.${G}.${re} <${+V+1}.0.0-0`),s("caret return",J),J})},x=(N,L)=>(s("replaceXRanges",N,L),N.split(/\s+/).map(D=>j(D,L)).join(" ")),j=(N,L)=>{N=N.trim();const D=L.loose?u[l.XRANGELOOSE]:u[l.XRANGE];return N.replace(D,(q,M,V,G,re,K)=>{s("xRange",N,q,M,V,G,re,K);const J=b(V),ie=J||b(G),oe=ie||b(re),S=oe;return M==="="&&S&&(M=""),K=L.includePrerelease?"-0":"",J?M===">"||M==="<"?q="<0.0.0-0":q="*":M&&S?(ie&&(G=0),re=0,M===">"?(M=">=",ie?(V=+V+1,G=0,re=0):(G=+G+1,re=0)):M==="<="&&(M="<",ie?V=+V+1:G=+G+1),M==="<"&&(K="-0"),q=`${M+V}.${G}.${re}${K}`):ie?q=`>=${V}.0.0${K} <${+V+1}.0.0-0`:oe&&(q=`>=${V}.${G}.0${K} <${V}.${+G+1}.0-0`),s("xRange return",q),q})},k=(N,L)=>(s("replaceStars",N,L),N.trim().replace(u[l.STAR],"")),R=(N,L)=>(s("replaceGTE0",N,L),N.trim().replace(u[L.includePrerelease?l.GTE0PRE:l.GTE0],"")),F=N=>(L,D,q,M,V,G,re,K,J,ie,oe,S)=>(b(q)?D="":b(M)?D=`>=${q}.0.0${N?"-0":""}`:b(V)?D=`>=${q}.${M}.0${N?"-0":""}`:G?D=`>=${D}`:D=`>=${D}${N?"-0":""}`,b(J)?K="":b(ie)?K=`<${+J+1}.0.0-0`:b(oe)?K=`<${J}.${+ie+1}.0-0`:S?K=`<=${J}.${ie}.${oe}-${S}`:N?K=`<${J}.${ie}.${+oe+1}-0`:K=`<=${K}`,`${D} ${K}`.trim()),z=(N,L,D)=>{for(let q=0;q<N.length;q++)if(!N[q].test(L))return!1;if(L.prerelease.length&&!D.includePrerelease){for(let q=0;q<N.length;q++)if(s(N[q].semver),N[q].semver!==a.ANY&&N[q].semver.prerelease.length>0){const M=N[q].semver;if(M.major===L.major&&M.minor===L.minor&&M.patch===L.patch)return!0}return!1}return!0};return pO}var mO,xL;function G_(){if(xL)return mO;xL=1;const t=Symbol("SemVer ANY");class e{static get ANY(){return t}constructor(c,h){if(h=r(h),c instanceof e){if(c.loose===!!h.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),s("comparator",c,h),this.options=h,this.loose=!!h.loose,this.parse(c),this.semver===t?this.value="":this.value=this.operator+this.semver.version,s("comp",this)}parse(c){const h=this.options.loose?n[i.COMPARATORLOOSE]:n[i.COMPARATOR],d=c.match(h);if(!d)throw new TypeError(`Invalid comparator: ${c}`);this.operator=d[1]!==void 0?d[1]:"",this.operator==="="&&(this.operator=""),d[2]?this.semver=new o(d[2],this.options.loose):this.semver=t}toString(){return this.value}test(c){if(s("Comparator.test",c,this.options.loose),this.semver===t||c===t)return!0;if(typeof c=="string")try{c=new o(c,this.options)}catch{return!1}return a(c,this.operator,this.semver,this.options)}intersects(c,h){if(!(c instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new u(c.value,h).test(this.value):c.operator===""?c.value===""?!0:new u(this.value,h).test(c.semver):(h=r(h),h.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!h.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||a(this.semver,"<",c.semver,h)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||a(this.semver,">",c.semver,h)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}mO=e;const r=OC,{safeRe:n,t:i}=Tg,a=Y6,s=H_,o=jn,u=$a();return mO}const ZRe=$a(),XRe=(t,e,r)=>{try{e=new ZRe(e,r)}catch{return!1}return e.test(t)};var Y_=XRe;const QRe=$a(),eNe=(t,e)=>new QRe(t,e).set.map(r=>r.map(n=>n.value).join(" ").trim().split(" "));var tNe=eNe;const rNe=jn,nNe=$a(),iNe=(t,e,r)=>{let n=null,i=null,a=null;try{a=new nNe(e,r)}catch{return null}return t.forEach(s=>{a.test(s)&&(!n||i.compare(s)===-1)&&(n=s,i=new rNe(n,r))}),n};var aNe=iNe;const sNe=jn,oNe=$a(),uNe=(t,e,r)=>{let n=null,i=null,a=null;try{a=new oNe(e,r)}catch{return null}return t.forEach(s=>{a.test(s)&&(!n||i.compare(s)===1)&&(n=s,i=new sNe(n,r))}),n};var lNe=uNe;const gO=jn,cNe=$a(),OL=W_,hNe=(t,e)=>{t=new cNe(t,e);let r=new gO("0.0.0");if(t.test(r)||(r=new gO("0.0.0-0"),t.test(r)))return r;r=null;for(let n=0;n<t.set.length;++n){const i=t.set[n];let a=null;i.forEach(s=>{const o=new gO(s.semver.version);switch(s.operator){case">":o.prerelease.length===0?o.patch++:o.prerelease.push(0),o.raw=o.format();case"":case">=":(!a||OL(o,a))&&(a=o);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${s.operator}`)}}),a&&(!r||OL(r,a))&&(r=a)}return r&&t.test(r)?r:null};var dNe=hNe;const fNe=$a(),pNe=(t,e)=>{try{return new fNe(t,e).range||"*"}catch{return null}};var mNe=pNe;const gNe=jn,J6=G_(),{ANY:yNe}=J6,vNe=$a(),bNe=Y_,SL=W_,PL=PC,wNe=AC,_Ne=EC,xNe=(t,e,r,n)=>{t=new gNe(t,n),e=new vNe(e,n);let i,a,s,o,u;switch(r){case">":i=SL,a=wNe,s=PL,o=">",u=">=";break;case"<":i=PL,a=_Ne,s=SL,o="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(bNe(t,e,n))return!1;for(let l=0;l<e.set.length;++l){const c=e.set[l];let h=null,d=null;if(c.forEach(f=>{f.semver===yNe&&(f=new J6(">=0.0.0")),h=h||f,d=d||f,i(f.semver,h.semver,n)?h=f:s(f.semver,d.semver,n)&&(d=f)}),h.operator===o||h.operator===u||(!d.operator||d.operator===o)&&a(t,d.semver))return!1;if(d.operator===u&&s(t,d.semver))return!1}return!0};var TC=xNe;const ONe=TC,SNe=(t,e,r)=>ONe(t,e,">",r);var PNe=SNe;const ENe=TC,ANe=(t,e,r)=>ENe(t,e,"<",r);var TNe=ANe;const EL=$a(),kNe=(t,e,r)=>(t=new EL(t,r),e=new EL(e,r),t.intersects(e,r));var CNe=kNe;const INe=Y_,$Ne=Ia;var jNe=(t,e,r)=>{const n=[];let i=null,a=null;const s=t.sort((c,h)=>$Ne(c,h,r));for(const c of s)INe(c,e,r)?(a=c,i||(i=c)):(a&&n.push([i,a]),a=null,i=null);i&&n.push([i,null]);const o=[];for(const[c,h]of n)c===h?o.push(c):!h&&c===s[0]?o.push("*"):h?c===s[0]?o.push(`<=${h}`):o.push(`${c} - ${h}`):o.push(`>=${c}`);const u=o.join(" || "),l=typeof e.raw=="string"?e.raw:String(e);return u.length<l.length?u:e};const AL=$a(),kC=G_(),{ANY:yO}=kC,Ef=Y_,CC=Ia,RNe=(t,e,r={})=>{if(t===e)return!0;t=new AL(t,r),e=new AL(e,r);let n=!1;e:for(const i of t.set){for(const a of e.set){const s=MNe(i,a,r);if(n=n||s!==null,s)continue e}if(n)return!1}return!0},NNe=[new kC(">=0.0.0-0")],TL=[new kC(">=0.0.0")],MNe=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===yO){if(e.length===1&&e[0].semver===yO)return!0;r.includePrerelease?t=NNe:t=TL}if(e.length===1&&e[0].semver===yO){if(r.includePrerelease)return!0;e=TL}const n=new Set;let i,a;for(const f of t)f.operator===">"||f.operator===">="?i=kL(i,f,r):f.operator==="<"||f.operator==="<="?a=CL(a,f,r):n.add(f.semver);if(n.size>1)return null;let s;if(i&&a){if(s=CC(i.semver,a.semver,r),s>0)return null;if(s===0&&(i.operator!==">="||a.operator!=="<="))return null}for(const f of n){if(i&&!Ef(f,String(i),r)||a&&!Ef(f,String(a),r))return null;for(const p of e)if(!Ef(f,String(p),r))return!1;return!0}let o,u,l,c,h=a&&!r.includePrerelease&&a.semver.prerelease.length?a.semver:!1,d=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1;h&&h.prerelease.length===1&&a.operator==="<"&&h.prerelease[0]===0&&(h=!1);for(const f of e){if(c=c||f.operator===">"||f.operator===">=",l=l||f.operator==="<"||f.operator==="<=",i){if(d&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===d.major&&f.semver.minor===d.minor&&f.semver.patch===d.patch&&(d=!1),f.operator===">"||f.operator===">="){if(o=kL(i,f,r),o===f&&o!==i)return!1}else if(i.operator===">="&&!Ef(i.semver,String(f),r))return!1}if(a){if(h&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===h.major&&f.semver.minor===h.minor&&f.semver.patch===h.patch&&(h=!1),f.operator==="<"||f.operator==="<="){if(u=CL(a,f,r),u===f&&u!==a)return!1}else if(a.operator==="<="&&!Ef(a.semver,String(f),r))return!1}if(!f.operator&&(a||i)&&s!==0)return!1}return!(i&&l&&!a&&s!==0||a&&c&&!i&&s!==0||d||h)},kL=(t,e,r)=>{if(!t)return e;const n=CC(t.semver,e.semver,r);return n>0?t:n<0||e.operator===">"&&t.operator===">="?e:t},CL=(t,e,r)=>{if(!t)return e;const n=CC(t.semver,e.semver,r);return n<0?t:n>0||e.operator==="<"&&t.operator==="<="?e:t};var DNe=RNe;const vO=Tg,IL=V_,LNe=jn,$L=H6,FNe=Cd,UNe=Hje,zNe=Yje,BNe=Zje,qNe=Qje,KNe=rRe,VNe=aRe,HNe=uRe,WNe=hRe,GNe=Ia,YNe=mRe,JNe=vRe,ZNe=SC,XNe=xRe,QNe=PRe,e2e=W_,t2e=PC,r2e=W6,n2e=G6,i2e=EC,a2e=AC,s2e=Y6,o2e=GRe,u2e=G_(),l2e=$a(),c2e=Y_,h2e=tNe,d2e=aNe,f2e=lNe,p2e=dNe,m2e=mNe,g2e=TC,y2e=PNe,v2e=TNe,b2e=CNe,w2e=jNe,_2e=DNe;var jL={parse:FNe,valid:UNe,clean:zNe,inc:BNe,diff:qNe,major:KNe,minor:VNe,patch:HNe,prerelease:WNe,compare:GNe,rcompare:YNe,compareLoose:JNe,compareBuild:ZNe,sort:XNe,rsort:QNe,gt:e2e,lt:t2e,eq:r2e,neq:n2e,gte:i2e,lte:a2e,cmp:s2e,coerce:o2e,Comparator:u2e,Range:l2e,satisfies:c2e,toComparators:h2e,maxSatisfying:d2e,minSatisfying:f2e,minVersion:p2e,validRange:m2e,outside:g2e,gtr:y2e,ltr:v2e,intersects:b2e,simplifyRange:w2e,subset:_2e,SemVer:LNe,re:vO.re,src:vO.src,tokens:vO.t,SEMVER_SPEC_VERSION:IL.SEMVER_SPEC_VERSION,RELEASE_TYPES:IL.RELEASE_TYPES,compareIdentifiers:$L.compareIdentifiers,rcompareIdentifiers:$L.rcompareIdentifiers};function x2e(t,e){const r=jL.parse(t),n=jL.parse(e);if(!r||!n)throw new Error("Invalid version format.");return r.compare(n)>=0}function So(t){if(!t||t.split("/").length>2||t.startsWith("/")||t.endsWith("/")||t.split(":").length>2)throw new Error(`Invalid identifier format: ${t}`);const[e,r]=t.split(":"),n=r||"latest";if(e.includes("/")){const[i,a]=e.split("/",2);if(!i||!a)throw new Error(`Invalid identifier format: ${t}`);return[i,a,n]}else{if(!e)throw new Error(`Invalid identifier format: ${t}`);return["-",e,n]}}async function RL(t){const e=await B6(),r=Tje();return t.map(n=>{const i=n.extra??{},a=i.metadata;return n.extra={...i,runtime:{...e,...i==null?void 0:i.runtime},metadata:{...r,...r.revision_id||n.revision_id?{revision_id:n.revision_id??r.revision_id}:{},...a}},n})}const O2e=()=>{const t=Hu("TRACING_SAMPLING_RATE");if(t===void 0)return;const e=parseFloat(t);if(e<0||e>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${e}`);return e},S2e=t=>{const r=t.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return r==="localhost"||r==="127.0.0.1"||r==="::1"},As=async(t,e)=>{const r=await t.text();if(!t.ok)throw new Error(`Failed to ${e}: ${t.status} ${t.statusText} ${r}`)};async function P2e(t){const e=[];for await(const r of t)e.push(r);return e}function bO(t){if(t!==void 0)return t.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const E2e=async t=>{if((t==null?void 0:t.status)===429){const e=parseInt(t.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(r=>setTimeout(r,e)),!0}return!1};class A2e{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]})}get size(){return this.items.length}push(e){return new Promise(r=>{this.items.push([e,r])})}pop(e){if(e<1)throw new Error("Number of items to pop off may not be less than 1.");const r=[];for(;r.length<e&&this.items.length;){const n=this.items.shift();if(n)r.push(n);else break}return[r.map(n=>n[0]),()=>r.forEach(n=>n[1]())]}}const T2e=20971520;class Id{constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sampledPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"batchEndpointSupported",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new A2e}),Object.defineProperty(this,"pendingAutoBatchedRunLimit",{enumerable:!0,configurable:!0,writable:!0,value:100}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchInitialDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const r=Id.getDefaultClientConfig();this.tracingSampleRate=O2e(),this.apiUrl=bO(e.apiUrl??r.apiUrl)??"",this.apiKey=bO(e.apiKey??r.apiKey),this.webUrl=bO(e.webUrl??r.webUrl),this.timeout_ms=e.timeout_ms??12e3,this.caller=new uL(e.callerOptions??{}),this.batchIngestCaller=new uL({...e.callerOptions??{},onFailedResponseHook:E2e}),this.hideInputs=e.hideInputs??e.anonymizer??r.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??r.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.pendingAutoBatchedRunLimit=e.pendingAutoBatchedRunLimit??this.pendingAutoBatchedRunLimit,this.fetchOptions=e.fetchOptions||{}}static getDefaultClientConfig(){const e=Hu("API_KEY"),r=Hu("ENDPOINT")??"https://api.smith.langchain.com",n=Hu("HIDE_INPUTS")==="true",i=Hu("HIDE_OUTPUTS")==="true";return{apiUrl:r,apiKey:e,webUrl:void 0,hideInputs:n,hideOutputs:i}}getHostUrl(){return this.webUrl?this.webUrl:S2e(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${X6}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}prepareRunCreateOrUpdateInputs(e){const r={...e};return r.inputs!==void 0&&(r.inputs=this.processInputs(r.inputs)),r.outputs!==void 0&&(r.outputs=this.processOutputs(r.outputs)),r}async _getResponse(e,r){const n=(r==null?void 0:r.toString())??"",i=`${this.apiUrl}${e}?${n}`,a=await this.caller.call(fetch,i,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!a.ok)throw new Error(`Failed to fetch ${e}: ${a.status} ${a.statusText}`);return a}async _get(e,r){return(await this._getResponse(e,r)).json()}async*_getPaginated(e,r=new URLSearchParams,n){let i=Number(r.get("offset"))||0;const a=Number(r.get("limit"))||100;for(;;){r.set("offset",String(i)),r.set("limit",String(a));const s=`${this.apiUrl}${e}?${r}`,o=await this.caller.call(fetch,s,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!o.ok)throw new Error(`Failed to fetch ${e}: ${o.status} ${o.statusText}`);const u=n?n(await o.json()):await o.json();if(u.length===0||(yield u,u.length<a))break;i+=u.length}}async*_getCursorPaginatedList(e,r=null,n="POST",i="runs"){const a=r?{...r}:{};for(;;){const o=await(await this.caller.call(fetch,`${this.apiUrl}${e}`,{method:n,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(a)})).json();if(!o||!o[i])break;yield o[i];const u=o.cursors;if(!u||!u.next)break;a.cursor=u.next}}_filterForSampling(e,r=!1){if(this.tracingSampleRate===void 0)return e;if(r){const n=[];for(const i of e)this.sampledPostUuids.has(i.id)&&(n.push(i),this.sampledPostUuids.delete(i.id));return n}else{const n=[];for(const i of e)Math.random()<this.tracingSampleRate&&(n.push(i),this.sampledPostUuids.add(i.id));return n}}async drainAutoBatchQueue(){for(;this.autoBatchQueue.size>=0;){const[e,r]=this.autoBatchQueue.pop(this.pendingAutoBatchedRunLimit);if(!e.length){r();return}try{await this.batchIngestRuns({runCreates:e.filter(n=>n.action==="create").map(n=>n.item),runUpdates:e.filter(n=>n.action==="update").map(n=>n.item)})}finally{r()}}}async processRunOperation(e,r){const n=this.autoBatchTimeout;clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0;const i=this.autoBatchQueue.push(e);return(r||this.autoBatchQueue.size>this.pendingAutoBatchedRunLimit)&&await this.drainAutoBatchQueue(),this.autoBatchQueue.size>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue().catch(console.error)},n?this.autoBatchAggregationDelayMs:this.autoBatchInitialDelayMs)),i}async _getServerInfo(){const e=await fetch(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!e.ok)throw await e.text(),new Error("Failed to retrieve server info.");return e.json()}async batchEndpointIsSupported(){try{this.serverInfo=await this._getServerInfo()}catch{return!1}return!0}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async createRun(e){if(!this._filterForSampling([e]).length)return;const r={...this.headers,"Content-Type":"application/json"},n=e.project_name;delete e.project_name;const i=this.prepareRunCreateOrUpdateInputs({session_name:n,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&i.trace_id!==void 0&&i.dotted_order!==void 0){this.processRunOperation({action:"create",item:i}).catch(console.error);return}const a=await RL([i]),s=await this.caller.call(fetch,`${this.apiUrl}/runs`,{method:"POST",headers:r,body:JSON.stringify(a[0]),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await As(s,"create run")}async batchIngestRuns({runCreates:e,runUpdates:r}){var l,c;if(e===void 0&&r===void 0)return;let n=(e==null?void 0:e.map(h=>this.prepareRunCreateOrUpdateInputs(h)))??[],i=(r==null?void 0:r.map(h=>this.prepareRunCreateOrUpdateInputs(h)))??[];if(n.length>0&&i.length>0){const h=n.reduce((f,p)=>(p.id&&(f[p.id]=p),f),{}),d=[];for(const f of i)f.id!==void 0&&h[f.id]?h[f.id]={...h[f.id],...f}:d.push(f);n=Object.values(h),i=d}const a={post:this._filterForSampling(n),patch:this._filterForSampling(i,!0)};if(!a.post.length&&!a.patch.length)return;if(n=await RL(n),this.batchEndpointSupported===void 0&&(this.batchEndpointSupported=await this.batchEndpointIsSupported()),!this.batchEndpointSupported){this.autoBatchTracing=!1;for(const h of a.post)await this.createRun(h);for(const h of a.patch)h.id!==void 0&&await this.updateRun(h.id,h);return}const s=((c=(l=this.serverInfo)==null?void 0:l.batch_ingest_config)==null?void 0:c.size_limit_bytes)??T2e,o={post:[],patch:[]};let u=0;for(const h of["post","patch"]){const d=h,f=a[d].reverse();let p=f.pop();for(;p!==void 0;){const m=JSON.stringify(p);u>0&&u+m.length>s&&(await this._postBatchIngestRuns(JSON.stringify(o)),u=0,o.post=[],o.patch=[]),u+=m.length,o[d].push(p),p=f.pop()}}(o.post.length>0||o.patch.length>0)&&await this._postBatchIngestRuns(JSON.stringify(o))}async _postBatchIngestRuns(e){const r={...this.headers,"Content-Type":"application/json",Accept:"application/json"},n=await this.batchIngestCaller.call(fetch,`${this.apiUrl}/runs/batch`,{method:"POST",headers:r,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await As(n,"batch create run")}async updateRun(e,r){_t(e),r.inputs&&(r.inputs=this.processInputs(r.inputs)),r.outputs&&(r.outputs=this.processOutputs(r.outputs));const n={...r,id:e};if(!this._filterForSampling([n],!0).length)return;if(this.autoBatchTracing&&n.trace_id!==void 0&&n.dotted_order!==void 0){if(r.end_time!==void 0&&n.parent_run_id===void 0){await this.processRunOperation({action:"update",item:n},!0);return}else this.processRunOperation({action:"update",item:n}).catch(console.error);return}const i={...this.headers,"Content-Type":"application/json"},a=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:i,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await As(a,"update run")}async readRun(e,{loadChildRuns:r}={loadChildRuns:!1}){_t(e);let n=await this._get(`/runs/${e}`);return r&&n.child_run_ids&&(n=await this._loadChildRuns(n)),n}async getRunUrl({runId:e,run:r,projectOpts:n}){if(r!==void 0){let i;r.session_id?i=r.session_id:n!=null&&n.projectName?i=(await this.readProject({projectName:n==null?void 0:n.projectName})).id:n!=null&&n.projectId?i=n==null?void 0:n.projectId:i=(await this.readProject({projectName:Hu("PROJECT")||"default"})).id;const a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/projects/p/${i}/r/${r.id}?poll=true`}else if(e!==void 0){const i=await this.readRun(e);if(!i.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${i.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const r=await P2e(this.listRuns({id:e.child_run_ids})),n={},i={};r.sort((a,s)=>((a==null?void 0:a.dotted_order)??"").localeCompare((s==null?void 0:s.dotted_order)??""));for(const a of r){if(a.parent_run_id===null||a.parent_run_id===void 0)throw new Error(`Child run ${a.id} has no parent`);a.parent_run_id in n||(n[a.parent_run_id]=[]),n[a.parent_run_id].push(a),i[a.id]=a}e.child_runs=n[e.id]||[];for(const a in n)a!==e.id&&(i[a].child_runs=n[a]);return e}async*listRuns(e){const{projectId:r,projectName:n,parentRunId:i,traceId:a,referenceExampleId:s,startTime:o,executionOrder:u,isRoot:l,runType:c,error:h,id:d,query:f,filter:p,traceFilter:m,treeFilter:g,limit:v,select:y}=e;let b=[];if(r&&(b=Array.isArray(r)?r:[r]),n){const P=Array.isArray(n)?n:[n],x=await Promise.all(P.map(j=>this.readProject({projectName:j}).then(k=>k.id)));b.push(...x)}const w=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],_={session:b.length?b:null,run_type:c,reference_example:s,query:f,filter:p,trace_filter:m,tree_filter:g,execution_order:u,parent_run:i,start_time:o?o.toISOString():null,error:h,id:d,limit:v,trace:a,select:y||w,is_root:l};let O=0;for await(const P of this._getCursorPaginatedList("/runs/query",_))if(v){if(O>=v)break;if(P.length+O>v){yield*P.slice(0,v-O);break}O+=P.length,yield*P}else yield*P}async getRunStats({id:e,trace:r,parentRun:n,runType:i,projectNames:a,projectIds:s,referenceExampleIds:o,startTime:u,endTime:l,error:c,query:h,filter:d,traceFilter:f,treeFilter:p,isRoot:m,dataSourceType:g}){let v=s||[];a&&(v=[...s||[],...await Promise.all(a.map(O=>this.readProject({projectName:O}).then(P=>P.id)))]);const b=Object.fromEntries(Object.entries({id:e,trace:r,parent_run:n,run_type:i,session:v,reference_example:o,start_time:u,end_time:l,error:c,query:h,filter:d,trace_filter:f,tree_filter:p,is_root:m,data_source_type:g}).filter(([O,P])=>P!==void 0));return await(await this.caller.call(fetch,`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(b),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async shareRun(e,{shareId:r}={}){const n={run_id:e,share_token:r||YE()};_t(e);const a=await(await this.caller.call(fetch,`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(a===null||!("share_token"in a))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${a.share_token}/r`}async unshareRun(e){_t(e);const r=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await As(r,"unshare run")}async readRunSharedLink(e){_t(e);const n=await(await this.caller.call(fetch,`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(n===null||!("share_token"in n)))return`${this.getHostUrl()}/public/${n.share_token}/r`}async listSharedRuns(e,{runIds:r}={}){const n=new URLSearchParams({share_token:e});if(r!==void 0)for(const s of r)n.append("id",s);return _t(e),await(await this.caller.call(fetch,`${this.apiUrl}/public/${e}/runs${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,r){if(!e&&!r)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:r})).id),_t(e);const i=await(await this.caller.call(fetch,`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return i.url=`${this.getHostUrl()}/public/${i.share_token}/d`,i}async shareDataset(e,r){if(!e&&!r)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:r})).id);const n={dataset_id:e};_t(e);const a=await(await this.caller.call(fetch,`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return a.url=`${this.getHostUrl()}/public/${a.share_token}/d`,a}async unshareDataset(e){_t(e);const r=await this.caller.call(fetch,`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await As(r,"unshare dataset")}async readSharedDataset(e){return _t(e),await(await this.caller.call(fetch,`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createProject({projectName:e,description:r=null,metadata:n=null,upsert:i=!1,projectExtra:a=null,referenceDatasetId:s=null}){const o=i?"?upsert=true":"",u=`${this.apiUrl}/sessions${o}`,l=a||{};n&&(l.metadata=n);const c={name:e,extra:l,description:r};s!==null&&(c.reference_dataset_id=s);const h=await this.caller.call(fetch,u,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),d=await h.json();if(!h.ok)throw new Error(`Failed to create session ${e}: ${h.status} ${h.statusText}`);return d}async updateProject(e,{name:r=null,description:n=null,metadata:i=null,projectExtra:a=null,endTime:s=null}){const o=`${this.apiUrl}/sessions/${e}`;let u=a;i&&(u={...u||{},metadata:i});const l={name:r,extra:u,description:n,end_time:s?new Date(s).toISOString():null},c=await this.caller.call(fetch,o,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),h=await c.json();if(!c.ok)throw new Error(`Failed to update project ${e}: ${c.status} ${c.statusText}`);return h}async hasProject({projectId:e,projectName:r}){let n="/sessions";const i=new URLSearchParams;if(e!==void 0&&r!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)_t(e),n+=`/${e}`;else if(r!==void 0)i.append("name",r);else throw new Error("Must provide projectName or projectId");const a=await this.caller.call(fetch,`${this.apiUrl}${n}?${i}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const s=await a.json();return a.ok?Array.isArray(s)?s.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:r,includeStats:n}){let i="/sessions";const a=new URLSearchParams;if(e!==void 0&&r!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)_t(e),i+=`/${e}`;else if(r!==void 0)a.append("name",r);else throw new Error("Must provide projectName or projectId");n!==void 0&&a.append("include_stats",n.toString());const s=await this._get(i,a);let o;if(Array.isArray(s)){if(s.length===0)throw new Error(`Project[id=${e}, name=${r}] not found`);o=s[0]}else o=s;return o}async getProjectUrl({projectId:e,projectName:r}){if(e===void 0&&r===void 0)throw new Error("Must provide either projectName or projectId");const n=await this.readProject({projectId:e,projectName:r}),i=await this._getTenantId();return`${this.getHostUrl()}/o/${i}/projects/p/${n.id}`}async getDatasetUrl({datasetId:e,datasetName:r}){if(e===void 0&&r===void 0)throw new Error("Must provide either datasetName or datasetId");const n=await this.readDataset({datasetId:e,datasetName:r}),i=await this._getTenantId();return`${this.getHostUrl()}/o/${i}/datasets/${n.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const r of this._getPaginated("/sessions",e))return this._tenantId=r[0].tenant_id,r[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:r,nameContains:n,referenceDatasetId:i,referenceDatasetName:a,referenceFree:s,metadata:o}={}){const u=new URLSearchParams;if(e!==void 0)for(const l of e)u.append("id",l);if(r!==void 0&&u.append("name",r),n!==void 0&&u.append("name_contains",n),i!==void 0)u.append("reference_dataset",i);else if(a!==void 0){const l=await this.readDataset({datasetName:a});u.append("reference_dataset",l.id)}s!==void 0&&u.append("reference_free",s.toString()),o!==void 0&&u.append("metadata",JSON.stringify(o));for await(const l of this._getPaginated("/sessions",u))yield*l}async deleteProject({projectId:e,projectName:r}){let n;if(e===void 0&&r===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&r!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?n=(await this.readProject({projectName:r})).id:n=e,_t(n);const i=await this.caller.call(fetch,`${this.apiUrl}/sessions/${n}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await As(i,`delete session ${n} (${r})`)}async uploadCsv({csvFile:e,fileName:r,inputKeys:n,outputKeys:i,description:a,dataType:s,name:o}){const u=`${this.apiUrl}/datasets/upload`,l=new FormData;l.append("file",e,r),n.forEach(d=>{l.append("input_keys",d)}),i.forEach(d=>{l.append("output_keys",d)}),a&&l.append("description",a),s&&l.append("data_type",s),o&&l.append("name",o);const c=await this.caller.call(fetch,u,{method:"POST",headers:this.headers,body:l,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!c.ok){const d=await c.json();throw d.detail&&d.detail.includes("already exists")?new Error(`Dataset ${r} already exists`):new Error(`Failed to upload CSV: ${c.status} ${c.statusText}`)}return await c.json()}async createDataset(e,{description:r,dataType:n}={}){const i={name:e,description:r};n&&(i.data_type=n);const a=await this.caller.call(fetch,`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!a.ok){const o=await a.json();throw o.detail&&o.detail.includes("already exists")?new Error(`Dataset ${e} already exists`):new Error(`Failed to create dataset ${a.status} ${a.statusText}`)}return await a.json()}async readDataset({datasetId:e,datasetName:r}){let n="/datasets";const i=new URLSearchParams({limit:"1"});if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)_t(e),n+=`/${e}`;else if(r!==void 0)i.append("name",r);else throw new Error("Must provide datasetName or datasetId");const a=await this._get(n,i);let s;if(Array.isArray(a)){if(a.length===0)throw new Error(`Dataset[id=${e}, name=${r}] not found`);s=a[0]}else s=a;return s}async hasDataset({datasetId:e,datasetName:r}){try{return await this.readDataset({datasetId:e,datasetName:r}),!0}catch(n){if(n instanceof Error&&n.message.toLocaleLowerCase().includes("not found"))return!1;throw n}}async diffDatasetVersions({datasetId:e,datasetName:r,fromVersion:n,toVersion:i}){let a=e;if(a===void 0&&r===void 0)throw new Error("Must provide either datasetName or datasetId");if(a!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");a===void 0&&(a=(await this.readDataset({datasetName:r})).id);const s=new URLSearchParams({from_version:typeof n=="string"?n:n.toISOString(),to_version:typeof i=="string"?i:i.toISOString()});return await this._get(`/datasets/${a}/versions/diff`,s)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:r}){const n="/datasets";if(e===void 0)if(r!==void 0)e=(await this.readDataset({datasetName:r})).id;else throw new Error("Must provide datasetName or datasetId");return(await(await this._getResponse(`${n}/${e}/openai_ft`)).text()).trim().split(`
`).map(o=>JSON.parse(o))}async*listDatasets({limit:e=100,offset:r=0,datasetIds:n,datasetName:i,datasetNameContains:a}={}){const s="/datasets",o=new URLSearchParams({limit:e.toString(),offset:r.toString()});if(n!==void 0)for(const u of n)o.append("id",u);i!==void 0&&o.append("name",i),a!==void 0&&o.append("name_contains",a);for await(const u of this._getPaginated(s,o))yield*u}async updateDataset(e){const{datasetId:r,datasetName:n,...i}=e;if(!r&&!n)throw new Error("Must provide either datasetName or datasetId");const a=r??(await this.readDataset({datasetName:n})).id;_t(a);const s=await this.caller.call(fetch,`${this.apiUrl}/datasets/${a}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!s.ok)throw new Error(`Failed to update dataset ${a}: ${s.status} ${s.statusText}`);return await s.json()}async deleteDataset({datasetId:e,datasetName:r}){let n="/datasets",i=e;if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(r!==void 0&&(i=(await this.readDataset({datasetName:r})).id),i!==void 0)_t(i),n+=`/${i}`;else throw new Error("Must provide datasetName or datasetId");const a=await this.caller.call(fetch,this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!a.ok)throw new Error(`Failed to delete ${n}: ${a.status} ${a.statusText}`);await a.json()}async createExample(e,r,{datasetId:n,datasetName:i,createdAt:a,exampleId:s,metadata:o,split:u}){let l=n;if(l===void 0&&i===void 0)throw new Error("Must provide either datasetName or datasetId");if(l!==void 0&&i!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");l===void 0&&(l=(await this.readDataset({datasetName:i})).id);const c=a||new Date,h={dataset_id:l,inputs:e,outputs:r,created_at:c==null?void 0:c.toISOString(),id:s,metadata:o,split:u},d=await this.caller.call(fetch,`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(h),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!d.ok)throw new Error(`Failed to create example: ${d.status} ${d.statusText}`);return await d.json()}async createExamples(e){const{inputs:r,outputs:n,metadata:i,sourceRunIds:a,exampleIds:s,datasetId:o,datasetName:u}=e;let l=o;if(l===void 0&&u===void 0)throw new Error("Must provide either datasetName or datasetId");if(l!==void 0&&u!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");l===void 0&&(l=(await this.readDataset({datasetName:u})).id);const c=r.map((f,p)=>({dataset_id:l,inputs:f,outputs:n?n[p]:void 0,metadata:i?i[p]:void 0,split:e.splits?e.splits[p]:void 0,id:s?s[p]:void 0,source_run_id:a?a[p]:void 0})),h=await this.caller.call(fetch,`${this.apiUrl}/examples/bulk`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!h.ok)throw new Error(`Failed to create examples: ${h.status} ${h.statusText}`);return await h.json()}async createLLMExample(e,r,n){return this.createExample({input:e},{output:r},n)}async createChatExample(e,r,n){const i=e.map(s=>lL(s)?cL(s):s),a=lL(r)?cL(r):r;return this.createExample({input:i},{output:a},n)}async readExample(e){_t(e);const r=`/examples/${e}`;return await this._get(r)}async*listExamples({datasetId:e,datasetName:r,exampleIds:n,asOf:i,splits:a,inlineS3Urls:s,metadata:o,limit:u,offset:l,filter:c}={}){let h;if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)h=e;else if(r!==void 0)h=(await this.readDataset({datasetName:r})).id;else throw new Error("Must provide a datasetName or datasetId");const d=new URLSearchParams({dataset:h}),f=i?typeof i=="string"?i:i==null?void 0:i.toISOString():void 0;f&&d.append("as_of",f);const p=s??!0;if(d.append("inline_s3_urls",p.toString()),n!==void 0)for(const g of n)d.append("id",g);if(a!==void 0)for(const g of a)d.append("splits",g);if(o!==void 0){const g=JSON.stringify(o);d.append("metadata",g)}u!==void 0&&d.append("limit",u.toString()),l!==void 0&&d.append("offset",l.toString()),c!==void 0&&d.append("filter",c);let m=0;for await(const g of this._getPaginated("/examples",d)){for(const v of g)yield v,m++;if(u!==void 0&&m>=u)break}}async deleteExample(e){_t(e);const r=`/examples/${e}`,n=await this.caller.call(fetch,this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!n.ok)throw new Error(`Failed to delete ${r}: ${n.status} ${n.statusText}`);await n.json()}async updateExample(e,r){_t(e);const n=await this.caller.call(fetch,`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!n.ok)throw new Error(`Failed to update example ${e}: ${n.status} ${n.statusText}`);return await n.json()}async updateExamples(e){const r=await this.caller.call(fetch,`${this.apiUrl}/examples/bulk`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(e),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!r.ok)throw new Error(`Failed to update examples: ${r.status} ${r.statusText}`);return await r.json()}async listDatasetSplits({datasetId:e,datasetName:r,asOf:n}){let i;if(e===void 0&&r===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?i=(await this.readDataset({datasetName:r})).id:i=e,_t(i);const a=new URLSearchParams,s=n?typeof n=="string"?n:n==null?void 0:n.toISOString():void 0;return s&&a.append("as_of",s),await this._get(`/datasets/${i}/splits`,a)}async updateDatasetSplits({datasetId:e,datasetName:r,splitName:n,exampleIds:i,remove:a=!1}){let s;if(e===void 0&&r===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?s=(await this.readDataset({datasetName:r})).id:s=e,_t(s);const o={split_name:n,examples:i.map(l=>(_t(l),l)),remove:a},u=await this.caller.call(fetch,`${this.apiUrl}/datasets/${s}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await As(u,"update dataset splits")}async evaluateRun(e,r,{sourceInfo:n,loadChildRuns:i,referenceExample:a}={loadChildRuns:!1}){q6("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let s;if(typeof e=="string")s=await this.readRun(e,{loadChildRuns:i});else if(typeof e=="object"&&"id"in e)s=e;else throw new Error(`Invalid run type: ${typeof e}`);s.reference_example_id!==null&&s.reference_example_id!==void 0&&(a=await this.readExample(s.reference_example_id));const o=await r.evaluateRun(s,a),[u,l]=await this._logEvaluationFeedback(o,s,n);return l[0]}async createFeedback(e,r,{score:n,value:i,correction:a,comment:s,sourceInfo:o,feedbackSourceType:u="api",sourceRunId:l,feedbackId:c,feedbackConfig:h,projectId:d,comparativeExperimentId:f}){var y;if(!e&&!d)throw new Error("One of runId or projectId must be provided");if(e&&d)throw new Error("Only one of runId or projectId can be provided");const p={type:u??"api",metadata:o??{}};l!==void 0&&(p==null?void 0:p.metadata)!==void 0&&!p.metadata.__run&&(p.metadata.__run={run_id:l}),(p==null?void 0:p.metadata)!==void 0&&((y=p.metadata.__run)==null?void 0:y.run_id)!==void 0&&_t(p.metadata.__run.run_id);const m={id:c??YE(),run_id:e,key:r,score:n,value:i,correction:a,comment:s,feedback_source:p,comparative_experiment_id:f,feedbackConfig:h,session_id:d},g=`${this.apiUrl}/feedback`,v=await this.caller.call(fetch,g,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(m),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await As(v,"create feedback"),m}async updateFeedback(e,{score:r,value:n,correction:i,comment:a}){const s={};r!=null&&(s.score=r),n!=null&&(s.value=n),i!=null&&(s.correction=i),a!=null&&(s.comment=a),_t(e);const o=await this.caller.call(fetch,`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await As(o,"update feedback")}async readFeedback(e){_t(e);const r=`/feedback/${e}`;return await this._get(r)}async deleteFeedback(e){_t(e);const r=`/feedback/${e}`,n=await this.caller.call(fetch,this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!n.ok)throw new Error(`Failed to delete ${r}: ${n.status} ${n.statusText}`);await n.json()}async*listFeedback({runIds:e,feedbackKeys:r,feedbackSourceTypes:n}={}){const i=new URLSearchParams;if(e&&i.append("run",e.join(",")),r)for(const a of r)i.append("key",a);if(n)for(const a of n)i.append("source",a);for await(const a of this._getPaginated("/feedback",i))yield*a}async createPresignedFeedbackToken(e,r,{expiration:n,feedbackConfig:i}={}){const a={run_id:e,feedback_key:r,feedback_config:i};return n?typeof n=="string"?a.expires_at=n:(n!=null&&n.hours||n!=null&&n.minutes||n!=null&&n.days)&&(a.expires_in=n):a.expires_in={hours:3},await(await this.caller.call(fetch,`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createComparativeExperiment({name:e,experimentIds:r,referenceDatasetId:n,createdAt:i,description:a,metadata:s,id:o}){var c;if(r.length===0)throw new Error("At least one experiment is required");if(n||(n=(await this.readProject({projectId:r[0]})).reference_dataset_id),!n==null)throw new Error("A reference dataset is required");const u={id:o,name:e,experiment_ids:r,reference_dataset_id:n,description:a,created_at:(c=i??new Date)==null?void 0:c.toISOString(),extra:{}};return s&&(u.extra.metadata=s),await(await this.caller.call(fetch,`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){_t(e);const r=new URLSearchParams({run_id:e});for await(const n of this._getPaginated("/feedback/tokens",r))yield*n}_selectEvalResults(e){let r;return"results"in e?r=e.results:r=[e],r}async _logEvaluationFeedback(e,r,n){const i=this._selectEvalResults(e),a=[];for(const s of i){let o=n||{};s.evaluatorInfo&&(o={...s.evaluatorInfo,...o});let u=null;s.targetRunId?u=s.targetRunId:r&&(u=r.id),a.push(await this.createFeedback(u,s.key,{score:s.score,value:s.value,comment:s.comment,correction:s.correction,sourceInfo:o,sourceRunId:s.sourceRunId,feedbackConfig:s.feedbackConfig,feedbackSourceType:"model"}))}return[i,a]}async logEvaluationFeedback(e,r,n){const[i]=await this._logEvaluationFeedback(e,r,n);return i}async _currentTenantIsOwner(e){const r=await this._getSettings();return e=="-"||r.tenant_handle===e}async _ownerConflictError(e,r){const n=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${n.tenant_handle}

      Requested tenant: ${r}`)}async _getLatestCommitHash(e){const r=await this.caller.call(fetch,`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),n=await r.json();if(!r.ok){const i=typeof n.detail=="string"?n.detail:JSON.stringify(n.detail),a=new Error(`Error ${r.status}: ${r.statusText}
${i}`);throw a.statusCode=r.status,a}if(n.commits.length!==0)return n.commits[0].commit_hash}async _likeOrUnlikePrompt(e,r){const[n,i,a]=So(e),s=await this.caller.call(fetch,`${this.apiUrl}/likes/${n}/${i}`,{method:"POST",body:JSON.stringify({like:r}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!s.ok)throw new Error(`Failed to ${r?"like":"unlike"} prompt: ${s.status} ${await s.text()}`);return await s.json()}async _getPromptUrl(e){const[r,n,i]=So(e);if(await this._currentTenantIsOwner(r)){const a=await this._getSettings();return i!=="latest"?`${this.getHostUrl()}/prompts/${n}/${i.substring(0,8)}?organizationId=${a.id}`:`${this.getHostUrl()}/prompts/${n}?organizationId=${a.id}`}else return i!=="latest"?`${this.getHostUrl()}/hub/${r}/${n}/${i.substring(0,8)}`:`${this.getHostUrl()}/hub/${r}/${n}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const r of this._getPaginated(`/commits/${e}/`,{},n=>n.commits))yield*r}async*listPrompts(e){const r=new URLSearchParams;r.append("sort_field",(e==null?void 0:e.sortField)??"updated_at"),r.append("sort_direction","desc"),r.append("is_archived",(!!(e!=null&&e.isArchived)).toString()),(e==null?void 0:e.isPublic)!==void 0&&r.append("is_public",e.isPublic.toString()),e!=null&&e.query&&r.append("query",e.query);for await(const n of this._getPaginated("/repos",r,i=>i.repos))yield*n}async getPrompt(e){const[r,n,i]=So(e),a=await this.caller.call(fetch,`${this.apiUrl}/repos/${r}/${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(a.status===404)return null;if(!a.ok)throw new Error(`Failed to get prompt: ${a.status} ${await a.text()}`);const s=await a.json();return s.repo?s.repo:null}async createPrompt(e,r){const n=await this._getSettings();if(r!=null&&r.isPublic&&!n.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle. 
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[i,a,s]=So(e);if(!await this._currentTenantIsOwner(i))throw await this._ownerConflictError("create a prompt",i);const o={repo_handle:a,...(r==null?void 0:r.description)&&{description:r.description},...(r==null?void 0:r.readme)&&{readme:r.readme},...(r==null?void 0:r.tags)&&{tags:r.tags},is_public:!!(r!=null&&r.isPublic)},u=await this.caller.call(fetch,`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!u.ok)throw new Error(`Failed to create prompt: ${u.status} ${await u.text()}`);const{repo:l}=await u.json();return l}async createCommit(e,r,n){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[i,a,s]=So(e),o=(n==null?void 0:n.parentCommitHash)==="latest"||!(n!=null&&n.parentCommitHash)?await this._getLatestCommitHash(`${i}/${a}`):n==null?void 0:n.parentCommitHash,u={manifest:JSON.parse(JSON.stringify(r)),parent_commit:o},l=await this.caller.call(fetch,`${this.apiUrl}/commits/${i}/${a}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!l.ok)throw new Error(`Failed to create commit: ${l.status} ${await l.text()}`);const c=await l.json();return this._getPromptUrl(`${i}/${a}${c.commit_hash?`:${c.commit_hash}`:""}`)}async updatePrompt(e,r){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[n,i]=So(e);if(!await this._currentTenantIsOwner(n))throw await this._ownerConflictError("update a prompt",n);const a={};if((r==null?void 0:r.description)!==void 0&&(a.description=r.description),(r==null?void 0:r.readme)!==void 0&&(a.readme=r.readme),(r==null?void 0:r.tags)!==void 0&&(a.tags=r.tags),(r==null?void 0:r.isPublic)!==void 0&&(a.is_public=r.isPublic),(r==null?void 0:r.isArchived)!==void 0&&(a.is_archived=r.isArchived),Object.keys(a).length===0)throw new Error("No valid update options provided");const s=await this.caller.call(fetch,`${this.apiUrl}/repos/${n}/${i}`,{method:"PATCH",body:JSON.stringify(a),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!s.ok)throw new Error(`HTTP Error: ${s.status} - ${await s.text()}`);return s.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,n,i]=So(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("delete a prompt",r);return await(await this.caller.call(fetch,`${this.apiUrl}/repos/${r}/${n}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async pullPromptCommit(e,r){const[n,i,a]=So(e),s=await this._getServerInfo(),o=x2e(s.version,"0.5.23");let u=a;if(!o&&a==="latest"){const h=await this._getLatestCommitHash(`${n}/${i}`);if(h)u=h;else throw new Error("No commits found")}const l=await this.caller.call(fetch,`${this.apiUrl}/commits/${n}/${i}/${u}${r!=null&&r.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(!l.ok)throw new Error(`Failed to pull prompt commit: ${l.status} ${l.statusText}`);const c=await l.json();return{owner:n,repo:i,commit_hash:c.commit_hash,manifest:c.manifest,examples:c.examples}}async _pullPrompt(e,r){const n=await this.pullPromptCommit(e,{includeModel:r==null?void 0:r.includeModel});return JSON.stringify(n.manifest)}async pushPrompt(e,r){return await this.promptExists(e)?r&&Object.keys(r).some(i=>i!=="object")&&await this.updatePrompt(e,{description:r==null?void 0:r.description,readme:r==null?void 0:r.readme,tags:r==null?void 0:r.tags,isPublic:r==null?void 0:r.isPublic}):await this.createPrompt(e,{description:r==null?void 0:r.description,readme:r==null?void 0:r.readme,tags:r==null?void 0:r.tags,isPublic:r==null?void 0:r.isPublic}),r!=null&&r.object?await this.createCommit(e,r==null?void 0:r.object,{parentCommitHash:r==null?void 0:r.parentCommitHash}):await this._getPromptUrl(e)}}const k2e=t=>t!==void 0?t:!!["TRACING_V2","TRACING"].find(r=>Hu(r)==="true");function C2e(t){return t.replace(/[-:.]/g,"")}function I2e(t,e,r=1){const n=r.toFixed(0).slice(0,3).padStart(3,"0");return C2e(`${new Date(t).toISOString().slice(0,-1)}${n}Z`)+e}class xw{constructor(e,r){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=r}static fromHeader(e){const r=e.split(",");let n={},i=[];for(const a of r){const[s,o]=a.split("="),u=decodeURIComponent(o);s==="langsmith-metadata"?n=JSON.parse(u):s==="langsmith-tags"&&(i=u.split(","))}return new xw(n,i)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),e.join(",")}}class Ka{constructor(e){var o;Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const r=Ka.getDefaultConfig(),{metadata:n,...i}=e,a=i.client??new Id,s={...n,...(o=i==null?void 0:i.extra)==null?void 0:o.metadata};if(i.extra={...i.extra,metadata:s},Object.assign(this,{...r,...i,client:a}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.execution_order??(this.execution_order=1),this.child_execution_order??(this.child_execution_order=1),!this.dotted_order){const u=I2e(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+u:this.dotted_order=u}}static getDefaultConfig(){return{id:YE(),run_type:"chain",project_name:sl("LANGCHAIN_PROJECT")??sl("LANGCHAIN_SESSION")??"default",child_runs:[],api_url:sl("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:sl("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}createChild(e){var u,l,c,h,d,f;const r=this.child_execution_order+1,n=new Ka({...e,parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:r,child_execution_order:r}),i=Symbol.for("lc:child_config"),a=((u=e.extra)==null?void 0:u[i])??this.extra[i];if(j2e(a)){const p={...a},m=$2e(p.callbacks)?(c=(l=p.callbacks).copy)==null?void 0:c.call(l):void 0;m&&(Object.assign(m,{_parentRunId:n.id}),(f=(d=(h=m.handlers)==null?void 0:h.find(Z6))==null?void 0:d.updateFromRunTree)==null||f.call(d,n),p.callbacks=m),n.extra[i]=p}const s=new Set;let o=this;for(;o!=null&&!s.has(o.id);)s.add(o.id),o.child_execution_order=Math.max(o.child_execution_order,r),o=o.parent_run;return this.child_runs.push(n),n}async end(e,r,n=Date.now()){this.outputs=this.outputs??e,this.error=this.error??r,this.end_time=this.end_time??n}_convertToCreate(e,r,n=!0){var u;const i=e.extra??{};if(i.runtime||(i.runtime={}),r)for(const[l,c]of Object.entries(r))i.runtime[l]||(i.runtime[l]=c);let a,s;return n?(s=(u=e.parent_run)==null?void 0:u.id,a=[]):(a=e.child_runs.map(l=>this._convertToCreate(l,r,n)),s=void 0),{id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:i,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:a,parent_run_id:s,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags}}async postRun(e=!0){const r=await B6(),n=await this._convertToCreate(this,r,!0);if(await this.client.createRun(n),!e){q6("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const i of this.child_runs)await i.postRun(!1)}}async patchRun(){var r;const e={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:(r=this.parent_run)==null?void 0:r.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags};await this.client.updateRun(this.id,e)}toJSON(){return this._convertToCreate(this,void 0,!1)}static fromRunnableConfig(e,r){var l,c,h,d;const n=e==null?void 0:e.callbacks;let i,a,s,o=k2e();if(n){const f=((l=n==null?void 0:n.getParentRunId)==null?void 0:l.call(n))??"",p=(c=n==null?void 0:n.handlers)==null?void 0:c.find(m=>(m==null?void 0:m.name)=="langchain_tracer");i=(h=p==null?void 0:p.getRun)==null?void 0:h.call(p,f),a=p==null?void 0:p.projectName,s=p==null?void 0:p.client,o=o||!!p}return i?new Ka({name:i.name,id:i.id,client:s,tracingEnabled:o,project_name:a,tags:[...new Set(((i==null?void 0:i.tags)??[]).concat((e==null?void 0:e.tags)??[]))],extra:{metadata:{...(d=i==null?void 0:i.extra)==null?void 0:d.metadata,...e==null?void 0:e.metadata}}}).createChild(r):new Ka({...r,client:s,tracingEnabled:o,project_name:a})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,r){var l;const n="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,i=n["langsmith-trace"];if(!i||typeof i!="string")return;const a=i.trim(),s=a.split(".").map(c=>{const[h,d]=c.split("Z");return{strTime:h,time:Date.parse(h+"Z"),uuid:d}}),o=s[0].uuid,u={...r,name:(r==null?void 0:r.name)??"parent",run_type:(r==null?void 0:r.run_type)??"chain",start_time:(r==null?void 0:r.start_time)??Date.now(),id:(l=s.at(-1))==null?void 0:l.uuid,trace_id:o,dotted_order:a};if(n.baggage&&typeof n.baggage=="string"){const c=xw.fromHeader(n.baggage);u.metadata=c.metadata,u.tags=c.tags}return new Ka(u)}toHeaders(e){var n;const r={"langsmith-trace":this.dotted_order,baggage:new xw((n=this.extra)==null?void 0:n.metadata,this.tags).toHeader()};if(e)for(const[i,a]of Object.entries(r))e.set(i,a);return r}}function Z6(t){return typeof t=="object"&&t!=null&&typeof t.name=="string"&&t.name==="langchain_tracer"}function NL(t){return Array.isArray(t)&&t.some(e=>Z6(e))}function $2e(t){return typeof t=="object"&&t!=null&&Array.isArray(t.handlers)}function j2e(t){var e;return t!==void 0&&typeof t.callbacks=="object"&&(NL((e=t.callbacks)==null?void 0:e.handlers)||NL(t.callbacks))}const X6="0.1.42";var IC={exports:{}};IC.exports;(function(t){const r=(a=0)=>s=>`\x1B[${38+a};5;${s}m`,n=(a=0)=>(s,o,u)=>`\x1B[${38+a};2;${s};${o};${u}m`;function i(){const a=new Map,s={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};s.color.gray=s.color.blackBright,s.bgColor.bgGray=s.bgColor.bgBlackBright,s.color.grey=s.color.blackBright,s.bgColor.bgGrey=s.bgColor.bgBlackBright;for(const[o,u]of Object.entries(s)){for(const[l,c]of Object.entries(u))s[l]={open:`\x1B[${c[0]}m`,close:`\x1B[${c[1]}m`},u[l]=s[l],a.set(c[0],c[1]);Object.defineProperty(s,o,{value:u,enumerable:!1})}return Object.defineProperty(s,"codes",{value:a,enumerable:!1}),s.color.close="\x1B[39m",s.bgColor.close="\x1B[49m",s.color.ansi256=r(),s.color.ansi16m=n(),s.bgColor.ansi256=r(10),s.bgColor.ansi16m=n(10),Object.defineProperties(s,{rgbToAnsi256:{value:(o,u,l)=>o===u&&u===l?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(u/255*5)+Math.round(l/255*5),enumerable:!1},hexToRgb:{value:o=>{const u=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!u)return[0,0,0];let{colorString:l}=u.groups;l.length===3&&(l=l.split("").map(h=>h+h).join(""));const c=Number.parseInt(l,16);return[c>>16&255,c>>8&255,c&255]},enumerable:!1},hexToAnsi256:{value:o=>s.rgbToAnsi256(...s.hexToRgb(o)),enumerable:!1}}),s}Object.defineProperty(t,"exports",{enumerable:!0,get:i})})(IC);var R2e=IC.exports;const Q6=Ze(R2e);function vn(t,e){return`${t.open}${e}${t.close}`}function Ji(t,e){try{return JSON.stringify(t,null,2)}catch{return e}}function Po(t){if(!t.end_time)return"";const e=t.end_time-t.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:Nn}=Q6;class Ow extends Wi{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const r=[];let n=e;for(;n.parent_run_id;){const i=this.runMap.get(n.parent_run_id);if(i)r.push(i),n=i;else break}return r}getBreadcrumbs(e){const n=[...this.getParents(e).reverse(),e].map((i,a,s)=>{const o=`${i.execution_order}:${i.run_type}:${i.name}`;return a===s.length-1?vn(Q6.bold,o):o}).join(" > ");return vn(Nn.grey,n)}onChainStart(e){const r=this.getBreadcrumbs(e);console.log(`${vn(Nn.green,"[chain/start]")} [${r}] Entering Chain run with input: ${Ji(e.inputs,"[inputs]")}`)}onChainEnd(e){const r=this.getBreadcrumbs(e);console.log(`${vn(Nn.cyan,"[chain/end]")} [${r}] [${Po(e)}] Exiting Chain run with output: ${Ji(e.outputs,"[outputs]")}`)}onChainError(e){const r=this.getBreadcrumbs(e);console.log(`${vn(Nn.red,"[chain/error]")} [${r}] [${Po(e)}] Chain run errored with error: ${Ji(e.error,"[error]")}`)}onLLMStart(e){const r=this.getBreadcrumbs(e),n="prompts"in e.inputs?{prompts:e.inputs.prompts.map(i=>i.trim())}:e.inputs;console.log(`${vn(Nn.green,"[llm/start]")} [${r}] Entering LLM run with input: ${Ji(n,"[inputs]")}`)}onLLMEnd(e){const r=this.getBreadcrumbs(e);console.log(`${vn(Nn.cyan,"[llm/end]")} [${r}] [${Po(e)}] Exiting LLM run with output: ${Ji(e.outputs,"[response]")}`)}onLLMError(e){const r=this.getBreadcrumbs(e);console.log(`${vn(Nn.red,"[llm/error]")} [${r}] [${Po(e)}] LLM run errored with error: ${Ji(e.error,"[error]")}`)}onToolStart(e){var n;const r=this.getBreadcrumbs(e);console.log(`${vn(Nn.green,"[tool/start]")} [${r}] Entering Tool run with input: "${(n=e.inputs.input)==null?void 0:n.trim()}"`)}onToolEnd(e){var n,i;const r=this.getBreadcrumbs(e);console.log(`${vn(Nn.cyan,"[tool/end]")} [${r}] [${Po(e)}] Exiting Tool run with output: "${(i=(n=e.outputs)==null?void 0:n.output)==null?void 0:i.trim()}"`)}onToolError(e){const r=this.getBreadcrumbs(e);console.log(`${vn(Nn.red,"[tool/error]")} [${r}] [${Po(e)}] Tool run errored with error: ${Ji(e.error,"[error]")}`)}onRetrieverStart(e){const r=this.getBreadcrumbs(e);console.log(`${vn(Nn.green,"[retriever/start]")} [${r}] Entering Retriever run with input: ${Ji(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const r=this.getBreadcrumbs(e);console.log(`${vn(Nn.cyan,"[retriever/end]")} [${r}] [${Po(e)}] Exiting Retriever run with output: ${Ji(e.outputs,"[outputs]")}`)}onRetrieverError(e){const r=this.getBreadcrumbs(e);console.log(`${vn(Nn.red,"[retriever/error]")} [${r}] [${Po(e)}] Retriever run errored with error: ${Ji(e.error,"[error]")}`)}onAgentAction(e){const r=e,n=this.getBreadcrumbs(e);console.log(`${vn(Nn.blue,"[agent/action]")} [${n}] Agent selected action: ${Ji(r.actions[r.actions.length-1],"[action]")}`)}}const N2e=Object.freeze(Object.defineProperty({__proto__:null,ConsoleCallbackHandler:Ow},Symbol.toStringTag,{value:"Module"}));class Ui extends Wi{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:r,projectName:n,client:i}=e;this.projectName=n??Me("LANGCHAIN_PROJECT")??Me("LANGCHAIN_SESSION"),this.exampleId=r,this.client=i??new Id({});const a=Ui.getTraceableRunTree();a&&this.updateFromRunTree(a)}async _convertToCreate(e,r=void 0){return{...e,extra:{...e.extra,runtime:await M6()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:r}}async persistRun(e){}async onRunCreate(e){const r=await this._convertToCreate(e,this.exampleId);await this.client.createRun(r)}async onRunUpdate(e){const r={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id};await this.client.updateRun(e.id,r)}getRun(e){return this.runMap.get(e)}updateFromRunTree(e){let r=e;const n=new Set;for(;r.parent_run&&!(n.has(r.id)||(n.add(r.id),!r.parent_run));)r=r.parent_run;n.clear();const i=[r];for(;i.length>0;){const a=i.shift();!a||n.has(a.id)||(n.add(a.id),this.runMap.set(a.id,a),a.child_runs&&i.push(...a.child_runs))}this.client=e.client??this.client,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}convertToRunTree(e){const r={},n=[];for(const[i,a]of this.runMap){const s=new Ka({...a,child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0});r[i]=s,n.push([i,a.dotted_order])}n.sort((i,a)=>!i[1]||!a[1]?0:i[1].localeCompare(a[1]));for(const[i]of n){const a=this.runMap.get(i),s=r[i];if(!(!a||!s)&&a.parent_run_id){const o=r[a.parent_run_id];o&&(o.child_runs.push(s),s.parent_run=o)}}return r[e]}static getTraceableRunTree(){try{return W$e()}catch{return}}}const M2e=Object.freeze(Object.defineProperty({__proto__:null,LangChainTracer:Ui},Symbol.toStringTag,{value:"Module"}));let pp;function D2e(){const t="default"in Ws?Ws.default:Ws;return new t({autoStart:!0,concurrency:1})}async function tr(t,e){e===!0?await t():(typeof pp>"u"&&(pp=D2e()),pp.add(t))}function e8(){return typeof pp<"u"?pp.onIdle():Promise.resolve()}const L2e=Object.freeze(Object.defineProperty({__proto__:null,awaitAllCallbacks:e8,consumeCallback:tr},Symbol.toStringTag,{value:"Module"})),F2e=t=>t!==void 0?t:!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(r=>Me(r)==="true");function $d(t){return t?Array.isArray(t)||"name"in t?{callbacks:t}:t:{}}class t8{setHandler(e){return this.setHandlers([e])}}class kg{constructor(e,r,n,i,a,s,o,u){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:u})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(r=>tr(async()=>{var n;try{await((n=r.handleText)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(i){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleText: ${i}`),r.raiseError)throw i}},r.awaitHandlers)))}async handleCustomEvent(e,r,n,i,a){await Promise.all(this.handlers.map(s=>tr(async()=>{var o;try{await((o=s.handleCustomEvent)==null?void 0:o.call(s,e,r,this.runId,this.tags,this.metadata))}catch(u){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleCustomEvent: ${u}`),s.raiseError)throw u}},s.awaitHandlers)))}}class r8 extends kg{getChild(e){const r=new Zt(this.runId);return r.setHandlers(this.inheritableHandlers),r.addTags(this.inheritableTags),r.addMetadata(this.inheritableMetadata),e&&r.addTags([e],!1),r}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(r=>tr(async()=>{var n;if(!r.ignoreRetriever)try{await((n=r.handleRetrieverEnd)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(i){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleRetriever`),r.raiseError)throw i}},r.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(r=>tr(async()=>{var n;if(!r.ignoreRetriever)try{await((n=r.handleRetrieverError)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(i){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleRetrieverError: ${i}`),r.raiseError)throw e}},r.awaitHandlers)))}}class ZE extends kg{async handleLLMNewToken(e,r,n,i,a,s){await Promise.all(this.handlers.map(o=>tr(async()=>{var u;if(!o.ignoreLLM)try{await((u=o.handleLLMNewToken)==null?void 0:u.call(o,e,r??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,s))}catch(l){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleLLMNewToken: ${l}`),o.raiseError)throw l}},o.awaitHandlers)))}async handleLLMError(e){await Promise.all(this.handlers.map(r=>tr(async()=>{var n;if(!r.ignoreLLM)try{await((n=r.handleLLMError)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(i){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleLLMError: ${i}`),r.raiseError)throw i}},r.awaitHandlers)))}async handleLLMEnd(e){await Promise.all(this.handlers.map(r=>tr(async()=>{var n;if(!r.ignoreLLM)try{await((n=r.handleLLMEnd)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(i){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleLLMEnd: ${i}`),r.raiseError)throw i}},r.awaitHandlers)))}}class n8 extends kg{getChild(e){const r=new Zt(this.runId);return r.setHandlers(this.inheritableHandlers),r.addTags(this.inheritableTags),r.addMetadata(this.inheritableMetadata),e&&r.addTags([e],!1),r}async handleChainError(e,r,n,i,a){await Promise.all(this.handlers.map(s=>tr(async()=>{var o;if(!s.ignoreChain)try{await((o=s.handleChainError)==null?void 0:o.call(s,e,this.runId,this._parentRunId,this.tags,a))}catch(u){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleChainError: ${u}`),s.raiseError)throw u}},s.awaitHandlers)))}async handleChainEnd(e,r,n,i,a){await Promise.all(this.handlers.map(s=>tr(async()=>{var o;if(!s.ignoreChain)try{await((o=s.handleChainEnd)==null?void 0:o.call(s,e,this.runId,this._parentRunId,this.tags,a))}catch(u){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleChainEnd: ${u}`),s.raiseError)throw u}},s.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(r=>tr(async()=>{var n;if(!r.ignoreAgent)try{await((n=r.handleAgentAction)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(i){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleAgentAction: ${i}`),r.raiseError)throw i}},r.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(r=>tr(async()=>{var n;if(!r.ignoreAgent)try{await((n=r.handleAgentEnd)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(i){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleAgentEnd: ${i}`),r.raiseError)throw i}},r.awaitHandlers)))}}class i8 extends kg{getChild(e){const r=new Zt(this.runId);return r.setHandlers(this.inheritableHandlers),r.addTags(this.inheritableTags),r.addMetadata(this.inheritableMetadata),e&&r.addTags([e],!1),r}async handleToolError(e){await Promise.all(this.handlers.map(r=>tr(async()=>{var n;if(!r.ignoreAgent)try{await((n=r.handleToolError)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(i){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleToolError: ${i}`),r.raiseError)throw i}},r.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(r=>tr(async()=>{var n;if(!r.ignoreAgent)try{await((n=r.handleToolEnd)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(i){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleToolEnd: ${i}`),r.raiseError)throw i}},r.awaitHandlers)))}}class Zt extends t8{constructor(e,r){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=(r==null?void 0:r.handlers)??this.handlers,this.inheritableHandlers=(r==null?void 0:r.inheritableHandlers)??this.inheritableHandlers,this.tags=(r==null?void 0:r.tags)??this.tags,this.inheritableTags=(r==null?void 0:r.inheritableTags)??this.inheritableTags,this.metadata=(r==null?void 0:r.metadata)??this.metadata,this.inheritableMetadata=(r==null?void 0:r.inheritableMetadata)??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,r,n=void 0,i=void 0,a=void 0,s=void 0,o=void 0,u=void 0){return Promise.all(r.map(async(l,c)=>{const h=c===0&&n?n:Fa();return await Promise.all(this.handlers.map(d=>{if(!d.ignoreLLM)return xc(d)&&d._createRunForLLMStart(e,[l],h,this._parentRunId,a,this.tags,this.metadata,u),tr(async()=>{var f;try{await((f=d.handleLLMStart)==null?void 0:f.call(d,e,[l],h,this._parentRunId,a,this.tags,this.metadata,u))}catch(p){if((d.raiseError?console.error:console.warn)(`Error in handler ${d.constructor.name}, handleLLMStart: ${p}`),d.raiseError)throw p}},d.awaitHandlers)})),new ZE(h,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,r,n=void 0,i=void 0,a=void 0,s=void 0,o=void 0,u=void 0){return Promise.all(r.map(async(l,c)=>{const h=c===0&&n?n:Fa();return await Promise.all(this.handlers.map(d=>{if(!d.ignoreLLM)return xc(d)&&d._createRunForChatModelStart(e,[l],h,this._parentRunId,a,this.tags,this.metadata,u),tr(async()=>{var f,p;try{if(d.handleChatModelStart)await((f=d.handleChatModelStart)==null?void 0:f.call(d,e,[l],h,this._parentRunId,a,this.tags,this.metadata,u));else if(d.handleLLMStart){const m=Nr(l);await((p=d.handleLLMStart)==null?void 0:p.call(d,e,[m],h,this._parentRunId,a,this.tags,this.metadata,u))}}catch(m){if((d.raiseError?console.error:console.warn)(`Error in handler ${d.constructor.name}, handleLLMStart: ${m}`),d.raiseError)throw m}},d.awaitHandlers)})),new ZE(h,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,r,n=Fa(),i=void 0,a=void 0,s=void 0,o=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreChain)return xc(u)&&u._createRunForChainStart(e,r,n,this._parentRunId,this.tags,this.metadata,i,o),tr(async()=>{var l;try{await((l=u.handleChainStart)==null?void 0:l.call(u,e,r,n,this._parentRunId,this.tags,this.metadata,i,o))}catch(c){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleChainStart: ${c}`),u.raiseError)throw c}},u.awaitHandlers)})),new n8(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,r,n=Fa(),i=void 0,a=void 0,s=void 0,o=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreAgent)return xc(u)&&u._createRunForToolStart(e,r,n,this._parentRunId,this.tags,this.metadata,o),tr(async()=>{var l;try{await((l=u.handleToolStart)==null?void 0:l.call(u,e,r,n,this._parentRunId,this.tags,this.metadata,o))}catch(c){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleToolStart: ${c}`),u.raiseError)throw c}},u.awaitHandlers)})),new i8(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,r,n=Fa(),i=void 0,a=void 0,s=void 0,o=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreRetriever)return xc(u)&&u._createRunForRetrieverStart(e,r,n,this._parentRunId,this.tags,this.metadata,o),tr(async()=>{var l;try{await((l=u.handleRetrieverStart)==null?void 0:l.call(u,e,r,n,this._parentRunId,this.tags,this.metadata,o))}catch(c){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleRetrieverStart: ${c}`),u.raiseError)throw c}},u.awaitHandlers)})),new r8(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,r,n,i,a){await Promise.all(this.handlers.map(s=>tr(async()=>{var o;if(!s.ignoreCustomEvent)try{await((o=s.handleCustomEvent)==null?void 0:o.call(s,e,r,n,this.tags,this.metadata))}catch(u){if((s.raiseError?console.error:console.warn)(`Error in handler ${s.constructor.name}, handleCustomEvent: ${u}`),s.raiseError)throw u}},s.awaitHandlers)))}addHandler(e,r=!0){this.handlers.push(e),r&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(r=>r!==e),this.inheritableHandlers=this.inheritableHandlers.filter(r=>r!==e)}setHandlers(e,r=!0){this.handlers=[],this.inheritableHandlers=[];for(const n of e)this.addHandler(n,r)}addTags(e,r=!0){this.removeTags(e),this.tags.push(...e),r&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(r=>!e.includes(r)),this.inheritableTags=this.inheritableTags.filter(r=>!e.includes(r))}addMetadata(e,r=!0){this.metadata={...this.metadata,...e},r&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const r of Object.keys(e))delete this.metadata[r],delete this.inheritableMetadata[r]}copy(e=[],r=!0){const n=new Zt(this._parentRunId);for(const i of this.handlers){const a=this.inheritableHandlers.includes(i);n.addHandler(i,a)}for(const i of this.tags){const a=this.inheritableTags.includes(i);n.addTags([i],a)}for(const i of Object.keys(this.metadata)){const a=Object.keys(this.inheritableMetadata).includes(i);n.addMetadata({[i]:this.metadata[i]},a)}for(const i of e)n.handlers.filter(a=>a.name==="console_callback_handler").some(a=>a.name===i.name)||n.addHandler(i,r);return n}static fromHandlers(e){class r extends kd{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Fa()}),Object.assign(this,e)}}const n=new this;return n.addHandler(new r),n}static async configure(e,r,n,i,a,s,o){return this._configureSync(e,r,n,i,a,s,o)}static _configureSync(e,r,n,i,a,s,o){var d,f;let u;(e||r)&&(Array.isArray(e)||!e?(u=new Zt,u.setHandlers((e==null?void 0:e.map(Fm))??[],!0)):u=e,u=u.copy(Array.isArray(r)?r.map(Fm):r==null?void 0:r.handlers,!1));const l=Me("LANGCHAIN_VERBOSE")==="true"||(o==null?void 0:o.verbose),c=((d=Ui.getTraceableRunTree())==null?void 0:d.tracingEnabled)||F2e(),h=c||(Me("LANGCHAIN_TRACING")??!1);if(l||h){if(u||(u=new Zt),l&&!u.handlers.some(p=>p.name===Ow.prototype.name)){const p=new Ow;u.addHandler(p,!0)}if(h&&!u.handlers.some(p=>p.name==="langchain_tracer")&&c){const p=new Ui;u.addHandler(p,!0),u._parentRunId=((f=Ui.getTraceableRunTree())==null?void 0:f.id)??u._parentRunId}}return(n||i)&&u&&(u.addTags(n??[]),u.addTags(i??[],!1)),(a||s)&&u&&(u.addMetadata(a??{}),u.addMetadata(s??{},!1)),u}}function Fm(t){return"name"in t?t:kd.fromMethods(t)}class a8{constructor(e,r){Object.defineProperty(this,"groupName",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"runManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}async getTraceGroupCallbackManager(e,r,n){const i=new Ui(n),a=await Zt.configure([i]),s=await(a==null?void 0:a.handleChainStart({lc:1,type:"not_implemented",id:["langchain","callbacks","groups",e]},r??{}));if(!s)throw new Error("Failed to create run group callback manager.");return s}async start(e){return this.runManager||(this.runManager=await this.getTraceGroupCallbackManager(this.groupName,e,this.options)),this.runManager.getChild()}async error(e){this.runManager&&(await this.runManager.handleChainError(e),this.runManager=void 0)}async end(e){this.runManager&&(await this.runManager.handleChainEnd(e??{}),this.runManager=void 0)}}function U2e(t,e){return t&&!Array.isArray(t)&&typeof t=="object"?t:{[e]:t}}async function z2e(t,e,...r){const n=new a8(t.name,t),i=await n.start({...r});try{const a=await e(i,...r);return await n.end(U2e(a,"output")),a}catch(a){throw await n.error(a),a}}const B2e=Object.freeze(Object.defineProperty({__proto__:null,BaseCallbackManager:t8,BaseRunManager:kg,CallbackManager:Zt,CallbackManagerForChainRun:n8,CallbackManagerForLLMRun:ZE,CallbackManagerForRetrieverRun:r8,CallbackManagerForToolRun:i8,TraceGroup:a8,ensureHandler:Fm,parseCallbackConfigArg:$d,traceAsGroup:z2e},Symbol.toStringTag,{value:"Module"}));class q2e{getStore(){}run(e,r){return r()}}const K2e=new q2e,wO=Symbol.for("ls:tracing_async_local_storage"),ML=Symbol.for("lc:child_config");class V2e{getInstance(){return globalThis[wO]??K2e}getRunnableConfig(){var r,n;return(n=(r=this.getInstance().getStore())==null?void 0:r.extra)==null?void 0:n[ML]}runWithConfig(e,r,n){var l;const i=Zt._configureSync(e==null?void 0:e.callbacks,void 0,e==null?void 0:e.tags,void 0,e==null?void 0:e.metadata),a=this.getInstance(),s=i==null?void 0:i.getParentRunId(),o=(l=i==null?void 0:i.handlers)==null?void 0:l.find(c=>(c==null?void 0:c.name)==="langchain_tracer");let u;return o&&s?u=o.convertToRunTree(s):n||(u=new Ka({name:"<runnable_lambda>",tracingEnabled:!1})),u&&(u.extra={...u.extra,[ML]:e}),a.run(u,r)}initializeGlobalInstance(e){globalThis[wO]===void 0&&(globalThis[wO]=e)}}const mu=new V2e;async function gu(t,e){if(e===void 0)return t;let r;return Promise.race([t.catch(n=>{if(!(e!=null&&e.aborted))throw n}),new Promise((n,i)=>{r=()=>{i(new Error("Aborted"))},e.addEventListener("abort",r),e.aborted&&i(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",r))}class mn extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const r=this.reader.cancel();this.reader.releaseLock(),await r}throw e}[Symbol.asyncIterator](){return this}static fromReadableStream(e){const r=e.getReader();return new mn({start(n){return i();function i(){return r.read().then(({done:a,value:s})=>{if(a){n.close();return}return n.enqueue(s),i()})}},cancel(){r.releaseLock()}})}static fromAsyncGenerator(e){return new mn({async pull(r){const{value:n,done:i}=await e.next();i&&r.close(),r.enqueue(n)},async cancel(r){await e.return(r)}})}}function $C(t,e=2){const r=Array.from({length:e},()=>[]);return r.map(async function*(i){for(;;)if(i.length===0){const a=await t.next();for(const s of r)s.push(a)}else{if(i[0].done)return;yield i.shift().value}})}function cn(t,e){if(Array.isArray(t)&&Array.isArray(e))return t.concat(e);if(typeof t=="string"&&typeof e=="string")return t+e;if(typeof t=="number"&&typeof e=="number")return t+e;if("concat"in t&&typeof t.concat=="function")return t.concat(e);if(typeof t=="object"&&typeof e=="object"){const r={...t};for(const[n,i]of Object.entries(e))n in r&&!Array.isArray(r[n])?r[n]=cn(r[n],i):r[n]=i;return r}else throw new Error(`Cannot concat ${typeof t} and ${typeof e}`)}class Jl{constructor(e){var r;Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??((r=this.config)==null?void 0:r.signal),this.setup=new Promise((n,i)=>{mu.runWithConfig(e.config,async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(n,i):this.firstResult.then(a=>n(void 0),i)},!0)})}async next(...e){var r;return(r=this.signal)==null||r.throwIfAborted(),this.firstResultUsed?mu.runWithConfig(this.config,this.signal?async()=>gu(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}}async function s8(t,e,r,n,...i){const a=new Jl({generator:e,startSetup:r,signal:n}),s=await a.setup;return{output:t(a,s,...i),setup:s}}const H2e=Object.freeze(Object.defineProperty({__proto__:null,AsyncGeneratorWithSetup:Jl,IterableReadableStream:mn,atee:$C,concat:cn,pipeGeneratorWithSetup:s8},Symbol.toStringTag,{value:"Module"}));class Ua{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const r=this.ops.concat(e.ops),n=Lm({},r);return new $l({ops:r,state:n[n.length-1].newDocument})}}class $l extends Ua{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const r=this.ops.concat(e.ops),n=Lm(this.state,e.ops);return new $l({ops:r,state:n[n.length-1].newDocument})}static fromRunLogPatch(e){const r=Lm({},e.ops);return new $l({ops:e.ops,state:r[r.length-1].newDocument})}}const J_=t=>t.name==="log_stream_tracer";async function DL(t,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:r}=t;if(["retriever","llm","prompt"].includes(t.run_type))return r;if(!(Object.keys(r).length===1&&(r==null?void 0:r.input)===""))return r.input}async function LL(t,e){const{outputs:r}=t;return e==="original"||["retriever","llm","prompt"].includes(t.run_type)?r:r!==void 0&&Object.keys(r).length===1&&(r==null?void 0:r.output)!==void 0?r.output:r}function W2e(t){return t!==void 0&&t.message!==void 0}class XE extends Wi{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this._schemaFormat=(e==null?void 0:e._schemaFormat)??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=mn.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const r=e.tags??[];let n=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(n=n||r.find(i=>{var a;return(a=this.includeTags)==null?void 0:a.includes(i)})!==void 0),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(n=n&&r.every(i=>{var a;return!((a=this.excludeTags)!=null&&a.includes(i))})),n}async*tapOutputIterable(e,r){for await(const n of r){if(e!==this.rootId){const i=this.keyMapByRunId[e];i&&await this.writer.write(new Ua({ops:[{op:"add",path:`/logs/${i}/streamed_output/-`,value:n}]}))}yield n}}async onRunCreate(e){var i;if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new Ua({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const r=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=r===1?e.name:`${e.name}:${r}`;const n={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:((i=e.extra)==null?void 0:i.metadata)??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(n.inputs=await DL(e,this._schemaFormat)),await this.writer.write(new Ua({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:n}]}))}async onRunUpdate(e){try{const r=this.keyMapByRunId[e.id];if(r===void 0)return;const n=[];this._schemaFormat==="streaming_events"&&n.push({op:"replace",path:`/logs/${r}/inputs`,value:await DL(e,this._schemaFormat)}),n.push({op:"add",path:`/logs/${r}/final_output`,value:await LL(e,this._schemaFormat)}),e.end_time!==void 0&&n.push({op:"add",path:`/logs/${r}/end_time`,value:new Date(e.end_time).toISOString()});const i=new Ua({ops:n});await this.writer.write(i)}finally{if(e.id===this.rootId){const r=new Ua({ops:[{op:"replace",path:"/final_output",value:await LL(e,this._schemaFormat)}]});await this.writer.write(r),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,r,n){const i=this.keyMapByRunId[e.id];if(i===void 0)return;const a=e.inputs.messages!==void 0;let s;a?W2e(n==null?void 0:n.chunk)?s=n==null?void 0:n.chunk:s=new Mr(r):s=r;const o=new Ua({ops:[{op:"add",path:`/logs/${i}/streamed_output_str/-`,value:r},{op:"add",path:`/logs/${i}/streamed_output/-`,value:s}]});await this.writer.write(o)}}const G2e=Object.freeze(Object.defineProperty({__proto__:null,LogStreamCallbackHandler:XE,RunLog:$l,RunLogPatch:Ua,isLogStreamHandler:J_},Symbol.toStringTag,{value:"Module"})),br="__run";class Vi{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new Vi({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class Yn extends Vi{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new Yn({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}const Y2e=Object.freeze(Object.defineProperty({__proto__:null,ChatGenerationChunk:Yn,GenerationChunk:Vi,RUN_KEY:br},Symbol.toStringTag,{value:"Module"}));function zy({name:t,serialized:e}){return t!==void 0?t:(e==null?void 0:e.name)!==void 0?e.name:(e==null?void 0:e.id)!==void 0&&Array.isArray(e==null?void 0:e.id)?e.id[e.id.length-1]:"Unnamed"}const jC=t=>t.name==="event_stream_tracer";class J2e extends Wi{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=mn.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const r=e.tags??[];let n=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(n=n||r.find(i=>{var a;return(a=this.includeTags)==null?void 0:a.includes(i)})!==void 0),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(n=n&&r.every(i=>{var a;return!((a=this.excludeTags)!=null&&a.includes(i))})),n}async*tapOutputIterable(e,r){const n=await r.next();if(n.done)return;const i=this.runInfoMap.get(e);if(i===void 0){yield n.value;return}function a(o,u){return o==="llm"&&typeof u=="string"?new Vi({text:u}):u}let s=this.tappedPromises.get(e);if(s===void 0){let o;s=new Promise(u=>{o=u}),this.tappedPromises.set(e,s);try{const u={event:`on_${i.runType}_stream`,run_id:e,name:i.name,tags:i.tags,metadata:i.metadata,data:{}};await this.send({...u,data:{chunk:a(i.runType,n.value)}},i),yield n.value;for await(const l of r)i.runType!=="tool"&&i.runType!=="retriever"&&await this.send({...u,data:{chunk:a(i.runType,l)}},i),yield l}finally{o()}}else{yield n.value;for await(const o of r)yield o}}async send(e,r){this._includeRun(r)&&await this.writer.write(e)}async sendEndEvent(e,r){const n=this.tappedPromises.get(e.run_id);n!==void 0?n.then(()=>{this.send(e,r)}):await this.send(e,r)}async onLLMStart(e){var s,o;const r=zy(e),n=e.inputs.messages!==void 0?"chat_model":"llm",i={tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{},name:r,runType:n,inputs:e.inputs};this.runInfoMap.set(e.id,i);const a=`on_${n}_start`;await this.send({event:a,data:{input:e.inputs},name:r,tags:e.tags??[],run_id:e.id,metadata:((o=e.extra)==null?void 0:o.metadata)??{}},i)}async onLLMNewToken(e,r,n){const i=this.runInfoMap.get(e.id);let a,s;if(i===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(e.parent_run_id!==void 0){if(i.runType==="chat_model")s="on_chat_model_stream",(n==null?void 0:n.chunk)===void 0?a=new Mr({content:r}):a=n.chunk.message;else if(i.runType==="llm")s="on_llm_stream",(n==null?void 0:n.chunk)===void 0?a=new Vi({text:r}):a=n.chunk;else throw new Error(`Unexpected run type ${i.runType}`);await this.send({event:s,data:{chunk:a},run_id:e.id,name:i.name,tags:i.tags,metadata:i.metadata},i)}}async onLLMEnd(e){var s,o,u;const r=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let n;if(r===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const i=(s=e.outputs)==null?void 0:s.generations;let a;if(r.runType==="chat_model"){for(const l of i??[]){if(a!==void 0)break;a=(o=l[0])==null?void 0:o.message}n="on_chat_model_end"}else if(r.runType==="llm")a={generations:i==null?void 0:i.map(l=>l.map(c=>({text:c.text,generationInfo:c.generationInfo}))),llmOutput:((u=e.outputs)==null?void 0:u.llmOutput)??{}},n="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${r.runType}`);await this.sendEndEvent({event:n,data:{output:a,input:r.inputs},run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata},r)}async onChainStart(e){var s,o;const r=zy(e),n=e.run_type??"chain",i={tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{},name:r,runType:e.run_type};let a={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(a={},i.inputs={}):e.inputs.input!==void 0?(a.input=e.inputs.input,i.inputs=e.inputs.input):(a.input=e.inputs,i.inputs=e.inputs),this.runInfoMap.set(e.id,i),await this.send({event:`on_${n}_start`,data:a,name:r,tags:e.tags??[],run_id:e.id,metadata:((o=e.extra)==null?void 0:o.metadata)??{}},i)}async onChainEnd(e){var o;const r=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),r===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const n=`on_${e.run_type}_end`,i=e.inputs??r.inputs??{},s={output:((o=e.outputs)==null?void 0:o.output)??e.outputs,input:i};i.input&&Object.keys(i).length===1&&(s.input=i.input,r.inputs=i.input),await this.sendEndEvent({event:n,data:s,run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata??{}},r)}async onToolStart(e){var i,a;const r=zy(e),n={tags:e.tags??[],metadata:((i=e.extra)==null?void 0:i.metadata)??{},name:r,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,n),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:r,run_id:e.id,tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{}},n)}async onToolEnd(e){var i;const r=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),r===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(r.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const n=((i=e.outputs)==null?void 0:i.output)===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:n,input:r.inputs},run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata},r)}async onRetrieverStart(e){var a,s;const r=zy(e),n="retriever",i={tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},name:r,runType:n,inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,i),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:r,tags:e.tags??[],run_id:e.id,metadata:((s=e.extra)==null?void 0:s.metadata)??{}},i)}async onRetrieverEnd(e){var n;const r=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),r===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:((n=e.outputs)==null?void 0:n.documents)??e.outputs,input:r.inputs},run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata},r)}async handleCustomEvent(e,r,n){const i=this.runInfoMap.get(n);if(i===void 0)throw new Error(`handleCustomEvent: Run ID ${n} not found in run map.`);await this.send({event:"on_custom_event",run_id:n,name:e,tags:i.tags,metadata:i.metadata,data:r},i)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const _O=25;async function Zr(t){return Zt._configureSync(t==null?void 0:t.callbacks,void 0,t==null?void 0:t.tags,void 0,t==null?void 0:t.metadata)}function QE(...t){const e={};for(const r of t.filter(n=>!!n))for(const n of Object.keys(r))if(n==="metadata")e[n]={...e[n],...r[n]};else if(n==="tags"){const i=e[n]??[];e[n]=[...new Set(i.concat(r[n]??[]))]}else if(n==="configurable")e[n]={...e[n],...r[n]};else if(n==="timeout")e.timeout===void 0?e.timeout=r.timeout:r.timeout!==void 0&&(e.timeout=Math.min(e.timeout,r.timeout));else if(n==="signal")e.signal===void 0?e.signal=r.signal:r.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,r.signal]):e.signal=r.signal);else if(n==="callbacks"){const i=e.callbacks,a=r.callbacks;if(Array.isArray(a))if(!i)e.callbacks=a;else if(Array.isArray(i))e.callbacks=i.concat(a);else{const s=i.copy();for(const o of a)s.addHandler(Fm(o),!0);e.callbacks=s}else if(a)if(!i)e.callbacks=a;else if(Array.isArray(i)){const s=a.copy();for(const o of i)s.addHandler(Fm(o),!0);e.callbacks=s}else e.callbacks=new Zt(a._parentRunId,{handlers:i.handlers.concat(a.handlers),inheritableHandlers:i.inheritableHandlers.concat(a.inheritableHandlers),tags:Array.from(new Set(i.tags.concat(a.tags))),inheritableTags:Array.from(new Set(i.inheritableTags.concat(a.inheritableTags))),metadata:{...i.metadata,...a.metadata}})}else{const i=n;e[i]=r[i]??e[i]}return e}const Z2e=new Set(["string","number","boolean"]);function Ve(t){var n;const e=mu.getRunnableConfig();let r={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:i,runName:a,...s}=e;r=Object.entries(s).reduce((o,[u,l])=>(l!==void 0&&(o[u]=l),o),r)}if(t&&(r=Object.entries(t).reduce((i,[a,s])=>(s!==void 0&&(i[a]=s),i),r)),r!=null&&r.configurable)for(const i of Object.keys(r.configurable))Z2e.has(typeof r.configurable[i])&&!((n=r.metadata)!=null&&n[i])&&(r.metadata||(r.metadata={}),r.metadata[i]=r.configurable[i]);if(r.timeout!==void 0){if(r.timeout<=0)throw new Error("Timeout must be a positive number");const i=AbortSignal.timeout(r.timeout);r.signal!==void 0?"any"in AbortSignal&&(r.signal=AbortSignal.any([r.signal,i])):r.signal=i,delete r.timeout}return r}function xt(t={},{callbacks:e,maxConcurrency:r,recursionLimit:n,runName:i,configurable:a,runId:s}={}){const o=Ve(t);return e!==void 0&&(delete o.runName,o.callbacks=e),n!==void 0&&(o.recursionLimit=n),r!==void 0&&(o.maxConcurrency=r),i!==void 0&&(o.runName=i),a!==void 0&&(o.configurable={...o.configurable,...a}),s!==void 0&&delete o.runId,o}const X2e=[400,401,402,403,404,405,406,407,409],Q2e=t=>{var r,n;if(t.message.startsWith("Cancel")||t.message.startsWith("AbortError")||t.name==="AbortError"||(t==null?void 0:t.code)==="ECONNABORTED")throw t;const e=((r=t==null?void 0:t.response)==null?void 0:r.status)??(t==null?void 0:t.status);if(e&&X2e.includes(+e))throw t;if(((n=t==null?void 0:t.error)==null?void 0:n.code)==="insufficient_quota"){const i=new Error(t==null?void 0:t.message);throw i.name="InsufficientQuotaError",i}};class Zl{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??Q2e;const r="default"in Ws?Ws.default:Ws;this.queue=new r({concurrency:this.maxConcurrency})}call(e,...r){return this.queue.add(()=>bw(()=>e(...r).catch(n=>{throw n instanceof Error?n:new Error(n)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,r,...n){return e.signal?Promise.race([this.call(r,...n),new Promise((i,a)=>{var s;(s=e.signal)==null||s.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(r,...n)}fetch(...e){return this.call(()=>fetch(...e).then(r=>r.ok?r:Promise.reject(r)))}}const eMe=Object.freeze(Object.defineProperty({__proto__:null,AsyncCaller:Zl},Symbol.toStringTag,{value:"Module"}));class o8 extends Wi{constructor({config:e,onStart:r,onEnd:n,onError:i}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=r,this.argOnEnd=n,this.argOnError=i}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&(this.argOnStart.length===1?await this.argOnStart(e):this.argOnStart.length===2&&await this.argOnStart(e,this.config)))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&(this.argOnError.length===1?await this.argOnError(e):this.argOnError.length===2&&await this.argOnError(e,this.config)):this.argOnEnd&&(this.argOnEnd.length===1?await this.argOnEnd(e):this.argOnEnd.length===2&&await this.argOnEnd(e,this.config)))}}function RC(t){return t?t.lc_runnable:!1}class tMe{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,r){let n=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const i=e.tags??[];return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(r)),this.includeTags!==void 0&&(n=n||i.some(a=>{var s;return(s=this.includeTags)==null?void 0:s.includes(a)})),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(r)),this.excludeTags!==void 0&&(n=n&&i.every(a=>{var s;return!((s=this.excludeTags)!=null&&s.includes(a))})),n}}const rMe=Symbol("Let zodToJsonSchema decide on which parser to use"),FL={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},nMe=t=>typeof t=="string"?{...FL,name:t}:{...FL,...t},iMe=t=>{const e=nMe(t),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([n,i])=>[i._def,{def:i._def,path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function u8(t,e,r,n){n!=null&&n.errorMessages&&r&&(t.errorMessage={...t.errorMessage,[e]:r})}function ct(t,e,r,n,i){t[e]=r,u8(t,e,n,i)}function aMe(){return{}}function sMe(t,e){var n,i;const r={type:"array"};return((i=(n=t.type)==null?void 0:n._def)==null?void 0:i.typeName)!==Z.ZodAny&&(r.items=rt(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&ct(r,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&ct(r,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(ct(r,"minItems",t.exactLength.value,t.exactLength.message,e),ct(r,"maxItems",t.exactLength.value,t.exactLength.message,e)),r}function oMe(t,e){const r={type:"integer",format:"int64"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?ct(r,"minimum",n.value,n.message,e):ct(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),ct(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?ct(r,"maximum",n.value,n.message,e):ct(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),ct(r,"maximum",n.value,n.message,e));break;case"multipleOf":ct(r,"multipleOf",n.value,n.message,e);break}return r}function uMe(){return{type:"boolean"}}function lMe(t,e){return rt(t.type._def,e)}const cMe=(t,e)=>rt(t.innerType._def,e);function l8(t,e,r){const n=r??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((i,a)=>l8(t,e,i))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return hMe(t,e)}}const hMe=(t,e)=>{const r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(const n of t.checks)switch(n.kind){case"min":ct(r,"minimum",n.value,n.message,e);break;case"max":ct(r,"maximum",n.value,n.message,e);break}return r};function dMe(t,e){return{...rt(t.innerType._def,e),default:t.defaultValue()}}function fMe(t,e){return e.effectStrategy==="input"?rt(t.schema._def,e):{}}function pMe(t){return{type:"string",enum:t.values}}const mMe=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function gMe(t,e){const r=[rt(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),rt(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const i=[];return r.forEach(a=>{if(mMe(a))i.push(...a.allOf),a.unevaluatedProperties===void 0&&(n=void 0);else{let s=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:o,...u}=a;s=u}else n=void 0;i.push(s)}}),i.length?{allOf:i,...n}:void 0}function yMe(t,e){const r=typeof t.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[t.value]}:{type:r==="bigint"?"integer":r,const:t.value}}let xO;const Ru={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(xO===void 0&&(xO=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),xO),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function c8(t,e){const r={type:"string"};function n(i){return e.patternStrategy==="escape"?vMe(i):i}if(t.checks)for(const i of t.checks)switch(i.kind){case"min":ct(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,i.value):i.value,i.message,e);break;case"max":ct(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,i.value):i.value,i.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Zi(r,"email",i.message,e);break;case"format:idn-email":Zi(r,"idn-email",i.message,e);break;case"pattern:zod":Xi(r,Ru.email,i.message,e);break}break;case"url":Zi(r,"uri",i.message,e);break;case"uuid":Zi(r,"uuid",i.message,e);break;case"regex":Xi(r,i.regex,i.message,e);break;case"cuid":Xi(r,Ru.cuid,i.message,e);break;case"cuid2":Xi(r,Ru.cuid2,i.message,e);break;case"startsWith":Xi(r,RegExp(`^${n(i.value)}`),i.message,e);break;case"endsWith":Xi(r,RegExp(`${n(i.value)}$`),i.message,e);break;case"datetime":Zi(r,"date-time",i.message,e);break;case"date":Zi(r,"date",i.message,e);break;case"time":Zi(r,"time",i.message,e);break;case"duration":Zi(r,"duration",i.message,e);break;case"length":ct(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,i.value):i.value,i.message,e),ct(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,i.value):i.value,i.message,e);break;case"includes":{Xi(r,RegExp(n(i.value)),i.message,e);break}case"ip":{i.version!=="v6"&&Zi(r,"ipv4",i.message,e),i.version!=="v4"&&Zi(r,"ipv6",i.message,e);break}case"emoji":Xi(r,Ru.emoji,i.message,e);break;case"ulid":{Xi(r,Ru.ulid,i.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Zi(r,"binary",i.message,e);break}case"contentEncoding:base64":{ct(r,"contentEncoding","base64",i.message,e);break}case"pattern:zod":{Xi(r,Ru.base64,i.message,e);break}}break}case"nanoid":Xi(r,Ru.nanoid,i.message,e)}return r}const vMe=t=>Array.from(t).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),Zi=(t,e,r,n)=>{var i;t.format||(i=t.anyOf)!=null&&i.some(a=>a.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&n.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...r&&n.errorMessages&&{errorMessage:{format:r}}})):ct(t,"format",e,r,n)},Xi=(t,e,r,n)=>{var i;t.pattern||(i=t.allOf)!=null&&i.some(a=>a.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&n.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:UL(e,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):ct(t,"pattern",UL(e,n),r,n)},UL=(t,e)=>{var l;const r=typeof t=="function"?t():t;if(!e.applyRegexFlags||!r.flags)return r.source;const n={i:r.flags.includes("i"),m:r.flags.includes("m"),s:r.flags.includes("s")},i=n.i?r.source.toLowerCase():r.source;let a="",s=!1,o=!1,u=!1;for(let c=0;c<i.length;c++){if(s){a+=i[c],s=!1;continue}if(n.i){if(o){if(i[c].match(/[a-z]/)){u?(a+=i[c],a+=`${i[c-2]}-${i[c]}`.toUpperCase(),u=!1):i[c+1]==="-"&&((l=i[c+2])!=null&&l.match(/[a-z]/))?(a+=i[c],u=!0):a+=`${i[c]}${i[c].toUpperCase()}`;continue}}else if(i[c].match(/[a-z]/)){a+=`[${i[c]}${i[c].toUpperCase()}]`;continue}}if(n.m){if(i[c]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(i[c]==="$"){a+=`($|(?=[\r
]))`;continue}}if(n.s&&i[c]==="."){a+=o?`${i[c]}\r
`:`[${i[c]}\r
]`;continue}a+=i[c],i[c]==="\\"?s=!0:o&&i[c]==="]"?o=!1:!o&&i[c]==="["&&(o=!0)}try{const c=new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),r.source}return a};function h8(t,e){var n,i,a,s;if(e.target==="openApi3"&&((n=t.keyType)==null?void 0:n._def.typeName)===Z.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((o,u)=>({...o,[u]:rt(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",u]})??{}}),{}),additionalProperties:!1};const r={type:"object",additionalProperties:rt(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return r;if(((i=t.keyType)==null?void 0:i._def.typeName)===Z.ZodString&&((a=t.keyType._def.checks)!=null&&a.length)){const o=Object.entries(c8(t.keyType._def,e)).reduce((u,[l,c])=>l==="type"?u:{...u,[l]:c},{});return{...r,propertyNames:o}}else if(((s=t.keyType)==null?void 0:s._def.typeName)===Z.ZodEnum)return{...r,propertyNames:{enum:t.keyType._def.values}};return r}function bMe(t,e){if(e.mapStrategy==="record")return h8(t,e);const r=rt(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=rt(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function wMe(t){const e=t.values,n=Object.keys(t.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),i=Array.from(new Set(n.map(a=>typeof a)));return{type:i.length===1?i[0]==="string"?"string":"number":["string","number"],enum:n}}function _Me(){return{not:{}}}function xMe(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Sw={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function OMe(t,e){if(e.target==="openApi3")return zL(t,e);const r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every(n=>n._def.typeName in Sw&&(!n._def.checks||!n._def.checks.length))){const n=r.reduce((i,a)=>{const s=Sw[a._def.typeName];return s&&!i.includes(s)?[...i,s]:i},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){const n=r.reduce((i,a)=>{const s=typeof a._def.value;switch(s){case"string":case"number":case"boolean":return[...i,s];case"bigint":return[...i,"integer"];case"object":if(a._def.value===null)return[...i,"null"];case"symbol":case"undefined":case"function":default:return i}},[]);if(n.length===r.length){const i=n.filter((a,s,o)=>o.indexOf(a)===s);return{type:i.length>1?i:i[0],enum:r.reduce((a,s)=>a.includes(s._def.value)?a:[...a,s._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,i)=>[...n,...i._def.values.filter(a=>!n.includes(a))],[])};return zL(t,e)}const zL=(t,e)=>{const r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((n,i)=>rt(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${i}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function SMe(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:Sw[t.innerType._def.typeName],nullable:!0}:{type:[Sw[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const n=rt(t.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const r=rt(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function PMe(t,e){const r={type:"number"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"int":r.type="integer",u8(r,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?ct(r,"minimum",n.value,n.message,e):ct(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),ct(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?ct(r,"maximum",n.value,n.message,e):ct(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),ct(r,"maximum",n.value,n.message,e));break;case"multipleOf":ct(r,"multipleOf",n.value,n.message,e);break}return r}function EMe(t,e){return e.removeAdditionalStrategy==="strict"?t.catchall._def.typeName==="ZodNever"?t.unknownKeys!=="strict":rt(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":rt(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function AMe(t,e){const r={type:"object",...Object.entries(t.shape()).reduce((n,[i,a])=>{if(a===void 0||a._def===void 0)return n;const s=rt(a._def,{...e,currentPath:[...e.currentPath,"properties",i],propertyPath:[...e.currentPath,"properties",i]});return s===void 0?n:{properties:{...n.properties,[i]:s},required:a.isOptional()?n.required:[...n.required,i]}},{properties:{},required:[]}),additionalProperties:EMe(t,e)};return r.required.length||delete r.required,r}const TMe=(t,e)=>{var n;if(e.currentPath.toString()===((n=e.propertyPath)==null?void 0:n.toString()))return rt(t.innerType._def,e);const r=rt(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}},kMe=(t,e)=>{if(e.pipeStrategy==="input")return rt(t.in._def,e);if(e.pipeStrategy==="output")return rt(t.out._def,e);const r=rt(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=rt(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(i=>i!==void 0)}};function CMe(t,e){return rt(t.type._def,e)}function IMe(t,e){const n={type:"array",uniqueItems:!0,items:rt(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&ct(n,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&ct(n,"maxItems",t.maxSize.value,t.maxSize.message,e),n}function $Me(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((r,n)=>rt(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:rt(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((r,n)=>rt(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function jMe(){return{not:{}}}function RMe(){return{}}const NMe=(t,e)=>rt(t.innerType._def,e);function rt(t,e,r=!1){var s;const n=e.seen.get(t);if(e.override){const o=(s=e.override)==null?void 0:s.call(e,t,e,n,r);if(o!==rMe)return o}if(n&&!r){const o=MMe(n,e);if(o!==void 0)return o}const i={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,i);const a=LMe(t,t.typeName,e);return a&&FMe(t,e,a),i.jsonSchema=a,a}const MMe=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:DMe(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((r,n)=>e.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},DMe=(t,e)=>{let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString(),...e.slice(r)].join("/")},LMe=(t,e,r)=>{switch(e){case Z.ZodString:return c8(t,r);case Z.ZodNumber:return PMe(t,r);case Z.ZodObject:return AMe(t,r);case Z.ZodBigInt:return oMe(t,r);case Z.ZodBoolean:return uMe();case Z.ZodDate:return l8(t,r);case Z.ZodUndefined:return jMe();case Z.ZodNull:return xMe(r);case Z.ZodArray:return sMe(t,r);case Z.ZodUnion:case Z.ZodDiscriminatedUnion:return OMe(t,r);case Z.ZodIntersection:return gMe(t,r);case Z.ZodTuple:return $Me(t,r);case Z.ZodRecord:return h8(t,r);case Z.ZodLiteral:return yMe(t,r);case Z.ZodEnum:return pMe(t);case Z.ZodNativeEnum:return wMe(t);case Z.ZodNullable:return SMe(t,r);case Z.ZodOptional:return TMe(t,r);case Z.ZodMap:return bMe(t,r);case Z.ZodSet:return IMe(t,r);case Z.ZodLazy:return rt(t.getter()._def,r);case Z.ZodPromise:return CMe(t,r);case Z.ZodNaN:case Z.ZodNever:return _Me();case Z.ZodEffects:return fMe(t,r);case Z.ZodAny:return aMe();case Z.ZodUnknown:return RMe();case Z.ZodDefault:return dMe(t,r);case Z.ZodBranded:return lMe(t,r);case Z.ZodReadonly:return NMe(t,r);case Z.ZodCatch:return cMe(t,r);case Z.ZodPipeline:return kMe(t,r);case Z.ZodFunction:case Z.ZodVoid:case Z.ZodSymbol:return;default:return(n=>{})()}},FMe=(t,e,r)=>(t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r),Ur=(t,e)=>{const r=iMe(e),n=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((u,[l,c])=>({...u,[l]:rt(c._def,{...r,currentPath:[...r.basePath,r.definitionPath,l]},!0)??{}}),{}):void 0,i=typeof e=="string"?e:(e==null?void 0:e.nameStrategy)==="title"||e==null?void 0:e.name,a=rt(t._def,i===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,i]},!1)??{},s=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;s!==void 0&&(a.title=s);const o=i===void 0?n?{...a,[r.definitionPath]:n}:a:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,i].join("/"),[r.definitionPath]:{...n,[i]:a}};return r.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":r.target==="jsonSchema2019-09"&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o};function OO(t){return t.replace(/[^a-zA-Z-_0-9]/g,"_")}function UMe(t,e){const r=e[t.source]??t.source,n=e[t.target]??t.target;return[r,n]}function zMe(t){let e="";for(const[r,n]of Object.entries(t))e+=`	classDef ${r}class fill:${n};
`;return e}function BMe(t,e,r){const{firstNodeLabel:n,lastNodeLabel:i,nodeColors:a,withStyles:s=!0,curveStyle:o="linear",wrapLabelNWords:u=9}=r??{};let l=s?`%%{init: {'flowchart': {'curve': '${o}'}}}%%
graph TD;
`:`graph TD;
`;if(s){const h="default",d={[h]:"{0}([{1}]):::otherclass"};n!==void 0&&(d[n]="{0}[{0}]:::startclass"),i!==void 0&&(d[i]="{0}[{0}]:::endclass");for(const f of Object.values(t)){const p=d[f]??d[h],m=OO(f),g=f.split(":"),v=g[g.length-1];l+=`	${p.replace(/\{0\}/g,m).replace(/\{1\}/g,v)};
`}}let c="";for(const h of e){const d=h.source.includes(":")?h.source.split(":")[0]:void 0,f=h.target.includes(":")?h.target.split(":")[0]:void 0;c!==""&&(c!==d||c!==f)&&(l+=`	end
`,c=""),c===""&&d!==void 0&&d===f&&(l=`	subgraph ${d}
`,c=d);const[p,m]=UMe(h,t);let g="";if(h.data!==void 0){let v=h.data;const y=v.split(" ");y.length>u&&(v=y.reduce((b,w,_)=>(_%u===0&&b.push(""),b[b.length-1]+=` ${w}`,b),[]).join("<br>")),h.conditional?g=` -. ${v} .-> `:g=` -- ${v} --> `}else h.conditional?g=" -.-> ":g=" --> ";l+=`	${OO(p)}${g}${OO(m)};
`}return c!==""&&(l+=`end
`),s&&a!==void 0&&(l+=zMe(a)),l}async function qMe(t,e){let{backgroundColor:r="white"}=e??{};const n=btoa(t);r!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(r)||(r=`!${r}`));const i=`https://mermaid.ink/img/${n}?bgColor=${r}`,a=await fetch(i);if(!a.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${a.status}`,`Status text: ${a.statusText}`].join(`
`));return await a.blob()}const BL=42;function SO(t){if(ww(t.id))if(RC(t.data))try{let e=t.data.getName();return e=e.startsWith("Runnable")?e.slice(8):e,e.length>BL&&(e=`${e.substring(0,BL)}...`),e}catch{return t.data.getName()}else return t.data.name??"UnknownSchema";else return t.id}function KMe(t){return RC(t.data)?{type:"runnable",data:{id:t.data.lc_id,name:t.data.getName()}}:{type:"schema",data:{...Ur(t.data.schema),title:t.data.name}}}class d8{constructor(){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]})}toJSON(){const e={};return Object.values(this.nodes).forEach((r,n)=>{e[r.id]=ww(r.id)?n:r.id}),{nodes:Object.values(this.nodes).map(r=>({id:e[r.id],...KMe(r)})),edges:this.edges.map(r=>r.data?{source:e[r.source],target:e[r.target],data:r.data}:{source:e[r.source],target:e[r.target]})}}addNode(e,r){if(r!==void 0&&this.nodes[r]!==void 0)throw new Error(`Node with id ${r} already exists`);const n=r||Fa(),i={id:n,data:e};return this.nodes[n]=i,i}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(r=>r.source!==e.id&&r.target!==e.id)}addEdge(e,r,n,i){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[r.id]===void 0)throw new Error(`Target node ${r.id} not in graph`);const a={source:e.id,target:r.id,data:n,conditional:i};return this.edges.push(a),a}firstNode(){const e=new Set(this.edges.map(n=>n.target)),r=[];return Object.values(this.nodes).forEach(n=>{e.has(n.id)||r.push(n)}),r[0]}lastNode(){const e=new Set(this.edges.map(n=>n.source)),r=[];return Object.values(this.nodes).forEach(n=>{e.has(n.id)||r.push(n)}),r[0]}extend(e,r=""){let n=r;Object.values(e.nodes).map(l=>l.id).every(ww)&&(n="");const a=l=>n?`${n}:${l}`:l;Object.entries(e.nodes).forEach(([l,c])=>{this.nodes[a(l)]={...c,id:a(l)}});const s=e.edges.map(l=>({...l,source:a(l.source),target:a(l.target)}));this.edges=[...this.edges,...s];const o=e.firstNode(),u=e.lastNode();return[o?{id:a(o.id),data:o.data}:void 0,u?{id:a(u.id),data:u.data}:void 0]}trimFirstNode(){const e=this.firstNode();if(e){const r=this.edges.filter(n=>n.source===e.id);(Object.keys(this.nodes).length===1||r.length===1)&&this.removeNode(e)}}trimLastNode(){const e=this.lastNode();if(e){const r=this.edges.filter(n=>n.target===e.id);(Object.keys(this.nodes).length===1||r.length===1)&&this.removeNode(e)}}drawMermaid(e){const{withStyles:r,curveStyle:n,nodeColors:i={start:"#ffdfba",end:"#baffc9",other:"#fad7de"},wrapLabelNWords:a}=e??{},s={};for(const h of Object.values(this.nodes))s[h.id]=SO(h);const o=this.firstNode(),u=o?SO(o):void 0,l=this.lastNode(),c=l?SO(l):void 0;return BMe(s,this.edges,{firstNodeLabel:u,lastNodeLabel:c,withStyles:r,curveStyle:n,nodeColors:i,wrapLabelNWords:a})}async drawMermaidPng(e){const r=this.drawMermaid(e);return qMe(r,{backgroundColor:e==null?void 0:e.backgroundColor})}}function VMe(t){const e=new TextEncoder,r=new ReadableStream({async start(n){for await(const i of t)n.enqueue(e.encode(`event: data
data: ${JSON.stringify(i)}

`));n.enqueue(e.encode(`event: end

`)),n.close()}});return mn.fromReadableStream(r)}function qL(t){return typeof t=="object"&&t!==null&&typeof t[Symbol.iterator]=="function"&&typeof t.next=="function"}const HMe=t=>t!=null&&typeof t=="object"&&"next"in t&&typeof t.next=="function";function eA(t){return typeof t=="object"&&t!==null&&typeof t[Symbol.asyncIterator]=="function"}function*KL(t,e){for(;;){const{value:r,done:n}=mu.runWithConfig(t,e.next.bind(e),!0);if(n)break;yield r}}async function*VL(t,e){const r=e[Symbol.asyncIterator]();for(;;){const{value:n,done:i}=await mu.runWithConfig(t,r.next.bind(e),!0);if(i)break;yield n}}function f8(t){return!!(t&&typeof t=="object"&&"type"in t&&t.type==="tool_call")}class Um extends Error{constructor(e,r){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=r}}function Jt(t,e){return t&&!Array.isArray(t)&&!(t instanceof Date)&&typeof t=="object"?t:{[e]:t}}class Je extends Or{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const r=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${r}${e}`:r}bind(e){return new as({bound:this,kwargs:e,config:{}})}map(){return new Zh({bound:this})}withRetry(e){return new NC({bound:this,kwargs:{},config:{},maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}withConfig(e){return new as({bound:this,config:e,kwargs:{}})}withFallbacks(e){const r=Array.isArray(e)?e:e.fallbacks;return new MC({runnable:this,fallbacks:r})}_getOptionsList(e,r=0){if(Array.isArray(e)&&e.length!==r)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${r} inputs`);if(Array.isArray(e))return e.map(Ve);if(r>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const n=Object.fromEntries(Object.entries(e).filter(([i])=>i!=="runId"));return Array.from({length:r},(i,a)=>Ve(a===0?e:n))}return Array.from({length:r},()=>Ve(e))}async batch(e,r,n){var u;const i=this._getOptionsList(r??{},e.length),a=((u=i[0])==null?void 0:u.maxConcurrency)??(n==null?void 0:n.maxConcurrency),s=new Zl({maxConcurrency:a,onFailedAttempt:l=>{throw l}}),o=e.map((l,c)=>s.call(async()=>{try{return await this.invoke(l,i[c])}catch(h){if(n!=null&&n.returnExceptions)return h;throw h}}));return Promise.all(o)}async*_streamIterator(e,r){yield this.invoke(e,r)}async stream(e,r){const n=Ve(r),i=new Jl({generator:this._streamIterator(e,n),config:n});return await i.setup,mn.fromAsyncGenerator(i)}_separateRunnableConfigFromCallOptions(e){let r;e===void 0?r=Ve(e):r=Ve({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const n={...e};return delete n.callbacks,delete n.tags,delete n.metadata,delete n.runName,delete n.configurable,delete n.recursionLimit,delete n.maxConcurrency,delete n.runId,delete n.timeout,delete n.signal,[r,n]}async _callWithConfig(e,r,n){const i=Ve(n),a=await Zr(i),s=await(a==null?void 0:a.handleChainStart(this.toJSON(),Jt(r,"input"),i.runId,i==null?void 0:i.runType,void 0,void 0,(i==null?void 0:i.runName)??this.getName()));delete i.runId;let o;try{const u=e.call(this,r,i,s);o=await gu(u,n==null?void 0:n.signal)}catch(u){throw await(s==null?void 0:s.handleChainError(u)),u}return await(s==null?void 0:s.handleChainEnd(Jt(o,"output"))),o}async _batchWithConfig(e,r,n,i){var l;const a=this._getOptionsList(n??{},r.length),s=await Promise.all(a.map(Zr)),o=await Promise.all(s.map(async(c,h)=>{const d=await(c==null?void 0:c.handleChainStart(this.toJSON(),Jt(r[h],"input"),a[h].runId,a[h].runType,void 0,void 0,a[h].runName??this.getName()));return delete a[h].runId,d}));let u;try{const c=e.call(this,r,a,o,i);u=await gu(c,(l=a==null?void 0:a[0])==null?void 0:l.signal)}catch(c){throw await Promise.all(o.map(h=>h==null?void 0:h.handleChainError(c))),c}return await Promise.all(o.map(c=>c==null?void 0:c.handleChainEnd(Jt(u,"output")))),u}async*_transformStreamWithConfig(e,r,n){let i,a=!0,s,o=!0;const u=Ve(n),l=await Zr(u);async function*c(){for await(const d of e){if(a)if(i===void 0)i=d;else try{i=cn(i,d)}catch{i=void 0,a=!1}yield d}}let h;try{const d=await s8(r.bind(this),c(),async()=>l==null?void 0:l.handleChainStart(this.toJSON(),{input:""},u.runId,u.runType,void 0,void 0,u.runName??this.getName()),n==null?void 0:n.signal,u);delete u.runId,h=d.setup;const f=h==null?void 0:h.handlers.find(jC);let p=d.output;f!==void 0&&h!==void 0&&(p=f.tapOutputIterable(h.runId,p));const m=h==null?void 0:h.handlers.find(J_);m!==void 0&&h!==void 0&&(p=m.tapOutputIterable(h.runId,p));for await(const g of p)if(yield g,o)if(s===void 0)s=g;else try{s=cn(s,g)}catch{s=void 0,o=!1}}catch(d){throw await(h==null?void 0:h.handleChainError(d,void 0,void 0,void 0,{inputs:Jt(i,"input")})),d}await(h==null?void 0:h.handleChainEnd(s??{},void 0,void 0,void 0,{inputs:Jt(i,"input")}))}getGraph(e){const r=new d8,n=r.addNode({name:`${this.getName()}Input`,schema:tt.any()}),i=r.addNode(this),a=r.addNode({name:`${this.getName()}Output`,schema:tt.any()});return r.addEdge(n,i),r.addEdge(i,a),r}pipe(e){return new wr({first:this,last:ga(e)})}pick(e){return this.pipe(new X_(e))}assign(e){return this.pipe(new Z_(new vo({steps:e})))}async*transform(e,r){let n;for await(const i of e)n===void 0?n=i:n=cn(n,i);yield*this._streamIterator(n,Ve(r))}async*streamLog(e,r,n){const i=new XE({...n,autoClose:!1,_schemaFormat:"original"}),a=Ve(r);yield*this._streamLog(e,i,a)}async*_streamLog(e,r,n){const{callbacks:i}=n;if(i===void 0)n.callbacks=[r];else if(Array.isArray(i))n.callbacks=i.concat([r]);else{const u=i.copy();u.inheritableHandlers.push(r),n.callbacks=u}const a=this.stream(e,n);async function s(){try{const u=await a;for await(const l of u){const c=new Ua({ops:[{op:"add",path:"/streamed_output/-",value:l}]});await r.writer.write(c)}}finally{await r.writer.close()}}const o=s();try{for await(const u of r)yield u}finally{await o}}streamEvents(e,r,n){let i;if(r.version==="v1")i=this._streamEventsV1(e,r,n);else if(r.version==="v2")i=this._streamEventsV2(e,r,n);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return r.encoding==="text/event-stream"?VMe(i):mn.fromAsyncGenerator(i)}async*_streamEventsV2(e,r,n){var f;const i=new J2e({...n,autoClose:!1}),a=Ve(r),s=a.runId??Fa();a.runId=s;const o=a.callbacks;if(o===void 0)a.callbacks=[i];else if(Array.isArray(o))a.callbacks=o.concat(i);else{const p=o.copy();p.inheritableHandlers.push(i),a.callbacks=p}const u=this;async function l(){try{const p=await u.stream(e,a),m=i.tapOutputIterable(s,p);for await(const g of m);}finally{await i.finish()}}const c=l();let h=!1,d;try{for await(const p of i){if(!h){p.data.input=e,h=!0,d=p.run_id,yield p;continue}p.run_id===d&&p.event.endsWith("_end")&&(f=p.data)!=null&&f.input&&delete p.data.input,yield p}}finally{await c}}async*_streamEventsV1(e,r,n){let i,a=!1;const s=Ve(r),o=s.tags??[],u=s.metadata??{},l=s.runName??this.getName(),c=new XE({...n,autoClose:!1,_schemaFormat:"streaming_events"}),h=new tMe({...n}),d=this._streamLog(e,c,s);for await(const p of d){if(i?i=i.concat(p):i=$l.fromRunLogPatch(p),i.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!a){a=!0;const y={...i.state},b={run_id:y.id,event:`on_${y.type}_start`,name:l,tags:o,metadata:u,data:{input:e}};h.includeEvent(b,y.type)&&(yield b)}const m=p.ops.filter(y=>y.path.startsWith("/logs/")).map(y=>y.path.split("/")[2]),g=[...new Set(m)];for(const y of g){let b,w={};const _=i.state.logs[y];if(_.end_time===void 0?_.streamed_output.length>0?b="stream":b="start":b="end",b==="start")_.inputs!==void 0&&(w.input=_.inputs);else if(b==="end")_.inputs!==void 0&&(w.input=_.inputs),w.output=_.final_output;else if(b==="stream"){const O=_.streamed_output.length;if(O!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${O} instead. Encountered in: "${_.name}"`);w={chunk:_.streamed_output[0]},_.streamed_output=[]}yield{event:`on_${_.type}_${b}`,name:_.name,run_id:_.id,tags:_.tags,metadata:_.metadata,data:w}}const{state:v}=i;if(v.streamed_output.length>0){const y=v.streamed_output.length;if(y!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${y} instead. Encountered in: "${v.name}"`);const b={chunk:v.streamed_output[0]};v.streamed_output=[];const w={event:`on_${v.type}_stream`,run_id:v.id,tags:o,metadata:u,name:l,data:b};h.includeEvent(w,v.type)&&(yield w)}}const f=i==null?void 0:i.state;if(f!==void 0){const p={event:`on_${f.type}_end`,name:l,run_id:f.id,tags:o,metadata:u,data:{output:f.final_output}};h.includeEvent(p,f.type)&&(yield p)}}static isRunnable(e){return RC(e)}withListeners({onStart:e,onEnd:r,onError:n}){return new as({bound:this,config:{},configFactories:[i=>({callbacks:[new o8({config:i,onStart:e,onEnd:r,onError:n})]})]})}asTool(e){return YMe(this,e)}}class as extends Je{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const r=QE(this.config,...e);return QE(r,...this.configFactories?await Promise.all(this.configFactories.map(async n=>await n(r))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}async invoke(e,r){return this.bound.invoke(e,await this._mergeConfig(Ve(r),this.kwargs))}async batch(e,r,n){const i=Array.isArray(r)?await Promise.all(r.map(async a=>this._mergeConfig(Ve(a),this.kwargs))):await this._mergeConfig(Ve(r),this.kwargs);return this.bound.batch(e,i,n)}async*_streamIterator(e,r){yield*this.bound._streamIterator(e,await this._mergeConfig(Ve(r),this.kwargs))}async stream(e,r){return this.bound.stream(e,await this._mergeConfig(Ve(r),this.kwargs))}async*transform(e,r){yield*this.bound.transform(e,await this._mergeConfig(Ve(r),this.kwargs))}streamEvents(e,r,n){const i=this,a=async function*(){yield*i.bound.streamEvents(e,{...await i._mergeConfig(Ve(r),i.kwargs),version:r.version},n)};return mn.fromAsyncGenerator(a())}static isRunnableBinding(e){return e.bound&&Je.isRunnable(e.bound)}withListeners({onStart:e,onEnd:r,onError:n}){return new as({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[i=>({callbacks:[new o8({config:i,onStart:e,onEnd:r,onError:n})]})]})}}class Zh extends Je{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new Zh({bound:this.bound.bind(e)})}async invoke(e,r){return this._callWithConfig(this._invoke,e,r)}async _invoke(e,r,n){return this.bound.batch(e,xt(r,{callbacks:n==null?void 0:n.getChild()}))}withListeners({onStart:e,onEnd:r,onError:n}){return new Zh({bound:this.bound.withListeners({onStart:e,onEnd:r,onError:n})})}}class NC extends as{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,r,n){const i=e>1?`retry:attempt:${e}`:void 0;return xt(r,{callbacks:n==null?void 0:n.getChild(i)})}async _invoke(e,r,n){return bw(i=>super.invoke(e,this._patchConfigForRetry(i,r,n)),{onFailedAttempt:i=>this.onFailedAttempt(i,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,r){return this._callWithConfig(this._invoke,e,r)}async _batch(e,r,n,i){const a={};try{await bw(async s=>{const o=e.map((d,f)=>f).filter(d=>a[d.toString()]===void 0||a[d.toString()]instanceof Error),u=o.map(d=>e[d]),l=o.map(d=>this._patchConfigForRetry(s,r==null?void 0:r[d],n==null?void 0:n[d])),c=await super.batch(u,l,{...i,returnExceptions:!0});let h;for(let d=0;d<c.length;d+=1){const f=c[d],p=o[d];f instanceof Error&&h===void 0&&(h=f,h.input=u[d]),a[p.toString()]=f}if(h)throw h;return c},{onFailedAttempt:s=>this.onFailedAttempt(s,s.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(s){if((i==null?void 0:i.returnExceptions)!==!0)throw s}return Object.keys(a).sort((s,o)=>parseInt(s,10)-parseInt(o,10)).map(s=>a[parseInt(s,10)])}async batch(e,r,n){return this._batchWithConfig(this._batch.bind(this),e,r,n)}}class wr extends Je{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,r){var u;const n=Ve(r),i=await Zr(n),a=await(i==null?void 0:i.handleChainStart(this.toJSON(),Jt(e,"input"),n.runId,void 0,void 0,void 0,n==null?void 0:n.runName));delete n.runId;let s=e,o;try{const l=[this.first,...this.middle];for(let c=0;c<l.length;c+=1){const d=l[c].invoke(s,xt(n,{callbacks:a==null?void 0:a.getChild(`seq:step:${c+1}`)}));s=await gu(d,r==null?void 0:r.signal)}if((u=r==null?void 0:r.signal)!=null&&u.aborted)throw new Error("Aborted");o=await this.last.invoke(s,xt(n,{callbacks:a==null?void 0:a.getChild(`seq:step:${this.steps.length}`)}))}catch(l){throw await(a==null?void 0:a.handleChainError(l)),l}return await(a==null?void 0:a.handleChainEnd(Jt(o,"output"))),o}async batch(e,r,n){var u;const i=this._getOptionsList(r??{},e.length),a=await Promise.all(i.map(Zr)),s=await Promise.all(a.map(async(l,c)=>{const h=await(l==null?void 0:l.handleChainStart(this.toJSON(),Jt(e[c],"input"),i[c].runId,void 0,void 0,void 0,i[c].runName));return delete i[c].runId,h}));let o=e;try{for(let l=0;l<this.steps.length;l+=1){const h=this.steps[l].batch(o,s.map((d,f)=>{const p=d==null?void 0:d.getChild(`seq:step:${l+1}`);return xt(i[f],{callbacks:p})}),n);o=await gu(h,(u=i[0])==null?void 0:u.signal)}}catch(l){throw await Promise.all(s.map(c=>c==null?void 0:c.handleChainError(l))),l}return await Promise.all(s.map(l=>l==null?void 0:l.handleChainEnd(Jt(o,"output")))),o}async*_streamIterator(e,r){var h;const n=await Zr(r),{runId:i,...a}=r??{},s=await(n==null?void 0:n.handleChainStart(this.toJSON(),Jt(e,"input"),i,void 0,void 0,void 0,a==null?void 0:a.runName)),o=[this.first,...this.middle,this.last];let u=!0,l;async function*c(){yield e}try{let d=o[0].transform(c(),xt(a,{callbacks:s==null?void 0:s.getChild("seq:step:1")}));for(let f=1;f<o.length;f+=1)d=await o[f].transform(d,xt(a,{callbacks:s==null?void 0:s.getChild(`seq:step:${f+1}`)}));for await(const f of d)if((h=r==null?void 0:r.signal)==null||h.throwIfAborted(),yield f,u)if(l===void 0)l=f;else try{l=cn(l,f)}catch{l=void 0,u=!1}}catch(d){throw await(s==null?void 0:s.handleChainError(d)),d}await(s==null?void 0:s.handleChainEnd(Jt(l,"output")))}getGraph(e){const r=new d8;let n=null;return this.steps.forEach((i,a)=>{const s=i.getGraph(e);a!==0&&s.trimFirstNode(),a!==this.steps.length-1&&s.trimLastNode(),r.extend(s);const o=s.firstNode();if(!o)throw new Error(`Runnable ${i} has no first node`);n&&r.addEdge(n,o),n=s.lastNode()}),r}pipe(e){return wr.isRunnableSequence(e)?new wr({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new wr({first:this.first,middle:[...this.middle,this.last],last:ga(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&Je.isRunnable(e)}static from([e,...r],n){return new wr({first:ga(e),middle:r.slice(0,-1).map(ga),last:ga(r[r.length-1]),name:n})}}class vo extends Je{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[r,n]of Object.entries(e.steps))this.steps[r]=ga(n)}static from(e){return new vo({steps:e})}async invoke(e,r){const n=Ve(r),i=await Zr(n),a=await(i==null?void 0:i.handleChainStart(this.toJSON(),{input:e},n.runId,void 0,void 0,void 0,n==null?void 0:n.runName));delete n.runId;const s={};try{const o=Object.entries(this.steps).map(async([u,l])=>{s[u]=await l.invoke(e,xt(n,{callbacks:a==null?void 0:a.getChild(`map:key:${u}`)}))});await gu(Promise.all(o),r==null?void 0:r.signal)}catch(o){throw await(a==null?void 0:a.handleChainError(o)),o}return await(a==null?void 0:a.handleChainEnd(s)),s}async*_transform(e,r,n){const i={...this.steps},a=$C(e,Object.keys(i).length),s=new Map(Object.entries(i).map(([o,u],l)=>{const c=u.transform(a[l],xt(n,{callbacks:r==null?void 0:r.getChild(`map:key:${o}`)}));return[o,c.next().then(h=>({key:o,gen:c,result:h}))]}));for(;s.size;){const o=Promise.race(s.values()),{key:u,result:l,gen:c}=await gu(o,n==null?void 0:n.signal);s.delete(u),l.done||(yield{[u]:l.value},s.set(u,c.next().then(h=>({key:u,gen:c,result:h}))))}}transform(e,r){return this._transformStreamWithConfig(e,this._transform.bind(this),r)}async stream(e,r){async function*n(){yield e}const i=Ve(r),a=new Jl({generator:this.transform(n(),i),config:i});return await a.setup,mn.fromAsyncGenerator(a)}}let WMe=class p8 extends Je{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!bC(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,r){const[n]=this._getOptionsList(r??{},1),i=await Zr(n),a=this.func(xt(n,{callbacks:i}),e);return gu(a,n==null?void 0:n.signal)}async*_streamIterator(e,r){var a,s;const[n]=this._getOptionsList(r??{},1),i=await this.invoke(e,r);if(eA(i)){for await(const o of i)(a=n==null?void 0:n.signal)==null||a.throwIfAborted(),yield o;return}if(HMe(i)){for(;;){(s=n==null?void 0:n.signal)==null||s.throwIfAborted();const o=i.next();if(o.done)break;yield o.value}return}yield i}static from(e){return new p8({func:e})}};function GMe(t){if(bC(t))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}class Qn extends Je{static lc_name(){return"RunnableLambda"}constructor(e){if(bC(e.func))return WMe.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),GMe(e.func),this.func=e.func}static from(e){return new Qn({func:e})}async _invoke(e,r,n){return new Promise((i,a)=>{const s=xt(r,{callbacks:n==null?void 0:n.getChild(),recursionLimit:((r==null?void 0:r.recursionLimit)??_O)-1});mu.runWithConfig(s,async()=>{var o,u;try{let l=await this.func(e,{...s,config:s});if(l&&Je.isRunnable(l)){if((r==null?void 0:r.recursionLimit)===0)throw new Error("Recursion limit reached.");l=await l.invoke(e,{...s,recursionLimit:(s.recursionLimit??_O)-1})}else if(eA(l)){let c;for await(const h of VL(s,l))if((o=r==null?void 0:r.signal)==null||o.throwIfAborted(),c===void 0)c=h;else try{c=cn(c,h)}catch{c=h}l=c}else if(qL(l)){let c;for(const h of KL(s,l))if((u=r==null?void 0:r.signal)==null||u.throwIfAborted(),c===void 0)c=h;else try{c=cn(c,h)}catch{c=h}l=c}i(l)}catch(l){a(l)}})})}async invoke(e,r){return this._callWithConfig(this._invoke,e,r)}async*_transform(e,r,n){var o,u;let i;for await(const l of e)if(i===void 0)i=l;else try{i=cn(i,l)}catch{i=l}const a=xt(n,{callbacks:r==null?void 0:r.getChild(),recursionLimit:((n==null?void 0:n.recursionLimit)??_O)-1}),s=await new Promise((l,c)=>{mu.runWithConfig(a,async()=>{try{const h=await this.func(i,{...a,config:a});l(h)}catch(h){c(h)}})});if(s&&Je.isRunnable(s)){if((n==null?void 0:n.recursionLimit)===0)throw new Error("Recursion limit reached.");const l=await s.stream(i,a);for await(const c of l)yield c}else if(eA(s))for await(const l of VL(a,s))(o=n==null?void 0:n.signal)==null||o.throwIfAborted(),yield l;else if(qL(s))for(const l of KL(a,s))(u=n==null?void 0:n.signal)==null||u.throwIfAborted(),yield l;else yield s}transform(e,r){return this._transformStreamWithConfig(e,this._transform.bind(this),r)}async stream(e,r){async function*n(){yield e}const i=Ve(r),a=new Jl({generator:this.transform(n(),i),config:i});return await a.setup,mn.fromAsyncGenerator(a)}}class m8 extends vo{}class MC extends Je{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,r){var l;const n=Ve(r),i=await Zr(r),{runId:a,...s}=n,o=await(i==null?void 0:i.handleChainStart(this.toJSON(),Jt(e,"input"),a,void 0,void 0,void 0,s==null?void 0:s.runName));let u;for(const c of this.runnables()){(l=n==null?void 0:n.signal)==null||l.throwIfAborted();try{const h=await c.invoke(e,xt(s,{callbacks:o==null?void 0:o.getChild()}));return await(o==null?void 0:o.handleChainEnd(Jt(h,"output"))),h}catch(h){u===void 0&&(u=h)}}throw u===void 0?new Error("No error stored at end of fallback."):(await(o==null?void 0:o.handleChainError(u)),u)}async*_streamIterator(e,r){var h;const n=Ve(r),i=await Zr(r),{runId:a,...s}=n,o=await(i==null?void 0:i.handleChainStart(this.toJSON(),Jt(e,"input"),a,void 0,void 0,void 0,s==null?void 0:s.runName));let u,l;for(const d of this.runnables()){(h=n==null?void 0:n.signal)==null||h.throwIfAborted();const f=xt(s,{callbacks:o==null?void 0:o.getChild()});try{l=await d.stream(e,f);break}catch(p){u===void 0&&(u=p)}}if(l===void 0){const d=u??new Error("No error stored at end of fallback.");throw await(o==null?void 0:o.handleChainError(d)),d}let c;try{for await(const d of l){yield d;try{c=c===void 0?c:cn(c,d)}catch{c=void 0}}}catch(d){throw await(o==null?void 0:o.handleChainError(d)),d}await(o==null?void 0:o.handleChainEnd(Jt(c,"output")))}async batch(e,r,n){var u;if(n!=null&&n.returnExceptions)throw new Error("Not implemented.");const i=this._getOptionsList(r??{},e.length),a=await Promise.all(i.map(l=>Zr(l))),s=await Promise.all(a.map(async(l,c)=>{const h=await(l==null?void 0:l.handleChainStart(this.toJSON(),Jt(e[c],"input"),i[c].runId,void 0,void 0,void 0,i[c].runName));return delete i[c].runId,h}));let o;for(const l of this.runnables()){(u=i[0].signal)==null||u.throwIfAborted();try{const c=await l.batch(e,s.map((h,d)=>xt(i[d],{callbacks:h==null?void 0:h.getChild()})),n);return await Promise.all(s.map((h,d)=>h==null?void 0:h.handleChainEnd(Jt(c[d],"output")))),c}catch(c){o===void 0&&(o=c)}}throw o?(await Promise.all(s.map(l=>l==null?void 0:l.handleChainError(o))),o):new Error("No error stored at end of fallbacks.")}}function ga(t){if(typeof t=="function")return new Qn({func:t});if(Je.isRunnable(t))return t;if(!Array.isArray(t)&&typeof t=="object"){const e={};for(const[r,n]of Object.entries(t))e[r]=ga(n);return new vo({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class Z_ extends Je{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof vo&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,r){const n=await this.mapper.invoke(e,r);return{...e,...n}}async*_transform(e,r,n){const i=this.mapper.getStepsKeys(),[a,s]=$C(e),o=this.mapper.transform(s,xt(n,{callbacks:r==null?void 0:r.getChild()})),u=o.next();for await(const l of a){if(typeof l!="object"||Array.isArray(l))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof l}`);const c=Object.fromEntries(Object.entries(l).filter(([h])=>!i.includes(h)));Object.keys(c).length>0&&(yield c)}yield(await u).value;for await(const l of o)yield l}transform(e,r){return this._transformStreamWithConfig(e,this._transform.bind(this),r)}async stream(e,r){async function*n(){yield e}const i=Ve(r),a=new Jl({generator:this.transform(n(),i),config:i});return await a.setup,mn.fromAsyncGenerator(a)}}class X_ extends Je{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const r=this.keys.map(n=>[n,e[n]]).filter(n=>n[1]!==void 0);return r.length===0?void 0:Object.fromEntries(r)}}async invoke(e,r){return this._callWithConfig(this._pick.bind(this),e,r)}async*_transform(e){for await(const r of e){const n=await this._pick(r);n!==void 0&&(yield n)}}transform(e,r){return this._transformStreamWithConfig(e,this._transform.bind(this),r)}async stream(e,r){async function*n(){yield e}const i=Ve(r),a=new Jl({generator:this.transform(n(),i),config:i});return await a.setup,mn.fromAsyncGenerator(a)}}class tA extends as{constructor(e){const r=wr.from([Qn.from(async n=>{let i;if(f8(n))try{i=await this.schema.parseAsync(n.args)}catch{throw new Um("Received tool input did not match expected schema",JSON.stringify(n.args))}else i=n;return i}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:r,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function YMe(t,e){var i;const r=e.name??t.getName(),n=e.description??((i=e.schema)==null?void 0:i.description);return e.schema.constructor===tt.ZodString?new tA({name:r,description:n,schema:tt.object({input:tt.string()}).transform(a=>a.input),bound:t}):new tA({name:r,description:n,schema:e.schema,bound:t})}class rA extends Wn{constructor(e){super({...e,content:""}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=e.id}_getType(){return"remove"}get _printableFields(){return{...super._printableFields,id:this.id}}}const Pw=(t,e)=>{const r=[...new Set(e==null?void 0:e.map(i=>{if(typeof i=="string")return i;const a=new i({});if(!("_getType"in a)||typeof a._getType!="function")throw new Error("Invalid type provided.");return a._getType()}))],n=t._getType();return r.some(i=>i===n)};function JMe(t,e){return Array.isArray(t)?HL(t,e):Qn.from(r=>HL(r,t))}function HL(t,e={}){const{includeNames:r,excludeNames:n,includeTypes:i,excludeTypes:a,includeIds:s,excludeIds:o}=e,u=[];for(const l of t)if(!(n&&l.name&&n.includes(l.name))){{if(a&&Pw(l,a))continue;if(o&&l.id&&o.includes(l.id))continue}i||s||r?(r&&l.name&&r.some(c=>c===l.name)||i&&Pw(l,i)||s&&l.id&&s.some(c=>c===l.id))&&u.push(l):u.push(l)}return u}function ZMe(t){return Array.isArray(t)?WL(t):Qn.from(WL)}function WL(t){if(!t.length)return[];const e=[];for(const r of t){const n=r,i=e.pop();if(!i)e.push(n);else if(n._getType()==="tool"||n._getType()!==i._getType())e.push(i,n);else{const a=hw(i),s=hw(n),o=a.concat(s);typeof a.content=="string"&&typeof s.content=="string"&&(o.content=`${a.content}
${s.content}`),e.push(eDe(o))}}return e}function XMe(t,e){if(Array.isArray(t)){const r=t;if(!e)throw new Error("Options parameter is required when providing messages.");return GL(r,e)}else{const r=t;return Qn.from(n=>GL(n,r))}}async function GL(t,e){const{maxTokens:r,tokenCounter:n,strategy:i="last",allowPartial:a=!1,endOn:s,startOn:o,includeSystem:u=!1,textSplitter:l}=e;if(o&&i==="first")throw new Error("`startOn` should only be specified if `strategy` is 'last'.");if(u&&i==="first")throw new Error("`includeSystem` should only be specified if `strategy` is 'last'.");let c;"getNumTokens"in n?c=async d=>(await Promise.all(d.map(p=>n.getNumTokens(p.content)))).reduce((p,m)=>p+m,0):c=async d=>n(d);let h=v8;if(l&&("splitText"in l?h=l.splitText:h=async d=>l(d)),i==="first")return g8(t,{maxTokens:r,tokenCounter:c,textSplitter:h,partialStrategy:a?"first":void 0,endOn:s});if(i==="last")return QMe(t,{maxTokens:r,tokenCounter:c,textSplitter:h,allowPartial:a,includeSystem:u,startOn:o,endOn:s});throw new Error(`Unrecognized strategy: '${i}'. Must be one of 'first' or 'last'.`)}async function g8(t,e){const{maxTokens:r,tokenCounter:n,textSplitter:i,partialStrategy:a,endOn:s}=e;let o=[...t],u=0;for(let l=0;l<o.length;l+=1){const c=l>0?o.slice(0,-l):o;if(await n(c)<=r){u=o.length-l;break}}if(u<o.length-1&&a){let l=!1;if(Array.isArray(o[u].content)){const c=o[u];if(typeof c.content=="string")throw new Error("Expected content to be an array.");const h=c.content.length,d=a==="last"?[...c.content].reverse():c.content;for(let f=1;f<=h;f+=1){const p=a==="first"?d.slice(0,f):d.slice(-f),m=Object.fromEntries(Object.entries(c).filter(([y])=>y!=="type"&&!y.startsWith("lc_"))),g=y8(c._getType(),{...m,content:p}),v=[...o.slice(0,u),g];if(await n(v)<=r)o=v,u+=1,l=!0;else break}l&&a==="last"&&(c.content=[...d].reverse())}if(!l){const c=o[u];let h;if(Array.isArray(c.content)&&c.content.some(d=>typeof d=="string"||d.type==="text")){const d=c.content.find(f=>f.type==="text"&&f.text);h=d==null?void 0:d.text}else typeof c.content=="string"&&(h=c.content);if(h){const d=await i(h),f=d.length;a==="last"&&d.reverse();for(let p=0;p<f-1;p+=1)if(d.pop(),c.content=d.join(""),await n([...o.slice(0,u),c])<=r){a==="last"&&(c.content=[...d].reverse().join("")),o=[...o.slice(0,u),c],u+=1;break}}}}if(s){const l=Array.isArray(s)?s:[s];for(;u>0&&!Pw(o[u-1],l);)u-=1}return o.slice(0,u)}async function QMe(t,e){const{allowPartial:r=!1,includeSystem:n=!1,endOn:i,startOn:a,...s}=e;if(i){const l=Array.isArray(i)?i:[i];for(;t&&!Pw(t[t.length-1],l);)t.pop()}const o=n&&t[0]._getType()==="system";let u=o?t.slice(0,1).concat(t.slice(1).reverse()):t.reverse();return u=await g8(u,{...s,partialStrategy:r?"last":void 0,endOn:a}),o?[u[0],...u.slice(1).reverse()]:u.reverse()}const YL={human:{message:Wt,messageChunk:ws},ai:{message:pt,messageChunk:Mr},system:{message:Gn,messageChunk:_s},tool:{message:Pa,messageChunk:go},function:{message:yo,messageChunk:bs},generic:{message:gn,messageChunk:vs},remove:{message:rA,messageChunk:rA}};function y8(t,e,r){var a;let n,i;switch(t){case"human":r?n=new ws(e):i=new Wt(e);break;case"ai":if(r){let s={...e};"tool_calls"in s&&(s={...s,tool_call_chunks:(a=s.tool_calls)==null?void 0:a.map(o=>({...o,type:"tool_call_chunk",index:void 0,args:JSON.stringify(o.args)}))}),n=new Mr(s)}else i=new pt(e);break;case"system":r?n=new _s(e):i=new Gn(e);break;case"tool":if("tool_call_id"in e)r?n=new go(e):i=new Pa(e);else throw new Error("Can not convert ToolMessage to ToolMessageChunk if 'tool_call_id' field is not defined.");break;case"function":if(r)n=new bs(e);else{if(!e.name)throw new Error("FunctionMessage must have a 'name' field");i=new yo(e)}break;case"generic":if("role"in e)r?n=new vs(e):i=new gn(e);else throw new Error("Can not convert ChatMessage to ChatMessageChunk if 'role' field is not defined.");break;default:throw new Error(`Unrecognized message type ${t}`)}if(r&&n)return n;if(i)return i;throw new Error(`Unrecognized message type ${t}`)}function eDe(t){const e=t._getType();let r;const n=Object.fromEntries(Object.entries(t).filter(([i])=>!["type","tool_call_chunks"].includes(i)&&!i.startsWith("lc_")));if(e in YL&&(r=y8(e,n)),!r)throw new Error(`Unrecognized message chunk class ${e}. Supported classes are ${Object.keys(YL)}`);return r}function v8(t){const e=t.split(`
`);return Promise.resolve([...e.slice(0,-1).map(r=>`${r}
`),e[e.length-1]])}const tDe=Object.freeze(Object.defineProperty({__proto__:null,AIMessage:pt,AIMessageChunk:Mr,BaseMessage:Wn,BaseMessageChunk:mo,ChatMessage:gn,ChatMessageChunk:vs,FunctionMessage:yo,FunctionMessageChunk:bs,HumanMessage:Wt,HumanMessageChunk:ws,RemoveMessage:rA,SystemMessage:Gn,SystemMessageChunk:_s,ToolMessage:Pa,ToolMessageChunk:go,_mergeDicts:fn,_mergeLists:Eg,_mergeObj:f6,_mergeStatus:d6,coerceMessageLikeToMessage:zs,convertToChunk:hw,defaultTextSplitter:v8,filterMessages:JMe,getBufferString:Nr,isAIMessage:gC,isBaseMessage:An,isBaseMessageChunk:p6,isOpenAIToolCallArray:vIe,mapChatMessagesToStoredMessages:_Ie,mapStoredMessageToChatMessage:yC,mapStoredMessagesToChatMessages:m6,mergeContent:Yl,mergeMessageRuns:ZMe,trimMessages:XMe},Symbol.toStringTag,{value:"Module"}));var rDe=typeof window=="object"?window:{},Ue="0123456789abcdef".split(""),nDe=[-2147483648,8388608,32768,128],Qi=[24,16,8,0],Er=[];function Aa(t){t?(Er[0]=Er[16]=Er[1]=Er[2]=Er[3]=Er[4]=Er[5]=Er[6]=Er[7]=Er[8]=Er[9]=Er[10]=Er[11]=Er[12]=Er[13]=Er[14]=Er[15]=0,this.blocks=Er):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Aa.prototype.update=function(t){if(!this.finalized){var e=typeof t!="string";e&&t.constructor===rDe.ArrayBuffer&&(t=new Uint8Array(t));for(var r,n=0,i,a=t.length||0,s=this.blocks;n<a;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),e)for(i=this.start;n<a&&i<64;++n)s[i>>2]|=t[n]<<Qi[i++&3];else for(i=this.start;n<a&&i<64;++n)r=t.charCodeAt(n),r<128?s[i>>2]|=r<<Qi[i++&3]:r<2048?(s[i>>2]|=(192|r>>6)<<Qi[i++&3],s[i>>2]|=(128|r&63)<<Qi[i++&3]):r<55296||r>=57344?(s[i>>2]|=(224|r>>12)<<Qi[i++&3],s[i>>2]|=(128|r>>6&63)<<Qi[i++&3],s[i>>2]|=(128|r&63)<<Qi[i++&3]):(r=65536+((r&1023)<<10|t.charCodeAt(++n)&1023),s[i>>2]|=(240|r>>18)<<Qi[i++&3],s[i>>2]|=(128|r>>12&63)<<Qi[i++&3],s[i>>2]|=(128|r>>6&63)<<Qi[i++&3],s[i>>2]|=(128|r&63)<<Qi[i++&3]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=s[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};Aa.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[16]=this.block,t[e>>2]|=nDe[e&3],this.block=t[16],e>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}};Aa.prototype.hash=function(){var t=this.h0,e=this.h1,r=this.h2,n=this.h3,i=this.h4,a,s,o,u=this.blocks;for(s=16;s<80;++s)o=u[s-3]^u[s-8]^u[s-14]^u[s-16],u[s]=o<<1|o>>>31;for(s=0;s<20;s+=5)a=e&r|~e&n,o=t<<5|t>>>27,i=o+a+i+1518500249+u[s]<<0,e=e<<30|e>>>2,a=t&e|~t&r,o=i<<5|i>>>27,n=o+a+n+1518500249+u[s+1]<<0,t=t<<30|t>>>2,a=i&t|~i&e,o=n<<5|n>>>27,r=o+a+r+1518500249+u[s+2]<<0,i=i<<30|i>>>2,a=n&i|~n&t,o=r<<5|r>>>27,e=o+a+e+1518500249+u[s+3]<<0,n=n<<30|n>>>2,a=r&n|~r&i,o=e<<5|e>>>27,t=o+a+t+1518500249+u[s+4]<<0,r=r<<30|r>>>2;for(;s<40;s+=5)a=e^r^n,o=t<<5|t>>>27,i=o+a+i+1859775393+u[s]<<0,e=e<<30|e>>>2,a=t^e^r,o=i<<5|i>>>27,n=o+a+n+1859775393+u[s+1]<<0,t=t<<30|t>>>2,a=i^t^e,o=n<<5|n>>>27,r=o+a+r+1859775393+u[s+2]<<0,i=i<<30|i>>>2,a=n^i^t,o=r<<5|r>>>27,e=o+a+e+1859775393+u[s+3]<<0,n=n<<30|n>>>2,a=r^n^i,o=e<<5|e>>>27,t=o+a+t+1859775393+u[s+4]<<0,r=r<<30|r>>>2;for(;s<60;s+=5)a=e&r|e&n|r&n,o=t<<5|t>>>27,i=o+a+i-1894007588+u[s]<<0,e=e<<30|e>>>2,a=t&e|t&r|e&r,o=i<<5|i>>>27,n=o+a+n-1894007588+u[s+1]<<0,t=t<<30|t>>>2,a=i&t|i&e|t&e,o=n<<5|n>>>27,r=o+a+r-1894007588+u[s+2]<<0,i=i<<30|i>>>2,a=n&i|n&t|i&t,o=r<<5|r>>>27,e=o+a+e-1894007588+u[s+3]<<0,n=n<<30|n>>>2,a=r&n|r&i|n&i,o=e<<5|e>>>27,t=o+a+t-1894007588+u[s+4]<<0,r=r<<30|r>>>2;for(;s<80;s+=5)a=e^r^n,o=t<<5|t>>>27,i=o+a+i-899497514+u[s]<<0,e=e<<30|e>>>2,a=t^e^r,o=i<<5|i>>>27,n=o+a+n-899497514+u[s+1]<<0,t=t<<30|t>>>2,a=i^t^e,o=n<<5|n>>>27,r=o+a+r-899497514+u[s+2]<<0,i=i<<30|i>>>2,a=n^i^t,o=r<<5|r>>>27,e=o+a+e-899497514+u[s+3]<<0,n=n<<30|n>>>2,a=r^n^i,o=e<<5|e>>>27,t=o+a+t-899497514+u[s+4]<<0,r=r<<30|r>>>2;this.h0=this.h0+t<<0,this.h1=this.h1+e<<0,this.h2=this.h2+r<<0,this.h3=this.h3+n<<0,this.h4=this.h4+i<<0};Aa.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,r=this.h2,n=this.h3,i=this.h4;return Ue[t>>28&15]+Ue[t>>24&15]+Ue[t>>20&15]+Ue[t>>16&15]+Ue[t>>12&15]+Ue[t>>8&15]+Ue[t>>4&15]+Ue[t&15]+Ue[e>>28&15]+Ue[e>>24&15]+Ue[e>>20&15]+Ue[e>>16&15]+Ue[e>>12&15]+Ue[e>>8&15]+Ue[e>>4&15]+Ue[e&15]+Ue[r>>28&15]+Ue[r>>24&15]+Ue[r>>20&15]+Ue[r>>16&15]+Ue[r>>12&15]+Ue[r>>8&15]+Ue[r>>4&15]+Ue[r&15]+Ue[n>>28&15]+Ue[n>>24&15]+Ue[n>>20&15]+Ue[n>>16&15]+Ue[n>>12&15]+Ue[n>>8&15]+Ue[n>>4&15]+Ue[n&15]+Ue[i>>28&15]+Ue[i>>24&15]+Ue[i>>20&15]+Ue[i>>16&15]+Ue[i>>12&15]+Ue[i>>8&15]+Ue[i>>4&15]+Ue[i&15]};Aa.prototype.toString=Aa.prototype.hex;Aa.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,r=this.h2,n=this.h3,i=this.h4;return[t>>24&255,t>>16&255,t>>8&255,t&255,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24&255,r>>16&255,r>>8&255,r&255,n>>24&255,n>>16&255,n>>8&255,n&255,i>>24&255,i>>16&255,i>>8&255,i&255]};Aa.prototype.array=Aa.prototype.digest;Aa.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),t};const zm=t=>new Aa(!0).update(t).hex(),iDe=Object.freeze(Object.defineProperty({__proto__:null,insecureHash:zm},Symbol.toStringTag,{value:"Module"})),nA=(...t)=>zm(t.join("_"));function aDe(t){return t.message!==void 0?{text:t.text,message:yC(t.message)}:{text:t.text}}function sDe(t){const e={text:t.text};return t.message!==void 0&&(e.message=t.message.toDict()),e}class b8{}const oDe=new Map;class Q_ extends b8{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,r){return Promise.resolve(this.cache.get(nA(e,r))??null)}async update(e,r,n){this.cache.set(nA(e,r),n)}static global(){return new Q_(oDe)}}const uDe=Object.freeze(Object.defineProperty({__proto__:null,BaseCache:b8,InMemoryCache:Q_,deserializeStoredGeneration:aDe,getCacheKey:nA,serializeGeneration:sDe},Symbol.toStringTag,{value:"Module"}));class e1 extends Or{}class jd extends e1{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new Wt(this.value)]}}class t1 extends e1{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return Nr(this.messages)}toChatMessages(){return this.messages}}class w8 extends e1{static lc_name(){return"ImagePromptValue"}constructor(e){"imageUrl"in e||(e={imageUrl:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"imageUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.imageUrl=e.imageUrl}toString(){return this.imageUrl.url}toChatMessages(){return[new Wt({content:[{type:"image_url",image_url:{detail:this.imageUrl.detail,url:this.imageUrl.url}}]})]}}const lDe=Object.freeze(Object.defineProperty({__proto__:null,BasePromptValue:e1,ChatPromptValue:t1,ImagePromptValue:w8,StringPromptValue:jd},Symbol.toStringTag,{value:"Module"}));var r1={};r1.byteLength=dDe;r1.toByteArray=pDe;r1.fromByteArray=yDe;var Va=[],Pi=[],cDe=typeof Uint8Array<"u"?Uint8Array:Array,PO="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var pc=0,hDe=PO.length;pc<hDe;++pc)Va[pc]=PO[pc],Pi[PO.charCodeAt(pc)]=pc;Pi["-".charCodeAt(0)]=62;Pi["_".charCodeAt(0)]=63;function _8(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function dDe(t){var e=_8(t),r=e[0],n=e[1];return(r+n)*3/4-n}function fDe(t,e,r){return(e+r)*3/4-r}function pDe(t){var e,r=_8(t),n=r[0],i=r[1],a=new cDe(fDe(t,n,i)),s=0,o=i>0?n-4:n,u;for(u=0;u<o;u+=4)e=Pi[t.charCodeAt(u)]<<18|Pi[t.charCodeAt(u+1)]<<12|Pi[t.charCodeAt(u+2)]<<6|Pi[t.charCodeAt(u+3)],a[s++]=e>>16&255,a[s++]=e>>8&255,a[s++]=e&255;return i===2&&(e=Pi[t.charCodeAt(u)]<<2|Pi[t.charCodeAt(u+1)]>>4,a[s++]=e&255),i===1&&(e=Pi[t.charCodeAt(u)]<<10|Pi[t.charCodeAt(u+1)]<<4|Pi[t.charCodeAt(u+2)]>>2,a[s++]=e>>8&255,a[s++]=e&255),a}function mDe(t){return Va[t>>18&63]+Va[t>>12&63]+Va[t>>6&63]+Va[t&63]}function gDe(t,e,r){for(var n,i=[],a=e;a<r;a+=3)n=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(t[a+2]&255),i.push(mDe(n));return i.join("")}function yDe(t){for(var e,r=t.length,n=r%3,i=[],a=16383,s=0,o=r-n;s<o;s+=a)i.push(gDe(t,s,s+a>o?o:s+a));return n===1?(e=t[r-1],i.push(Va[e>>2]+Va[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(Va[e>>10]+Va[e>>4&63]+Va[e<<2&63]+"=")),i.join("")}var vDe=Object.defineProperty,bDe=(t,e,r)=>e in t?vDe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,wDe=(t,e,r)=>(bDe(t,typeof e!="symbol"?e+"":e,r),r);function _De(t,e){let r=Array.from({length:t.length},(n,i)=>({start:i,end:i+1}));for(;r.length>1;){let n=null;for(let i=0;i<r.length-1;i++){const a=t.slice(r[i].start,r[i+1].end),s=e.get(a.join(","));s!=null&&(n==null||s<n[0])&&(n=[s,i])}if(n!=null){const i=n[1];r[i]={start:r[i].start,end:r[i+1].end},r.splice(i+1,1)}else break}return r}function xDe(t,e){return t.length===1?[e.get(t.join(","))]:_De(t,e).map(r=>e.get(t.slice(r.start,r.end).join(","))).filter(r=>r!=null)}function ODe(t){return t.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var iA=class{constructor(t,e){_o(this,"specialTokens");_o(this,"inverseSpecialTokens");_o(this,"patStr");_o(this,"textEncoder",new TextEncoder);_o(this,"textDecoder",new TextDecoder("utf-8"));_o(this,"rankMap",new Map);_o(this,"textMap",new Map);this.patStr=t.pat_str;const r=t.bpe_ranks.split(`
`).filter(Boolean).reduce((n,i)=>{const[a,s,...o]=i.split(" "),u=Number.parseInt(s,10);return o.forEach((l,c)=>n[l]=u+c),n},{});for(const[n,i]of Object.entries(r)){const a=r1.toByteArray(n);this.rankMap.set(a.join(","),i),this.textMap.set(i,a)}this.specialTokens={...t.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((n,[i,a])=>(n[a]=this.textEncoder.encode(i),n),{})}encode(t,e=[],r="all"){const n=new RegExp(this.patStr,"ug"),i=iA.specialTokenRegex(Object.keys(this.specialTokens)),a=[],s=new Set(e==="all"?Object.keys(this.specialTokens):e),o=new Set(r==="all"?Object.keys(this.specialTokens).filter(l=>!s.has(l)):r);if(o.size>0){const l=iA.specialTokenRegex([...o]),c=t.match(l);if(c!=null)throw new Error(`The text contains a special token that is not allowed: ${c[0]}`)}let u=0;for(;;){let l=null,c=u;for(;i.lastIndex=c,l=i.exec(t),!(l==null||s.has(l[0]));)c=l.index+1;const h=(l==null?void 0:l.index)??t.length;for(const f of t.substring(u,h).matchAll(n)){const p=this.textEncoder.encode(f[0]),m=this.rankMap.get(p.join(","));if(m!=null){a.push(m);continue}a.push(...xDe(p,this.rankMap))}if(l==null)break;let d=this.specialTokens[l[0]];a.push(d),u=l.index+l[0].length}return a}decode(t){const e=[];let r=0;for(let a=0;a<t.length;++a){const s=t[a],o=this.textMap.get(s)??this.inverseSpecialTokens[s];o!=null&&(e.push(o),r+=o.length)}const n=new Uint8Array(r);let i=0;for(const a of e)n.set(a,i),i+=a.length;return this.textDecoder.decode(n)}},x8=iA;wDe(x8,"specialTokenRegex",t=>new RegExp(t.map(e=>ODe(e)).join("|"),"g"));function SDe(t){switch(t){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":return"o200k_base";default:throw new Error("Unknown model")}}const By={},PDe=new Zl({});async function DC(t){return t in By||(By[t]=PDe.fetch(`https://tiktoken.pages.dev/js/${t}.json`).then(e=>e.json()).then(e=>new x8(e)).catch(e=>{throw delete By[t],e})),await By[t]}async function LC(t){return DC(SDe(t))}const EDe=Object.freeze(Object.defineProperty({__proto__:null,encodingForModel:LC,getEncoding:DC},Symbol.toStringTag,{value:"Module"})),n1=t=>t.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":t.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":t.startsWith("gpt-4-32k")?"gpt-4-32k":t.startsWith("gpt-4-")?"gpt-4":t.startsWith("gpt-4o")?"gpt-4o":t,O8=t=>{switch(t){case"text-embedding-ada-002":return 8191;default:return 2046}},FC=t=>{switch(n1(t)){case"gpt-3.5-turbo-16k":return 16384;case"gpt-3.5-turbo":return 4096;case"gpt-4-32k":return 32768;case"gpt-4":return 8192;case"text-davinci-003":return 4097;case"text-curie-001":return 2048;case"text-babbage-001":return 2048;case"text-ada-001":return 2048;case"code-davinci-002":return 8e3;case"code-cushman-001":return 2048;default:return 4097}};function Rd(t){return typeof t!="object"||!t?!1:!!("type"in t&&t.type==="function"&&"function"in t&&typeof t.function=="object"&&t.function&&"name"in t.function&&"parameters"in t.function)}const S8=async({prompt:t,modelName:e})=>{let r;try{r=(await LC(n1(e))).encode(t).length}catch{console.warn("Failed to calculate number of tokens, falling back to approximate count"),r=Math.ceil(t.length/4)}return FC(e)-r},ADe=()=>!1;class i1 extends Je{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??ADe(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class a1 extends i1{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:r,...n}){super({callbacks:e??r,...n}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof n.cache=="object"?this.cache=n.cache:n.cache?this.cache=Q_.global():this.cache=void 0,this.caller=new Zl(n??{})}async getNumTokens(e){if(typeof e!="string")return 0;let r=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await LC("modelName"in this?n1(this.modelName):"gpt2")}catch(n){console.warn("Failed to calculate number of tokens, falling back to approximate count",n)}if(this._encoding)try{r=this._encoding.encode(e).length}catch(n){console.warn("Failed to calculate number of tokens, falling back to approximate count",n)}return r}static _convertInputToPromptValue(e){return typeof e=="string"?new jd(e):Array.isArray(e)?new t1(e.map(zs)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...r}){const n={...this._identifyingParams(),...r,_type:this._llmType(),_model:this._modelType()};return Object.entries(n).filter(([s,o])=>o!==void 0).map(([s,o])=>`${s}:${JSON.stringify(o)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}const TDe=Object.freeze(Object.defineProperty({__proto__:null,BaseLangChain:i1,BaseLanguageModel:a1,calculateMaxTokens:S8,getEmbeddingContextSize:O8,getModelContextSize:FC,getModelNameForTiktoken:n1,isOpenAITool:Rd},Symbol.toStringTag,{value:"Module"}));class Dr extends Je{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,r){const n=Ve(r);return this.func&&await this.func(e,n),this._callWithConfig(i=>Promise.resolve(i),e,n)}async*transform(e,r){const n=Ve(r);let i,a=!0;for await(const s of this._transformStreamWithConfig(e,o=>o,n))if(yield s,a)if(i===void 0)i=s;else try{i=cn(i,s)}catch{i=void 0,a=!1}this.func&&i!==void 0&&await this.func(i,n)}static assign(e){return new Z_(new vo({steps:e}))}}function Nd(t){return typeof(t==null?void 0:t.parse)=="function"}function kDe(){const t=new TextEncoder;return new TransformStream({transform(e,r){r.enqueue(t.encode(typeof e.content=="string"?e.content:JSON.stringify(e.content)))}})}class xn extends a1{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptionsCompat(e){const[r,n]=super._separateRunnableConfigFromCallOptions(e);return n.signal=r.signal,[r,n]}async invoke(e,r){const n=xn._convertInputToPromptValue(e);return(await this.generatePrompt([n],r,r==null?void 0:r.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,r,n){throw new Error("Not implemented.")}async*_streamIterator(e,r){if(this._streamResponseChunks===xn.prototype._streamResponseChunks)yield this.invoke(e,r);else{const i=xn._convertInputToPromptValue(e).toChatMessages(),[a,s]=this._separateRunnableConfigFromCallOptionsCompat(r),o={...a.metadata,...this.getLsParams(s)},u=await Zt.configure(a.callbacks,this.callbacks,a.tags,this.tags,o,this.metadata,{verbose:this.verbose}),l={options:s,invocation_params:this==null?void 0:this.invocationParams(s),batch_size:1},c=await(u==null?void 0:u.handleChatModelStart(this.toJSON(),[i],a.runId,void 0,l,void 0,void 0,a.runName));let h;try{for await(const d of this._streamResponseChunks(i,s,c==null?void 0:c[0]))d.message.response_metadata={...d.generationInfo,...d.message.response_metadata},yield d.message,h?h=h.concat(d):h=d}catch(d){throw await Promise.all((c??[]).map(f=>f==null?void 0:f.handleLLMError(d))),d}await Promise.all((c??[]).map(d=>d==null?void 0:d.handleLLMEnd({generations:[[h]]})))}}getLsParams(e){return{ls_model_type:"chat",ls_stop:e.stop}}async _generateUncached(e,r,n){var f;const i=e.map(p=>p.map(zs)),a={...n.metadata,...this.getLsParams(r)},s=await Zt.configure(n.callbacks,this.callbacks,n.tags,this.tags,a,this.metadata,{verbose:this.verbose}),o={options:r,invocation_params:this==null?void 0:this.invocationParams(r),batch_size:1},u=await(s==null?void 0:s.handleChatModelStart(this.toJSON(),i,n.runId,void 0,o,void 0,void 0,n.runName)),l=[],c=[];if(!!(u!=null&&u[0].handlers.find(p=>jC(p)||J_(p)))&&i.length===1&&this._streamResponseChunks!==xn.prototype._streamResponseChunks)try{const p=await this._streamResponseChunks(i[0],r,u==null?void 0:u[0]);let m;for await(const g of p)m===void 0?m=g:m=cn(m,g);if(m===void 0)throw new Error("Received empty response from chat model call.");l.push([m]),await(u==null?void 0:u[0].handleLLMEnd({generations:l,llmOutput:{}}))}catch(p){throw await(u==null?void 0:u[0].handleLLMError(p)),p}else{const p=await Promise.allSettled(i.map((m,g)=>this._generate(m,{...r,promptIndex:g},u==null?void 0:u[g])));await Promise.all(p.map(async(m,g)=>{var v,y;if(m.status==="fulfilled"){const b=m.value;for(const w of b.generations)w.message.response_metadata={...w.generationInfo,...w.message.response_metadata};return b.generations.length===1&&(b.generations[0].message.response_metadata={...b.llmOutput,...b.generations[0].message.response_metadata}),l[g]=b.generations,c[g]=b.llmOutput,(v=u==null?void 0:u[g])==null?void 0:v.handleLLMEnd({generations:[b.generations],llmOutput:b.llmOutput})}else return await((y=u==null?void 0:u[g])==null?void 0:y.handleLLMError(m.reason)),Promise.reject(m.reason)}))}const d={generations:l,llmOutput:c.length?(f=this._combineLLMOutput)==null?void 0:f.call(this,...c):void 0};return Object.defineProperty(d,br,{value:u?{runIds:u==null?void 0:u.map(p=>p.runId)}:void 0,configurable:!0}),d}async _generateCached({messages:e,cache:r,llmStringKey:n,parsedOptions:i,handledOptions:a}){const s=e.map(g=>g.map(zs)),o={...a.metadata,...this.getLsParams(i)},u=await Zt.configure(a.callbacks,this.callbacks,a.tags,this.tags,o,this.metadata,{verbose:this.verbose}),l={options:i,invocation_params:this==null?void 0:this.invocationParams(i),batch_size:1,cached:!0},c=await(u==null?void 0:u.handleChatModelStart(this.toJSON(),s,a.runId,void 0,l,void 0,void 0,a.runName)),h=[],f=(await Promise.allSettled(s.map(async(g,v)=>{const y=xn._convertInputToPromptValue(g).toString(),b=await r.lookup(y,n);return b==null&&h.push(v),b}))).map((g,v)=>({result:g,runManager:c==null?void 0:c[v]})).filter(({result:g})=>g.status==="fulfilled"&&g.value!=null||g.status==="rejected"),p=[];await Promise.all(f.map(async({result:g,runManager:v},y)=>{if(g.status==="fulfilled"){const b=g.value;return p[y]=b,b.length&&await(v==null?void 0:v.handleLLMNewToken(b[0].text)),v==null?void 0:v.handleLLMEnd({generations:[b]})}else return await(v==null?void 0:v.handleLLMError(g.reason)),Promise.reject(g.reason)}));const m={generations:p,missingPromptIndices:h};return Object.defineProperty(m,br,{value:c?{runIds:c==null?void 0:c.map(g=>g.runId)}:void 0,configurable:!0}),m}async generate(e,r,n){let i;Array.isArray(r)?i={stop:r}:i=r;const a=e.map(f=>f.map(zs)),[s,o]=this._separateRunnableConfigFromCallOptionsCompat(i);if(s.callbacks=s.callbacks??n,!this.cache)return this._generateUncached(a,o,s);const{cache:u}=this,l=this._getSerializedCacheKeyParametersForCall(o),{generations:c,missingPromptIndices:h}=await this._generateCached({messages:a,cache:u,llmStringKey:l,parsedOptions:o,handledOptions:s});let d={};if(h.length>0){const f=await this._generateUncached(h.map(p=>a[p]),o,s);await Promise.all(f.generations.map(async(p,m)=>{const g=h[m];c[g]=p;const v=xn._convertInputToPromptValue(a[g]).toString();return u.update(v,l,p)})),d=f.llmOutput??{}}return{generations:c,llmOutput:d}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,r,n){const i=e.map(a=>a.toChatMessages());return this.generate(i,r,n)}async call(e,r,n){return(await this.generate([e.map(zs)],r,n)).generations[0][0].message}async callPrompt(e,r,n){const i=e.toChatMessages();return this.call(i,r,n)}async predictMessages(e,r,n){return this.call(e,r,n)}async predict(e,r,n){const i=new Wt(e),a=await this.call([i],r,n);if(typeof a.content!="string")throw new Error("Cannot use predict when output is not a string.");return a.content}withStructuredOutput(e,r){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');const n=e,i=r==null?void 0:r.name,a=n.description??"A function available to call.",s=r==null?void 0:r.method,o=r==null?void 0:r.includeRaw;if(s==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let u=i??"extract",l;Nd(n)?l=[{type:"function",function:{name:u,description:a,parameters:Ur(n)}}]:("name"in n&&(u=n.name),l=[{type:"function",function:{name:u,description:a,parameters:n}}]);const c=this.bindTools(l),h=Qn.from(m=>{if(!m.tool_calls||m.tool_calls.length===0)throw new Error("No tool calls found in the response.");const g=m.tool_calls.find(v=>v.name===u);if(!g)throw new Error(`No tool call found with name ${u}.`);return g.args});if(!o)return c.pipe(h).withConfig({runName:"StructuredOutput"});const d=Dr.assign({parsed:(m,g)=>h.invoke(m.raw,g)}),f=Dr.assign({parsed:()=>null}),p=d.withFallbacks({fallbacks:[f]});return wr.from([{raw:c},p]).withConfig({runName:"StructuredOutputRunnable"})}}class CDe extends xn{async _generate(e,r,n){const i=await this._call(e,r,n),a=new pt(i);if(typeof a.content!="string")throw new Error("Cannot generate with a simple chat model when output is not a string.");return{generations:[{text:a.content,message:a}]}}}const IDe=Object.freeze(Object.defineProperty({__proto__:null,BaseChatModel:xn,SimpleChatModel:CDe,createChatMessageChunkEncoderStream:kDe},Symbol.toStringTag,{value:"Module"}));var Gr=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{},bn={searchParams:"URLSearchParams"in Gr,iterable:"Symbol"in Gr&&"iterator"in Symbol,blob:"FileReader"in Gr&&"Blob"in Gr&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in Gr,arrayBuffer:"ArrayBuffer"in Gr};function $De(t){return t&&DataView.prototype.isPrototypeOf(t)}if(bn.arrayBuffer)var jDe=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],RDe=ArrayBuffer.isView||function(t){return t&&jDe.indexOf(Object.prototype.toString.call(t))>-1};function Md(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||t==="")throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function UC(t){return typeof t!="string"&&(t=String(t)),t}function zC(t){var e={next:function(){var r=t.shift();return{done:r===void 0,value:r}}};return bn.iterable&&(e[Symbol.iterator]=function(){return e}),e}function Sr(t){this.map={},t instanceof Sr?t.forEach(function(e,r){this.append(r,e)},this):Array.isArray(t)?t.forEach(function(e){if(e.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}Sr.prototype.append=function(t,e){t=Md(t),e=UC(e);var r=this.map[t];this.map[t]=r?r+", "+e:e};Sr.prototype.delete=function(t){delete this.map[Md(t)]};Sr.prototype.get=function(t){return t=Md(t),this.has(t)?this.map[t]:null};Sr.prototype.has=function(t){return this.map.hasOwnProperty(Md(t))};Sr.prototype.set=function(t,e){this.map[Md(t)]=UC(e)};Sr.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)};Sr.prototype.keys=function(){var t=[];return this.forEach(function(e,r){t.push(r)}),zC(t)};Sr.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),zC(t)};Sr.prototype.entries=function(){var t=[];return this.forEach(function(e,r){t.push([r,e])}),zC(t)};bn.iterable&&(Sr.prototype[Symbol.iterator]=Sr.prototype.entries);function EO(t){if(!t._noBody){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}}function P8(t){return new Promise(function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}})}function NDe(t){var e=new FileReader,r=P8(e);return e.readAsArrayBuffer(t),r}function MDe(t){var e=new FileReader,r=P8(e),n=/charset=([A-Za-z0-9_-]+)/.exec(t.type),i=n?n[1]:"utf-8";return e.readAsText(t,i),r}function DDe(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}function JL(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function E8(){return this.bodyUsed=!1,this._initBody=function(t){this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:bn.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:bn.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:bn.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():bn.arrayBuffer&&bn.blob&&$De(t)?(this._bodyArrayBuffer=JL(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):bn.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||RDe(t))?this._bodyArrayBuffer=JL(t):this._bodyText=t=Object.prototype.toString.call(t):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):bn.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},bn.blob&&(this.blob=function(){var t=EO(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=EO(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(bn.blob)return this.blob().then(NDe);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var t=EO(this);if(t)return t;if(this._bodyBlob)return MDe(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(DDe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},bn.formData&&(this.formData=function(){return this.text().then(UDe)}),this.json=function(){return this.text().then(JSON.parse)},this}var LDe=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function FDe(t){var e=t.toUpperCase();return LDe.indexOf(e)>-1?e:t}function jl(t,e){if(!(this instanceof jl))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{};var r=e.body;if(t instanceof jl){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new Sr(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!r&&t._bodyInit!=null&&(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new Sr(e.headers)),this.method=FDe(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in Gr){var a=new AbortController;return a.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),(this.method==="GET"||this.method==="HEAD")&&(e.cache==="no-store"||e.cache==="no-cache")){var n=/([?&])_=[^&]*/;if(n.test(this.url))this.url=this.url.replace(n,"$1_="+new Date().getTime());else{var i=/\?/;this.url+=(i.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}jl.prototype.clone=function(){return new jl(this,{body:this._bodyInit})};function UDe(t){var e=new FormData;return t.trim().split("&").forEach(function(r){if(r){var n=r.split("="),i=n.shift().replace(/\+/g," "),a=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(a))}}),e}function zDe(t){var e=new Sr,r=t.replace(/\r?\n[\t ]+/g," ");return r.split("\r").map(function(n){return n.indexOf(`
`)===0?n.substr(1,n.length):n}).forEach(function(n){var i=n.split(":"),a=i.shift().trim();if(a){var s=i.join(":").trim();try{e.append(a,s)}catch(o){console.warn("Response "+o.message)}}}),e}E8.call(jl.prototype);function ds(t,e){if(!(this instanceof ds))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new Sr(e.headers),this.url=e.url||"",this._initBody(t)}E8.call(ds.prototype);ds.prototype.clone=function(){return new ds(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Sr(this.headers),url:this.url})};ds.error=function(){var t=new ds(null,{status:200,statusText:""});return t.ok=!1,t.status=0,t.type="error",t};var BDe=[301,302,303,307,308];ds.redirect=function(t,e){if(BDe.indexOf(e)===-1)throw new RangeError("Invalid status code");return new ds(null,{status:e,headers:{location:t}})};var Wu=Gr.DOMException;try{new Wu}catch{Wu=function(e,r){this.message=e,this.name=r;var n=Error(e);this.stack=n.stack},Wu.prototype=Object.create(Error.prototype),Wu.prototype.constructor=Wu}function A8(t,e){return new Promise(function(r,n){var i=new jl(t,e);if(i.signal&&i.signal.aborted)return n(new Wu("Aborted","AbortError"));var a=new XMLHttpRequest;function s(){a.abort()}a.onload=function(){var l={statusText:a.statusText,headers:zDe(a.getAllResponseHeaders()||"")};i.url.indexOf("file://")===0&&(a.status<200||a.status>599)?l.status=200:l.status=a.status,l.url="responseURL"in a?a.responseURL:l.headers.get("X-Request-URL");var c="response"in a?a.response:a.responseText;setTimeout(function(){r(new ds(c,l))},0)},a.onerror=function(){setTimeout(function(){n(new TypeError("Network request failed"))},0)},a.ontimeout=function(){setTimeout(function(){n(new TypeError("Network request timed out"))},0)},a.onabort=function(){setTimeout(function(){n(new Wu("Aborted","AbortError"))},0)};function o(l){try{return l===""&&Gr.location.href?Gr.location.href:l}catch{return l}}if(a.open(i.method,o(i.url),!0),i.credentials==="include"?a.withCredentials=!0:i.credentials==="omit"&&(a.withCredentials=!1),"responseType"in a&&(bn.blob?a.responseType="blob":bn.arrayBuffer&&(a.responseType="arraybuffer")),e&&typeof e.headers=="object"&&!(e.headers instanceof Sr||Gr.Headers&&e.headers instanceof Gr.Headers)){var u=[];Object.getOwnPropertyNames(e.headers).forEach(function(l){u.push(Md(l)),a.setRequestHeader(l,UC(e.headers[l]))}),i.headers.forEach(function(l,c){u.indexOf(c)===-1&&a.setRequestHeader(c,l)})}else i.headers.forEach(function(l,c){a.setRequestHeader(c,l)});i.signal&&(i.signal.addEventListener("abort",s),a.onreadystatechange=function(){a.readyState===4&&i.signal.removeEventListener("abort",s)}),a.send(typeof i._bodyInit>"u"?null:i._bodyInit)})}A8.polyfill=!0;Gr.fetch||(Gr.fetch=A8,Gr.Headers=Sr,Gr.Request=jl,Gr.Response=ds);const qDe="0.5.8";var KDe=Object.defineProperty,VDe=(t,e,r)=>e in t?KDe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,AO=(t,e,r)=>(VDe(t,typeof e!="symbol"?e+"":e,r),r);class BC extends Error{constructor(e,r){super(e),this.error=e,this.status_code=r,this.name="ResponseError",Error.captureStackTrace&&Error.captureStackTrace(this,BC)}}class HDe{constructor(e,r,n){AO(this,"abortController"),AO(this,"itr"),AO(this,"doneCallback"),this.abortController=e,this.itr=r,this.doneCallback=n}abort(){this.abortController.abort()}async*[Symbol.asyncIterator](){for await(const e of this.itr){if("error"in e)throw new Error(e.error);if(yield e,e.done||e.status==="success"){this.doneCallback();return}}throw new Error("Did not receive done or success response in stream.")}}const qC=async t=>{var n;if(t.ok)return;let e=`Error ${t.status}: ${t.statusText}`,r=null;if((n=t.headers.get("content-type"))!=null&&n.includes("application/json"))try{r=await t.json(),e=r.error||e}catch{console.log("Failed to parse error response as JSON")}else try{console.log("Getting text from response"),e=await t.text()||e}catch{console.log("Failed to get text from error response")}throw new BC(e,t.status)};function WDe(){return typeof window<"u"&&window.navigator?`${window.navigator.platform.toLowerCase()} Browser/${navigator.userAgent};`:typeof process<"u"?`${process.arch} ${process.platform} Node.js/${process.version}`:""}const KC=async(t,e,r={})=>{const n={"Content-Type":"application/json",Accept:"application/json","User-Agent":`ollama-js/${qDe} (${WDe()})`};return r.headers||(r.headers={}),r.headers={...n,...r.headers},t(e,r)},ZL=async(t,e)=>{const r=await KC(t,e);return await qC(r),r},mc=async(t,e,r,n)=>{const a=(o=>o!==null&&typeof o=="object"&&!Array.isArray(o))(r)?JSON.stringify(r):r,s=await KC(t,e,{method:"POST",body:a,signal:n==null?void 0:n.signal});return await qC(s),s},GDe=async(t,e,r)=>{const n=await KC(t,e,{method:"DELETE",body:JSON.stringify(r)});return await qC(n),n},YDe=async function*(t){const e=new TextDecoder("utf-8");let r="";const n=t.getReader();for(;;){const{done:i,value:a}=await n.read();if(i)break;r+=e.decode(a);const s=r.split(`
`);r=s.pop()??"";for(const o of s)try{yield JSON.parse(o)}catch{console.warn("invalid json: ",o)}}for(const i of r.split(`
`).filter(a=>a!==""))try{yield JSON.parse(i)}catch{console.warn("invalid json: ",i)}},JDe=t=>{if(!t)return"http://127.0.0.1:11434";let e=t.includes("://");t.startsWith(":")&&(t=`http://127.0.0.1${t}`,e=!0),e||(t=`http://${t}`);const r=new URL(t);let n=r.port;n||(e?n=r.protocol==="https:"?"443":"80":n="11434");let i=`${r.protocol}//${r.hostname}:${n}${r.pathname}`;return i.endsWith("/")&&(i=i.slice(0,-1)),i};var ZDe=Object.defineProperty,XDe=(t,e,r)=>e in t?ZDe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,TO=(t,e,r)=>(XDe(t,typeof e!="symbol"?e+"":e,r),r);let T8=class{constructor(e){TO(this,"config"),TO(this,"fetch"),TO(this,"ongoingStreamedRequests",[]),this.config={host:""},e!=null&&e.proxy||(this.config.host=JDe((e==null?void 0:e.host)??"http://127.0.0.1:11434")),this.fetch=fetch,(e==null?void 0:e.fetch)!=null&&(this.fetch=e.fetch)}abort(){for(const e of this.ongoingStreamedRequests)e.abort();this.ongoingStreamedRequests.length=0}async processStreamableRequest(e,r){r.stream=r.stream??!1;const n=`${this.config.host}/api/${e}`;if(r.stream){const a=new AbortController,s=await mc(this.fetch,n,r,{signal:a.signal});if(!s.body)throw new Error("Missing body");const o=YDe(s.body),u=new HDe(a,o,()=>{const l=this.ongoingStreamedRequests.indexOf(u);l>-1&&this.ongoingStreamedRequests.splice(l,1)});return this.ongoingStreamedRequests.push(u),u}return await(await mc(this.fetch,n,r)).json()}async encodeImage(e){if(typeof e!="string"){const r=new Uint8Array(e);let n="";const i=r.byteLength;for(let a=0;a<i;a++)n+=String.fromCharCode(r[a]);return btoa(n)}return e}async generate(e){return e.images&&(e.images=await Promise.all(e.images.map(this.encodeImage.bind(this)))),this.processStreamableRequest("generate",e)}async chat(e){if(e.messages)for(const r of e.messages)r.images&&(r.images=await Promise.all(r.images.map(this.encodeImage.bind(this))));return this.processStreamableRequest("chat",e)}async create(e){return this.processStreamableRequest("create",{name:e.model,stream:e.stream,modelfile:e.modelfile,quantize:e.quantize})}async pull(e){return this.processStreamableRequest("pull",{name:e.model,stream:e.stream,insecure:e.insecure})}async push(e){return this.processStreamableRequest("push",{name:e.model,stream:e.stream,insecure:e.insecure})}async delete(e){return await GDe(this.fetch,`${this.config.host}/api/delete`,{name:e.model}),{status:"success"}}async copy(e){return await mc(this.fetch,`${this.config.host}/api/copy`,{...e}),{status:"success"}}async list(){return await(await ZL(this.fetch,`${this.config.host}/api/tags`)).json()}async show(e){return await(await mc(this.fetch,`${this.config.host}/api/show`,{...e})).json()}async embed(e){return await(await mc(this.fetch,`${this.config.host}/api/embed`,{...e})).json()}async embeddings(e){return await(await mc(this.fetch,`${this.config.host}/api/embeddings`,{...e})).json()}async ps(){return await(await ZL(this.fetch,`${this.config.host}/api/ps`)).json()}};new T8;function Dd(t,e){const r=typeof e=="number"?void 0:e;return{name:t.name,description:t.description,parameters:Ur(t.schema),...(r==null?void 0:r.strict)!==void 0?{strict:r.strict}:{}}}function VC(t,e){const r=typeof e=="number"?void 0:e;let n;return s1(t)?n={type:"function",function:Dd(t)}:n=t,(r==null?void 0:r.strict)!==void 0&&(n.function.strict=r.strict),n}function HC(t){return t!==void 0&&Array.isArray(t.lc_namespace)}function k8(t){return t!==void 0&&Je.isRunnable(t)&&"lc_name"in t.constructor&&typeof t.constructor.lc_name=="function"&&t.constructor.lc_name()==="RunnableToolLike"}function C8(t){return!!t&&typeof t=="object"&&"name"in t&&"schema"in t&&Nd(t.schema)}function s1(t){return C8(t)||k8(t)||HC(t)}const QDe=Object.freeze(Object.defineProperty({__proto__:null,convertToOpenAIFunction:Dd,convertToOpenAITool:VC,isLangChainTool:s1,isRunnableToolLike:k8,isStructuredTool:HC,isStructuredToolParams:C8},Symbol.toStringTag,{value:"Module"}));let Ld=class{constructor(e){Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new Zl(e??{})}};const eLe=Object.freeze(Object.defineProperty({__proto__:null,Embeddings:Ld},Symbol.toStringTag,{value:"Module"}));class tLe extends Ld{constructor(e){super({maxConcurrency:1,...e}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"mxbai-embed-large"}),Object.defineProperty(this,"baseUrl",{enumerable:!0,configurable:!0,writable:!0,value:"http://localhost:11434"}),Object.defineProperty(this,"keepAlive",{enumerable:!0,configurable:!0,writable:!0,value:"5m"}),Object.defineProperty(this,"requestOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"truncate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.client=new T8({host:e==null?void 0:e.baseUrl}),this.baseUrl=(e==null?void 0:e.baseUrl)??this.baseUrl,this.model=(e==null?void 0:e.model)??this.model,this.keepAlive=(e==null?void 0:e.keepAlive)??this.keepAlive,this.truncate=(e==null?void 0:e.truncate)??this.truncate,this.requestOptions=e!=null&&e.requestOptions?this._convertOptions(e==null?void 0:e.requestOptions):void 0}_convertOptions(e){const r={},n={embeddingOnly:"embedding_only",frequencyPenalty:"frequency_penalty",keepAlive:"keep_alive",logitsAll:"logits_all",lowVram:"low_vram",mainGpu:"main_gpu",mirostat:"mirostat",mirostatEta:"mirostat_eta",mirostatTau:"mirostat_tau",numBatch:"num_batch",numCtx:"num_ctx",numGpu:"num_gpu",numKeep:"num_keep",numPredict:"num_predict",numThread:"num_thread",penalizeNewline:"penalize_newline",presencePenalty:"presence_penalty",repeatLastN:"repeat_last_n",repeatPenalty:"repeat_penalty",temperature:"temperature",stop:"stop",tfsZ:"tfs_z",topK:"top_k",topP:"top_p",typicalP:"typical_p",useMlock:"use_mlock",useMmap:"use_mmap",vocabOnly:"vocab_only",f16Kv:"f16_kv",numa:"numa",seed:"seed"};for(const[i,a]of Object.entries(e)){const s=n[i];s&&(r[s]=a)}return r}async embedDocuments(e){return this.embeddingWithRetry(e)}async embedQuery(e){return(await this.embeddingWithRetry([e]))[0]}async embeddingWithRetry(e){return(await this.caller.call(()=>this.client.embed({model:this.model,input:e,keep_alive:this.keepAlive,options:this.requestOptions,truncate:this.truncate}))).embeddings}}class Go extends a1{constructor({concurrency:e,...r}){super(e?{maxConcurrency:e,...r}:r),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","llms",this._llmType()]})}async invoke(e,r){const n=Go._convertInputToPromptValue(e);return(await this.generatePrompt([n],r,r==null?void 0:r.callbacks)).generations[0][0].text}async*_streamResponseChunks(e,r,n){throw new Error("Not implemented.")}_separateRunnableConfigFromCallOptionsCompat(e){const[r,n]=super._separateRunnableConfigFromCallOptions(e);return n.signal=r.signal,[r,n]}async*_streamIterator(e,r){if(this._streamResponseChunks===Go.prototype._streamResponseChunks)yield this.invoke(e,r);else{const n=Go._convertInputToPromptValue(e),[i,a]=this._separateRunnableConfigFromCallOptionsCompat(r),s=await Zt.configure(i.callbacks,this.callbacks,i.tags,this.tags,i.metadata,this.metadata,{verbose:this.verbose}),o={options:a,invocation_params:this==null?void 0:this.invocationParams(a),batch_size:1},u=await(s==null?void 0:s.handleLLMStart(this.toJSON(),[n.toString()],i.runId,void 0,o,void 0,void 0,i.runName));let l=new Vi({text:""});try{for await(const c of this._streamResponseChunks(n.toString(),a,u==null?void 0:u[0]))l?l=l.concat(c):l=c,typeof c.text=="string"&&(yield c.text)}catch(c){throw await Promise.all((u??[]).map(h=>h==null?void 0:h.handleLLMError(c))),c}await Promise.all((u??[]).map(c=>c==null?void 0:c.handleLLMEnd({generations:[[l]]})))}}async generatePrompt(e,r,n){const i=e.map(a=>a.toString());return this.generate(i,r,n)}invocationParams(e){return{}}_flattenLLMResult(e){const r=[];for(let n=0;n<e.generations.length;n+=1){const i=e.generations[n];if(n===0)r.push({generations:[i],llmOutput:e.llmOutput});else{const a=e.llmOutput?{...e.llmOutput,tokenUsage:{}}:void 0;r.push({generations:[i],llmOutput:a})}}return r}async _generateUncached(e,r,n){const i=await Zt.configure(n.callbacks,this.callbacks,n.tags,this.tags,n.metadata,this.metadata,{verbose:this.verbose}),a={options:r,invocation_params:this==null?void 0:this.invocationParams(r),batch_size:e.length},s=await(i==null?void 0:i.handleLLMStart(this.toJSON(),e,n.runId,void 0,a,void 0,void 0,n==null?void 0:n.runName)),o=!!(s!=null&&s[0].handlers.find(c=>jC(c)||J_(c)));let u;if(o&&e.length===1&&this._streamResponseChunks!==Go.prototype._streamResponseChunks)try{const c=await this._streamResponseChunks(e[0],r,s==null?void 0:s[0]);let h;for await(const d of c)h===void 0?h=d:h=cn(h,d);if(h===void 0)throw new Error("Received empty response from chat model call.");u={generations:[[h]],llmOutput:{}},await(s==null?void 0:s[0].handleLLMEnd(u))}catch(c){throw await(s==null?void 0:s[0].handleLLMError(c)),c}else{try{u=await this._generate(e,r,s==null?void 0:s[0])}catch(h){throw await Promise.all((s??[]).map(d=>d==null?void 0:d.handleLLMError(h))),h}const c=this._flattenLLMResult(u);await Promise.all((s??[]).map((h,d)=>h==null?void 0:h.handleLLMEnd(c[d])))}const l=(s==null?void 0:s.map(c=>c.runId))||void 0;return Object.defineProperty(u,br,{value:l?{runIds:l}:void 0,configurable:!0}),u}async _generateCached({prompts:e,cache:r,llmStringKey:n,parsedOptions:i,handledOptions:a,runId:s}){const o=await Zt.configure(a.callbacks,this.callbacks,a.tags,this.tags,a.metadata,this.metadata,{verbose:this.verbose}),u={options:i,invocation_params:this==null?void 0:this.invocationParams(i),batch_size:e.length,cached:!0},l=await(o==null?void 0:o.handleLLMStart(this.toJSON(),e,s,void 0,u,void 0,void 0,a==null?void 0:a.runName)),c=[],d=(await Promise.allSettled(e.map(async(m,g)=>{const v=await r.lookup(m,n);return v==null&&c.push(g),v}))).map((m,g)=>({result:m,runManager:l==null?void 0:l[g]})).filter(({result:m})=>m.status==="fulfilled"&&m.value!=null||m.status==="rejected"),f=[];await Promise.all(d.map(async({result:m,runManager:g},v)=>{if(m.status==="fulfilled"){const y=m.value;return f[v]=y,y.length&&await(g==null?void 0:g.handleLLMNewToken(y[0].text)),g==null?void 0:g.handleLLMEnd({generations:[y]})}else return await(g==null?void 0:g.handleLLMError(m.reason)),Promise.reject(m.reason)}));const p={generations:f,missingPromptIndices:c};return Object.defineProperty(p,br,{value:l?{runIds:l==null?void 0:l.map(m=>m.runId)}:void 0,configurable:!0}),p}async generate(e,r,n){if(!Array.isArray(e))throw new Error("Argument 'prompts' is expected to be a string[]");let i;Array.isArray(r)?i={stop:r}:i=r;const[a,s]=this._separateRunnableConfigFromCallOptionsCompat(i);if(a.callbacks=a.callbacks??n,!this.cache)return this._generateUncached(e,s,a);const{cache:o}=this,u=this._getSerializedCacheKeyParametersForCall(s),{generations:l,missingPromptIndices:c}=await this._generateCached({prompts:e,cache:o,llmStringKey:u,parsedOptions:s,handledOptions:a,runId:a.runId});let h={};if(c.length>0){const d=await this._generateUncached(c.map(f=>e[f]),s,a);await Promise.all(d.generations.map(async(f,p)=>{const m=c[p];return l[m]=f,o.update(e[m],u,f)})),h=d.llmOutput??{}}return{generations:l,llmOutput:h}}async call(e,r,n){const{generations:i}=await this.generate([e],r,n);return i[0][0].text}async predict(e,r,n){return this.call(e,r,n)}async predictMessages(e,r,n){const i=Nr(e),a=await this.call(i,r,n);return new pt(a)}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}_modelType(){return"base_llm"}}class o1 extends Go{async _generate(e,r,n){return{generations:await Promise.all(e.map((a,s)=>this._call(a,{...r,promptIndex:s},n).then(o=>[{text:o}])))}}}const rLe=Object.freeze(Object.defineProperty({__proto__:null,BaseLLM:Go,LLM:o1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL=["user","model","function","system"];var QL;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT"})(QL||(QL={}));var eF;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(eF||(eF={}));var tF;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(tF||(tF={}));var rF;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER"})(rF||(rF={}));var Ew;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.OTHER="OTHER"})(Ew||(Ew={}));var nF;(function(t){t.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",t.RETRIEVAL_QUERY="RETRIEVAL_QUERY",t.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",t.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",t.CLASSIFICATION="CLASSIFICATION",t.CLUSTERING="CLUSTERING"})(nF||(nF={}));var iF;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(iF||(iF={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var aF;(function(t){t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT"})(aF||(aF={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class gc extends oi{constructor(e,r){super(e),this.response=r}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nLe="https://generativelanguage.googleapis.com",iLe="v1beta",aLe="0.7.1",sLe="genai-js";var Rl;(function(t){t.GENERATE_CONTENT="generateContent",t.STREAM_GENERATE_CONTENT="streamGenerateContent",t.COUNT_TOKENS="countTokens",t.EMBED_CONTENT="embedContent",t.BATCH_EMBED_CONTENTS="batchEmbedContents"})(Rl||(Rl={}));class I8{constructor(e,r,n,i,a){this.model=e,this.task=r,this.apiKey=n,this.stream=i,this.requestOptions=a}toString(){var e,r;const n=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||iLe;let a=`${((r=this.requestOptions)===null||r===void 0?void 0:r.baseUrl)||nLe}/${n}/${this.model}:${this.task}`;return this.stream&&(a+="?alt=sse"),a}}function oLe(t){const e=[];return t!=null&&t.apiClient&&e.push(t.apiClient),e.push(`${sLe}/${aLe}`),e.join(" ")}async function uLe(t){const e=new Headers;return e.append("Content-Type","application/json"),e.append("x-goog-api-client",oLe(t.requestOptions)),e.append("x-goog-api-key",t.apiKey),e}async function lLe(t,e,r,n,i,a){const s=new I8(t,e,r,n,a);return{url:s.toString(),fetchOptions:Object.assign(Object.assign({},hLe(a)),{method:"POST",headers:await uLe(s),body:i})}}async function Cg(t,e,r,n,i,a){return cLe(t,e,r,n,i,a,fetch)}async function cLe(t,e,r,n,i,a,s=fetch){const o=new I8(t,e,r,n,a);let u;try{const l=await lLe(t,e,r,n,i,a);if(u=await s(l.url,l.fetchOptions),!u.ok){let c="";try{const h=await u.json();c=h.error.message,h.error.details&&(c+=` ${JSON.stringify(h.error.details)}`)}catch{}throw new Error(`[${u.status} ${u.statusText}] ${c}`)}}catch(l){const c=new oi(`Error fetching from ${o.toString()}: ${l.message}`);throw c.stack=l.stack,c}return u}function hLe(t){const e={};if((t==null?void 0:t.timeout)>=0){const r=new AbortController,n=r.signal;setTimeout(()=>r.abort(),t.timeout),e.signal=n}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WC(t){return t.text=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),vv(t.candidates[0]))throw new gc(`${No(t)}`,t);return dLe(t)}else if(t.promptFeedback)throw new gc(`Text not available. ${No(t)}`,t);return""},t.functionCall=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),vv(t.candidates[0]))throw new gc(`${No(t)}`,t);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),sF(t)[0]}else if(t.promptFeedback)throw new gc(`Function call not available. ${No(t)}`,t)},t.functionCalls=()=>{if(t.candidates&&t.candidates.length>0){if(t.candidates.length>1&&console.warn(`This response had ${t.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),vv(t.candidates[0]))throw new gc(`${No(t)}`,t);return sF(t)}else if(t.promptFeedback)throw new gc(`Function call not available. ${No(t)}`,t)},t}function dLe(t){var e,r,n,i;return!((i=(n=(r=(e=t.candidates)===null||e===void 0?void 0:e[0].content)===null||r===void 0?void 0:r.parts)===null||n===void 0?void 0:n[0])===null||i===void 0)&&i.text?t.candidates[0].content.parts.map(({text:a})=>a).join(""):""}function sF(t){var e,r,n,i;const a=[];if(!((r=(e=t.candidates)===null||e===void 0?void 0:e[0].content)===null||r===void 0)&&r.parts)for(const s of(i=(n=t.candidates)===null||n===void 0?void 0:n[0].content)===null||i===void 0?void 0:i.parts)s.functionCall&&a.push(s.functionCall);if(a.length>0)return a}const fLe=[Ew.RECITATION,Ew.SAFETY];function vv(t){return!!t.finishReason&&fLe.includes(t.finishReason)}function No(t){var e,r,n;let i="";if((!t.candidates||t.candidates.length===0)&&t.promptFeedback)i+="Response was blocked",!((e=t.promptFeedback)===null||e===void 0)&&e.blockReason&&(i+=` due to ${t.promptFeedback.blockReason}`),!((r=t.promptFeedback)===null||r===void 0)&&r.blockReasonMessage&&(i+=`: ${t.promptFeedback.blockReasonMessage}`);else if(!((n=t.candidates)===null||n===void 0)&&n[0]){const a=t.candidates[0];vv(a)&&(i+=`Candidate was blocked due to ${a.finishReason}`,a.finishMessage&&(i+=`: ${a.finishMessage}`))}return i}function Bm(t){return this instanceof Bm?(this.v=t,this):new Bm(t)}function pLe(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,a=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(d){n[d]&&(i[d]=function(f){return new Promise(function(p,m){a.push([d,f,p,m])>1||o(d,f)})})}function o(d,f){try{u(n[d](f))}catch(p){h(a[0][3],p)}}function u(d){d.value instanceof Bm?Promise.resolve(d.value.v).then(l,c):h(a[0][2],d)}function l(d){o("next",d)}function c(d){o("throw",d)}function h(d,f){d(f),a.shift(),a.length&&o(a[0][0],a[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function mLe(t){const e=t.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),r=vLe(e),[n,i]=r.tee();return{stream:yLe(n),response:gLe(i)}}async function gLe(t){const e=[],r=t.getReader();for(;;){const{done:n,value:i}=await r.read();if(n)return WC(bLe(e));e.push(i)}}function yLe(t){return pLe(this,arguments,function*(){const r=t.getReader();for(;;){const{value:n,done:i}=yield Bm(r.read());if(i)break;yield yield Bm(WC(n))}})}function vLe(t){const e=t.getReader();return new ReadableStream({start(n){let i="";return a();function a(){return e.read().then(({value:s,done:o})=>{if(o){if(i.trim()){n.error(new oi("Failed to parse stream"));return}n.close();return}i+=s;let u=i.match(oF),l;for(;u;){try{l=JSON.parse(u[1])}catch{n.error(new oi(`Error parsing JSON response: "${u[1]}"`));return}n.enqueue(l),i=i.substring(u[0].length),u=i.match(oF)}return a()})}}})}function bLe(t){const e=t[t.length-1],r={promptFeedback:e==null?void 0:e.promptFeedback};for(const n of t)if(n.candidates)for(const i of n.candidates){const a=i.index;if(r.candidates||(r.candidates=[]),r.candidates[a]||(r.candidates[a]={index:i.index}),r.candidates[a].citationMetadata=i.citationMetadata,r.candidates[a].finishReason=i.finishReason,r.candidates[a].finishMessage=i.finishMessage,r.candidates[a].safetyRatings=i.safetyRatings,i.content&&i.content.parts){r.candidates[a].content||(r.candidates[a].content={role:i.content.role||"user",parts:[]});const s={};for(const o of i.content.parts)o.text&&(s.text=o.text),o.functionCall&&(s.functionCall=o.functionCall),Object.keys(s).length===0&&(s.text=""),r.candidates[a].content.parts.push(s)}}return r}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $8(t,e,r,n){const i=await Cg(e,Rl.STREAM_GENERATE_CONTENT,t,!0,JSON.stringify(r),n);return mLe(i)}async function j8(t,e,r,n){const a=await(await Cg(e,Rl.GENERATE_CONTENT,t,!1,JSON.stringify(r),n)).json();return{response:WC(a)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aw(t){let e=[];if(typeof t=="string")e=[{text:t}];else for(const r of t)typeof r=="string"?e.push({text:r}):e.push(r);return wLe(e)}function wLe(t){const e={role:"user",parts:[]},r={role:"function",parts:[]};let n=!1,i=!1;for(const a of t)"functionResponse"in a?(r.parts.push(a),i=!0):(e.parts.push(a),n=!0);if(n&&i)throw new oi("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!n&&!i)throw new oi("No content is provided for sending chat message.");return n?e:r}function kO(t){return t.contents?t:{contents:[Aw(t)]}}function _Le(t){return typeof t=="string"||Array.isArray(t)?{content:Aw(t)}:t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uF=["text","inlineData","functionCall","functionResponse"],xLe={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall"],system:["text"]},lF={user:["model"],function:["model"],model:["user","function"],system:[]};function OLe(t){let e;for(const r of t){const{role:n,parts:i}=r;if(!e&&n!=="user")throw new oi(`First content should be with role 'user', got ${n}`);if(!XL.includes(n))throw new oi(`Each item should include role field. Got ${n} but valid roles are: ${JSON.stringify(XL)}`);if(!Array.isArray(i))throw new oi("Content should have 'parts' property with an array of Parts");if(i.length===0)throw new oi("Each Content should have at least one part");const a={text:0,inlineData:0,functionCall:0,functionResponse:0};for(const o of i)for(const u of uF)u in o&&(a[u]+=1);const s=xLe[n];for(const o of uF)if(!s.includes(o)&&a[o]>0)throw new oi(`Content with role '${n}' can't contain '${o}' part`);if(e&&!lF[n].includes(e.role))throw new oi(`Content with role '${n}' can't follow '${e.role}'. Valid previous roles: ${JSON.stringify(lF)}`);e=r}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF="SILENT_ERROR";class SLe{constructor(e,r,n,i){this.model=r,this.params=n,this.requestOptions=i,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,n!=null&&n.history&&(OLe(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e){var r,n,i,a,s;await this._sendPromise;const o=Aw(e),u={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(n=this.params)===null||n===void 0?void 0:n.generationConfig,tools:(i=this.params)===null||i===void 0?void 0:i.tools,toolConfig:(a=this.params)===null||a===void 0?void 0:a.toolConfig,systemInstruction:(s=this.params)===null||s===void 0?void 0:s.systemInstruction,contents:[...this._history,o]};let l;return this._sendPromise=this._sendPromise.then(()=>j8(this._apiKey,this.model,u,this.requestOptions)).then(c=>{var h;if(c.response.candidates&&c.response.candidates.length>0){this._history.push(o);const d=Object.assign({parts:[],role:"model"},(h=c.response.candidates)===null||h===void 0?void 0:h[0].content);this._history.push(d)}else{const d=No(c.response);d&&console.warn(`sendMessage() was unsuccessful. ${d}. Inspect response object for details.`)}l=c}),await this._sendPromise,l}async sendMessageStream(e){var r,n,i,a,s;await this._sendPromise;const o=Aw(e),u={safetySettings:(r=this.params)===null||r===void 0?void 0:r.safetySettings,generationConfig:(n=this.params)===null||n===void 0?void 0:n.generationConfig,tools:(i=this.params)===null||i===void 0?void 0:i.tools,toolConfig:(a=this.params)===null||a===void 0?void 0:a.toolConfig,systemInstruction:(s=this.params)===null||s===void 0?void 0:s.systemInstruction,contents:[...this._history,o]},l=$8(this._apiKey,this.model,u,this.requestOptions);return this._sendPromise=this._sendPromise.then(()=>l).catch(c=>{throw new Error(cF)}).then(c=>c.response).then(c=>{if(c.candidates&&c.candidates.length>0){this._history.push(o);const h=Object.assign({},c.candidates[0].content);h.role||(h.role="model"),this._history.push(h)}else{const h=No(c);h&&console.warn(`sendMessageStream() was unsuccessful. ${h}. Inspect response object for details.`)}}).catch(c=>{c.message!==cF&&console.error(c)}),l}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PLe(t,e,r,n){return(await Cg(e,Rl.COUNT_TOKENS,t,!1,JSON.stringify(Object.assign(Object.assign({},r),{model:e})),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ELe(t,e,r,n){return(await Cg(e,Rl.EMBED_CONTENT,t,!1,JSON.stringify(r),n)).json()}async function ALe(t,e,r,n){const i=r.requests.map(s=>Object.assign(Object.assign({},s),{model:e}));return(await Cg(e,Rl.BATCH_EMBED_CONTENTS,t,!1,JSON.stringify({requests:i}),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TLe{constructor(e,r,n){this.apiKey=e,r.model.includes("/")?this.model=r.model:this.model=`models/${r.model}`,this.generationConfig=r.generationConfig||{},this.safetySettings=r.safetySettings||[],this.tools=r.tools,this.toolConfig=r.toolConfig,this.systemInstruction=r.systemInstruction,this.requestOptions=n||{}}async generateContent(e){const r=kO(e);return j8(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction},r),this.requestOptions)}async generateContentStream(e){const r=kO(e);return $8(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction},r),this.requestOptions)}startChat(e){return new SLe(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction},e),this.requestOptions)}async countTokens(e){const r=kO(e);return PLe(this.apiKey,this.model,r,this.requestOptions)}async embedContent(e){const r=_Le(e);return ELe(this.apiKey,this.model,r,this.requestOptions)}async batchEmbedContents(e){return ALe(this.apiKey,this.model,e,this.requestOptions)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kLe{constructor(e){this.apiKey=e}getGenerativeModel(e,r){if(!e.model)throw new oi("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new TLe(this.apiKey,e,r)}}class R8 extends Je{static lc_name(){return"RouterRunnable"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnables=e.runnables}async invoke(e,r){const{key:n,input:i}=e,a=this.runnables[n];if(a===void 0)throw new Error(`No runnable associated with key "${n}".`);return a.invoke(i,Ve(r))}async batch(e,r,n){var d;const i=e.map(f=>f.key),a=e.map(f=>f.input);if(i.find(f=>this.runnables[f]===void 0)!==void 0)throw new Error("One or more keys do not have a corresponding runnable.");const o=i.map(f=>this.runnables[f]),u=this._getOptionsList(r??{},e.length),l=((d=u[0])==null?void 0:d.maxConcurrency)??(n==null?void 0:n.maxConcurrency),c=l&&l>0?l:e.length,h=[];for(let f=0;f<a.length;f+=c){const p=a.slice(f,f+c).map((g,v)=>o[v].invoke(g,u[v])),m=await Promise.all(p);h.push(m)}return h.flat()}async stream(e,r){const{key:n,input:i}=e,a=this.runnables[n];if(a===void 0)throw new Error(`No runnable associated with key "${n}".`);return a.stream(i,r)}}class GC extends Je{static lc_name(){return"RunnableBranch"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"default",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"branches",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.branches=e.branches,this.default=e.default}static from(e){if(e.length<1)throw new Error("RunnableBranch requires at least one branch");const n=e.slice(0,-1).map(([a,s])=>[ga(a),ga(s)]),i=ga(e[e.length-1]);return new this({branches:n,default:i})}async _invoke(e,r,n){let i;for(let a=0;a<this.branches.length;a+=1){const[s,o]=this.branches[a];if(await s.invoke(e,xt(r,{callbacks:n==null?void 0:n.getChild(`condition:${a+1}`)}))){i=await o.invoke(e,xt(r,{callbacks:n==null?void 0:n.getChild(`branch:${a+1}`)}));break}}return i||(i=await this.default.invoke(e,xt(r,{callbacks:n==null?void 0:n.getChild("branch:default")}))),i}async invoke(e,r={}){return this._callWithConfig(this._invoke,e,r)}async*_streamIterator(e,r){const n=await Zr(r),i=await(n==null?void 0:n.handleChainStart(this.toJSON(),Jt(e,"input"),r==null?void 0:r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));let a,s=!0,o;try{for(let u=0;u<this.branches.length;u+=1){const[l,c]=this.branches[u];if(await l.invoke(e,xt(r,{callbacks:i==null?void 0:i.getChild(`condition:${u+1}`)}))){o=await c.stream(e,xt(r,{callbacks:i==null?void 0:i.getChild(`branch:${u+1}`)}));for await(const d of o)if(yield d,s)if(a===void 0)a=d;else try{a=cn(a,d)}catch{a=void 0,s=!1}break}}if(o===void 0){o=await this.default.stream(e,xt(r,{callbacks:i==null?void 0:i.getChild("branch:default")}));for await(const u of o)if(yield u,s)if(a===void 0)a=u;else try{a=cn(a,u)}catch{a=void 0,s=!1}}}catch(u){throw await(i==null?void 0:i.handleChainError(u)),u}await(i==null?void 0:i.handleChainEnd(a??{}))}}class N8 extends as{constructor(e){let r=new Qn({func:(s,o)=>this._enterHistory(s,o??{})}).withConfig({runName:"loadHistory"});const n=e.historyMessagesKey??e.inputMessagesKey;n&&(r=Dr.assign({[n]:r}).withConfig({runName:"insertHistory"}));const i=r.pipe(e.runnable.withListeners({onEnd:(s,o)=>this._exitHistory(s,o??{})})).withConfig({runName:"RunnableWithMessageHistory"}),a=e.config??{};super({...e,config:a,bound:i}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputMessagesKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputMessagesKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"historyMessagesKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"getMessageHistory",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.getMessageHistory=e.getMessageHistory,this.inputMessagesKey=e.inputMessagesKey,this.outputMessagesKey=e.outputMessagesKey,this.historyMessagesKey=e.historyMessagesKey}_getInputMessages(e){let r;if(typeof e=="object"&&!Array.isArray(e)&&!An(e)){let n;this.inputMessagesKey?n=this.inputMessagesKey:Object.keys(e).length===1?n=Object.keys(e)[0]:n="input",Array.isArray(e[n])&&Array.isArray(e[n][0])?r=e[n][0]:r=e[n]}else r=e;if(typeof r=="string")return[new Wt(r)];if(Array.isArray(r))return r;if(An(r))return[r];throw new Error(`Expected a string, BaseMessage, or array of BaseMessages.
Got ${JSON.stringify(r,null,2)}`)}_getOutputMessages(e){let r;if(!Array.isArray(e)&&!An(e)&&typeof e!="string"){let n;this.outputMessagesKey!==void 0?n=this.outputMessagesKey:Object.keys(e).length===1?n=Object.keys(e)[0]:n="output",e.generations!==void 0?r=e.generations[0][0].message:r=e[n]}else r=e;if(typeof r=="string")return[new pt(r)];if(Array.isArray(r))return r;if(An(r))return[r];throw new Error(`Expected a string, BaseMessage, or array of BaseMessages. Received: ${JSON.stringify(r,null,2)}`)}async _enterHistory(e,r){var a;const i=await((a=r==null?void 0:r.configurable)==null?void 0:a.messageHistory).getMessages();return this.historyMessagesKey===void 0?i.concat(this._getInputMessages(e)):i}async _exitHistory(e,r){var u;const n=(u=r.configurable)==null?void 0:u.messageHistory;let i;Array.isArray(e.inputs)&&Array.isArray(e.inputs[0])?i=e.inputs[0]:i=e.inputs;let a=this._getInputMessages(i);if(this.historyMessagesKey===void 0){const l=await n.getMessages();a=a.slice(l.length)}const s=e.outputs;if(!s)throw new Error(`Output values from 'Run' undefined. Run: ${JSON.stringify(e,null,2)}`);const o=this._getOutputMessages(s);await n.addMessages([...a,...o])}async _mergeConfig(...e){const r=await super._mergeConfig(...e);if(!r.configurable||!r.configurable.sessionId){const i={[this.inputMessagesKey??"input"]:"foo"},a={configurable:{sessionId:"123"}};throw new Error(`sessionId is required. Pass it in as part of the config argument to .invoke() or .stream()
eg. chain.invoke(${JSON.stringify(i)}, ${JSON.stringify(a)})`)}const{sessionId:n}=r.configurable;return r.configurable.messageHistory=await this.getMessageHistory(n),r}}const CLe=Object.freeze(Object.defineProperty({__proto__:null,RouterRunnable:R8,Runnable:Je,RunnableAssign:Z_,RunnableBinding:as,RunnableBranch:GC,RunnableEach:Zh,RunnableLambda:Qn,RunnableMap:vo,RunnableParallel:m8,RunnablePassthrough:Dr,RunnablePick:X_,RunnableRetry:NC,RunnableSequence:wr,RunnableToolLike:tA,RunnableWithFallbacks:MC,RunnableWithMessageHistory:N8,_coerceToRunnable:ga,ensureConfig:Ve,getCallbackManagerForConfig:Zr,mergeConfigs:QE,patchConfig:xt},Symbol.toStringTag,{value:"Module"})),ILe=Object.freeze(Object.defineProperty({__proto__:null,isZodSchema:Nd},Symbol.toStringTag,{value:"Module"}));function Tw(t){if(typeof t=="object"&&t!==null){const e={...t};"additionalProperties"in e&&delete e.additionalProperties;for(const r in e)r in e&&(Array.isArray(e[r])?e[r]=e[r].map(Tw):typeof e[r]=="object"&&e[r]!==null&&(e[r]=Tw(e[r])));return e}return t}function M8(t){const e=Tw(Ur(t)),{$schema:r,...n}=e;return n}function $Le(t){const e=Tw(t),{$schema:r,...n}=e;return n}function jLe(t){const e=t._getType();return gn.isInstance(t)?t.role:e==="tool"?e:t.name??e}function RLe(t){switch(t){case"ai":case"model":return"model";case"system":case"human":return"user";case"tool":case"function":return"function";default:throw new Error(`Unknown / unsupported author: ${t}`)}}function NLe(t){if("mimeType"in t&&"data"in t)return{inlineData:{mimeType:t.mimeType,data:t.data}};throw new Error("Invalid media content")}function MLe(t,e){if(typeof t.content=="string"&&t.content!=="")return[{text:t.content}];let r=[],n=[],i=[];return"tool_calls"in t&&Array.isArray(t.tool_calls)&&t.tool_calls.length>0?r=t.tool_calls.map(a=>({functionCall:{name:a.name,args:a.args}})):t._getType()==="tool"&&t.name&&t.content?n=[{functionResponse:{name:t.name,response:t.content}}]:Array.isArray(t.content)&&(i=t.content.map(a=>{if(a.type==="text")return{text:a.text};if(a.type==="image_url"){if(!e)throw new Error("This model does not support images");let s;if(typeof a.image_url=="string")s=a.image_url;else if(typeof a.image_url=="object"&&"url"in a.image_url)s=a.image_url.url;else throw new Error("Please provide image as base64 encoded data URL");const[o,u]=s.split(",");if(!o.startsWith("data:"))throw new Error("Please provide image as base64 encoded data URL");const[l,c]=o.replace(/^data:/,"").split(";");if(c!=="base64")throw new Error("Please provide image as base64 encoded data URL");return{inlineData:{data:u,mimeType:l}}}else{if(a.type==="media")return NLe(a);if(a.type==="tool_use")return{functionCall:{name:a.name,args:a.input}}}throw new Error(`Unknown content type ${a.type}`)})),[...i,...r,...n]}function hF(t,e){return t.reduce((r,n,i)=>{if(!An(n))throw new Error("Unsupported message input");const a=jLe(n);if(a==="system"&&i!==0)throw new Error("System message should be the first one");const s=RLe(a),o=r.content[r.content.length];if(!r.mergeWithPreviousContent&&o&&o.role===s)throw new Error("Google Generative AI requires alternate messages between authors");const u=MLe(n,e);if(r.mergeWithPreviousContent){const h=r.content[r.content.length-1];if(!h)throw new Error("There was a problem parsing your system message. Please try a prompt without one.");return h.parts.push(...u),{mergeWithPreviousContent:!1,content:r.content}}let l=s;l==="function"&&(l="user");const c={role:l,parts:u};return{mergeWithPreviousContent:a==="system",content:[...r.content,c]}},{content:[],mergeWithPreviousContent:!1}).content}function DLe(t,e){var u;if(!t.candidates||t.candidates.length===0||!t.candidates[0])return{generations:[],llmOutput:{filters:t.promptFeedback}};const r=t.functionCalls(),[n]=t.candidates,{content:i,...a}=n,s=((u=i==null?void 0:i.parts[0])==null?void 0:u.text)??"";return{generations:[{text:s,message:new pt({content:s,tool_calls:r==null?void 0:r.map(l=>({...l,type:"tool_call"})),additional_kwargs:{...a},usage_metadata:e==null?void 0:e.usageMetadata}),generationInfo:a}]}}function LLe(t,e){var u;if(!t.candidates||t.candidates.length===0)return null;const r=t.functionCalls(),[n]=t.candidates,{content:i,...a}=n,s=((u=i==null?void 0:i.parts[0])==null?void 0:u.text)??"",o=[];return r&&o.push(...r.map(l=>({...l,args:JSON.stringify(l.args),index:e.index,type:"tool_call_chunk"}))),new Yn({text:s,message:new Mr({content:s,name:i?i.role:void 0,tool_call_chunks:o,additional_kwargs:{},usage_metadata:e.usageMetadata}),generationInfo:a})}function dF(t){return t.every(e=>"functionDeclarations"in e&&Array.isArray(e.functionDeclarations))?t:[{functionDeclarations:t.map(e=>{if(s1(e)){const r=M8(e.schema);return{name:e.name,description:e.description,parameters:r}}return Rd(e)?{name:e.function.name,description:e.function.description??"A function available to call.",parameters:$Le(e.function.parameters)}:e})}]}class wi extends Je{parseResultWithPrompt(e,r,n){return this.parseResult(e,n)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,r){return typeof e=="string"?this._callWithConfig(async(n,i)=>this.parseResult([{text:n}],i==null?void 0:i.callbacks),e,{...r,runType:"parser"}):this._callWithConfig(async(n,i)=>this.parseResult([{message:n,text:this._baseMessageToString(n)}],i==null?void 0:i.callbacks),e,{...r,runType:"parser"})}}class zr extends wi{parseResult(e,r){return this.parse(e[0].text,r)}async parseWithPrompt(e,r,n){return this.parse(e,n)}_type(){throw new Error("_type not implemented")}}class ft extends Error{constructor(e,r,n,i=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=r,this.observation=n,this.sendToLLM=i,i&&(n===void 0||r===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true")}}function pl(t,e){const r=typeof t;if(r!==typeof e)return!1;if(Array.isArray(t)){if(!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(!pl(t[i],e[i]))return!1;return!0}if(r==="object"){if(!t||!e)return t===e;const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const s of n)if(!pl(t[s],e[s]))return!1;return!0}return t===e}function na(t){return encodeURI(FLe(t))}function FLe(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}const ULe={prefixItems:!0,items:!0,allOf:!0,anyOf:!0,oneOf:!0},zLe={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependentSchemas:!0},BLe={id:!0,$id:!0,$ref:!0,$schema:!0,$anchor:!0,$vocabulary:!0,$comment:!0,default:!0,enum:!0,const:!0,required:!0,type:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};let qLe=typeof self<"u"&&self.location&&self.location.origin!=="null"?new URL(self.location.origin+self.location.pathname+location.search):new URL("https://github.com/cfworker");function ol(t,e=Object.create(null),r=qLe,n=""){if(t&&typeof t=="object"&&!Array.isArray(t)){const a=t.$id||t.id;if(a){const s=new URL(a,r.href);s.hash.length>1?e[s.href]=t:(s.hash="",n===""?r=s:ol(t,e,r))}}else if(t!==!0&&t!==!1)return e;const i=r.href+(n?"#"+n:"");if(e[i]!==void 0)throw new Error(`Duplicate schema URI "${i}".`);if(e[i]=t,t===!0||t===!1)return e;if(t.__absolute_uri__===void 0&&Object.defineProperty(t,"__absolute_uri__",{enumerable:!1,value:i}),t.$ref&&t.__absolute_ref__===void 0){const a=new URL(t.$ref,r.href);a.hash=a.hash,Object.defineProperty(t,"__absolute_ref__",{enumerable:!1,value:a.href})}if(t.$recursiveRef&&t.__absolute_recursive_ref__===void 0){const a=new URL(t.$recursiveRef,r.href);a.hash=a.hash,Object.defineProperty(t,"__absolute_recursive_ref__",{enumerable:!1,value:a.href})}if(t.$anchor){const a=new URL("#"+t.$anchor,r.href);e[a.href]=t}for(let a in t){if(BLe[a])continue;const s=`${n}/${na(a)}`,o=t[a];if(Array.isArray(o)){if(ULe[a]){const u=o.length;for(let l=0;l<u;l++)ol(o[l],e,r,`${s}/${l}`)}}else if(zLe[a])for(let u in o)ol(o[u],e,r,`${s}/${na(u)}`);else ol(o,e,r,s)}return e}const KLe=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,VLe=[0,31,28,31,30,31,30,31,31,30,31,30,31],HLe=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,WLe=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,GLe=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,YLe=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,JLe=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)(?:\.(?:[a-z\u{00a1}-\u{ffff}0-9]+-?)*[a-z\u{00a1}-\u{ffff}0-9]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,ZLe=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,XLe=/^(?:\/(?:[^~/]|~0|~1)*)*$/,QLe=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,eFe=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,tFe=/^\d\d\d\d-[0-1]\d-[0-3]\d$/,rFe=/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,nFe=/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,iFe=/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,aFe=t=>{if(t[0]==='"')return!1;const[e,r,...n]=t.split("@");return!e||!r||n.length!==0||e.length>64||r.length>253||e[0]==="."||e.endsWith(".")||e.includes("..")||!/^[a-z0-9.-]+$/i.test(r)||!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(e)?!1:r.split(".").every(i=>/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(i))},sFe=/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,oFe=/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,uFe=t=>t.length>1&&t.length<80&&(/^P\d+([.,]\d+)?W$/.test(t)||/^P[\dYMDTHS]*(\d[.,]\d+)?[YMDHS]$/.test(t)&&/^P([.,\d]+Y)?([.,\d]+M)?([.,\d]+D)?(T([.,\d]+H)?([.,\d]+M)?([.,\d]+S)?)?$/.test(t));function Ln(t){return t.test.bind(t)}const lFe={date:D8,time:L8.bind(void 0,!1),"date-time":dFe,duration:uFe,uri:mFe,"uri-reference":Ln(GLe),"uri-template":Ln(YLe),url:Ln(JLe),email:aFe,hostname:Ln(WLe),ipv4:Ln(sFe),ipv6:Ln(oFe),regex:yFe,uuid:Ln(ZLe),"json-pointer":Ln(XLe),"json-pointer-uri-fragment":Ln(QLe),"relative-json-pointer":Ln(eFe)},fF={...lFe,date:Ln(tFe),time:Ln(rFe),"date-time":Ln(nFe),"uri-reference":Ln(iFe)};function cFe(t){return t%4===0&&(t%100!==0||t%400===0)}function D8(t){const e=t.match(KLe);if(!e)return!1;const r=+e[1],n=+e[2],i=+e[3];return n>=1&&n<=12&&i>=1&&i<=(n==2&&cFe(r)?29:VLe[n])}function L8(t,e){const r=e.match(HLe);if(!r)return!1;const n=+r[1],i=+r[2],a=+r[3],s=!!r[5];return(n<=23&&i<=59&&a<=59||n==23&&i==59&&a==60)&&(!t||s)}const hFe=/t|\s/i;function dFe(t){const e=t.split(hFe);return e.length==2&&D8(e[0])&&L8(!0,e[1])}const fFe=/\/|:/,pFe=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function mFe(t){return fFe.test(t)&&pFe.test(t)}const gFe=/[^\\]\\Z/;function yFe(t){if(gFe.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}function vFe(t){let e=0,r=t.length,n=0,i;for(;n<r;)e++,i=t.charCodeAt(n++),i>=55296&&i<=56319&&n<r&&(i=t.charCodeAt(n),(i&64512)==56320&&n++);return e}function Ft(t,e,r="2019-09",n=ol(e),i=!0,a=null,s="#",o="#",u=Object.create(null)){if(e===!0)return{valid:!0,errors:[]};if(e===!1)return{valid:!1,errors:[{instanceLocation:s,keyword:"false",keywordLocation:s,error:"False boolean schema."}]};const l=typeof t;let c;switch(l){case"boolean":case"number":case"string":c=l;break;case"object":t===null?c="null":Array.isArray(t)?c="array":c="object";break;default:throw new Error(`Instances of "${l}" type are not supported.`)}const{$ref:h,$recursiveRef:d,$recursiveAnchor:f,type:p,const:m,enum:g,required:v,not:y,anyOf:b,allOf:w,oneOf:_,if:O,then:P,else:x,format:j,properties:k,patternProperties:R,additionalProperties:F,unevaluatedProperties:z,minProperties:N,maxProperties:L,propertyNames:D,dependentRequired:q,dependentSchemas:M,dependencies:V,prefixItems:G,items:re,additionalItems:K,unevaluatedItems:J,contains:ie,minContains:oe,maxContains:S,minItems:E,maxItems:U,uniqueItems:T,minimum:ee,maximum:se,exclusiveMinimum:H,exclusiveMaximum:Oe,multipleOf:be,minLength:xe,maxLength:C,pattern:B,__absolute_ref__:Y,__absolute_recursive_ref__:me}=e,W=[];if(f===!0&&a===null&&(a=e),d==="#"){const ne=a===null?n[me]:a,le=`${o}/$recursiveRef`,X=Ft(t,a===null?e:a,r,n,i,ne,s,le,u);X.valid||W.push({instanceLocation:s,keyword:"$recursiveRef",keywordLocation:le,error:"A subschema had errors."},...X.errors)}if(h!==void 0){const le=n[Y||h];if(le===void 0){let pe=`Unresolved $ref "${h}".`;throw Y&&Y!==h&&(pe+=`  Absolute URI "${Y}".`),pe+=`
Known schemas:
- ${Object.keys(n).join(`
- `)}`,new Error(pe)}const X=`${o}/$ref`,ce=Ft(t,le,r,n,i,a,s,X,u);if(ce.valid||W.push({instanceLocation:s,keyword:"$ref",keywordLocation:X,error:"A subschema had errors."},...ce.errors),r==="4"||r==="7")return{valid:W.length===0,errors:W}}if(Array.isArray(p)){let ne=p.length,le=!1;for(let X=0;X<ne;X++)if(c===p[X]||p[X]==="integer"&&c==="number"&&t%1===0&&t===t){le=!0;break}le||W.push({instanceLocation:s,keyword:"type",keywordLocation:`${o}/type`,error:`Instance type "${c}" is invalid. Expected "${p.join('", "')}".`})}else p==="integer"?(c!=="number"||t%1||t!==t)&&W.push({instanceLocation:s,keyword:"type",keywordLocation:`${o}/type`,error:`Instance type "${c}" is invalid. Expected "${p}".`}):p!==void 0&&c!==p&&W.push({instanceLocation:s,keyword:"type",keywordLocation:`${o}/type`,error:`Instance type "${c}" is invalid. Expected "${p}".`});if(m!==void 0&&(c==="object"||c==="array"?pl(t,m)||W.push({instanceLocation:s,keyword:"const",keywordLocation:`${o}/const`,error:`Instance does not match ${JSON.stringify(m)}.`}):t!==m&&W.push({instanceLocation:s,keyword:"const",keywordLocation:`${o}/const`,error:`Instance does not match ${JSON.stringify(m)}.`})),g!==void 0&&(c==="object"||c==="array"?g.some(ne=>pl(t,ne))||W.push({instanceLocation:s,keyword:"enum",keywordLocation:`${o}/enum`,error:`Instance does not match any of ${JSON.stringify(g)}.`}):g.some(ne=>t===ne)||W.push({instanceLocation:s,keyword:"enum",keywordLocation:`${o}/enum`,error:`Instance does not match any of ${JSON.stringify(g)}.`})),y!==void 0){const ne=`${o}/not`;Ft(t,y,r,n,i,a,s,ne).valid&&W.push({instanceLocation:s,keyword:"not",keywordLocation:ne,error:'Instance matched "not" schema.'})}let ae=[];if(b!==void 0){const ne=`${o}/anyOf`,le=W.length;let X=!1;for(let ce=0;ce<b.length;ce++){const pe=b[ce],Ie=Object.create(u),Se=Ft(t,pe,r,n,i,f===!0?a:null,s,`${ne}/${ce}`,Ie);W.push(...Se.errors),X=X||Se.valid,Se.valid&&ae.push(Ie)}X?W.length=le:W.splice(le,0,{instanceLocation:s,keyword:"anyOf",keywordLocation:ne,error:"Instance does not match any subschemas."})}if(w!==void 0){const ne=`${o}/allOf`,le=W.length;let X=!0;for(let ce=0;ce<w.length;ce++){const pe=w[ce],Ie=Object.create(u),Se=Ft(t,pe,r,n,i,f===!0?a:null,s,`${ne}/${ce}`,Ie);W.push(...Se.errors),X=X&&Se.valid,Se.valid&&ae.push(Ie)}X?W.length=le:W.splice(le,0,{instanceLocation:s,keyword:"allOf",keywordLocation:ne,error:"Instance does not match every subschema."})}if(_!==void 0){const ne=`${o}/oneOf`,le=W.length,X=_.filter((ce,pe)=>{const Ie=Object.create(u),Se=Ft(t,ce,r,n,i,f===!0?a:null,s,`${ne}/${pe}`,Ie);return W.push(...Se.errors),Se.valid&&ae.push(Ie),Se.valid}).length;X===1?W.length=le:W.splice(le,0,{instanceLocation:s,keyword:"oneOf",keywordLocation:ne,error:`Instance does not match exactly one subschema (${X} matches).`})}if((c==="object"||c==="array")&&Object.assign(u,...ae),O!==void 0){const ne=`${o}/if`;if(Ft(t,O,r,n,i,a,s,ne,u).valid){if(P!==void 0){const X=Ft(t,P,r,n,i,a,s,`${o}/then`,u);X.valid||W.push({instanceLocation:s,keyword:"if",keywordLocation:ne,error:'Instance does not match "then" schema.'},...X.errors)}}else if(x!==void 0){const X=Ft(t,x,r,n,i,a,s,`${o}/else`,u);X.valid||W.push({instanceLocation:s,keyword:"if",keywordLocation:ne,error:'Instance does not match "else" schema.'},...X.errors)}}if(c==="object"){if(v!==void 0)for(const ce of v)ce in t||W.push({instanceLocation:s,keyword:"required",keywordLocation:`${o}/required`,error:`Instance does not have required property "${ce}".`});const ne=Object.keys(t);if(N!==void 0&&ne.length<N&&W.push({instanceLocation:s,keyword:"minProperties",keywordLocation:`${o}/minProperties`,error:`Instance does not have at least ${N} properties.`}),L!==void 0&&ne.length>L&&W.push({instanceLocation:s,keyword:"maxProperties",keywordLocation:`${o}/maxProperties`,error:`Instance does not have at least ${L} properties.`}),D!==void 0){const ce=`${o}/propertyNames`;for(const pe in t){const Ie=`${s}/${na(pe)}`,Se=Ft(pe,D,r,n,i,a,Ie,ce);Se.valid||W.push({instanceLocation:s,keyword:"propertyNames",keywordLocation:ce,error:`Property name "${pe}" does not match schema.`},...Se.errors)}}if(q!==void 0){const ce=`${o}/dependantRequired`;for(const pe in q)if(pe in t){const Ie=q[pe];for(const Se of Ie)Se in t||W.push({instanceLocation:s,keyword:"dependentRequired",keywordLocation:ce,error:`Instance has "${pe}" but does not have "${Se}".`})}}if(M!==void 0)for(const ce in M){const pe=`${o}/dependentSchemas`;if(ce in t){const Ie=Ft(t,M[ce],r,n,i,a,s,`${pe}/${na(ce)}`,u);Ie.valid||W.push({instanceLocation:s,keyword:"dependentSchemas",keywordLocation:pe,error:`Instance has "${ce}" but does not match dependant schema.`},...Ie.errors)}}if(V!==void 0){const ce=`${o}/dependencies`;for(const pe in V)if(pe in t){const Ie=V[pe];if(Array.isArray(Ie))for(const Se of Ie)Se in t||W.push({instanceLocation:s,keyword:"dependencies",keywordLocation:ce,error:`Instance has "${pe}" but does not have "${Se}".`});else{const Se=Ft(t,Ie,r,n,i,a,s,`${ce}/${na(pe)}`);Se.valid||W.push({instanceLocation:s,keyword:"dependencies",keywordLocation:ce,error:`Instance has "${pe}" but does not match dependant schema.`},...Se.errors)}}}const le=Object.create(null);let X=!1;if(k!==void 0){const ce=`${o}/properties`;for(const pe in k){if(!(pe in t))continue;const Ie=`${s}/${na(pe)}`,Se=Ft(t[pe],k[pe],r,n,i,a,Ie,`${ce}/${na(pe)}`);if(Se.valid)u[pe]=le[pe]=!0;else if(X=i,W.push({instanceLocation:s,keyword:"properties",keywordLocation:ce,error:`Property "${pe}" does not match schema.`},...Se.errors),X)break}}if(!X&&R!==void 0){const ce=`${o}/patternProperties`;for(const pe in R){const Ie=new RegExp(pe),Se=R[pe];for(const Qr in t){if(!Ie.test(Qr))continue;const ef=`${s}/${na(Qr)}`,Gg=Ft(t[Qr],Se,r,n,i,a,ef,`${ce}/${na(pe)}`);Gg.valid?u[Qr]=le[Qr]=!0:(X=i,W.push({instanceLocation:s,keyword:"patternProperties",keywordLocation:ce,error:`Property "${Qr}" matches pattern "${pe}" but does not match associated schema.`},...Gg.errors))}}}if(!X&&F!==void 0){const ce=`${o}/additionalProperties`;for(const pe in t){if(le[pe])continue;const Ie=`${s}/${na(pe)}`,Se=Ft(t[pe],F,r,n,i,a,Ie,ce);Se.valid?u[pe]=!0:(X=i,W.push({instanceLocation:s,keyword:"additionalProperties",keywordLocation:ce,error:`Property "${pe}" does not match additional properties schema.`},...Se.errors))}}else if(!X&&z!==void 0){const ce=`${o}/unevaluatedProperties`;for(const pe in t)if(!u[pe]){const Ie=`${s}/${na(pe)}`,Se=Ft(t[pe],z,r,n,i,a,Ie,ce);Se.valid?u[pe]=!0:W.push({instanceLocation:s,keyword:"unevaluatedProperties",keywordLocation:ce,error:`Property "${pe}" does not match unevaluated properties schema.`},...Se.errors)}}}else if(c==="array"){U!==void 0&&t.length>U&&W.push({instanceLocation:s,keyword:"maxItems",keywordLocation:`${o}/maxItems`,error:`Array has too many items (${t.length} > ${U}).`}),E!==void 0&&t.length<E&&W.push({instanceLocation:s,keyword:"minItems",keywordLocation:`${o}/minItems`,error:`Array has too few items (${t.length} < ${E}).`});const ne=t.length;let le=0,X=!1;if(G!==void 0){const ce=`${o}/prefixItems`,pe=Math.min(G.length,ne);for(;le<pe;le++){const Ie=Ft(t[le],G[le],r,n,i,a,`${s}/${le}`,`${ce}/${le}`);if(u[le]=!0,!Ie.valid&&(X=i,W.push({instanceLocation:s,keyword:"prefixItems",keywordLocation:ce,error:"Items did not match schema."},...Ie.errors),X))break}}if(re!==void 0){const ce=`${o}/items`;if(Array.isArray(re)){const pe=Math.min(re.length,ne);for(;le<pe;le++){const Ie=Ft(t[le],re[le],r,n,i,a,`${s}/${le}`,`${ce}/${le}`);if(u[le]=!0,!Ie.valid&&(X=i,W.push({instanceLocation:s,keyword:"items",keywordLocation:ce,error:"Items did not match schema."},...Ie.errors),X))break}}else for(;le<ne;le++){const pe=Ft(t[le],re,r,n,i,a,`${s}/${le}`,ce);if(u[le]=!0,!pe.valid&&(X=i,W.push({instanceLocation:s,keyword:"items",keywordLocation:ce,error:"Items did not match schema."},...pe.errors),X))break}if(!X&&K!==void 0){const pe=`${o}/additionalItems`;for(;le<ne;le++){const Ie=Ft(t[le],K,r,n,i,a,`${s}/${le}`,pe);u[le]=!0,Ie.valid||(X=i,W.push({instanceLocation:s,keyword:"additionalItems",keywordLocation:pe,error:"Items did not match additional items schema."},...Ie.errors))}}}if(ie!==void 0)if(ne===0&&oe===void 0)W.push({instanceLocation:s,keyword:"contains",keywordLocation:`${o}/contains`,error:"Array is empty. It must contain at least one item matching the schema."});else if(oe!==void 0&&ne<oe)W.push({instanceLocation:s,keyword:"minContains",keywordLocation:`${o}/minContains`,error:`Array has less items (${ne}) than minContains (${oe}).`});else{const ce=`${o}/contains`,pe=W.length;let Ie=0;for(let Se=0;Se<ne;Se++){const Qr=Ft(t[Se],ie,r,n,i,a,`${s}/${Se}`,ce);Qr.valid?(u[Se]=!0,Ie++):W.push(...Qr.errors)}Ie>=(oe||0)&&(W.length=pe),oe===void 0&&S===void 0&&Ie===0?W.splice(pe,0,{instanceLocation:s,keyword:"contains",keywordLocation:ce,error:"Array does not contain item matching schema."}):oe!==void 0&&Ie<oe?W.push({instanceLocation:s,keyword:"minContains",keywordLocation:`${o}/minContains`,error:`Array must contain at least ${oe} items matching schema. Only ${Ie} items were found.`}):S!==void 0&&Ie>S&&W.push({instanceLocation:s,keyword:"maxContains",keywordLocation:`${o}/maxContains`,error:`Array may contain at most ${S} items matching schema. ${Ie} items were found.`})}if(!X&&J!==void 0){const ce=`${o}/unevaluatedItems`;for(le;le<ne;le++){if(u[le])continue;const pe=Ft(t[le],J,r,n,i,a,`${s}/${le}`,ce);u[le]=!0,pe.valid||W.push({instanceLocation:s,keyword:"unevaluatedItems",keywordLocation:ce,error:"Items did not match unevaluated items schema."},...pe.errors)}}if(T)for(let ce=0;ce<ne;ce++){const pe=t[ce],Ie=typeof pe=="object"&&pe!==null;for(let Se=0;Se<ne;Se++){if(ce===Se)continue;const Qr=t[Se];(pe===Qr||Ie&&(typeof Qr=="object"&&Qr!==null)&&pl(pe,Qr))&&(W.push({instanceLocation:s,keyword:"uniqueItems",keywordLocation:`${o}/uniqueItems`,error:`Duplicate items at indexes ${ce} and ${Se}.`}),ce=Number.MAX_SAFE_INTEGER,Se=Number.MAX_SAFE_INTEGER)}}}else if(c==="number"){if(r==="4"?(ee!==void 0&&(H===!0&&t<=ee||t<ee)&&W.push({instanceLocation:s,keyword:"minimum",keywordLocation:`${o}/minimum`,error:`${t} is less than ${H?"or equal to ":""} ${ee}.`}),se!==void 0&&(Oe===!0&&t>=se||t>se)&&W.push({instanceLocation:s,keyword:"maximum",keywordLocation:`${o}/maximum`,error:`${t} is greater than ${Oe?"or equal to ":""} ${se}.`})):(ee!==void 0&&t<ee&&W.push({instanceLocation:s,keyword:"minimum",keywordLocation:`${o}/minimum`,error:`${t} is less than ${ee}.`}),se!==void 0&&t>se&&W.push({instanceLocation:s,keyword:"maximum",keywordLocation:`${o}/maximum`,error:`${t} is greater than ${se}.`}),H!==void 0&&t<=H&&W.push({instanceLocation:s,keyword:"exclusiveMinimum",keywordLocation:`${o}/exclusiveMinimum`,error:`${t} is less than ${H}.`}),Oe!==void 0&&t>=Oe&&W.push({instanceLocation:s,keyword:"exclusiveMaximum",keywordLocation:`${o}/exclusiveMaximum`,error:`${t} is greater than or equal to ${Oe}.`})),be!==void 0){const ne=t%be;Math.abs(0-ne)>=11920929e-14&&Math.abs(be-ne)>=11920929e-14&&W.push({instanceLocation:s,keyword:"multipleOf",keywordLocation:`${o}/multipleOf`,error:`${t} is not a multiple of ${be}.`})}}else if(c==="string"){const ne=xe===void 0&&C===void 0?0:vFe(t);xe!==void 0&&ne<xe&&W.push({instanceLocation:s,keyword:"minLength",keywordLocation:`${o}/minLength`,error:`String is too short (${ne} < ${xe}).`}),C!==void 0&&ne>C&&W.push({instanceLocation:s,keyword:"maxLength",keywordLocation:`${o}/maxLength`,error:`String is too long (${ne} > ${C}).`}),B!==void 0&&!new RegExp(B).test(t)&&W.push({instanceLocation:s,keyword:"pattern",keywordLocation:`${o}/pattern`,error:"String does not match pattern."}),j!==void 0&&fF[j]&&!fF[j](t)&&W.push({instanceLocation:s,keyword:"format",keywordLocation:`${o}/format`,error:`String does not match format "${j}".`})}return{valid:W.length===0,errors:W}}class F8{constructor(e,r="2019-09",n=!0){Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"draft",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"shortCircuit",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"lookup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lookup=ol(e)}validate(e){return Ft(e,this.schema,this.draft,this.lookup,this.shortCircuit)}addSchema(e,r){r&&(e={...e,$id:r}),ol(e,this.lookup)}}class Fd extends zr{async*_transform(e){for await(const r of e)typeof r=="string"?yield this.parseResult([{text:r}]):yield this.parseResult([{message:r,text:this._baseMessageToString(r)}])}async*transform(e,r){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...r,runType:"parser"})}}class u1 extends Fd{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(e==null?void 0:e.diff)??this.diff}async*_transform(e){let r,n;for await(const i of e){if(typeof i!="string"&&typeof i.content!="string")throw new Error("Cannot handle non-string output.");let a;if(p6(i)){if(typeof i.content!="string")throw new Error("Cannot handle non-string message output.");a=new Yn({message:i,text:i.content})}else if(An(i)){if(typeof i.content!="string")throw new Error("Cannot handle non-string message output.");a=new Yn({message:hw(i),text:i.content})}else a=new Vi({text:i});n===void 0?n=a:n=n.concat(a);const s=await this.parsePartialResult([n]);s!=null&&!pl(s,r)&&(this.diff?yield this._diff(r,s):yield s,r=s)}}}class bFe extends Fd{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","bytes"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"textEncoder",{enumerable:!0,configurable:!0,writable:!0,value:new TextEncoder})}static lc_name(){return"BytesOutputParser"}parse(e){return Promise.resolve(this.textEncoder.encode(e))}getFormatInstructions(){return""}}class Ud extends Fd{constructor(){super(...arguments),Object.defineProperty(this,"re",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}async*_transform(e){let r="";for await(const n of e)if(typeof n=="string"?r+=n:r+=n.content,this.re){const i=[...r.matchAll(this.re)];if(i.length>1){let a=0;for(const s of i.slice(0,-1))yield[s[1]],a+=(s.index??0)+s[0].length;r=r.slice(a)}}else{const i=await this.parse(r);if(i.length>1){for(const a of i.slice(0,-1))yield[a];r=i[i.length-1]}}for(const n of await this.parse(r))yield[n]}}class U8 extends Ud{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","list"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"CommaSeparatedListOutputParser"}async parse(e){try{return e.trim().split(",").map(r=>r.trim())}catch{throw new ft(`Could not parse output: ${e}`,e)}}getFormatInstructions(){return"Your response should be a list of comma separated values, eg: `foo, bar, baz`"}}class z8 extends Ud{constructor({length:e,separator:r}){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","list"]}),Object.defineProperty(this,"length",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"separator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.length=e,this.separator=r||","}async parse(e){try{const r=e.trim().split(this.separator).map(n=>n.trim());if(this.length!==void 0&&r.length!==this.length)throw new ft(`Incorrect number of items. Expected ${this.length}, got ${r.length}.`);return r}catch(r){throw Object.getPrototypeOf(r)===ft.prototype?r:new ft(`Could not parse output: ${e}`)}}getFormatInstructions(){return`Your response should be a list of ${this.length===void 0?"":`${this.length} `}items separated by "${this.separator}" (eg: \`foo${this.separator} bar${this.separator} baz\`)`}}class wFe extends Ud{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","list"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"re",{enumerable:!0,configurable:!0,writable:!0,value:/\d+\.\s([^\n]+)/g})}static lc_name(){return"NumberedListOutputParser"}getFormatInstructions(){return`Your response should be a numbered list with each item on a new line. For example: 

1. foo

2. bar

3. baz`}async parse(e){return[...e.matchAll(this.re)??[]].map(r=>r[1])}}class _Fe extends Ud{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","list"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"re",{enumerable:!0,configurable:!0,writable:!0,value:/^\s*[-*]\s([^\n]+)$/gm})}static lc_name(){return"NumberedListOutputParser"}getFormatInstructions(){return`Your response should be a numbered list with each item on a new line. For example: 

1. foo

2. bar

3. baz`}async parse(e){return[...e.matchAll(this.re)??[]].map(r=>r[1])}}class zd extends Fd{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers","string"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"StrOutputParser"}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}_textContentToString(e){return e.text}_imageUrlContentToString(e){throw new Error('Cannot coerce a multimodal "image_url" message part into a string.')}_messageContentComplexToString(e){switch(e.type){case"text":case"text_delta":if("text"in e)return this._textContentToString(e);break;case"image_url":if("image_url"in e)return this._imageUrlContentToString(e);break;default:throw new Error(`Cannot coerce "${e.type}" message part into a string.`)}throw new Error(`Invalid content type: ${e.type}`)}_baseMessageContentToString(e){return e.reduce((r,n)=>r+this._messageContentComplexToString(n),"")}}let kw=class extends zr{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const r=tt.object(Object.fromEntries(Object.entries(e).map(([n,i])=>[n,tt.string().describe(i)])));return new this(r)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(Ur(this.schema))}
\`\`\`
`}async parse(e){try{const n=(e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(i,a)=>`"${a.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(n))}catch(r){throw new ft(`Failed to parse. Text: "${e}". Error: ${r}`,e)}}},B8=class extends kw{static lc_name(){return"JsonMarkdownStructuredOutputParser"}getFormatInstructions(e){const r=(e==null?void 0:e.interpolationDepth)??1;if(r<1)throw new Error("f string interpolation depth must be at least 1");return`Return a markdown code snippet with a JSON object formatted to look like:
\`\`\`json
${this._schemaToInstruction(Ur(this.schema)).replaceAll("{","{".repeat(r)).replaceAll("}","}".repeat(r))}
\`\`\``}_schemaToInstruction(e,r=2){const n=e;if("type"in n){let i=!1,a;if(Array.isArray(n.type)){const u=n.type.findIndex(l=>l==="null");u!==-1&&(i=!0,n.type.splice(u,1)),a=n.type.join(" | ")}else a=n.type;if(n.type==="object"&&n.properties){const u=n.description?` // ${n.description}`:"";return`{
${Object.entries(n.properties).map(([c,h])=>{var f;const d=(f=n.required)!=null&&f.includes(c)?"":" (optional)";return`${" ".repeat(r)}"${c}": ${this._schemaToInstruction(h,r+2)}${d}`}).join(`
`)}
${" ".repeat(r-2)}}${u}`}if(n.type==="array"&&n.items){const u=n.description?` // ${n.description}`:"";return`array[
${" ".repeat(r)}${this._schemaToInstruction(n.items,r+2)}
${" ".repeat(r-2)}] ${u}`}const s=i?" (nullable)":"",o=n.description?` // ${n.description}`:"";return`${a}${o}${s}`}if("anyOf"in n)return n.anyOf.map(i=>this._schemaToInstruction(i,r)).join(`
${" ".repeat(r-2)}`);throw new Error("unsupported schema type")}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const r=tt.object(Object.fromEntries(Object.entries(e).map(([n,i])=>[n,tt.string().describe(i)])));return new this(r)}},xFe=class extends zr{constructor({inputSchema:e}){super(...arguments),Object.defineProperty(this,"structuredInputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.structuredInputParser=new B8(e)}async parse(e){let r;try{r=await this.structuredInputParser.parse(e)}catch(n){throw new ft(`Failed to parse. Text: "${e}". Error: ${n}`,e)}return this.outputProcessor(r)}getFormatInstructions(){return this.structuredInputParser.getFormatInstructions()}};const OFe=Object.freeze(Object.defineProperty({__proto__:null,applyPatch:Lm,compare:q_},Symbol.toStringTag,{value:"Module"}));class aA extends u1{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,r){if(r)return e?q_(e,r):[{op:"replace",path:"",value:r}]}async parsePartialResult(e){return LE(e[0].text)}async parse(e){return LE(e,JSON.parse)}getFormatInstructions(){return""}}const SFe=function(){const t={};t.parser=function(S,E){return new r(S,E)},t.SAXParser=r,t.SAXStream=l,t.createStream=u,t.MAX_BUFFER_LENGTH=64*1024;const e=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function r(S,E){if(!(this instanceof r))return new r(S,E);var U=this;i(U),U.q=U.c="",U.bufferCheckPosition=t.MAX_BUFFER_LENGTH,U.opt=E||{},U.opt.lowercase=U.opt.lowercase||U.opt.lowercasetags,U.looseCase=U.opt.lowercase?"toLowerCase":"toUpperCase",U.tags=[],U.closed=U.closedRoot=U.sawRoot=!1,U.tag=U.error=null,U.strict=!!S,U.noscript=!!(S||U.opt.noscript),U.state=x.BEGIN,U.strictEntities=U.opt.strictEntities,U.ENTITIES=U.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),U.attribList=[],U.opt.xmlns&&(U.ns=Object.create(p)),U.trackPosition=U.opt.position!==!1,U.trackPosition&&(U.position=U.line=U.column=0),k(U,"onready")}Object.create||(Object.create=function(S){function E(){}E.prototype=S;var U=new E;return U}),Object.keys||(Object.keys=function(S){var E=[];for(var U in S)S.hasOwnProperty(U)&&E.push(U);return E});function n(S){for(var E=Math.max(t.MAX_BUFFER_LENGTH,10),U=0,T=0,ee=e.length;T<ee;T++){var se=S[e[T]].length;if(se>E)switch(e[T]){case"textNode":F(S);break;case"cdata":R(S,"oncdata",S.cdata),S.cdata="";break;case"script":R(S,"onscript",S.script),S.script="";break;default:N(S,"Max buffer length exceeded: "+e[T])}U=Math.max(U,se)}var H=t.MAX_BUFFER_LENGTH-U;S.bufferCheckPosition=H+S.position}function i(S){for(var E=0,U=e.length;E<U;E++)S[e[E]]=""}function a(S){F(S),S.cdata!==""&&(R(S,"oncdata",S.cdata),S.cdata=""),S.script!==""&&(R(S,"onscript",S.script),S.script="")}r.prototype={end:function(){L(this)},write:oe,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){a(this)}};var s=ReadableStream;s||(s=function(){});var o=t.EVENTS.filter(function(S){return S!=="error"&&S!=="end"});function u(S,E){return new l(S,E)}function l(S,E){if(!(this instanceof l))return new l(S,E);s.apply(this),this._parser=new r(S,E),this.writable=!0,this.readable=!0;var U=this;this._parser.onend=function(){U.emit("end")},this._parser.onerror=function(T){U.emit("error",T),U._parser.error=null},this._decoder=null,o.forEach(function(T){Object.defineProperty(U,"on"+T,{get:function(){return U._parser["on"+T]},set:function(ee){if(!ee)return U.removeAllListeners(T),U._parser["on"+T]=ee,ee;U.on(T,ee)},enumerable:!0,configurable:!1})})}l.prototype=Object.create(s.prototype,{constructor:{value:l}}),l.prototype.write=function(S){return this._parser.write(S.toString()),this.emit("data",S),!0},l.prototype.end=function(S){return S&&S.length&&this.write(S),this._parser.end(),!0},l.prototype.on=function(S,E){var U=this;return!U._parser["on"+S]&&o.indexOf(S)!==-1&&(U._parser["on"+S]=function(){var T=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);T.splice(0,0,S),U.emit.apply(U,T)}),s.prototype.on.call(U,S,E)};var c="[CDATA[",h="DOCTYPE",d="http://www.w3.org/XML/1998/namespace",f="http://www.w3.org/2000/xmlns/",p={xml:d,xmlns:f},m=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,g=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,v=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function b(S){return S===" "||S===`
`||S==="\r"||S==="	"}function w(S){return S==='"'||S==="'"}function _(S){return S===">"||b(S)}function O(S,E){return S.test(E)}function P(S,E){return!O(S,E)}var x=0;t.STATE={BEGIN:x++,BEGIN_WHITESPACE:x++,TEXT:x++,TEXT_ENTITY:x++,OPEN_WAKA:x++,SGML_DECL:x++,SGML_DECL_QUOTED:x++,DOCTYPE:x++,DOCTYPE_QUOTED:x++,DOCTYPE_DTD:x++,DOCTYPE_DTD_QUOTED:x++,COMMENT_STARTING:x++,COMMENT:x++,COMMENT_ENDING:x++,COMMENT_ENDED:x++,CDATA:x++,CDATA_ENDING:x++,CDATA_ENDING_2:x++,PROC_INST:x++,PROC_INST_BODY:x++,PROC_INST_ENDING:x++,OPEN_TAG:x++,OPEN_TAG_SLASH:x++,ATTRIB:x++,ATTRIB_NAME:x++,ATTRIB_NAME_SAW_WHITE:x++,ATTRIB_VALUE:x++,ATTRIB_VALUE_QUOTED:x++,ATTRIB_VALUE_CLOSED:x++,ATTRIB_VALUE_UNQUOTED:x++,ATTRIB_VALUE_ENTITY_Q:x++,ATTRIB_VALUE_ENTITY_U:x++,CLOSE_TAG:x++,CLOSE_TAG_SAW_WHITE:x++,SCRIPT:x++,SCRIPT_ENDING:x++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(S){var E=t.ENTITIES[S],U=typeof E=="number"?String.fromCharCode(E):E;t.ENTITIES[S]=U});for(var j in t.STATE)t.STATE[t.STATE[j]]=j;x=t.STATE;function k(S,E,U){S[E]&&S[E](U)}function R(S,E,U){S.textNode&&F(S),k(S,E,U)}function F(S){S.textNode=z(S.opt,S.textNode),S.textNode&&k(S,"ontext",S.textNode),S.textNode=""}function z(S,E){return S.trim&&(E=E.trim()),S.normalize&&(E=E.replace(/\s+/g," ")),E}function N(S,E){return F(S),S.trackPosition&&(E+=`
Line: `+S.line+`
Column: `+S.column+`
Char: `+S.c),E=new Error(E),S.error=E,k(S,"onerror",E),S}function L(S){return S.sawRoot&&!S.closedRoot&&D(S,"Unclosed root tag"),S.state!==x.BEGIN&&S.state!==x.BEGIN_WHITESPACE&&S.state!==x.TEXT&&N(S,"Unexpected end"),F(S),S.c="",S.closed=!0,k(S,"onend"),r.call(S,S.strict,S.opt),S}function D(S,E){if(typeof S!="object"||!(S instanceof r))throw new Error("bad call to strictFail");S.strict&&N(S,E)}function q(S){S.strict||(S.tagName=S.tagName[S.looseCase]());var E=S.tags[S.tags.length-1]||S,U=S.tag={name:S.tagName,attributes:{}};S.opt.xmlns&&(U.ns=E.ns),S.attribList.length=0,R(S,"onopentagstart",U)}function M(S,E){var U=S.indexOf(":"),T=U<0?["",S]:S.split(":"),ee=T[0],se=T[1];return E&&S==="xmlns"&&(ee="xmlns",se=""),{prefix:ee,local:se}}function V(S){if(S.strict||(S.attribName=S.attribName[S.looseCase]()),S.attribList.indexOf(S.attribName)!==-1||S.tag.attributes.hasOwnProperty(S.attribName)){S.attribName=S.attribValue="";return}if(S.opt.xmlns){var E=M(S.attribName,!0),U=E.prefix,T=E.local;if(U==="xmlns")if(T==="xml"&&S.attribValue!==d)D(S,"xml: prefix must be bound to "+d+`
Actual: `+S.attribValue);else if(T==="xmlns"&&S.attribValue!==f)D(S,"xmlns: prefix must be bound to "+f+`
Actual: `+S.attribValue);else{var ee=S.tag,se=S.tags[S.tags.length-1]||S;ee.ns===se.ns&&(ee.ns=Object.create(se.ns)),ee.ns[T]=S.attribValue}S.attribList.push([S.attribName,S.attribValue])}else S.tag.attributes[S.attribName]=S.attribValue,R(S,"onattribute",{name:S.attribName,value:S.attribValue});S.attribName=S.attribValue=""}function G(S,E){if(S.opt.xmlns){var U=S.tag,T=M(S.tagName);U.prefix=T.prefix,U.local=T.local,U.uri=U.ns[T.prefix]||"",U.prefix&&!U.uri&&(D(S,"Unbound namespace prefix: "+JSON.stringify(S.tagName)),U.uri=T.prefix);var ee=S.tags[S.tags.length-1]||S;U.ns&&ee.ns!==U.ns&&Object.keys(U.ns).forEach(function(ae){R(S,"onopennamespace",{prefix:ae,uri:U.ns[ae]})});for(var se=0,H=S.attribList.length;se<H;se++){var Oe=S.attribList[se],be=Oe[0],xe=Oe[1],C=M(be,!0),B=C.prefix,Y=C.local,me=B===""?"":U.ns[B]||"",W={name:be,value:xe,prefix:B,local:Y,uri:me};B&&B!=="xmlns"&&!me&&(D(S,"Unbound namespace prefix: "+JSON.stringify(B)),W.uri=B),S.tag.attributes[be]=W,R(S,"onattribute",W)}S.attribList.length=0}S.tag.isSelfClosing=!!E,S.sawRoot=!0,S.tags.push(S.tag),R(S,"onopentag",S.tag),E||(!S.noscript&&S.tagName.toLowerCase()==="script"?S.state=x.SCRIPT:S.state=x.TEXT,S.tag=null,S.tagName=""),S.attribName=S.attribValue="",S.attribList.length=0}function re(S){if(!S.tagName){D(S,"Weird empty close tag."),S.textNode+="</>",S.state=x.TEXT;return}if(S.script){if(S.tagName!=="script"){S.script+="</"+S.tagName+">",S.tagName="",S.state=x.SCRIPT;return}R(S,"onscript",S.script),S.script=""}var E=S.tags.length,U=S.tagName;S.strict||(U=U[S.looseCase]());for(var T=U;E--;){var ee=S.tags[E];if(ee.name!==T)D(S,"Unexpected close tag");else break}if(E<0){D(S,"Unmatched closing tag: "+S.tagName),S.textNode+="</"+S.tagName+">",S.state=x.TEXT;return}S.tagName=U;for(var se=S.tags.length;se-- >E;){var H=S.tag=S.tags.pop();S.tagName=S.tag.name,R(S,"onclosetag",S.tagName);var Oe={};for(var be in H.ns)Oe[be]=H.ns[be];var xe=S.tags[S.tags.length-1]||S;S.opt.xmlns&&H.ns!==xe.ns&&Object.keys(H.ns).forEach(function(C){var B=H.ns[C];R(S,"onclosenamespace",{prefix:C,uri:B})})}E===0&&(S.closedRoot=!0),S.tagName=S.attribValue=S.attribName="",S.attribList.length=0,S.state=x.TEXT}function K(S){var E=S.entity,U=E.toLowerCase(),T,ee="";return S.ENTITIES[E]?S.ENTITIES[E]:S.ENTITIES[U]?S.ENTITIES[U]:(E=U,E.charAt(0)==="#"&&(E.charAt(1)==="x"?(E=E.slice(2),T=parseInt(E,16),ee=T.toString(16)):(E=E.slice(1),T=parseInt(E,10),ee=T.toString(10))),E=E.replace(/^0+/,""),isNaN(T)||ee.toLowerCase()!==E?(D(S,"Invalid character entity"),"&"+S.entity+";"):String.fromCodePoint(T))}function J(S,E){E==="<"?(S.state=x.OPEN_WAKA,S.startTagPosition=S.position):b(E)||(D(S,"Non-whitespace before first tag."),S.textNode=E,S.state=x.TEXT)}function ie(S,E){var U="";return E<S.length&&(U=S.charAt(E)),U}function oe(S){var E=this;if(this.error)throw this.error;if(E.closed)return N(E,"Cannot write after close. Assign an onready handler.");if(S===null)return L(E);typeof S=="object"&&(S=S.toString());for(var U=0,T="";T=ie(S,U++),E.c=T,!!T;)switch(E.trackPosition&&(E.position++,T===`
`?(E.line++,E.column=0):E.column++),E.state){case x.BEGIN:if(E.state=x.BEGIN_WHITESPACE,T==="\uFEFF")continue;J(E,T);continue;case x.BEGIN_WHITESPACE:J(E,T);continue;case x.TEXT:if(E.sawRoot&&!E.closedRoot){for(var ee=U-1;T&&T!=="<"&&T!=="&";)T=ie(S,U++),T&&E.trackPosition&&(E.position++,T===`
`?(E.line++,E.column=0):E.column++);E.textNode+=S.substring(ee,U-1)}T==="<"&&!(E.sawRoot&&E.closedRoot&&!E.strict)?(E.state=x.OPEN_WAKA,E.startTagPosition=E.position):(!b(T)&&(!E.sawRoot||E.closedRoot)&&D(E,"Text data outside of root node."),T==="&"?E.state=x.TEXT_ENTITY:E.textNode+=T);continue;case x.SCRIPT:T==="<"?E.state=x.SCRIPT_ENDING:E.script+=T;continue;case x.SCRIPT_ENDING:T==="/"?E.state=x.CLOSE_TAG:(E.script+="<"+T,E.state=x.SCRIPT);continue;case x.OPEN_WAKA:if(T==="!")E.state=x.SGML_DECL,E.sgmlDecl="";else if(!b(T))if(O(m,T))E.state=x.OPEN_TAG,E.tagName=T;else if(T==="/")E.state=x.CLOSE_TAG,E.tagName="";else if(T==="?")E.state=x.PROC_INST,E.procInstName=E.procInstBody="";else{if(D(E,"Unencoded <"),E.startTagPosition+1<E.position){var se=E.position-E.startTagPosition;T=new Array(se).join(" ")+T}E.textNode+="<"+T,E.state=x.TEXT}continue;case x.SGML_DECL:(E.sgmlDecl+T).toUpperCase()===c?(R(E,"onopencdata"),E.state=x.CDATA,E.sgmlDecl="",E.cdata=""):E.sgmlDecl+T==="--"?(E.state=x.COMMENT,E.comment="",E.sgmlDecl=""):(E.sgmlDecl+T).toUpperCase()===h?(E.state=x.DOCTYPE,(E.doctype||E.sawRoot)&&D(E,"Inappropriately located doctype declaration"),E.doctype="",E.sgmlDecl=""):T===">"?(R(E,"onsgmldeclaration",E.sgmlDecl),E.sgmlDecl="",E.state=x.TEXT):(w(T)&&(E.state=x.SGML_DECL_QUOTED),E.sgmlDecl+=T);continue;case x.SGML_DECL_QUOTED:T===E.q&&(E.state=x.SGML_DECL,E.q=""),E.sgmlDecl+=T;continue;case x.DOCTYPE:T===">"?(E.state=x.TEXT,R(E,"ondoctype",E.doctype),E.doctype=!0):(E.doctype+=T,T==="["?E.state=x.DOCTYPE_DTD:w(T)&&(E.state=x.DOCTYPE_QUOTED,E.q=T));continue;case x.DOCTYPE_QUOTED:E.doctype+=T,T===E.q&&(E.q="",E.state=x.DOCTYPE);continue;case x.DOCTYPE_DTD:E.doctype+=T,T==="]"?E.state=x.DOCTYPE:w(T)&&(E.state=x.DOCTYPE_DTD_QUOTED,E.q=T);continue;case x.DOCTYPE_DTD_QUOTED:E.doctype+=T,T===E.q&&(E.state=x.DOCTYPE_DTD,E.q="");continue;case x.COMMENT:T==="-"?E.state=x.COMMENT_ENDING:E.comment+=T;continue;case x.COMMENT_ENDING:T==="-"?(E.state=x.COMMENT_ENDED,E.comment=z(E.opt,E.comment),E.comment&&R(E,"oncomment",E.comment),E.comment=""):(E.comment+="-"+T,E.state=x.COMMENT);continue;case x.COMMENT_ENDED:T!==">"?(D(E,"Malformed comment"),E.comment+="--"+T,E.state=x.COMMENT):E.state=x.TEXT;continue;case x.CDATA:T==="]"?E.state=x.CDATA_ENDING:E.cdata+=T;continue;case x.CDATA_ENDING:T==="]"?E.state=x.CDATA_ENDING_2:(E.cdata+="]"+T,E.state=x.CDATA);continue;case x.CDATA_ENDING_2:T===">"?(E.cdata&&R(E,"oncdata",E.cdata),R(E,"onclosecdata"),E.cdata="",E.state=x.TEXT):T==="]"?E.cdata+="]":(E.cdata+="]]"+T,E.state=x.CDATA);continue;case x.PROC_INST:T==="?"?E.state=x.PROC_INST_ENDING:b(T)?E.state=x.PROC_INST_BODY:E.procInstName+=T;continue;case x.PROC_INST_BODY:if(!E.procInstBody&&b(T))continue;T==="?"?E.state=x.PROC_INST_ENDING:E.procInstBody+=T;continue;case x.PROC_INST_ENDING:T===">"?(R(E,"onprocessinginstruction",{name:E.procInstName,body:E.procInstBody}),E.procInstName=E.procInstBody="",E.state=x.TEXT):(E.procInstBody+="?"+T,E.state=x.PROC_INST_BODY);continue;case x.OPEN_TAG:O(g,T)?E.tagName+=T:(q(E),T===">"?G(E):T==="/"?E.state=x.OPEN_TAG_SLASH:(b(T)||D(E,"Invalid character in tag name"),E.state=x.ATTRIB));continue;case x.OPEN_TAG_SLASH:T===">"?(G(E,!0),re(E)):(D(E,"Forward-slash in opening tag not followed by >"),E.state=x.ATTRIB);continue;case x.ATTRIB:if(b(T))continue;T===">"?G(E):T==="/"?E.state=x.OPEN_TAG_SLASH:O(m,T)?(E.attribName=T,E.attribValue="",E.state=x.ATTRIB_NAME):D(E,"Invalid attribute name");continue;case x.ATTRIB_NAME:T==="="?E.state=x.ATTRIB_VALUE:T===">"?(D(E,"Attribute without value"),E.attribValue=E.attribName,V(E),G(E)):b(T)?E.state=x.ATTRIB_NAME_SAW_WHITE:O(g,T)?E.attribName+=T:D(E,"Invalid attribute name");continue;case x.ATTRIB_NAME_SAW_WHITE:if(T==="=")E.state=x.ATTRIB_VALUE;else{if(b(T))continue;D(E,"Attribute without value"),E.tag.attributes[E.attribName]="",E.attribValue="",R(E,"onattribute",{name:E.attribName,value:""}),E.attribName="",T===">"?G(E):O(m,T)?(E.attribName=T,E.state=x.ATTRIB_NAME):(D(E,"Invalid attribute name"),E.state=x.ATTRIB)}continue;case x.ATTRIB_VALUE:if(b(T))continue;w(T)?(E.q=T,E.state=x.ATTRIB_VALUE_QUOTED):(D(E,"Unquoted attribute value"),E.state=x.ATTRIB_VALUE_UNQUOTED,E.attribValue=T);continue;case x.ATTRIB_VALUE_QUOTED:if(T!==E.q){T==="&"?E.state=x.ATTRIB_VALUE_ENTITY_Q:E.attribValue+=T;continue}V(E),E.q="",E.state=x.ATTRIB_VALUE_CLOSED;continue;case x.ATTRIB_VALUE_CLOSED:b(T)?E.state=x.ATTRIB:T===">"?G(E):T==="/"?E.state=x.OPEN_TAG_SLASH:O(m,T)?(D(E,"No whitespace between attributes"),E.attribName=T,E.attribValue="",E.state=x.ATTRIB_NAME):D(E,"Invalid attribute name");continue;case x.ATTRIB_VALUE_UNQUOTED:if(!_(T)){T==="&"?E.state=x.ATTRIB_VALUE_ENTITY_U:E.attribValue+=T;continue}V(E),T===">"?G(E):E.state=x.ATTRIB;continue;case x.CLOSE_TAG:if(E.tagName)T===">"?re(E):O(g,T)?E.tagName+=T:E.script?(E.script+="</"+E.tagName,E.tagName="",E.state=x.SCRIPT):(b(T)||D(E,"Invalid tagname in closing tag"),E.state=x.CLOSE_TAG_SAW_WHITE);else{if(b(T))continue;P(m,T)?E.script?(E.script+="</"+T,E.state=x.SCRIPT):D(E,"Invalid tagname in closing tag."):E.tagName=T}continue;case x.CLOSE_TAG_SAW_WHITE:if(b(T))continue;T===">"?re(E):D(E,"Invalid characters in closing tag");continue;case x.TEXT_ENTITY:case x.ATTRIB_VALUE_ENTITY_Q:case x.ATTRIB_VALUE_ENTITY_U:var H,Oe;switch(E.state){case x.TEXT_ENTITY:H=x.TEXT,Oe="textNode";break;case x.ATTRIB_VALUE_ENTITY_Q:H=x.ATTRIB_VALUE_QUOTED,Oe="attribValue";break;case x.ATTRIB_VALUE_ENTITY_U:H=x.ATTRIB_VALUE_UNQUOTED,Oe="attribValue";break}if(T===";")if(E.opt.unparsedEntities){var be=K(E);E.entity="",E.state=H,E.write(be)}else E[Oe]+=K(E),E.entity="",E.state=H;else O(E.entity.length?y:v,T)?E.entity+=T:(D(E,"Invalid character in entity name"),E[Oe]+="&"+E.entity+T,E.entity="",E.state=H);continue;default:throw new Error(E,"Unknown state: "+E.state)}return E.position>=E.bufferCheckPosition&&n(E),E}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */return String.fromCodePoint||function(){var S=String.fromCharCode,E=Math.floor,U=function(){var T=16384,ee=[],se,H,Oe=-1,be=arguments.length;if(!be)return"";for(var xe="";++Oe<be;){var C=Number(arguments[Oe]);if(!isFinite(C)||C<0||C>1114111||E(C)!==C)throw RangeError("Invalid code point: "+C);C<=65535?ee.push(C):(C-=65536,se=(C>>10)+55296,H=C%1024+56320,ee.push(se,H)),(Oe+1===be||ee.length>T)&&(xe+=S.apply(null,ee),ee.length=0)}return xe};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:U,configurable:!0,writable:!0}):String.fromCodePoint=U}(),t},PFe=SFe(),sA=`The output should be formatted as a XML file.
1. Output should conform to the tags below. 
2. If tags are not given, make them on your own.
3. Remember to always open and close all the tags.

As an example, for the tags ["foo", "bar", "baz"]:
1. String "<foo>
   <bar>
      <baz></baz>
   </bar>
</foo>" is a well-formatted instance of the schema. 
2. String "<foo>
   <bar>
   </foo>" is a badly-formatted instance.
3. String "<foo>
   <tag>
   </tag>
</foo>" is a badly-formatted instance.

Here are the output tags:
\`\`\`
{tags}
\`\`\``;class EFe extends u1{constructor(e){super(e),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.tags=e==null?void 0:e.tags}static lc_name(){return"XMLOutputParser"}_diff(e,r){if(r)return e?q_(e,r):[{op:"replace",path:"",value:r}]}async parsePartialResult(e){return oA(e[0].text)}async parse(e){return oA(e)}getFormatInstructions(){var r;return!!(this.tags&&this.tags.length>0)?sA.replace("{tags}",((r=this.tags)==null?void 0:r.join(", "))??""):sA}}const AFe=t=>t.split(`
`).map(e=>e.replace(/^\s+/,"")).join(`
`).trim(),q8=t=>{if(Object.keys(t).length===0)return{};const e={};return t.children.length>0?(e[t.name]=t.children.map(q8),e):(e[t.name]=t.text??void 0,e)};function oA(t){const e=AFe(t),r=PFe.parser(!0);let n={};const i=[];r.onopentag=o=>{const u={name:o.name,attributes:o.attributes,children:[],text:"",isSelfClosing:o.isSelfClosing};i.length>0?i[i.length-1].children.push(u):n=u,o.isSelfClosing||i.push(u)},r.onclosetag=()=>{if(i.length>0){const o=i.pop();i.length===0&&o&&(n=o)}},r.ontext=o=>{if(i.length>0){const u=i[i.length-1];u.text+=o}},r.onattribute=o=>{if(i.length>0){const u=i[i.length-1];u.attributes[o.name]=o.value}};const a=/```(xml)?(.*)```/s.exec(e),s=a?a[2]:e;return r.write(s).close(),n&&n.name==="?xml"&&(n=n.children[0]),q8(n)}const TFe=Object.freeze(Object.defineProperty({__proto__:null,AsymmetricStructuredOutputParser:xFe,BaseCumulativeTransformOutputParser:u1,BaseLLMOutputParser:wi,BaseOutputParser:zr,BaseTransformOutputParser:Fd,BytesOutputParser:bFe,CommaSeparatedListOutputParser:U8,CustomListOutputParser:z8,JsonMarkdownStructuredOutputParser:B8,JsonOutputParser:aA,ListOutputParser:Ud,MarkdownListOutputParser:_Fe,NumberedListOutputParser:wFe,OutputParserException:ft,StringOutputParser:zd,StructuredOutputParser:kw,XMLOutputParser:EFe,XML_FORMAT_INSTRUCTIONS:sA,parseJsonMarkdown:LE,parsePartialJson:Wh,parseXMLMarkdown:oA},Symbol.toStringTag,{value:"Module"}));class pF extends wi{static lc_name(){return"GoogleGenerativeAIToolsOutputParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","google_genai","output_parsers"]}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const r=await this.zodSchema.safeParseAsync(e);if(r.success)return r.data;throw new ft(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(r.error.errors)}`,JSON.stringify(e,null,2))}async parseResult(e){const r=e.flatMap(a=>{const{message:s}=a;return!("tool_calls"in s)||!Array.isArray(s.tool_calls)?[]:s.tool_calls});if(r[0]===void 0)throw new Error("No parseable tool calls provided to GoogleGenerativeAIToolsOutputParser.");const[n]=r;return await this._validateResult(n.args)}}class kFe extends xn{static lc_name(){return"ChatGoogleGenerativeAI"}get lc_secrets(){return{apiKey:"GOOGLE_API_KEY"}}get lc_aliases(){return{apiKey:"google_api_key"}}get _isMultimodalModel(){return this.model.includes("vision")||this.model.startsWith("gemini-1.5")}constructor(e){var r,n;if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models","google_genai"]}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gemini-pro"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gemini-pro"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxOutputTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"safetySettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.modelName=((r=e==null?void 0:e.model)==null?void 0:r.replace(/^models\//,""))??((n=e==null?void 0:e.modelName)==null?void 0:n.replace(/^models\//,""))??this.model,this.model=this.modelName,this.maxOutputTokens=(e==null?void 0:e.maxOutputTokens)??this.maxOutputTokens,this.maxOutputTokens&&this.maxOutputTokens<0)throw new Error("`maxOutputTokens` must be a positive integer");if(this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.temperature&&(this.temperature<0||this.temperature>1))throw new Error("`temperature` must be in the range of [0.0,1.0]");if(this.topP=(e==null?void 0:e.topP)??this.topP,this.topP&&this.topP<0)throw new Error("`topP` must be a positive integer");if(this.topP&&this.topP>1)throw new Error("`topP` must be below 1.");if(this.topK=(e==null?void 0:e.topK)??this.topK,this.topK&&this.topK<0)throw new Error("`topK` must be a positive integer");if(this.stopSequences=(e==null?void 0:e.stopSequences)??this.stopSequences,this.apiKey=(e==null?void 0:e.apiKey)??Me("GOOGLE_API_KEY"),!this.apiKey)throw new Error("Please set an API key for Google GenerativeAI in the environment variable GOOGLE_API_KEY or in the `apiKey` field of the ChatGoogleGenerativeAI constructor");if(this.safetySettings=(e==null?void 0:e.safetySettings)??this.safetySettings,this.safetySettings&&this.safetySettings.length>0&&new Set(this.safetySettings.map(a=>a.category)).size!==this.safetySettings.length)throw new Error("The categories in `safetySettings` array must be unique");this.streaming=(e==null?void 0:e.streaming)??this.streaming,this.client=new kLe(this.apiKey).getGenerativeModel({model:this.model,safetySettings:this.safetySettings,generationConfig:{candidateCount:1,stopSequences:this.stopSequences,maxOutputTokens:this.maxOutputTokens,temperature:this.temperature,topP:this.topP,topK:this.topK,...e!=null&&e.json?{responseMimeType:"application/json"}:{}}},{apiVersion:e==null?void 0:e.apiVersion,baseUrl:e==null?void 0:e.baseUrl}),this.streamUsage=(e==null?void 0:e.streamUsage)??this.streamUsage}getLsParams(e){return{ls_provider:"google_genai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:this.client.generationConfig.temperature,ls_max_tokens:this.client.generationConfig.maxOutputTokens,ls_stop:e.stop}}_combineLLMOutput(){return[]}_llmType(){return"googlegenerativeai"}bindTools(e,r){return this.bind({tools:dF(e),...r})}invocationParams(e){if(e!=null&&e.tool_choice)throw new Error("'tool_choice' call option is not supported by ChatGoogleGenerativeAI.");const r=e==null?void 0:e.tools;return Array.isArray(r)&&!r.some(n=>!("lc_namespace"in n))?{tools:dF(e==null?void 0:e.tools)}:{tools:e==null?void 0:e.tools}}async _generate(e,r,n){var l;const i=hF(e,this._isMultimodalModel),a=this.invocationParams(r);if(this.streaming){const c={},h=this._streamResponseChunks(e,r,n),d={};for await(const p of h){const m=((l=p.generationInfo)==null?void 0:l.completion)??0;d[m]===void 0?d[m]=p:d[m]=d[m].concat(p)}return{generations:Object.entries(d).sort(([p],[m])=>parseInt(p,10)-parseInt(m,10)).map(([p,m])=>m),llmOutput:{estimatedTokenUsage:c}}}const s=await this.completionWithRetry({...a,contents:i});let o;if("usageMetadata"in s.response){const c=s.response.usageMetadata;o={input_tokens:c.promptTokenCount??0,output_tokens:c.candidatesTokenCount??0,total_tokens:c.totalTokenCount??0}}const u=DLe(s.response,{usageMetadata:o});return await(n==null?void 0:n.handleLLMNewToken(u.generations[0].text??"")),u}async*_streamResponseChunks(e,r,n){const i=hF(e,this._isMultimodalModel),s={...this.invocationParams(r),contents:i},o=await this.caller.callWithOptions({signal:r==null?void 0:r.signal},async()=>{const{stream:c}=await this.client.generateContentStream(s);return c});let u,l=0;for await(const c of o){if("usageMetadata"in c&&this.streamUsage!==!1&&r.streamUsage!==!1){const d=c.usageMetadata;if(!u)u={input_tokens:d.promptTokenCount,output_tokens:d.candidatesTokenCount,total_tokens:d.totalTokenCount};else{const f=d.candidatesTokenCount-u.output_tokens;u={input_tokens:0,output_tokens:f,total_tokens:f}}}const h=LLe(c,{usageMetadata:u,index:l});l+=1,h&&(yield h,await(n==null?void 0:n.handleLLMNewToken(h.text??"")))}}async completionWithRetry(e,r){return this.caller.callWithOptions({signal:r==null?void 0:r.signal},async()=>{var n;try{return await this.client.generateContent(e)}catch(i){throw(n=i.message)!=null&&n.includes("400 Bad Request")&&(i.status=400),i}})}withStructuredOutput(e,r){const n=e,i=r==null?void 0:r.name,a=r==null?void 0:r.method,s=r==null?void 0:r.includeRaw;if(a==="jsonMode")throw new Error('ChatGoogleGenerativeAI only supports "functionCalling" as a method.');let o=i??"extract",u,l;if(Nd(n)){const p=M8(n);l=[{functionDeclarations:[{name:o,description:p.description??"A function available to call.",parameters:p}]}],u=new pF({returnSingle:!0,keyName:o,zodSchema:n})}else{let p;typeof n.name=="string"&&typeof n.parameters=="object"&&n.parameters!=null?(p=n,o=n.name):p={name:o,description:n.description??"",parameters:n},l=[{functionDeclarations:[p]}],u=new pF({returnSingle:!0,keyName:o})}const c=this.bind({tools:l});if(!s)return c.pipe(u).withConfig({runName:"ChatGoogleGenerativeAIStructuredOutput"});const h=Dr.assign({parsed:(p,m)=>u.invoke(p.raw,m)}),d=Dr.assign({parsed:()=>null}),f=h.withFallbacks({fallbacks:[d]});return wr.from([{raw:c},f]).withConfig({runName:"StructuredOutputRunnable"})}}const Cw=(t,e)=>t.reduce((r,n,i)=>{const a=Math.floor(i/e),s=r[a]||[];return r[a]=s.concat([n]),r},[]),CFe=Object.freeze(Object.defineProperty({__proto__:null,chunkArray:Cw},Symbol.toStringTag,{value:"Module"}));class IFe extends Error{constructor(e,r){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=r}}class K8 extends Or{get returnValues(){return["output"]}get allowedTools(){}_agentType(){throw new Error("Not implemented")}returnStoppedResponse(e,r,n,i){if(e==="force")return Promise.resolve({returnValues:{output:"Agent stopped due to max iterations."},log:""});throw new Error(`Invalid stopping method: ${e}`)}async prepareForOutput(e,r){return{}}}class Ig extends K8{_agentActionType(){return"single"}}class V8 extends K8{_agentActionType(){return"multi"}}function $Fe(t){return!Array.isArray(t)&&(t==null?void 0:t.tool)!==void 0}function jFe(t){return t.runnable!==void 0}class Xl extends wr{constructor(){super(...arguments),Object.defineProperty(this,"streamRunnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"singleAction",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}static fromRunnables([e,...r],n){const i=wr.from([e,...r],n.name);return i.singleAction=n.singleAction,i.streamRunnable=n.streamRunnable,i}static isAgentRunnableSequence(e){return typeof e.singleAction=="boolean"}}class RFe extends Ig{get inputKeys(){return[]}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","runnable"]}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streamRunnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"defaultRunName",{enumerable:!0,configurable:!0,writable:!0,value:"RunnableAgent"}),this.runnable=e.runnable,this.defaultRunName=e.defaultRunName??this.runnable.name??this.defaultRunName,this.streamRunnable=e.streamRunnable??this.streamRunnable}async plan(e,r,n,i){const a={...r,steps:e},s=xt(i,{callbacks:n,runName:this.defaultRunName});if(this.streamRunnable){const o=await this.runnable.stream(a,s);let u;for await(const l of o)if(u===void 0)u=l;else throw new Error(["Multiple agent actions/finishes received in streamed agent output.",'Set "streamRunnable: false" when initializing the agent to invoke this agent in non-streaming mode.'].join(`
`));if(u===void 0)throw new Error(["No streaming output received from underlying runnable.",'Set "streamRunnable: false" when initializing the agent to invoke this agent in non-streaming mode.'].join(`
`));return u}else return this.runnable.invoke(a,s)}}class uA extends V8{get inputKeys(){return[]}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","runnable"]}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"defaultRunName",{enumerable:!0,configurable:!0,writable:!0,value:"RunnableAgent"}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streamRunnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.runnable=e.runnable,this.stop=e.stop,this.defaultRunName=e.defaultRunName??this.runnable.name??this.defaultRunName,this.streamRunnable=e.streamRunnable??this.streamRunnable}async plan(e,r,n,i){const a={...r,steps:e},s=xt(i,{callbacks:n,runName:this.defaultRunName});let o;if(this.streamRunnable){const u=await this.runnable.stream(a,s);let l;for await(const c of u)if(l===void 0)l=c;else throw new Error(["Multiple agent actions/finishes received in streamed agent output.",'Set "streamRunnable: false" when initializing the agent to invoke this agent in non-streaming mode.'].join(`
`));if(l===void 0)throw new Error(["No streaming output received from underlying runnable.",'Set "streamRunnable: false" when initializing the agent to invoke this agent in non-streaming mode.'].join(`
`));o=l}else o=await this.runnable.invoke(a,s);return $Fe(o)?[o]:o}}class NFe extends uA{}class MFe extends Ig{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents"]}),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.stop=e.stop,this.llmChain=e.llmChain,this.outputParser=e.outputParser}get inputKeys(){return this.llmChain.inputKeys}async plan(e,r,n){const i=await this.llmChain.call({intermediate_steps:e,stop:this.stop,...r},n);return this.outputParser.parse(i[this.llmChain.outputKey],n)}}class Bd extends Ig{get allowedTools(){return this._allowedTools}get inputKeys(){return this.llmChain.inputKeys.filter(e=>e!=="agent_scratchpad")}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_allowedTools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmChain=e.llmChain,this._allowedTools=e.allowedTools,this.outputParser=e.outputParser}static getDefaultOutputParser(e){throw new Error("Not implemented")}static createPrompt(e,r){throw new Error("Not implemented")}static fromLLMAndTools(e,r,n){throw new Error("Not implemented")}static validateTools(e){}_stop(){return[`
${this.observationPrefix()}`]}finishToolName(){return"Final Answer"}async constructScratchPad(e){return e.reduce((r,{action:n,observation:i})=>r+[n.log,`${this.observationPrefix()}${i}`,this.llmPrefix()].join(`
`),"")}async _plan(e,r,n,i){const a=await this.constructScratchPad(e),s={...r,agent_scratchpad:n?`${a}${n}`:a};this._stop().length!==0&&(s.stop=this._stop());const o=await this.llmChain.predict(s,i);if(!this.outputParser)throw new Error("Output parser not set");return this.outputParser.parse(o,i)}plan(e,r,n){return this._plan(e,r,void 0,n)}async returnStoppedResponse(e,r,n,i){if(e==="force")return{returnValues:{output:"Agent stopped due to max iterations."},log:""};if(e==="generate")try{const a=await this._plan(r,n,`

I now need to return a final answer based on the previous steps:`,i);return"returnValues"in a?a:{returnValues:{output:a.log},log:a.log}}catch(a){if(!(a instanceof IFe))throw a;return{returnValues:{output:a.output},log:a.output}}throw new Error(`Invalid stopping method: ${e}`)}static async deserialize(e){switch(e._type){case"zero-shot-react-description":{const{ZeroShotAgent:r}=await Cr(()=>Promise.resolve().then(()=>S3e),void 0);return r.deserialize(e)}default:throw new Error("Unknown agent type")}}}class Au extends i1{get lc_namespace(){return["langchain","tools"]}constructor(e){super(e??{}),Object.defineProperty(this,"returnDirect",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"responseFormat",{enumerable:!0,configurable:!0,writable:!0,value:"content"}),this.responseFormat=(e==null?void 0:e.responseFormat)??this.responseFormat}async invoke(e,r){let n,i;f8(e)?(n=e.id,i=e.args):i=e;const a=Ve(r);return this.call(i,{...a,configurable:{...a.configurable,tool_call_id:n}})}async call(e,r,n){let i;try{i=await this.schema.parseAsync(e)}catch{throw new Um("Received tool input did not match expected schema",JSON.stringify(e))}const a=$d(r),s=await Zt.configure(a.callbacks,this.callbacks,a.tags||n,this.tags,a.metadata,this.metadata,{verbose:this.verbose}),o=await(s==null?void 0:s.handleToolStart(this.toJSON(),typeof i=="string"?i:JSON.stringify(i),a.runId,void 0,void 0,void 0,a.runName));delete a.runId;let u;try{u=await this._call(i,o,a)}catch(f){throw await(o==null?void 0:o.handleToolError(f)),f}let l,c;if(this.responseFormat==="content_and_artifact")if(Array.isArray(u)&&u.length===2)[l,c]=u;else throw new Error(`Tool response format is "content_and_artifact" but the output was not a two-tuple.
Result: ${JSON.stringify(u)}`);else l=u;let h;a&&"configurable"in a&&(h=a.configurable.tool_call_id);const d=LFe({content:l,artifact:c,toolCallId:h,name:this.name});return await(o==null?void 0:o.handleToolEnd(d)),d}}class xs extends Au{constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:tt.object({input:tt.string().optional()}).transform(r=>r.input)})}call(e,r){return super.call(typeof e=="string"||!e?{input:e}:e,r)}}class $g extends xs{static lc_name(){return"DynamicTool"}constructor(e){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.func=e.func,this.returnDirect=e.returnDirect??this.returnDirect}async call(e,r){const n=$d(r);return n.runName===void 0&&(n.runName=this.name),super.call(e,n)}async _call(e,r,n){return this.func(e,r,n)}}class jg extends Au{static lc_name(){return"DynamicStructuredTool"}constructor(e){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.func=e.func,this.returnDirect=e.returnDirect??this.returnDirect,this.schema=Nd(e.schema)?e.schema:tt.object({}).passthrough()}async call(e,r,n){const i=$d(r);return i.runName===void 0&&(i.runName=this.name),super.call(e,i,n)}_call(e,r,n){return this.func(e,r,n)}}class qd{getTools(){return this.tools}}function DFe(t,e){var n;if(!e.schema||Nd(e.schema)&&(!("shape"in e.schema)||!e.schema.shape))return new $g({...e,description:e.description??((n=e.schema)==null?void 0:n.description)??`${e.name} tool`,func:t});const r=e.description??e.schema.description??`${e.name} tool`;return new jg({...e,description:r,schema:e.schema,func:async(i,a,s)=>new Promise((o,u)=>{const l=xt(s,{callbacks:a==null?void 0:a.getChild()});mu.getInstance().run(l,async()=>{try{o(t(i,l))}catch(c){u(c)}})})})}function LFe(t){const{content:e,artifact:r,toolCallId:n}=t;return n?typeof e=="string"||Array.isArray(e)&&e.every(i=>typeof i=="object")?new Pa({content:e,artifact:r,tool_call_id:n,name:t.name}):new Pa({content:FFe(e),artifact:r,tool_call_id:n,name:t.name}):e}function FFe(t){try{return JSON.stringify(t,null,2)}catch{return`${t}`}}const UFe=Object.freeze(Object.defineProperty({__proto__:null,BaseToolkit:qd,DynamicStructuredTool:jg,DynamicTool:$g,StructuredTool:Au,Tool:xs,ToolInputParsingException:Um,tool:DFe},Symbol.toStringTag,{value:"Module"}));var qm={},zFe=/~/,BFe=/~[01]/g;function qFe(t){switch(t){case"~1":return"/";case"~0":return"~"}throw new Error("Invalid tilde escape: "+t)}function H8(t){return zFe.test(t)?t.replace(BFe,qFe):t}function KFe(t,e,r){for(var n,i,a=1,s=e.length;a<s;){if(e[a]==="constructor"||e[a]==="prototype"||e[a]==="__proto__")return t;if(n=H8(e[a++]),i=s>a,typeof t[n]>"u"&&(Array.isArray(t)&&n==="-"&&(n=t.length),i&&(e[a]!==""&&e[a]<1/0||e[a]==="-"?t[n]=[]:t[n]={})),!i)break;t=t[n]}var o=t[n];return r===void 0?delete t[n]:t[n]=r,o}function YC(t){if(typeof t=="string"){if(t=t.split("/"),t[0]==="")return t;throw new Error("Invalid JSON pointer.")}else if(Array.isArray(t)){for(const e of t)if(typeof e!="string"&&typeof e!="number")throw new Error("Invalid JSON pointer. Must be of type string or number.");return t}throw new Error("Invalid JSON pointer.")}function W8(t,e){if(typeof t!="object")throw new Error("Invalid input object.");e=YC(e);var r=e.length;if(r===1)return t;for(var n=1;n<r;){if(t=t[H8(e[n++])],r===n)return t;if(typeof t!="object"||t===null)return}}function G8(t,e,r){if(typeof t!="object")throw new Error("Invalid input object.");if(e=YC(e),e.length===0)throw new Error("Invalid JSON pointer for set.");return KFe(t,e,r)}function VFe(t){var e=YC(t);return{get:function(r){return W8(r,e)},set:function(r,n){return G8(r,e,n)}}}qm.get=W8;qm.set=G8;qm.compile=VFe;class HFe extends Or{constructor(e,r=4e3){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","tools","json"]}),Object.defineProperty(this,"obj",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxValueLength",{enumerable:!0,configurable:!0,writable:!0,value:4e3}),this.obj=e,this.maxValueLength=r}getKeys(e){const n=qm.compile(e).get(this.obj);if(typeof n=="object"&&!Array.isArray(n)&&n!==null)return Object.keys(n).map(i=>i.replaceAll("~","~0").replaceAll("/","~1")).join(", ");throw new Error(`Value at ${e} is not a dictionary, get the value directly instead.`)}getValue(e){const n=qm.compile(e).get(this.obj);if(n==null)throw new Error(`Value at ${e} is null or undefined.`);const i=typeof n=="object"?JSON.stringify(n):n.toString();return typeof n=="object"&&!Array.isArray(n)&&i.length>this.maxValueLength?"Value is a large dictionary, should explore its keys directly.":i.length>this.maxValueLength?`${i.slice(0,this.maxValueLength)}...`:i}}class Y8 extends xs{static lc_name(){return"JsonListKeysTool"}constructor(e){"jsonSpec"in e||(e={jsonSpec:e}),super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"json_list_keys"}),Object.defineProperty(this,"jsonSpec",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:`Can be used to list all keys at a given path.
    Before calling this you should be SURE that the path to this exists.
    The input is a text representation of the path to the json as json pointer syntax (e.g. /key1/0/key2).`}),this.jsonSpec=e.jsonSpec}async _call(e){try{return this.jsonSpec.getKeys(e)}catch(r){return`${r}`}}}class J8 extends xs{static lc_name(){return"JsonGetValueTool"}constructor(e){super(),Object.defineProperty(this,"jsonSpec",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"json_get_value"}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:`Can be used to see value in string format at a given path.
    Before calling this you should be SURE that the path to this exists.
    The input is a text representation of the path to the json as json pointer syntax (e.g. /key1/0/key2).`})}async _call(e){try{return this.jsonSpec.getValue(e)}catch(r){return`${r}`}}}const WFe=`You are an agent designed to interact with JSON.
Your goal is to return a final answer by interacting with the JSON.
You have access to the following tools which help you learn more about the JSON you are interacting with.
Only use the below tools. Only use the information returned by the below tools to construct your final answer.
Do not make up any information that is not contained in the JSON.
Your input to the tools should be in the form of in json pointer syntax (e.g. /key1/0/key2).
You must escape a slash in a key with a ~1, and escape a tilde with a ~0.
For example, to access the key /foo, you would use /~1foo
You should only use keys that you know for a fact exist. You must validate that a key exists by seeing it previously when calling 'json_list_keys'.
If you have not seen a key in one of those responses, you cannot use it.
You should only add one key at a time to the path. You cannot add multiple keys at once.
If you encounter a null or undefined value, go back to the previous key, look at the available keys, and try again.

If the question does not seem to be related to the JSON, just return "I don't know" as the answer.
Always begin your interaction with the 'json_list_keys' with an empty string as the input to see what keys exist in the JSON.

Note that sometimes the value at a given path is large. In this case, you will get an error "Value is a large dictionary, should explore its keys directly".
In this case, you should ALWAYS follow up by using the 'json_list_keys' tool to see what keys exist at that path.
Do not simply refer the user to the JSON or a section of the JSON, as this is not a valid answer. Keep digging until you find the answer and explicitly return it.`,GFe=`Begin!"

Question: {input}
Thought: I should look at the keys that exist to see what I can query. I should use the 'json_list_keys' tool with an empty string as the input.
{agent_scratchpad}`;class Kd extends Je{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:r}=e;if(r.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const r=this.partialVariables??{},n={};for(const[a,s]of Object.entries(r))typeof s=="string"?n[a]=s:n[a]=await s();return{...n,...e}}async invoke(e,r){return this._callWithConfig(n=>this.formatPromptValue(n),e,{...r,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:r}=await Cr(()=>Promise.resolve().then(()=>yF),void 0);return r.deserialize(e)}case void 0:{const{PromptTemplate:r}=await Cr(()=>Promise.resolve().then(()=>yF),void 0);return r.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:r}=await Cr(()=>Promise.resolve().then(()=>m3e),void 0);return r.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class Km extends Kd{async formatPromptValue(e){const r=await this.format(e);return new jd(r)}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var YFe=Object.prototype.toString,Vd=Array.isArray||function(e){return YFe.call(e)==="[object Array]"};function JC(t){return typeof t=="function"}function JFe(t){return Vd(t)?"array":typeof t}function CO(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function mF(t,e){return t!=null&&typeof t=="object"&&e in t}function ZFe(t,e){return t!=null&&typeof t!="object"&&t.hasOwnProperty&&t.hasOwnProperty(e)}var XFe=RegExp.prototype.test;function QFe(t,e){return XFe.call(t,e)}var e3e=/\S/;function t3e(t){return!QFe(e3e,t)}var r3e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function n3e(t){return String(t).replace(/[&<>"'`=\/]/g,function(r){return r3e[r]})}var i3e=/\s*/,a3e=/\s+/,gF=/\s*=/,s3e=/\s*\}/,o3e=/#|\^|\/|>|\{|&|=|!/;function u3e(t,e){if(!t)return[];var r=!1,n=[],i=[],a=[],s=!1,o=!1,u="",l=0;function c(){if(s&&!o)for(;a.length;)delete i[a.pop()];else a=[];s=!1,o=!1}var h,d,f;function p(x){if(typeof x=="string"&&(x=x.split(a3e,2)),!Vd(x)||x.length!==2)throw new Error("Invalid tags: "+x);h=new RegExp(CO(x[0])+"\\s*"),d=new RegExp("\\s*"+CO(x[1])),f=new RegExp("\\s*"+CO("}"+x[1]))}p(e||Jn.tags);for(var m=new Rg(t),g,v,y,b,w,_;!m.eos();){if(g=m.pos,y=m.scanUntil(h),y)for(var O=0,P=y.length;O<P;++O)b=y.charAt(O),t3e(b)?(a.push(i.length),u+=b):(o=!0,r=!0,u+=" "),i.push(["text",b,g,g+1]),g+=1,b===`
`&&(c(),u="",l=0,r=!1);if(!m.scan(h))break;if(s=!0,v=m.scan(o3e)||"name",m.scan(i3e),v==="="?(y=m.scanUntil(gF),m.scan(gF),m.scanUntil(d)):v==="{"?(y=m.scanUntil(f),m.scan(s3e),m.scanUntil(d),v="&"):y=m.scanUntil(d),!m.scan(d))throw new Error("Unclosed tag at "+m.pos);if(v==">"?w=[v,y,g,m.pos,u,l,r]:w=[v,y,g,m.pos],l++,i.push(w),v==="#"||v==="^")n.push(w);else if(v==="/"){if(_=n.pop(),!_)throw new Error('Unopened section "'+y+'" at '+g);if(_[1]!==y)throw new Error('Unclosed section "'+_[1]+'" at '+g)}else v==="name"||v==="{"||v==="&"?o=!0:v==="="&&p(y)}if(c(),_=n.pop(),_)throw new Error('Unclosed section "'+_[1]+'" at '+m.pos);return c3e(l3e(i))}function l3e(t){for(var e=[],r,n,i=0,a=t.length;i<a;++i)r=t[i],r&&(r[0]==="text"&&n&&n[0]==="text"?(n[1]+=r[1],n[3]=r[3]):(e.push(r),n=r));return e}function c3e(t){for(var e=[],r=e,n=[],i,a,s=0,o=t.length;s<o;++s)switch(i=t[s],i[0]){case"#":case"^":r.push(i),n.push(i),r=i[4]=[];break;case"/":a=n.pop(),a[5]=i[2],r=n.length>0?n[n.length-1][4]:e;break;default:r.push(i)}return e}function Rg(t){this.string=t,this.tail=t,this.pos=0}Rg.prototype.eos=function(){return this.tail===""};Rg.prototype.scan=function(e){var r=this.tail.match(e);if(!r||r.index!==0)return"";var n=r[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n};Rg.prototype.scanUntil=function(e){var r=this.tail.search(e),n;switch(r){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=n.length,n};function Xh(t,e){this.view=t,this.cache={".":this.view},this.parent=e}Xh.prototype.push=function(e){return new Xh(e,this)};Xh.prototype.lookup=function(e){var r=this.cache,n;if(r.hasOwnProperty(e))n=r[e];else{for(var i=this,a,s,o,u=!1;i;){if(e.indexOf(".")>0)for(a=i.view,s=e.split("."),o=0;a!=null&&o<s.length;)o===s.length-1&&(u=mF(a,s[o])||ZFe(a,s[o])),a=a[s[o++]];else a=i.view[e],u=mF(i.view,e);if(u){n=a;break}i=i.parent}r[e]=n}return JC(n)&&(n=n.call(this.view)),n};function Rn(){this.templateCache={_cache:{},set:function(e,r){this._cache[e]=r},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}Rn.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};Rn.prototype.parse=function(e,r){var n=this.templateCache,i=e+":"+(r||Jn.tags).join(":"),a=typeof n<"u",s=a?n.get(i):void 0;return s==null&&(s=u3e(e,r),a&&n.set(i,s)),s};Rn.prototype.render=function(e,r,n,i){var a=this.getConfigTags(i),s=this.parse(e,a),o=r instanceof Xh?r:new Xh(r,void 0);return this.renderTokens(s,o,n,e,i)};Rn.prototype.renderTokens=function(e,r,n,i,a){for(var s="",o,u,l,c=0,h=e.length;c<h;++c)l=void 0,o=e[c],u=o[0],u==="#"?l=this.renderSection(o,r,n,i,a):u==="^"?l=this.renderInverted(o,r,n,i,a):u===">"?l=this.renderPartial(o,r,n,a):u==="&"?l=this.unescapedValue(o,r):u==="name"?l=this.escapedValue(o,r,a):u==="text"&&(l=this.rawValue(o)),l!==void 0&&(s+=l);return s};Rn.prototype.renderSection=function(e,r,n,i,a){var s=this,o="",u=r.lookup(e[1]);function l(d){return s.render(d,r,n,a)}if(u){if(Vd(u))for(var c=0,h=u.length;c<h;++c)o+=this.renderTokens(e[4],r.push(u[c]),n,i,a);else if(typeof u=="object"||typeof u=="string"||typeof u=="number")o+=this.renderTokens(e[4],r.push(u),n,i,a);else if(JC(u)){if(typeof i!="string")throw new Error("Cannot use higher-order sections without the original template");u=u.call(r.view,i.slice(e[3],e[5]),l),u!=null&&(o+=u)}else o+=this.renderTokens(e[4],r,n,i,a);return o}};Rn.prototype.renderInverted=function(e,r,n,i,a){var s=r.lookup(e[1]);if(!s||Vd(s)&&s.length===0)return this.renderTokens(e[4],r,n,i,a)};Rn.prototype.indentPartial=function(e,r,n){for(var i=r.replace(/[^ \t]/g,""),a=e.split(`
`),s=0;s<a.length;s++)a[s].length&&(s>0||!n)&&(a[s]=i+a[s]);return a.join(`
`)};Rn.prototype.renderPartial=function(e,r,n,i){if(n){var a=this.getConfigTags(i),s=JC(n)?n(e[1]):n[e[1]];if(s!=null){var o=e[6],u=e[5],l=e[4],c=s;u==0&&l&&(c=this.indentPartial(s,l,o));var h=this.parse(c,a);return this.renderTokens(h,r,n,c,i)}}};Rn.prototype.unescapedValue=function(e,r){var n=r.lookup(e[1]);if(n!=null)return n};Rn.prototype.escapedValue=function(e,r,n){var i=this.getConfigEscape(n)||Jn.escape,a=r.lookup(e[1]);if(a!=null)return typeof a=="number"&&i===Jn.escape?String(a):i(a)};Rn.prototype.rawValue=function(e){return e[1]};Rn.prototype.getConfigTags=function(e){return Vd(e)?e:e&&typeof e=="object"?e.tags:void 0};Rn.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!Vd(e))return e.escape};var Jn={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(t){Vm.templateCache=t},get templateCache(){return Vm.templateCache}},Vm=new Rn;Jn.clearCache=function(){return Vm.clearCache()};Jn.parse=function(e,r){return Vm.parse(e,r)};Jn.render=function(e,r,n,i){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+JFe(e)+'" was given as the first argument for mustache#render(template, view, partials)');return Vm.render(e,r,n,i)};Jn.escape=n3e;Jn.Scanner=Rg;Jn.Context=Xh;Jn.Writer=Rn;function Z8(){Jn.escape=t=>t}const Hm=t=>{const e=t.split(""),r=[],n=(a,s)=>{for(let o=s;o<e.length;o+=1)if(a.includes(e[o]))return o;return-1};let i=0;for(;i<e.length;)if(e[i]==="{"&&i+1<e.length&&e[i+1]==="{")r.push({type:"literal",text:"{"}),i+=2;else if(e[i]==="}"&&i+1<e.length&&e[i+1]==="}")r.push({type:"literal",text:"}"}),i+=2;else if(e[i]==="{"){const a=n("}",i);if(a<0)throw new Error("Unclosed '{' in template.");r.push({type:"variable",name:e.slice(i+1,a).join("")}),i=a+1}else{if(e[i]==="}")throw new Error("Single '}' in template.");{const a=n("{}",i),s=(a<0?e.slice(i):e.slice(i,a)).join("");r.push({type:"literal",text:s}),i=a<0?e.length:a}}return r},h3e=t=>t.map(e=>e[0]==="name"?{type:"variable",name:e[1].includes(".")?e[1].split(".")[0]:e[1]}:["#","&","^",">"].includes(e[0])?{type:"variable",name:e[1]}:{type:"literal",text:e[1]}),Iw=t=>{Z8();const e=Jn.parse(t);return h3e(e)},l1=(t,e)=>Hm(t).reduce((r,n)=>{if(n.type==="variable"){if(n.name in e)return r+e[n.name];throw new Error(`(f-string) Missing value for input ${n.name}`)}return r+n.text},""),X8=(t,e)=>(Z8(),Jn.render(t,e)),$w={"f-string":l1,mustache:X8},Q8={"f-string":Hm,mustache:Iw},_r=(t,e,r)=>$w[e](t,r),eK=(t,e)=>Q8[e](t),Ng=(t,e,r)=>{if(!(e in $w)){const n=Object.keys($w);throw new Error(`Invalid template format. Got \`${e}\`;
                         should be one of ${n}`)}try{const n=r.reduce((i,a)=>(i[a]="foo",i),{});Array.isArray(t)?t.forEach(i=>{if(i.type==="text")_r(i.text,e,n);else if(i.type==="image_url")if(typeof i.image_url=="string")_r(i.image_url,e,n);else{const a=i.image_url.url;_r(a,e,n)}else throw new Error(`Invalid message template received. ${JSON.stringify(i,null,2)}`)}):_r(t,e,n)}catch(n){throw new Error(`Invalid prompt schema: ${n.message}`)}};class ve extends Km{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if(this.templateFormat==="mustache")throw new Error("Mustache templates cannot be validated.");let r=this.inputVariables;this.partialVariables&&(r=r.concat(Object.keys(this.partialVariables))),Ng(this.template,this.templateFormat,r)}}_getPromptType(){return"prompt"}async format(e){const r=await this.mergePartialAndUserVariables(e);return _r(this.template,this.templateFormat,r)}static fromExamples(e,r,n,i=`

`,a=""){const s=[a,...e,r].join(i);return new ve({inputVariables:n,template:s})}static fromTemplate(e,r){const{templateFormat:n="f-string",...i}=r??{},a=new Set;return eK(e,n).forEach(s=>{s.type==="variable"&&a.add(s.name)}),new ve({inputVariables:[...a],templateFormat:n,template:e,...i})}async partial(e){const r=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},i={...this,inputVariables:r,partialVariables:n};return new ve(i)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new ve({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}const yF=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:ve},Symbol.toStringTag,{value:"Module"}));class ml extends Kd{static lc_name(){return"ImagePromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","image"]}),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.template=e.template,this.templateFormat=e.templateFormat??this.templateFormat,this.validateTemplate=e.validateTemplate??this.validateTemplate,this.additionalContentFields=e.additionalContentFields,this.validateTemplate){let r=this.inputVariables;this.partialVariables&&(r=r.concat(Object.keys(this.partialVariables))),Ng([{type:"image_url",image_url:this.template}],this.templateFormat,r)}}_getPromptType(){return"prompt"}async partial(e){const r=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},i={...this,inputVariables:r,partialVariables:n};return new ml(i)}async format(e){const r={};for(const[s,o]of Object.entries(this.template))typeof o=="string"?r[s]=_r(o,this.templateFormat,e):r[s]=o;const n=e.url||r.url,i=e.detail||r.detail;if(!n)throw new Error("Must provide either an image URL.");if(typeof n!="string")throw new Error("url must be a string.");const a={url:n};return i&&(a.detail=i),a}async formatPromptValue(e){const r=await this.format(e);return new w8(r)}}class c1 extends Je{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}async invoke(e,r){return this._callWithConfig(n=>this.formatMessages(n),e,{...r,runType:"prompt"})}}class Nl extends c1{static lc_name(){return"MessagesPlaceholder"}constructor(e){typeof e=="string"&&(e={variableName:e}),super(e),Object.defineProperty(this,"variableName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"optional",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.variableName=e.variableName,this.optional=e.optional??!1}get inputVariables(){return[this.variableName]}async formatMessages(e){const r=e[this.variableName];if(this.optional&&!r)return[];if(!r){const i=new Error(`Field "${this.variableName}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages as an input value. Received: undefined`);throw i.name="InputFormatError",i}let n;try{Array.isArray(r)?n=r.map(zs):n=[zs(r)]}catch(i){const a=typeof r=="string"?r:JSON.stringify(r,null,2),s=new Error([`Field "${this.variableName}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages or coerceable values as input.`,`Received value: ${a}`,`Additional message: ${i.message}`].join(`

`));throw s.name="InputFormatError",s}return n}}class tK extends c1{constructor(e){"prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt}get inputVariables(){return this.prompt.inputVariables}async formatMessages(e){return[await this.format(e)]}}class h1 extends Kd{constructor(e){super(e)}async format(e){return(await this.formatPromptValue(e)).toString()}async formatPromptValue(e){const r=await this.formatMessages(e);return new t1(r)}}class ZC extends tK{static lc_name(){return"ChatMessagePromptTemplate"}constructor(e,r){"prompt"in e||(e={prompt:e,role:r}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}async format(e){return new gn(await this.prompt.format(e),this.role)}static fromTemplate(e,r,n){return new this(ve.fromTemplate(e,{templateFormat:n==null?void 0:n.templateFormat}),r)}}class XC extends c1{static _messageClass(){throw new Error("Can not invoke _messageClass from inside _StringImageMessagePromptTemplate")}constructor(e,r){if("prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"additionalOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"messageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chatMessageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,Array.isArray(this.prompt)){let n=[];this.prompt.forEach(i=>{"inputVariables"in i&&(n=n.concat(i.inputVariables))}),this.inputVariables=n}else this.inputVariables=this.prompt.inputVariables;this.additionalOptions=r??this.additionalOptions}createMessage(e){const r=this.constructor;if(r._messageClass()){const n=r._messageClass();return new n({content:e})}else if(r.chatMessageClass){const n=r.chatMessageClass();return new n({content:e,role:this.getRoleFromMessageClass(n.lc_name())})}else throw new Error("No message class defined")}getRoleFromMessageClass(e){switch(e){case"HumanMessage":return"human";case"AIMessage":return"ai";case"SystemMessage":return"system";case"ChatMessage":return"chat";default:throw new Error("Invalid message class name")}}static fromTemplate(e,r){if(typeof e=="string")return new this(ve.fromTemplate(e,r));const n=[];for(const i of e)if(typeof i=="string"||typeof i=="object"&&"text"in i){let a="";typeof i=="string"?a=i:typeof i.text=="string"&&(a=i.text??"");const s={...r,...typeof i!="string"?{additionalContentFields:i}:{}};n.push(ve.fromTemplate(a,s))}else if(typeof i=="object"&&"image_url"in i){let a=i.image_url??"",s,o=[];if(typeof a=="string"){let u;(r==null?void 0:r.templateFormat)==="mustache"?u=Iw(a):u=Hm(a);const l=u.flatMap(c=>c.type==="variable"?[c.name]:[]);if(((l==null?void 0:l.length)??0)>0){if(l.length>1)throw new Error(`Only one format variable allowed per image template.
Got: ${l}
From: ${a}`);o=[l[0]]}else o=[];a={url:a},s=new ml({template:a,inputVariables:o,templateFormat:r==null?void 0:r.templateFormat,additionalContentFields:i})}else if(typeof a=="object"){if("url"in a){let u;(r==null?void 0:r.templateFormat)==="mustache"?u=Iw(a.url):u=Hm(a.url),o=u.flatMap(l=>l.type==="variable"?[l.name]:[])}else o=[];s=new ml({template:a,inputVariables:o,templateFormat:r==null?void 0:r.templateFormat,additionalContentFields:i})}else throw new Error("Invalid image template");n.push(s)}return new this({prompt:n,additionalOptions:r})}async format(e){if(this.prompt instanceof Km){const r=await this.prompt.format(e);return this.createMessage(r)}else{const r=[];for(const n of this.prompt){let i={};if(!("inputVariables"in n))throw new Error(`Prompt ${n} does not have inputVariables defined.`);for(const a of n.inputVariables)i||(i={[a]:e[a]}),i={...i,[a]:e[a]};if(n instanceof Km){const a=await n.format(i);let s;"additionalContentFields"in n&&(s=n.additionalContentFields),r.push({...s,type:"text",text:a})}else if(n instanceof ml){const a=await n.format(i);let s;"additionalContentFields"in n&&(s=n.additionalContentFields),r.push({...s,type:"image_url",image_url:a})}}return this.createMessage(r)}}async formatMessages(e){return[await this.format(e)]}}class ir extends XC{static _messageClass(){return Wt}static lc_name(){return"HumanMessagePromptTemplate"}}class Ql extends XC{static _messageClass(){return pt}static lc_name(){return"AIMessagePromptTemplate"}}class ei extends XC{static _messageClass(){return Gn}static lc_name(){return"SystemMessagePromptTemplate"}}function d3e(t){return typeof t.formatMessages=="function"}function f3e(t,e){if(d3e(t)||An(t))return t;if(Array.isArray(t)&&t[0]==="placeholder"){const i=t[1];if(typeof i!="string"||i[0]!=="{"||i[i.length-1]!=="}")throw new Error(`Invalid placeholder template: "${t[1]}". Expected a variable name surrounded by curly braces.`);const a=i.slice(1,-1);return new Nl({variableName:a,optional:!0})}const r=zs(t);let n;if(typeof r.content=="string"?n=r.content:n=r.content.map(i=>"text"in i?{...i,text:i.text}:"image_url"in i?{...i,image_url:i.image_url}:i),r._getType()==="human")return ir.fromTemplate(n,e);if(r._getType()==="ai")return Ql.fromTemplate(n,e);if(r._getType()==="system")return ei.fromTemplate(n,e);if(gn.isInstance(r))return ZC.fromTemplate(r.content,r.role,e);throw new Error(`Could not coerce message prompt template from input. Received message type: "${r._getType()}".`)}function p3e(t){return t.constructor.lc_name()==="MessagesPlaceholder"}class Xt extends h1{static lc_name(){return"ChatPromptTemplate"}get lc_aliases(){return{promptMessages:"messages"}}constructor(e){if(super(e),Object.defineProperty(this,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){const r=new Set;for(const o of this.promptMessages)if(!(o instanceof Wn))for(const u of o.inputVariables)r.add(u);const n=this.inputVariables,i=new Set(this.partialVariables?n.concat(Object.keys(this.partialVariables)):n),a=new Set([...i].filter(o=>!r.has(o)));if(a.size>0)throw new Error(`Input variables \`${[...a]}\` are not used in any of the prompt messages.`);const s=new Set([...r].filter(o=>!i.has(o)));if(s.size>0)throw new Error(`Input variables \`${[...s]}\` are used in prompt messages but not in the prompt template.`)}}_getPromptType(){return"chat"}async _parseImagePrompts(e,r){if(typeof e.content=="string")return e;const n=await Promise.all(e.content.map(async i=>{if(i.type!=="image_url")return i;let a="";typeof i.image_url=="string"?a=i.image_url:a=i.image_url.url;const o=await ve.fromTemplate(a,{templateFormat:this.templateFormat}).format(r);return typeof i.image_url!="string"&&"url"in i.image_url?i.image_url.url=o:i.image_url=o,i}));return e.content=n,e}async formatMessages(e){const r=await this.mergePartialAndUserVariables(e);let n=[];for(const i of this.promptMessages)if(i instanceof Wn)n.push(await this._parseImagePrompts(i,r));else{const a=i.inputVariables.reduce((o,u)=>{if(!(u in r)&&!(p3e(i)&&i.optional))throw new Error(`Missing value for input variable \`${u.toString()}\``);return o[u]=r[u],o},{}),s=await i.formatMessages(a);n=n.concat(s)}return n}async partial(e){const r=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},i={...this,inputVariables:r,partialVariables:n};return new Xt(i)}static fromTemplate(e,r){const n=ve.fromTemplate(e,r),i=new ir({prompt:n});return this.fromMessages([i])}static fromMessages(e,r){const n=e.reduce((s,o)=>s.concat(o instanceof Xt?o.promptMessages:[f3e(o,r)]),[]),i=e.reduce((s,o)=>o instanceof Xt?Object.assign(s,o.partialVariables):s,Object.create(null)),a=new Set;for(const s of n)if(!(s instanceof Wn))for(const o of s.inputVariables)o in i||a.add(o);return new this({...r,inputVariables:[...a],promptMessages:n,partialVariables:i,templateFormat:r==null?void 0:r.templateFormat})}static fromPromptMessages(e){return this.fromMessages(e)}}class Ml extends Km{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"examples",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleSelector",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"examplePrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"suffix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"exampleSeparator",{enumerable:!0,configurable:!0,writable:!0,value:`

`}),Object.defineProperty(this,"prefix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),this.examples!==void 0&&this.exampleSelector!==void 0)throw new Error("Only one of 'examples' and 'example_selector' should be provided");if(this.examples===void 0&&this.exampleSelector===void 0)throw new Error("One of 'examples' and 'example_selector' should be provided");if(this.validateTemplate){let r=this.inputVariables;this.partialVariables&&(r=r.concat(Object.keys(this.partialVariables))),Ng(this.prefix+this.suffix,this.templateFormat,r)}}_getPromptType(){return"few_shot"}static lc_name(){return"FewShotPromptTemplate"}async getExamples(e){if(this.examples!==void 0)return this.examples;if(this.exampleSelector!==void 0)return this.exampleSelector.selectExamples(e);throw new Error("One of 'examples' and 'example_selector' should be provided")}async partial(e){const r=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},i={...this,inputVariables:r,partialVariables:n};return new Ml(i)}async format(e){const r=await this.mergePartialAndUserVariables(e),n=await this.getExamples(r),i=await Promise.all(n.map(s=>this.examplePrompt.format(s))),a=[this.prefix,...i,this.suffix].join(this.exampleSeparator);return _r(a,this.templateFormat,r)}serialize(){if(this.exampleSelector||!this.examples)throw new Error("Serializing an example selector is not currently supported");if(this.outputParser!==void 0)throw new Error("Serializing an output parser is not currently supported");return{_type:this._getPromptType(),input_variables:this.inputVariables,example_prompt:this.examplePrompt.serialize(),example_separator:this.exampleSeparator,suffix:this.suffix,prefix:this.prefix,template_format:this.templateFormat,examples:this.examples}}static async deserialize(e){const{example_prompt:r}=e;if(!r)throw new Error("Missing example prompt");const n=await ve.deserialize(r);let i;if(Array.isArray(e.examples))i=e.examples;else throw new Error("Invalid examples format. Only list or string are supported.");return new Ml({inputVariables:e.input_variables,examplePrompt:n,examples:i,exampleSeparator:e.example_separator,prefix:e.prefix,suffix:e.suffix,templateFormat:e.template_format})}}class d1 extends h1{_getPromptType(){return"few_shot_chat"}static lc_name(){return"FewShotChatMessagePromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"examples",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleSelector",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"examplePrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"suffix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"exampleSeparator",{enumerable:!0,configurable:!0,writable:!0,value:`

`}),Object.defineProperty(this,"prefix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.examples=e.examples,this.examplePrompt=e.examplePrompt,this.exampleSeparator=e.exampleSeparator??`

`,this.exampleSelector=e.exampleSelector,this.prefix=e.prefix??"",this.suffix=e.suffix??"",this.templateFormat=e.templateFormat??"f-string",this.validateTemplate=e.validateTemplate??!0,this.examples!==void 0&&this.exampleSelector!==void 0)throw new Error("Only one of 'examples' and 'example_selector' should be provided");if(this.examples===void 0&&this.exampleSelector===void 0)throw new Error("One of 'examples' and 'example_selector' should be provided");if(this.validateTemplate){let r=this.inputVariables;this.partialVariables&&(r=r.concat(Object.keys(this.partialVariables))),Ng(this.prefix+this.suffix,this.templateFormat,r)}}async getExamples(e){if(this.examples!==void 0)return this.examples;if(this.exampleSelector!==void 0)return this.exampleSelector.selectExamples(e);throw new Error("One of 'examples' and 'example_selector' should be provided")}async formatMessages(e){const r=await this.mergePartialAndUserVariables(e);let n=await this.getExamples(r);n=n.map(a=>{const s={};return this.examplePrompt.inputVariables.forEach(o=>{s[o]=a[o]}),s});const i=[];for(const a of n){const s=await this.examplePrompt.formatMessages(a);i.push(...s)}return i}async format(e){const r=await this.mergePartialAndUserVariables(e),n=await this.getExamples(r),a=(await Promise.all(n.map(o=>this.examplePrompt.formatMessages(o)))).flat().map(o=>o.content),s=[this.prefix,...a,this.suffix].join(this.exampleSeparator);return _r(s,this.templateFormat,r)}async partial(e){const r=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},i={...this,inputVariables:r,partialVariables:n};return new d1(i)}}const m3e=Object.freeze(Object.defineProperty({__proto__:null,FewShotChatMessagePromptTemplate:d1,FewShotPromptTemplate:Ml},Symbol.toStringTag,{value:"Module"}));class ch extends Kd{static lc_name(){return"PipelinePromptTemplate"}constructor(e){super({...e,inputVariables:[]}),Object.defineProperty(this,"pipelinePrompts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"finalPrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pipelinePrompts=e.pipelinePrompts,this.finalPrompt=e.finalPrompt,this.inputVariables=this.computeInputValues()}computeInputValues(){const e=this.pipelinePrompts.map(n=>n.name),r=this.pipelinePrompts.map(n=>n.prompt.inputVariables.filter(i=>!e.includes(i))).flat();return[...new Set(r)]}static extractRequiredInputValues(e,r){return r.reduce((n,i)=>(n[i]=e[i],n),{})}async formatPipelinePrompts(e){const r=await this.mergePartialAndUserVariables(e);for(const{name:n,prompt:i}of this.pipelinePrompts){const a=ch.extractRequiredInputValues(r,i.inputVariables);i instanceof Xt?r[n]=await i.formatMessages(a):r[n]=await i.format(a)}return ch.extractRequiredInputValues(r,this.finalPrompt.inputVariables)}async formatPromptValue(e){return this.finalPrompt.formatPromptValue(await this.formatPipelinePrompts(e))}async format(e){return this.finalPrompt.format(await this.formatPipelinePrompts(e))}async partial(e){const r={...this};return r.inputVariables=this.inputVariables.filter(n=>!(n in e)),r.partialVariables={...this.partialVariables??{},...e},new ch(r)}serialize(){throw new Error("Not implemented.")}_getPromptType(){return"pipeline"}}function vF(t){return typeof t=="object"&&t!=null&&"withStructuredOutput"in t&&typeof t.withStructuredOutput=="function"}function g3e(t){return typeof t=="object"&&t!=null&&"lc_id"in t&&Array.isArray(t.lc_id)&&t.lc_id.join("/")==="langchain_core/runnables/RunnableBinding"}class QC extends Xt{get lc_aliases(){return{...super.lc_aliases,schema:"schema_"}}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","structured"]}),this.schema=e.schema}pipe(e){if(vF(e))return super.pipe(e.withStructuredOutput(this.schema));if(g3e(e)&&vF(e.bound))return super.pipe(e.bound.withStructuredOutput(this.schema).bind(e.kwargs??{}).withConfig(e.config));throw new Error('Structured prompts need to be piped to a language model that supports the "withStructuredOutput()" method.')}static fromMessagesAndSchema(e,r){return QC.fromMessages(e,{schema:r})}}const y3e=Object.freeze(Object.defineProperty({__proto__:null,AIMessagePromptTemplate:Ql,BaseChatPromptTemplate:h1,BaseMessagePromptTemplate:c1,BaseMessageStringPromptTemplate:tK,BasePromptTemplate:Kd,BaseStringPromptTemplate:Km,ChatMessagePromptTemplate:ZC,ChatPromptTemplate:Xt,DEFAULT_FORMATTER_MAPPING:$w,DEFAULT_PARSER_MAPPING:Q8,FewShotChatMessagePromptTemplate:d1,FewShotPromptTemplate:Ml,HumanMessagePromptTemplate:ir,ImagePromptTemplate:ml,MessagesPlaceholder:Nl,PipelinePromptTemplate:ch,PromptTemplate:ve,StructuredPrompt:QC,SystemMessagePromptTemplate:ei,checkValidTemplate:Ng,interpolateFString:l1,interpolateMustache:X8,parseFString:Hm,parseMustache:Iw,parseTemplate:eK,renderTemplate:_r},Symbol.toStringTag,{value:"Module"}));class st extends i1{get lc_namespace(){return["langchain","chains",this._chainType()]}constructor(e,r,n){if(arguments.length===1&&typeof e=="object"&&!("saveContext"in e)){const{memory:i,callbackManager:a,...s}=e;super({...s,callbacks:a??s.callbacks}),this.memory=i}else super({verbose:r,callbacks:n}),this.memory=e}_selectMemoryInputs(e){const r={...e};return"signal"in r&&delete r.signal,"timeout"in r&&delete r.timeout,r}async invoke(e,r){const n=Ve(r),i=await this._formatValues(e),a=await Zt.configure(n==null?void 0:n.callbacks,this.callbacks,n==null?void 0:n.tags,this.tags,n==null?void 0:n.metadata,this.metadata,{verbose:this.verbose}),s=await(a==null?void 0:a.handleChainStart(this.toJSON(),i,void 0,void 0,void 0,void 0,n==null?void 0:n.runName));let o;try{o=await(i.signal?Promise.race([this._call(i,s,n),new Promise((u,l)=>{var c;(c=i.signal)==null||c.addEventListener("abort",()=>{l(new Error("AbortError"))})})]):this._call(i,s,n))}catch(u){throw await(s==null?void 0:s.handleChainError(u)),u}return this.memory!=null&&await this.memory.saveContext(this._selectMemoryInputs(e),o),await(s==null?void 0:s.handleChainEnd(o)),Object.defineProperty(o,br,{value:s?{runId:s==null?void 0:s.runId}:void 0,configurable:!0}),o}_validateOutputs(e){const r=this.outputKeys.filter(n=>!(n in e));if(r.length)throw new Error(`Missing output keys: ${r.join(", ")} from chain ${this._chainType()}`)}async prepOutputs(e,r,n=!1){return this._validateOutputs(r),this.memory&&await this.memory.saveContext(e,r),n?r:{...e,...r}}serialize(){throw new Error("Method not implemented.")}async run(e,r){const n=this.inputKeys.filter(u=>{var l;return!((l=this.memory)!=null&&l.memoryKeys.includes(u))});if(!(n.length<=1))throw new Error(`Chain ${this._chainType()} expects multiple inputs, cannot use 'run' `);const a=n.length?{[n[0]]:e}:{},s=await this.call(a,r),o=Object.keys(s);if(o.length===1)return s[o[0]];throw new Error("return values have multiple keys, `run` only supported when one key currently")}async _formatValues(e){const r={...e};if(r.timeout&&!r.signal&&(r.signal=AbortSignal.timeout(r.timeout),delete r.timeout),this.memory!=null){const n=await this.memory.loadMemoryVariables(this._selectMemoryInputs(e));for(const[i,a]of Object.entries(n))r[i]=a}return r}async call(e,r,n){const i={tags:n,...$d(r)};return this.invoke(e,i)}async apply(e,r){return Promise.all(e.map(async(n,i)=>this.call(n,r==null?void 0:r[i])))}static async deserialize(e,r={}){switch(e._type){case"llm_chain":{const{LLMChain:n}=await Cr(()=>Promise.resolve().then(()=>w3e),void 0);return n.deserialize(e)}case"sequential_chain":{const{SequentialChain:n}=await Cr(()=>Promise.resolve().then(()=>OF),void 0);return n.deserialize(e)}case"simple_sequential_chain":{const{SimpleSequentialChain:n}=await Cr(()=>Promise.resolve().then(()=>OF),void 0);return n.deserialize(e)}case"stuff_documents_chain":{const{StuffDocumentsChain:n}=await Cr(()=>Promise.resolve().then(()=>$O),void 0);return n.deserialize(e)}case"map_reduce_documents_chain":{const{MapReduceDocumentsChain:n}=await Cr(()=>Promise.resolve().then(()=>$O),void 0);return n.deserialize(e)}case"refine_documents_chain":{const{RefineDocumentsChain:n}=await Cr(()=>Promise.resolve().then(()=>$O),void 0);return n.deserialize(e)}case"vector_db_qa":{const{VectorDBQAChain:n}=await Cr(()=>Promise.resolve().then(()=>s5e),void 0);return n.deserialize(e,r)}case"api_chain":{const{APIChain:n}=await Cr(()=>Promise.resolve().then(()=>q4e),void 0);return n.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class v3e extends zr{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","default"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"NoOpOutputParser"}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}}function b3e(t){return typeof t._llmType=="function"}function bv(t){if(b3e(t))return t;if("bound"in t&&Je.isRunnable(t.bound))return bv(t.bound);if("runnable"in t&&"fallbacks"in t&&Je.isRunnable(t.runnable))return bv(t.runnable);if("default"in t&&Je.isRunnable(t.default))return bv(t.default);throw new Error("Unable to extract BaseLanguageModel from llmLike object.")}class Pe extends st{static lc_name(){return"LLMChain"}get inputKeys(){return this.prompt.inputVariables}get outputKeys(){return[this.outputKey]}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llmKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"text"}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,this.llm=e.llm,this.llmKwargs=e.llmKwargs,this.outputKey=e.outputKey??this.outputKey,this.outputParser=e.outputParser??new v3e,this.prompt.outputParser){if(e.outputParser)throw new Error("Cannot set both outputParser and prompt.outputParser");this.outputParser=this.prompt.outputParser}}getCallKeys(){return"callKeys"in this.llm?this.llm.callKeys:[]}_selectMemoryInputs(e){const r=super._selectMemoryInputs(e),n=this.getCallKeys();for(const i of n)i in e&&delete r[i];return r}async _getFinalOutput(e,r,n){let i;return this.outputParser?i=await this.outputParser.parseResultWithPrompt(e,r,n==null?void 0:n.getChild()):i=e[0].text,i}call(e,r){return super.call(e,r)}async _call(e,r){const n={...e},i={...this.llmKwargs},a=this.getCallKeys();for(const l of a)l in e&&i&&(i[l]=e[l],delete n[l]);const s=await this.prompt.formatPromptValue(n);if("generatePrompt"in this.llm){const{generations:l}=await this.llm.generatePrompt([s],i,r==null?void 0:r.getChild());return{[this.outputKey]:await this._getFinalOutput(l[0],s,r)}}const u=await(this.outputParser?this.llm.pipe(this.outputParser):this.llm).invoke(s,r==null?void 0:r.getChild());return{[this.outputKey]:u}}async predict(e,r){return(await this.call(e,r))[this.outputKey]}_chainType(){return"llm"}static async deserialize(e){const{llm:r,prompt:n}=e;if(!r)throw new Error("LLMChain must have llm");if(!n)throw new Error("LLMChain must have prompt");return new Pe({llm:await a1.deserialize(r),prompt:await Kd.deserialize(n)})}serialize(){const e="serialize"in this.llm?this.llm.serialize():void 0;return{_type:`${this._chainType()}_chain`,llm:e,prompt:this.prompt.serialize()}}_getNumTokens(e){return bv(this.llm).getNumTokens(e)}}const w3e=Object.freeze(Object.defineProperty({__proto__:null,LLMChain:Pe},Symbol.toStringTag,{value:"Module"})),_3e=async(t,e,r,n,i)=>{if(r.load_from_llm_and_tools){if(!t)throw new Error("Loading from llm and tools, llm must be provided.");if(!e)throw new Error("Loading from llm and tools, tools must be provided.");return n(t,e,r)}if(!r.llm_chain)throw new Error("Loading from constructor, llm_chain must be provided.");const a=await Pe.deserialize(r.llm_chain);return i({...r,llmChain:a})};class Os extends zr{}class rK extends zr{}const x3e="Answer the following questions as best you can. You have access to the following tools:",nK=`Use the following format in your response:

Question: the input question you must answer
Thought: you should always think about what to do
Action: the action to take, should be one of [{tool_names}]
Action Input: the input to the action
Observation: the result of the action
... (this Thought/Action/Action Input/Observation can repeat N times)
Thought: I now know the final answer
Final Answer: the final answer to the original input question`,eI=`Begin!

Question: {input}
Thought:{agent_scratchpad}`,O3e="Final Answer:";class iK extends Os{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","mrkl"]}),Object.defineProperty(this,"finishToolName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.finishToolName=(e==null?void 0:e.finishToolName)||O3e}async parse(e){if(e.includes(this.finishToolName)){const n=e.split(this.finishToolName);return{returnValues:{output:n[n.length-1].trim()},log:e}}const r=/Action:([\s\S]*?)(?:\nAction Input:([\s\S]*?))?$/.exec(e);if(!r)throw new ft(`Could not parse LLM output: ${e}`);return{tool:r[1].trim(),toolInput:r[2]?r[2].trim().replace(/^("+)(.*?)(\1)$/,"$2"):"",log:e}}getFormatInstructions(){return nK}}class or extends Bd{static lc_name(){return"ZeroShotAgent"}constructor(e){const r=(e==null?void 0:e.outputParser)??or.getDefaultOutputParser();super({...e,outputParser:r}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","mrkl"]})}_agentType(){return"zero-shot-react-description"}observationPrefix(){return"Observation: "}llmPrefix(){return"Thought:"}static getDefaultOutputParser(e){return new iK(e)}static validateTools(e){const r=e.find(n=>!n.description);if(r){const n=`Got a tool ${r.name} without a description. This agent requires descriptions for all tools.`;throw new Error(n)}}static createPrompt(e,r){const{prefix:n=x3e,suffix:i=eI,inputVariables:a=["input","agent_scratchpad"]}=r??{},s=e.map(c=>`${c.name}: ${c.description}`).join(`
`),o=e.map(c=>c.name),u=_r(nK,"f-string",{tool_names:o}),l=[n,s,u,i].join(`

`);return new ve({template:l,inputVariables:a})}static fromLLMAndTools(e,r,n){or.validateTools(r);const i=or.createPrompt(r,n),a=(n==null?void 0:n.outputParser)??or.getDefaultOutputParser(),s=new Pe({prompt:i,llm:e,callbacks:(n==null?void 0:n.callbacks)??(n==null?void 0:n.callbackManager)});return new or({llmChain:s,allowedTools:r.map(o=>o.name),outputParser:a})}static async deserialize(e){const{llm:r,tools:n,...i}=e;return _3e(r,n,i,(a,s,o)=>or.fromLLMAndTools(a,s,{prefix:o.prefix,suffix:o.suffix,inputVariables:o.input_variables}),a=>new or(a))}}const S3e=Object.freeze(Object.defineProperty({__proto__:null,ZeroShotAgent:or},Symbol.toStringTag,{value:"Module"}));class P3e extends Or{get finalOutputs(){return this._finalOutputs}async setFinalOutputs(e){if(this._finalOutputs=void 0,e){const r=await this.agentExecutor.prepOutputs(this.inputs,e,!0);this._finalOutputs=r}}get nameToToolMap(){const e=this.agentExecutor.tools.map(r=>({[r.name]:r}));return Object.assign({},...e)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","executor_iterator"]}),Object.defineProperty(this,"agentExecutor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_finalOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"intermediateSteps",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"iterations",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.agentExecutor=e.agentExecutor,this.inputs=e.inputs,this.callbacks=e.callbacks,this.tags=e.tags,this.metadata=e.metadata,this.runName=e.runName,this.runManager=e.runManager,this.config=e.config}reset(){this.intermediateSteps=[],this.iterations=0,this._finalOutputs=void 0}updateIterations(){this.iterations+=1}async*streamIterator(){for(this.reset();;)try{this.iterations===0&&await this.onFirstStep(),yield await this._callNext()}catch(e){if("message"in e&&e.message.startsWith("Final outputs already reached: ")){if(!this.finalOutputs)throw e;return this.finalOutputs}throw this.runManager&&await this.runManager.handleChainError(e),e}}async onFirstStep(){var e,r,n,i,a,s,o;if(this.iterations===0){const u=await Zt.configure(this.callbacks??((e=this.config)==null?void 0:e.callbacks),this.agentExecutor.callbacks,this.tags??((r=this.config)==null?void 0:r.tags),this.agentExecutor.tags,this.metadata??((n=this.config)==null?void 0:n.metadata),this.agentExecutor.metadata,{verbose:this.agentExecutor.verbose});this.runManager=await(u==null?void 0:u.handleChainStart(this.agentExecutor.toJSON(),this.inputs,(i=this.config)==null?void 0:i.runId,void 0,this.tags??((a=this.config)==null?void 0:a.tags),this.metadata??((s=this.config)==null?void 0:s.metadata),this.runName??((o=this.config)==null?void 0:o.runName))),this.config!==void 0&&delete this.config.runId}}async _executeNextStep(e){return this.agentExecutor._takeNextStep(this.nameToToolMap,this.inputs,this.intermediateSteps,e,this.config)}async _processNextStepOutput(e,r){var i;if("returnValues"in e){const a=await this.agentExecutor._return(e,this.intermediateSteps,r);return this.runManager&&await this.runManager.handleChainEnd(a),await this.setFinalOutputs(a),a}this.intermediateSteps=this.intermediateSteps.concat(e);let n={};if(Array.isArray(e)&&e.length===1){const a=e[0],s=await this.agentExecutor._getToolReturn(a);s&&(n=await this.agentExecutor._return(s,this.intermediateSteps,r),await((i=this.runManager)==null?void 0:i.handleChainEnd(n)),await this.setFinalOutputs(n))}return n={intermediateSteps:e},n}async _stop(){var n;const e=await this.agentExecutor.agent.returnStoppedResponse(this.agentExecutor.earlyStoppingMethod,this.intermediateSteps,this.inputs),r=await this.agentExecutor._return(e,this.intermediateSteps,this.runManager);return await this.setFinalOutputs(r),await((n=this.runManager)==null?void 0:n.handleChainEnd(r)),r}async _callNext(){if(this.finalOutputs)throw new Error(`Final outputs already reached: ${JSON.stringify(this.finalOutputs,null,2)}`);if(!this.agentExecutor.shouldContinueGetter(this.iterations))return this._stop();const e=await this._executeNextStep(this.runManager),r=await this._processNextStepOutput(e,this.runManager);return this.updateIterations(),r}}class IO extends xs{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"_Exception"}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:"Exception tool"})}async _call(e){return e}}class mr extends st{static lc_name(){return"AgentExecutor"}get lc_namespace(){return["langchain","agents","executor"]}get inputKeys(){return this.agent.inputKeys}get outputKeys(){return this.agent.returnValues}constructor(e){let r,n=!0;if(Je.isRunnable(e.agent)?(Xl.isAgentRunnableSequence(e.agent)?e.agent.singleAction?r=new RFe({runnable:e.agent,streamRunnable:e.agent.streamRunnable}):r=new uA({runnable:e.agent,streamRunnable:e.agent.streamRunnable}):r=new uA({runnable:e.agent}),n=!1):(jFe(e.agent)&&(n=!1),r=e.agent),super(e),Object.defineProperty(this,"agent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnIntermediateSteps",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxIterations",{enumerable:!0,configurable:!0,writable:!0,value:15}),Object.defineProperty(this,"earlyStoppingMethod",{enumerable:!0,configurable:!0,writable:!0,value:"force"}),Object.defineProperty(this,"returnOnlyOutputs",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"handleParsingErrors",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.agent=r,this.tools=e.tools,this.handleParsingErrors=e.handleParsingErrors??this.handleParsingErrors,this.returnOnlyOutputs=n,this.agent._agentActionType()==="multi"){for(const i of this.tools)if(i.returnDirect)throw new Error(`Tool with return direct ${i.name} not supported for multi-action agent.`)}this.returnIntermediateSteps=e.returnIntermediateSteps??this.returnIntermediateSteps,this.maxIterations=e.maxIterations??this.maxIterations,this.earlyStoppingMethod=e.earlyStoppingMethod??this.earlyStoppingMethod}static fromAgentAndTools(e){return new mr(e)}get shouldContinueGetter(){return this.shouldContinue.bind(this)}shouldContinue(e){return this.maxIterations===void 0||e<this.maxIterations}async _call(e,r,n){var l;const i=Object.fromEntries(this.tools.map(c=>[c.name.toLowerCase(),c])),a=[];let s=0;const o=async c=>{const{returnValues:h}=c,d=await this.agent.prepareForOutput(h,a);await(r==null?void 0:r.handleAgentEnd(c));let f;return this.returnIntermediateSteps?f={...h,intermediateSteps:a,...d}:f={...h,...d},this.returnOnlyOutputs||(f={...e,...f}),f};for(;this.shouldContinue(s);){let c;try{c=await this.agent.plan(a,e,r==null?void 0:r.getChild(),n)}catch(m){if(m instanceof ft){let g,v=m.message;if(this.handleParsingErrors===!0)m.sendToLLM?(g=m.observation,v=m.llmOutput??""):g="Invalid or incomplete response";else if(typeof this.handleParsingErrors=="string")g=this.handleParsingErrors;else if(typeof this.handleParsingErrors=="function")g=this.handleParsingErrors(m);else throw m;c={tool:"_Exception",toolInput:g,log:v}}else throw m}if("returnValues"in c)return o(c);let h;Array.isArray(c)?h=c:h=[c];const d=await Promise.all(h.map(async m=>{var y;await(r==null?void 0:r.handleAgentAction(m));const g=m.tool==="_Exception"?new IO:i[(y=m.tool)==null?void 0:y.toLowerCase()];let v;try{if(v=g?await g.invoke(m.toolInput,xt(n,{callbacks:r==null?void 0:r.getChild()})):`${m.tool} is not a valid tool, try another one.`,typeof v!="string")throw new Error("Received unsupported non-string response from tool call.")}catch(b){if(b instanceof Um){if(this.handleParsingErrors===!0)v="Invalid or incomplete tool input. Please try again.";else if(typeof this.handleParsingErrors=="string")v=this.handleParsingErrors;else if(typeof this.handleParsingErrors=="function")v=this.handleParsingErrors(b);else throw b;return v=await new IO().call(v,r==null?void 0:r.getChild()),{action:m,observation:v??""}}}return{action:m,observation:v??""}}));a.push(...d);const f=a[a.length-1],p=i[(l=f.action.tool)==null?void 0:l.toLowerCase()];if(p!=null&&p.returnDirect)return o({returnValues:{[this.agent.returnValues[0]]:f.observation},log:""});s+=1}const u=await this.agent.returnStoppedResponse(this.earlyStoppingMethod,a,e);return o(u)}async _takeNextStep(e,r,n,i,a){let s;try{s=await this.agent.plan(n,r,i==null?void 0:i.getChild(),a)}catch(l){if(l instanceof ft){let c,h=l.message;if(this.handleParsingErrors===!0)l.sendToLLM?(c=l.observation,h=l.llmOutput??""):c="Invalid or incomplete response";else if(typeof this.handleParsingErrors=="string")c=this.handleParsingErrors;else if(typeof this.handleParsingErrors=="function")c=this.handleParsingErrors(l);else throw l;s={tool:"_Exception",toolInput:c,log:h}}else throw l}if("returnValues"in s)return s;let o;Array.isArray(s)?o=s:o=[s];const u=[];for(const l of o){let c="";if(i&&await(i==null?void 0:i.handleAgentAction(l)),l.tool in e){const h=e[l.tool];try{if(c=await h.call(l.toolInput,i==null?void 0:i.getChild()),typeof c!="string")throw new Error("Received unsupported non-string response from tool call.")}catch(d){if(d instanceof Um){if(this.handleParsingErrors===!0)c="Invalid or incomplete tool input. Please try again.";else if(typeof this.handleParsingErrors=="string")c=this.handleParsingErrors;else if(typeof this.handleParsingErrors=="function")c=this.handleParsingErrors(d);else throw d;c=await new IO().call(c,i==null?void 0:i.getChild())}}}else c=`${l.tool} is not a valid tool, try another available tool: ${Object.keys(e).join(", ")}`;u.push({action:l,observation:c})}return u}async _return(e,r,n){n&&await n.handleAgentEnd(e);const i=e.returnValues;return this.returnIntermediateSteps&&(i.intermediateSteps=r),i}async _getToolReturn(e){const{action:r,observation:n}=e,i=Object.fromEntries(this.tools.map(s=>[s.name.toLowerCase(),s])),[a="output"]=this.agent.returnValues;return r.tool in i&&i[r.tool].returnDirect?{returnValues:{[a]:n},log:""}:null}_returnStoppedResponse(e){if(e==="force")return{returnValues:{output:"Agent stopped due to iteration limit or time limit."},log:""};throw new Error(`Got unsupported early_stopping_method: ${e}`)}async*_streamIterator(e,r){const i=new P3e({inputs:e,agentExecutor:this,config:r,metadata:r==null?void 0:r.metadata,tags:r==null?void 0:r.tags,callbacks:r==null?void 0:r.callbacks}).streamIterator();for await(const a of i)a&&(yield a)}_chainType(){return"agent_executor"}serialize(){throw new Error("Cannot serialize an AgentExecutor")}}class tI extends qd{constructor(e){super(),Object.defineProperty(this,"jsonSpec",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tools=[new Y8(e),new J8(e)]}}function rI(t,e,r){const{prefix:n=WFe,suffix:i=GFe,inputVariables:a=["input","agent_scratchpad"]}=r??{},{tools:s}=e,o=or.createPrompt(s,{prefix:n,suffix:i,inputVariables:a}),u=new Pe({prompt:o,llm:t}),l=new or({llmChain:u,allowedTools:s.map(c=>c.name)});return mr.fromAgentAndTools({agent:l,tools:s,returnIntermediateSteps:!0})}const E3e=`You are an agent designed to answer questions by making web requests to an API given the OpenAPI spec.

If the question does not seem related to the API, return I don't know. Do not make up an answer.
Only use information provided by the tools to construct your response.

To find information in the OpenAPI spec, use the 'json_explorer' tool. The input to this tool is a question about the API.

Take the following steps:
First, find the base URL needed to make the request.

Second, find the relevant paths needed to answer the question. Take note that, sometimes, you might need to make more than one request to more than one path to answer the question.

Third, find the required parameters needed to make the request. For GET requests, these are usually URL parameters and for POST requests, these are request body parameters.

Fourth, make the requests needed to answer the question. Ensure that you are sending the correct parameters to the request by checking which parameters are required. For parameters with a fixed set of values, please use the spec to look at which values are allowed.

Use the exact parameter names as listed in the spec, do not make up any names or abbreviate the names of parameters.
If you get a not found error, ensure that you are using a path that actually exists in the spec.`,A3e=`Begin!"

Question: {input}
Thought: I should explore the spec to find the base url for the API.
{agent_scratchpad}`,T3e=`
Can be used to answer questions about the openapi spec for the API. Always use this tool before trying to make a request. 
Example inputs to this tool: 
    'What are the required query parameters for a GET request to the /bar endpoint?'
    'What are the required parameters in the request body for a POST request to the /foo endpoint?'
Always give this tool a specific question.`;class aK extends xs{static lc_name(){return"RequestsGetTool"}constructor(e={},{maxOutputLength:r}={}){super(...arguments),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"requests_get"}),Object.defineProperty(this,"maxOutputLength",{enumerable:!0,configurable:!0,writable:!0,value:2e3}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:`A portal to the internet. Use this when you need to get specific content from a website.
  Input should be a url string (i.e. "https://www.google.com"). The output will be the text response of the GET request.`}),this.maxOutputLength=r??this.maxOutputLength}async _call(e){return(await(await fetch(e,{headers:this.headers})).text()).slice(0,this.maxOutputLength)}}class sK extends xs{static lc_name(){return"RequestsPostTool"}constructor(e={},{maxOutputLength:r}={}){super(...arguments),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"requests_post"}),Object.defineProperty(this,"maxOutputLength",{enumerable:!0,configurable:!0,writable:!0,value:1/0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:`Use this when you want to POST to a website.
  Input should be a json string with two keys: "url" and "data".
  The value of "url" should be a string, and the value of "data" should be a dictionary of
  key-value pairs you want to POST to the url as a JSON body.
  Be careful to always use double quotes for strings in the json string
  The output will be the text response of the POST request.`}),this.maxOutputLength=r??this.maxOutputLength}async _call(e){try{const{url:r,data:n}=JSON.parse(e);return(await(await fetch(r,{method:"POST",headers:this.headers,body:JSON.stringify(n)})).text()).slice(0,this.maxOutputLength)}catch(r){return`${r}`}}}class nI extends qd{constructor(e){super(),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tools=[new aK(e),new sK(e)]}}class oK extends nI{constructor(e,r,n){super(n);const i=rI(r,new tI(e));this.tools=[...this.tools,new $g({name:"json_explorer",func:async a=>(await i.call({input:a})).output,description:T3e})]}}function uK(t,e,r){const{prefix:n=E3e,suffix:i=A3e,inputVariables:a=["input","agent_scratchpad"]}=r??{},{tools:s}=e,o=or.createPrompt(s,{prefix:n,suffix:i,inputVariables:a}),u=new Pe({prompt:o,llm:t}),l=s.map(h=>h.name),c=new or({llmChain:u,allowedTools:l});return mr.fromAgentAndTools({agent:c,tools:s,returnIntermediateSteps:!0})}class io extends st{static lc_name(){return"StuffDocumentsChain"}get inputKeys(){return[this.inputKey,...this.llmChain.inputKeys].filter(e=>e!==this.documentVariableName)}get outputKeys(){return this.llmChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),this.llmChain=e.llmChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey}_prepInputs(e){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:r,...n}=e,a=r.map(({pageContent:s})=>s).join(`

`);return{...n,[this.documentVariableName]:a}}async _call(e,r){return await this.llmChain.call(this._prepInputs(e),r==null?void 0:r.getChild("combine_documents"))}_chainType(){return"stuff_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw new Error("Missing llm_chain");return new io({llmChain:await Pe.deserialize(e.llm_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize()}}}class Hd extends st{static lc_name(){return"MapReduceDocumentsChain"}get inputKeys(){return[this.inputKey,...this.combineDocumentChain.inputKeys]}get outputKeys(){return this.combineDocumentChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"returnIntermediateSteps",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(this,"maxIterations",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"ensureMapStep",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"combineDocumentChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmChain=e.llmChain,this.combineDocumentChain=e.combineDocumentChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.ensureMapStep=e.ensureMapStep??this.ensureMapStep,this.inputKey=e.inputKey??this.inputKey,this.maxTokens=e.maxTokens??this.maxTokens,this.maxIterations=e.maxIterations??this.maxIterations,this.returnIntermediateSteps=e.returnIntermediateSteps??!1}async _call(e,r){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:n,...i}=e;let a=n,s=[];for(let l=0;l<this.maxIterations;l+=1){const c=a.map(p=>({[this.documentVariableName]:p.pageContent,...i}));if(l!==0||!this.ensureMapStep){const p=await this.combineDocumentChain.llmChain.prompt.format(this.combineDocumentChain._prepInputs({[this.combineDocumentChain.inputKey]:a,...i}));if(await this.combineDocumentChain.llmChain._getNumTokens(p)<this.maxTokens)break}const d=await this.llmChain.apply(c,r?Array.from({length:c.length},(p,m)=>r.getChild(`map_${m+1}`)):void 0),{outputKey:f}=this.llmChain;this.returnIntermediateSteps&&(s=s.concat(d.map(p=>p[f]))),a=d.map(p=>({pageContent:p[f],metadata:{}}))}const o={[this.combineDocumentChain.inputKey]:a,...i},u=await this.combineDocumentChain.call(o,r==null?void 0:r.getChild("combine_documents"));return this.returnIntermediateSteps?{...u,intermediateSteps:s}:u}_chainType(){return"map_reduce_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw new Error("Missing llm_chain");if(!e.combine_document_chain)throw new Error("Missing combine_document_chain");return new Hd({llmChain:await Pe.deserialize(e.llm_chain),combineDocumentChain:await io.deserialize(e.combine_document_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),combine_document_chain:this.combineDocumentChain.serialize()}}}class Wd extends st{static lc_name(){return"RefineDocumentsChain"}get defaultDocumentPrompt(){return new ve({inputVariables:["page_content"],template:"{page_content}"})}get inputKeys(){return[...new Set([this.inputKey,...this.llmChain.inputKeys,...this.refineLLMChain.inputKeys])].filter(e=>e!==this.documentVariableName&&e!==this.initialResponseName)}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output_text"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"initialResponseName",{enumerable:!0,configurable:!0,writable:!0,value:"existing_answer"}),Object.defineProperty(this,"refineLLMChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"documentPrompt",{enumerable:!0,configurable:!0,writable:!0,value:this.defaultDocumentPrompt}),this.llmChain=e.llmChain,this.refineLLMChain=e.refineLLMChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey,this.outputKey=e.outputKey??this.outputKey,this.documentPrompt=e.documentPrompt??this.documentPrompt,this.initialResponseName=e.initialResponseName??this.initialResponseName}async _constructInitialInputs(e,r){const n={page_content:e.pageContent,...e.metadata},i={};return this.documentPrompt.inputVariables.forEach(o=>{i[o]=n[o]}),{...{[this.documentVariableName]:await this.documentPrompt.format({...i})},...r}}async _constructRefineInputs(e,r){const n={page_content:e.pageContent,...e.metadata},i={};this.documentPrompt.inputVariables.forEach(o=>{i[o]=n[o]});const a={[this.documentVariableName]:await this.documentPrompt.format({...i})};return{[this.initialResponseName]:r,...a}}async _call(e,r){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:n,...i}=e,a=n,s=await this._constructInitialInputs(a[0],i);let o=await this.llmChain.predict({...s},r==null?void 0:r.getChild("answer"));for(let u=1;u<a.length;u+=1){const c={...await this._constructRefineInputs(a[u],o),...i};o=await this.refineLLMChain.predict({...c},r==null?void 0:r.getChild("refine"))}return{[this.outputKey]:o}}_chainType(){return"refine_documents_chain"}static async deserialize(e){const r=e.llm_chain;if(!r)throw new Error("Missing llm_chain");const n=e.refine_llm_chain;if(!n)throw new Error("Missing refine_llm_chain");return new Wd({llmChain:await Pe.deserialize(r),refineLLMChain:await Pe.deserialize(n)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),refine_llm_chain:this.refineLLMChain.serialize()}}}const $O=Object.freeze(Object.defineProperty({__proto__:null,MapReduceDocumentsChain:Hd,RefineDocumentsChain:Wd,StuffDocumentsChain:io},Symbol.toStringTag,{value:"Module"}));class iI extends Or{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","example_selectors","base"]})}}class lK{async getPromptAsync(e,r){return this.getPrompt(e).partial((r==null?void 0:r.partialVariables)??{})}}class Gd extends lK{constructor(e,r=[]){super(),Object.defineProperty(this,"defaultPrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"conditionals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.defaultPrompt=e,this.conditionals=r}getPrompt(e){for(const[r,n]of this.conditionals)if(r(e))return n;return this.defaultPrompt}}function k3e(t){return t._modelType()==="base_llm"}function Yd(t){return t._modelType()==="base_chat_model"}function bF(t){return t.split(/\n| /).length}class aI extends iI{constructor(e){super(e),Object.defineProperty(this,"examples",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"examplePrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"getTextLength",{enumerable:!0,configurable:!0,writable:!0,value:bF}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,writable:!0,value:2048}),Object.defineProperty(this,"exampleTextLengths",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.examplePrompt=e.examplePrompt,this.maxLength=e.maxLength??2048,this.getTextLength=e.getTextLength??bF}async addExample(e){this.examples.push(e);const r=await this.examplePrompt.format(e);this.exampleTextLengths.push(this.getTextLength(r))}async calculateExampleTextLengths(e,r){if(e.length>0)return e;const{examples:n,examplePrompt:i}=r;return(await Promise.all(n.map(s=>i.format(s)))).map(s=>this.getTextLength(s))}async selectExamples(e){const r=Object.values(e).join(" ");let n=this.maxLength-this.getTextLength(r),i=0;const a=[];for(;n>0&&i<this.examples.length;){const s=n-this.exampleTextLengths[i];if(s<0)break;a.push(this.examples[i]),n=s,i+=1}return a}static async fromExamples(e,r){const n=new aI(r);return await Promise.all(e.map(i=>n.addExample(i))),n}}class rr{constructor(e){Object.defineProperty(this,"pageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pageContent=e.pageContent!==void 0?e.pageContent.toString():"",this.metadata=e.metadata??{},this.id=e.id}}function jO(t){return Object.keys(t).sort().map(e=>t[e])}class sI extends iI{constructor(e){if(super(e),Object.defineProperty(this,"vectorStoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleKeys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKeys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.exampleKeys=e.exampleKeys,this.inputKeys=e.inputKeys,e.vectorStore!==void 0)this.vectorStoreRetriever=e.vectorStore.asRetriever({k:e.k??4,filter:e.filter});else if(e.vectorStoreRetriever)this.vectorStoreRetriever=e.vectorStoreRetriever;else throw new Error('You must specify one of "vectorStore" and "vectorStoreRetriever".')}async addExample(e){const r=this.inputKeys??Object.keys(e),n=jO(r.reduce((i,a)=>({...i,[a]:e[a]}),{})).join(" ");await this.vectorStoreRetriever.addDocuments([new rr({pageContent:n,metadata:e})])}async selectExamples(e){const r=this.inputKeys??Object.keys(e),n=jO(r.reduce((s,o)=>({...s,[o]:e[o]}),{})).join(" "),a=(await this.vectorStoreRetriever.invoke(n)).map(s=>s.metadata);return this.exampleKeys?a.map(s=>this.exampleKeys.reduce((o,u)=>({...o,[u]:s[u]}),{})):a}static async fromExamples(e,r,n,i={}){const a=i.inputKeys??null,s=e.map(u=>jO(a?a.reduce((l,c)=>({...l,[c]:u[c]}),{}):u).join(" ")),o=await n.fromTexts(s,e,r,i);return new sI({vectorStore:o,k:i.k??4,exampleKeys:i.exampleKeys,inputKeys:i.inputKeys})}}const C3e=Object.freeze(Object.defineProperty({__proto__:null,BaseExampleSelector:iI,BasePromptSelector:lK,ConditionalPromptSelector:Gd,LengthBasedExampleSelector:aI,SemanticSimilarityExampleSelector:sI,isChatModel:Yd,isLLM:k3e},Symbol.toStringTag,{value:"Module"})),I3e=new ve({template:`Use the following pieces of context to answer the question at the end. If you don't know the answer, just say that you don't know, don't try to make up an answer.

{context}

Question: {question}
Helpful Answer:`,inputVariables:["context","question"]}),$3e=`Use the following pieces of context to answer the users question. 
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}`,j3e=[ei.fromTemplate($3e),ir.fromTemplate("{question}")],R3e=Xt.fromMessages(j3e),N3e=new Gd(I3e,[[Yd,R3e]]),M3e=`Use the following portion of a long document to see if any of the text is relevant to answer the question. 
Return any relevant text verbatim.
{context}
Question: {question}
Relevant text, if any:`,D3e=ve.fromTemplate(M3e),L3e=`Use the following portion of a long document to see if any of the text is relevant to answer the question. 
Return any relevant text verbatim.
----------------
{context}`,F3e=[ei.fromTemplate(L3e),ir.fromTemplate("{question}")],U3e=Xt.fromMessages(F3e),z3e=new Gd(D3e,[[Yd,U3e]]),B3e=`Given the following extracted parts of a long document and a question, create a final answer. 
If you don't know the answer, just say that you don't know. Don't try to make up an answer.

QUESTION: Which state/country's law governs the interpretation of the contract?
=========
Content: This Agreement is governed by English law and the parties submit to the exclusive jurisdiction of the English courts in  relation to any dispute (contractual or non-contractual) concerning this Agreement save that either party may apply to any court for an  injunction or other relief to protect its Intellectual Property Rights.

Content: No Waiver. Failure or delay in exercising any right or remedy under this Agreement shall not constitute a waiver of such (or any other)  right or remedy.

11.7 Severability. The invalidity, illegality or unenforceability of any term (or part of a term) of this Agreement shall not affect the continuation  in force of the remainder of the term (if any) and this Agreement.

11.8 No Agency. Except as expressly stated otherwise, nothing in this Agreement shall create an agency, partnership or joint venture of any  kind between the parties.

11.9 No Third-Party Beneficiaries.

Content: (b) if Google believes, in good faith, that the Distributor has violated or caused Google to violate any Anti-Bribery Laws (as  defined in Clause 8.5) or that such a violation is reasonably likely to occur,
=========
FINAL ANSWER: This Agreement is governed by English law.

QUESTION: What did the president say about Michael Jackson?
=========
Content: Madam Speaker, Madam Vice President, our First Lady and Second Gentleman. Members of Congress and the Cabinet. Justices of the Supreme Court. My fellow Americans.  

Last year COVID-19 kept us apart. This year we are finally together again. 

Tonight, we meet as Democrats Republicans and Independents. But most importantly as Americans. 

With a duty to one another to the American people to the Constitution. 

And with an unwavering resolve that freedom will always triumph over tyranny. 

Six days ago, Russia’s Vladimir Putin sought to shake the foundations of the free world thinking he could make it bend to his menacing ways. But he badly miscalculated. 

He thought he could roll into Ukraine and the world would roll over. Instead he met a wall of strength he never imagined. 

He met the Ukrainian people. 

From President Zelenskyy to every Ukrainian, their fearlessness, their courage, their determination, inspires the world. 

Groups of citizens blocking tanks with their bodies. Everyone from students to retirees teachers turned soldiers defending their homeland.

Content: And we won’t stop. 

We have lost so much to COVID-19. Time with one another. And worst of all, so much loss of life. 

Let’s use this moment to reset. Let’s stop looking at COVID-19 as a partisan dividing line and see it for what it is: A God-awful disease.  

Let’s stop seeing each other as enemies, and start seeing each other for who we really are: Fellow Americans.  

We can’t change how divided we’ve been. But we can change how we move forward—on COVID-19 and other issues we must face together. 

I recently visited the New York City Police Department days after the funerals of Officer Wilbert Mora and his partner, Officer Jason Rivera. 

They were responding to a 9-1-1 call when a man shot and killed them with a stolen gun. 

Officer Mora was 27 years old. 

Officer Rivera was 22. 

Both Dominican Americans who’d grown up on the same streets they later chose to patrol as police officers. 

I spoke with their families and told them that we are forever in debt for their sacrifice, and we will carry on their mission to restore the trust and safety every community deserves.

Content: And a proud Ukrainian people, who have known 30 years  of independence, have repeatedly shown that they will not tolerate anyone who tries to take their country backwards.  

To all Americans, I will be honest with you, as I’ve always promised. A Russian dictator, invading a foreign country, has costs around the world. 

And I’m taking robust action to make sure the pain of our sanctions  is targeted at Russia’s economy. And I will use every tool at our disposal to protect American businesses and consumers. 

Tonight, I can announce that the United States has worked with 30 other countries to release 60 Million barrels of oil from reserves around the world.  

America will lead that effort, releasing 30 Million barrels from our own Strategic Petroleum Reserve. And we stand ready to do more if necessary, unified with our allies.  

These steps will help blunt gas prices here at home. And I know the news about what’s happening can seem alarming. 

But I want you to know that we are going to be okay.

Content: More support for patients and families. 

To get there, I call on Congress to fund ARPA-H, the Advanced Research Projects Agency for Health. 

It’s based on DARPA—the Defense Department project that led to the Internet, GPS, and so much more.  

ARPA-H will have a singular purpose—to drive breakthroughs in cancer, Alzheimer’s, diabetes, and more. 

A unity agenda for the nation. 

We can do this. 

My fellow Americans—tonight , we have gathered in a sacred space—the citadel of our democracy. 

In this Capitol, generation after generation, Americans have debated great questions amid great strife, and have done great things. 

We have fought for freedom, expanded liberty, defeated totalitarianism and terror. 

And built the strongest, freest, and most prosperous nation the world has ever known. 

Now is the hour. 

Our moment of responsibility. 

Our test of resolve and conscience, of history itself. 

It is in this moment that our character is formed. Our purpose is found. Our future is forged. 

Well I know this nation.
=========
FINAL ANSWER: The president did not mention Michael Jackson.

QUESTION: {question}
=========
{summaries}
=========
FINAL ANSWER:`,q3e=ve.fromTemplate(B3e),K3e=`Given the following extracted parts of a long document and a question, create a final answer. 
If you don't know the answer, just say that you don't know. Don't try to make up an answer.
----------------
{summaries}`,V3e=[ei.fromTemplate(K3e),ir.fromTemplate("{question}")],H3e=Xt.fromMessages(V3e),W3e=new Gd(q3e,[[Yd,H3e]]),G3e=`The original question is as follows: {question}
We have provided an existing answer: {existing_answer}
We have the opportunity to refine the existing answer
(only if needed) with some more context below.
------------
{context}
------------
Given the new context, refine the original answer to better answer the question. 
If the context isn't useful, return the original answer.`,Y3e=new ve({inputVariables:["question","existing_answer","context"],template:G3e}),J3e=`The original question is as follows: {question}
We have provided an existing answer: {existing_answer}
We have the opportunity to refine the existing answer
(only if needed) with some more context below.
------------
{context}
------------
Given the new context, refine the original answer to better answer the question. 
If the context isn't useful, return the original answer.`,Z3e=[ir.fromTemplate("{question}"),Ql.fromTemplate("{existing_answer}"),ir.fromTemplate(J3e)],X3e=Xt.fromMessages(Z3e),Q3e=new Gd(Y3e,[[Yd,X3e]]),e5e=`Context information is below. 
---------------------
{context}
---------------------
Given the context information and no prior knowledge, answer the question: {question}`,t5e=new ve({inputVariables:["context","question"],template:e5e}),r5e=`Context information is below. 
---------------------
{context}
---------------------
Given the context information and no prior knowledge, answer any questions`,n5e=[ei.fromTemplate(r5e),ir.fromTemplate("{question}")],i5e=Xt.fromMessages(n5e),a5e=new Gd(t5e,[[Yd,i5e]]),cK=(t,e={type:"stuff"})=>{const{type:r}=e;if(r==="stuff")return Mg(t,e);if(r==="map_reduce")return hK(t,e);if(r==="refine")return dK(t,e);throw new Error(`Invalid _type: ${r}`)};function Mg(t,e={}){const{prompt:r=N3e.getPrompt(t),verbose:n}=e,i=new Pe({prompt:r,llm:t,verbose:n});return new io({llmChain:i,verbose:n})}function hK(t,e={}){const{combineMapPrompt:r=z3e.getPrompt(t),combinePrompt:n=W3e.getPrompt(t),verbose:i,combineLLM:a,returnIntermediateSteps:s}=e,o=new Pe({prompt:r,llm:t,verbose:i}),u=new Pe({prompt:n,llm:a??t,verbose:i}),l=new io({llmChain:u,documentVariableName:"summaries",verbose:i});return new Hd({llmChain:o,combineDocumentChain:l,returnIntermediateSteps:s,verbose:i})}function dK(t,e={}){const{questionPrompt:r=a5e.getPrompt(t),refinePrompt:n=Q3e.getPrompt(t),refineLLM:i,verbose:a}=e,s=new Pe({prompt:r,llm:t,verbose:a}),o=new Pe({prompt:n,llm:i??t,verbose:a});return new Wd({llmChain:s,refineLLMChain:o,verbose:a})}class Dg extends st{static lc_name(){return"VectorDBQAChain"}get inputKeys(){return[this.inputKey]}get outputKeys(){return this.combineDocumentsChain.outputKeys.concat(this.returnSourceDocuments?["sourceDocuments"]:[])}constructor(e){super(e),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"query"}),Object.defineProperty(this,"vectorstore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"combineDocumentsChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSourceDocuments",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.vectorstore=e.vectorstore,this.combineDocumentsChain=e.combineDocumentsChain,this.inputKey=e.inputKey??this.inputKey,this.k=e.k??this.k,this.returnSourceDocuments=e.returnSourceDocuments??this.returnSourceDocuments}async _call(e,r){if(!(this.inputKey in e))throw new Error(`Question key ${this.inputKey} not found.`);const n=e[this.inputKey],i=await this.vectorstore.similaritySearch(n,this.k,e.filter,r==null?void 0:r.getChild("vectorstore")),a={question:n,input_documents:i},s=await this.combineDocumentsChain.call(a,r==null?void 0:r.getChild("combine_documents"));return this.returnSourceDocuments?{...s,sourceDocuments:i}:s}_chainType(){return"vector_db_qa"}static async deserialize(e,r){if(!("vectorstore"in r))throw new Error("Need to pass in a vectorstore to deserialize VectorDBQAChain");const{vectorstore:n}=r;if(!e.combine_documents_chain)throw new Error("VectorDBQAChain must have combine_documents_chain in serialized data");return new Dg({combineDocumentsChain:await st.deserialize(e.combine_documents_chain),k:e.k,vectorstore:n})}serialize(){return{_type:this._chainType(),combine_documents_chain:this.combineDocumentsChain.serialize(),k:this.k}}static fromLLM(e,r,n){const i=Mg(e);return new this({vectorstore:r,combineDocumentsChain:i,...n})}}const s5e=Object.freeze(Object.defineProperty({__proto__:null,VectorDBQAChain:Dg},Symbol.toStringTag,{value:"Module"}));class Wm extends xs{static lc_name(){return"VectorStoreQATool"}constructor(e,r,n){super(...arguments),Object.defineProperty(this,"vectorStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e,this.description=r,this.vectorStore=n.vectorStore,this.llm=n.llm,this.chain=Dg.fromLLM(this.llm,this.vectorStore)}static getDescription(e,r){return`Useful for when you need to answer questions about ${e}. Whenever you need information about ${r} you should ALWAYS use this. Input should be a fully formed question.`}async _call(e){return this.chain.run(e)}}const o5e=`You are an agent designed to answer questions about sets of documents.
You have access to tools for interacting with the documents, and the inputs to the tools are questions.
Sometimes, you will be asked to provide sources for your questions, in which case you should use the appropriate tool to do so.
If the question does not seem relevant to any of the tools provided, just return "I don't know" as the answer.`,u5e=`You are an agent designed to answer questions.
You have access to tools for interacting with different sources, and the inputs to the tools are questions.
Your main task is to decide which of the tools is relevant for answering question at hand.
For complex questions, you can break the question down into sub questions and use tools to answers the sub questions.`;class fK extends qd{constructor(e,r){super(),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const n=Wm.getDescription(e.name,e.description);this.llm=r,this.tools=[new Wm(e.name,n,{vectorStore:e.vectorStore,llm:this.llm})]}}class pK extends qd{constructor(e,r){super(),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vectorStoreInfos",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llm=r,this.vectorStoreInfos=e,this.tools=e.map(n=>{const i=Wm.getDescription(n.name,n.description);return new Wm(n.name,i,{vectorStore:n.vectorStore,llm:this.llm})})}}function mK(t,e,r){const{prefix:n=o5e,suffix:i=eI,inputVariables:a=["input","agent_scratchpad"]}=r??{},{tools:s}=e,o=or.createPrompt(s,{prefix:n,suffix:i,inputVariables:a}),u=new Pe({prompt:o,llm:t}),l=new or({llmChain:u,allowedTools:s.map(c=>c.name)});return mr.fromAgentAndTools({agent:l,tools:s,returnIntermediateSteps:!0})}function gK(t,e,r){const{prefix:n=u5e,suffix:i=eI,inputVariables:a=["input","agent_scratchpad"]}=r??{},{tools:s}=e,o=or.createPrompt(s,{prefix:n,suffix:i,inputVariables:a}),u=new Pe({prompt:o,llm:t}),l=new or({llmChain:u,allowedTools:s.map(c=>c.name)});return mr.fromAgentAndTools({agent:l,tools:s,returnIntermediateSteps:!0})}const f1=t=>t.map(e=>e.pageContent).join(`

`),l5e=Object.freeze(Object.defineProperty({__proto__:null,formatDocumentsAsString:f1},Symbol.toStringTag,{value:"Module"}));function c5e(t,e){const r=async({input:i},a)=>{const s=await t.getRelevantDocuments(i,a==null?void 0:a.getChild("retriever"));return f1(s)},n=tt.object({input:tt.string().describe("Natural language query used as input to the retriever")});return new jg({...e,func:r,schema:n})}const h5e=`Progressively summarize the lines of conversation provided, adding onto the previous summary returning a new summary.

EXAMPLE
Current summary:
The human asks what the AI thinks of artificial intelligence. The AI thinks artificial intelligence is a force for good.

New lines of conversation:
Human: Why do you think artificial intelligence is a force for good?
AI: Because artificial intelligence will help humans reach their full potential.

New summary:
The human asks what the AI thinks of artificial intelligence. The AI thinks artificial intelligence is a force for good because it will help humans reach their full potential.
END OF EXAMPLE

Current summary:
{summary}

New lines of conversation:
{new_lines}

New summary:`,d5e=new ve({inputVariables:["summary","new_lines"],template:h5e}),f5e=`You are an assistant to a human, powered by a large language model trained by OpenAI.

You are designed to be able to assist with a wide range of tasks, from answering simple questions to providing in-depth explanations and discussions on a wide range of topics. As a language model, you are able to generate human-like text based on the input you receive, allowing you to engage in natural-sounding conversations and provide responses that are coherent and relevant to the topic at hand.

You are constantly learning and improving, and your capabilities are constantly evolving. You are able to process and understand large amounts of text, and can use this knowledge to provide accurate and informative responses to a wide range of questions. You have access to some personalized information provided by the human in the Context section below. Additionally, you are able to generate your own text based on the input you receive, allowing you to engage in discussions and provide explanations and descriptions on a wide range of topics.

Overall, you are a powerful tool that can help with a wide range of tasks and provide valuable insights and information on a wide range of topics. Whether the human needs help with a specific question or just wants to have a conversation about a particular topic, you are here to assist.

Context:
{entities}

Current conversation:
{history}
Last line:
Human: {input}
You:`,p5e=new ve({inputVariables:["entities","history","input"],template:f5e}),m5e=`You are an AI assistant reading the transcript of a conversation between an AI and a human. Extract all of the proper nouns from the last line of conversation. As a guideline, a proper noun is generally capitalized. You should definitely extract all names and places.

The conversation history is provided just in case of a coreference (e.g. "What do you know about him" where "him" is defined in a previous line) -- ignore items mentioned there that are not in the last line.

Return the output as a single comma-separated list, or NONE if there is nothing of note to return (e.g. the user is just issuing a greeting or having a simple conversation).

EXAMPLE
Conversation history:
Person #1: my name is Jacob. how's it going today?
AI: "It's going great! How about you?"
Person #1: good! busy working on Langchain. lots to do.
AI: "That sounds like a lot of work! What kind of things are you doing to make Langchain better?"
Last line:
Person #1: i'm trying to improve Langchain's interfaces, the UX, its integrations with various products the user might want ... a lot of stuff.
Output: Jacob,Langchain
END OF EXAMPLE

EXAMPLE
Conversation history:
Person #1: how's it going today?
AI: "It's going great! How about you?"
Person #1: good! busy working on Langchain. lots to do.
AI: "That sounds like a lot of work! What kind of things are you doing to make Langchain better?"
Last line:
Person #1: i'm trying to improve Langchain's interfaces, the UX, its integrations with various products the user might want ... a lot of stuff. I'm working with Person #2.
Output: Langchain, Person #2
END OF EXAMPLE

Conversation history (for reference only):
{history}
Last line of conversation (for extraction):
Human: {input}

Output:`,g5e=new ve({inputVariables:["history","input"],template:m5e}),y5e=`You are an AI assistant helping a human keep track of facts about relevant people, places, and concepts in their life. Update and add to the summary of the provided entity in the "Entity" section based on the last line of your conversation with the human. If you are writing the summary for the first time, return a single sentence.
The update should only include facts that are relayed in the last line of conversation about the provided entity, and should only contain facts about the provided entity.

If there is no new information about the provided entity or the information is not worth noting (not an important or relevant fact to remember long-term), output the exact string "UNCHANGED" below.

Full conversation history (for context):
{history}

Entity to summarize:
{entity}

Existing summary of {entity}:
{summary}

Last line of conversation:
Human: {input}
Updated summary (or the exact string "UNCHANGED" if there is no new information about {entity} above):`,v5e=new ve({inputVariables:["entity","summary","history","input"],template:y5e});class Lg{}const yK=(t,e)=>{if(e!==void 0)return t[e];const r=Object.keys(t);if(r.length===1)return t[r[0]]},Fg=(t,e)=>{const r=yK(t,e);if(!r){const n=Object.keys(t);throw new Error(`input values have ${n.length} keys, you must specify an input key or pass only 1 key as input`)}return r},p1=(t,e)=>{const r=yK(t,e);if(!r){const n=Object.keys(t);throw new Error(`output values have ${n.length} keys, you must specify an output key or pass only 1 key as output`)}return r};function lA(t,e){const r=Object.keys(t).filter(n=>!e.includes(n)&&n!=="stop");if(r.length!==1)throw new Error(`One input key expected, but got ${r.length}`);return r[0]}const b5e=Object.freeze(Object.defineProperty({__proto__:null,BaseMemory:Lg,getInputValue:Fg,getOutputValue:p1,getPromptInputKey:lA},Symbol.toStringTag,{value:"Module"}));class vK extends Or{async addMessages(e){for(const r of e)await this.addMessage(r)}}class oI extends Or{addUserMessage(e){return this.addMessage(new Wt(e))}addAIChatMessage(e){return this.addMessage(new pt(e))}addAIMessage(e){return this.addMessage(new pt(e))}async addMessages(e){for(const r of e)await this.addMessage(r)}clear(){throw new Error("Not implemented.")}}class m1 extends oI{constructor(e){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","stores","message","in_memory"]}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.messages=e??[]}async getMessages(){return this.messages}async addMessage(e){this.messages.push(e)}async clear(){this.messages=[]}}const w5e=Object.freeze(Object.defineProperty({__proto__:null,BaseChatMessageHistory:vK,BaseListChatMessageHistory:oI,InMemoryChatMessageHistory:m1},Symbol.toStringTag,{value:"Module"})),_5e=Object.freeze(Object.defineProperty({__proto__:null,ChatMessageHistory:m1},Symbol.toStringTag,{value:"Module"}));class bo extends Lg{constructor(e){super(),Object.defineProperty(this,"chatHistory",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnMessages",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chatHistory=(e==null?void 0:e.chatHistory)??new m1,this.returnMessages=(e==null?void 0:e.returnMessages)??this.returnMessages,this.inputKey=(e==null?void 0:e.inputKey)??this.inputKey,this.outputKey=(e==null?void 0:e.outputKey)??this.outputKey}async saveContext(e,r){await this.chatHistory.addUserMessage(Fg(e,this.inputKey)),await this.chatHistory.addAIChatMessage(p1(r,this.outputKey))}async clear(){await this.chatHistory.clear()}}const x5e=Object.freeze(Object.defineProperty({__proto__:null,BaseChatMemory:bo},Symbol.toStringTag,{value:"Module"}));class uI extends bo{constructor(e){const{returnMessages:r,inputKey:n,outputKey:i,chatHistory:a,humanPrefix:s,aiPrefix:o,llm:u,prompt:l,summaryChatMessageClass:c}=e;super({returnMessages:r,inputKey:n,outputKey:i,chatHistory:a}),Object.defineProperty(this,"memoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"history"}),Object.defineProperty(this,"humanPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"Human"}),Object.defineProperty(this,"aiPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"AI"}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:d5e}),Object.defineProperty(this,"summaryChatMessageClass",{enumerable:!0,configurable:!0,writable:!0,value:Gn}),this.memoryKey=(e==null?void 0:e.memoryKey)??this.memoryKey,this.humanPrefix=s??this.humanPrefix,this.aiPrefix=o??this.aiPrefix,this.llm=u,this.prompt=l??this.prompt,this.summaryChatMessageClass=c??this.summaryChatMessageClass}async predictNewSummary(e,r){const n=Nr(e,this.humanPrefix,this.aiPrefix);return await new Pe({llm:this.llm,prompt:this.prompt}).predict({summary:r,new_lines:n})}}class O5e extends uI{constructor(e){super(e),Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:""})}get memoryKeys(){return[this.memoryKey]}async loadMemoryVariables(e){return this.returnMessages?{[this.memoryKey]:[new this.summaryChatMessageClass(this.buffer)]}:{[this.memoryKey]:this.buffer}}async saveContext(e,r){await super.saveContext(e,r);const n=await this.chatHistory.getMessages();this.buffer=await this.predictNewSummary(n.slice(-2),this.buffer)}async clear(){await super.clear(),this.buffer=""}}class bK extends uI{constructor(e){super(e),Object.defineProperty(this,"movingSummaryBuffer",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"maxTokenLimit",{enumerable:!0,configurable:!0,writable:!0,value:2e3}),this.maxTokenLimit=(e==null?void 0:e.maxTokenLimit)??this.maxTokenLimit}get memoryKeys(){return[this.memoryKey]}async loadMemoryVariables(e){let r=await this.chatHistory.getMessages();this.movingSummaryBuffer&&(r=[new this.summaryChatMessageClass(this.movingSummaryBuffer),...r]);let n;return this.returnMessages?n=r:n=Nr(r,this.humanPrefix,this.aiPrefix),{[this.memoryKey]:n}}async saveContext(e,r){await super.saveContext(e,r),await this.prune()}async prune(){let e=await this.chatHistory.getMessages();this.movingSummaryBuffer&&(e=[new this.summaryChatMessageClass(this.movingSummaryBuffer),...e]);let r=await this.llm.getNumTokens(Nr(e,this.humanPrefix,this.aiPrefix));if(r>this.maxTokenLimit){const n=[];for(;r>this.maxTokenLimit;){const i=e.shift();i&&(n.push(i),r=await this.llm.getNumTokens(Nr(e,this.humanPrefix,this.aiPrefix)))}this.movingSummaryBuffer=await this.predictNewSummary(n,this.movingSummaryBuffer)}}async clear(){await super.clear(),this.movingSummaryBuffer=""}}class jw extends bo{constructor(e){super({chatHistory:e==null?void 0:e.chatHistory,returnMessages:(e==null?void 0:e.returnMessages)??!1,inputKey:e==null?void 0:e.inputKey,outputKey:e==null?void 0:e.outputKey}),Object.defineProperty(this,"humanPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"Human"}),Object.defineProperty(this,"aiPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"AI"}),Object.defineProperty(this,"memoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"history"}),this.humanPrefix=(e==null?void 0:e.humanPrefix)??this.humanPrefix,this.aiPrefix=(e==null?void 0:e.aiPrefix)??this.aiPrefix,this.memoryKey=(e==null?void 0:e.memoryKey)??this.memoryKey}get memoryKeys(){return[this.memoryKey]}async loadMemoryVariables(e){const r=await this.chatHistory.getMessages();return this.returnMessages?{[this.memoryKey]:r}:{[this.memoryKey]:Nr(r,this.humanPrefix,this.aiPrefix)}}}const S5e="Answer the following questions as best you can. You have access to the following tools:",wK=`The way you use the tools is by specifying a json blob, denoted below by $JSON_BLOB
Specifically, this $JSON_BLOB should have a "action" key (with the name of the tool to use) and a "action_input" key (with the input to the tool going here). 
The $JSON_BLOB should only contain a SINGLE action, do NOT return a list of multiple actions. Here is an example of a valid $JSON_BLOB:

\`\`\`
{{
  "action": "calculator",
  "action_input": "1 + 2"
}}
\`\`\`

ALWAYS use the following format:

Question: the input question you must answer
Thought: you should always think about what to do
Action: 
\`\`\`
$JSON_BLOB
\`\`\`
Observation: the result of the action
... (this Thought/Action/Observation can repeat N times)
Thought: I now know the final answer
Final Answer: the final answer to the original input question`,P5e="Begin! Reminder to always use the exact characters `Final Answer` when responding.",wF="Final Answer:";class _K extends Os{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","chat"]})}async parse(e){if(e.includes(wF)||!e.includes('"action":')){const n=e.split(wF);return{returnValues:{output:n[n.length-1].trim()},log:e}}const r=e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim();try{const n=JSON.parse(r.trim());return{tool:n.action,toolInput:n.action_input,log:e}}catch{throw new ft(`Unable to parse JSON response from chat agent.

${e}`)}}getFormatInstructions(){return wK}}const E5e=`{input}

{agent_scratchpad}`;class Ha extends Bd{static lc_name(){return"ChatAgent"}constructor(e){const r=(e==null?void 0:e.outputParser)??Ha.getDefaultOutputParser();super({...e,outputParser:r}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","chat"]})}_agentType(){return"chat-zero-shot-react-description"}observationPrefix(){return"Observation: "}llmPrefix(){return"Thought:"}_stop(){return["Observation:"]}static validateTools(e){const r=e.find(n=>!n.description);if(r){const n=`Got a tool ${r.name} without a description. This agent requires descriptions for all tools.`;throw new Error(n)}}static getDefaultOutputParser(e){return new _K}async constructScratchPad(e){const r=await super.constructScratchPad(e);return r&&`This was your previous work (but I haven't seen any of it! I only see what you return as final answer):
${r}`}static createPrompt(e,r){const{prefix:n=S5e,suffix:i=P5e,humanMessageTemplate:a=E5e,formatInstructions:s=wK}=r??{},o=e.map(c=>`${c.name}: ${c.description}`).join(`
`),u=[n,o,s,i].join(`

`),l=[ei.fromTemplate(u),ir.fromTemplate(a)];return Xt.fromMessages(l)}static fromLLMAndTools(e,r,n){Ha.validateTools(r);const i=Ha.createPrompt(r,n),a=new Pe({prompt:i,llm:e,callbacks:(n==null?void 0:n.callbacks)??(n==null?void 0:n.callbackManager)}),s=(n==null?void 0:n.outputParser)??Ha.getDefaultOutputParser();return new Ha({llmChain:a,outputParser:s,allowedTools:r.map(o=>o.name)})}}const A5e=`Assistant is a large language model trained by OpenAI.

Assistant is designed to be able to assist with a wide range of tasks, from answering simple questions to providing in-depth explanations and discussions on a wide range of topics. As a language model, Assistant is able to generate human-like text based on the input it receives, allowing it to engage in natural-sounding conversations and provide responses that are coherent and relevant to the topic at hand.

Assistant is constantly learning and improving, and its capabilities are constantly evolving. It is able to process and understand large amounts of text, and can use this knowledge to provide accurate and informative responses to a wide range of questions. Additionally, Assistant is able to generate its own text based on the input it receives, allowing it to engage in discussions and provide explanations and descriptions on a wide range of topics.

Overall, Assistant is a powerful system that can help with a wide range of tasks and provide valuable insights and information on a wide range of topics. Whether you need help with a specific question or just want to have a conversation about a particular topic, Assistant is here to assist.`,T5e=" However, above all else, all responses must adhere to the format of RESPONSE FORMAT INSTRUCTIONS.",cA=`RESPONSE FORMAT INSTRUCTIONS
----------------------------

Output a JSON markdown code snippet containing a valid JSON object in one of two formats:

**Option 1:**
Use this if you want the human to use a tool.
Markdown code snippet formatted in the following schema:

\`\`\`json
{{{{
    "action": string, // The action to take. Must be one of [{tool_names}]
    "action_input": string // The input to the action. May be a stringified object.
}}}}
\`\`\`

**Option #2:**
Use this if you want to respond directly and conversationally to the human. Markdown code snippet formatted in the following schema:

\`\`\`json
{{{{
    "action": "Final Answer",
    "action_input": string // You should put what you want to return to use here and make sure to use valid json newline characters.
}}}}
\`\`\`

For both options, remember to always include the surrounding markdown code snippet delimiters (begin with "\`\`\`json" and end with "\`\`\`")!
`,k5e=`TOOLS
------
Assistant can ask the user to use tools to look up information that may be helpful in answering the users original question. The tools the human can use are:

{tools}

{format_instructions}

USER'S INPUT
--------------------
Here is the user's input (remember to respond with a markdown code snippet of a json blob with a single action, and NOTHING else):

{{input}}`,xK=`TOOL RESPONSE:
---------------------
{observation}

USER'S INPUT
--------------------

Okay, so what is the response to my last comment? If using information obtained from the tools you must mention it explicitly without mentioning the tool names - I have forgotten all TOOL RESPONSES! Remember to respond with a markdown code snippet of a json blob with a single action, and NOTHING else.`,C5e=`Instructions:
--------------
{instructions}
--------------
Completion:
--------------
{completion}
--------------

Above, the Completion did not satisfy the constraints given in the Instructions.
Error:
--------------
{error}
--------------

Please try again. Please only respond with an answer that satisfies the constraints laid out in the Instructions:`,I5e=ve.fromTemplate(C5e);function $5e(t){return t.prompt!==void 0&&t.llm!==void 0}class Ug extends zr{static lc_name(){return"OutputFixingParser"}static fromLLM(e,r,n){const i=(n==null?void 0:n.prompt)??I5e,a=new Pe({llm:e,prompt:i});return new Ug({parser:r,retryChain:a})}constructor({parser:e,retryChain:r}){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","fix"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"parser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"retryChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.parser=e,this.retryChain=r}async parse(e,r){try{return await this.parser.parse(e,r)}catch(n){if(n instanceof ft){const i={instructions:this.parser.getFormatInstructions(),completion:e,error:n};if($5e(this.retryChain)){const s=(await this.retryChain.call(i,r))[this.retryChain.outputKey];return this.parser.parse(s,r)}else return await this.retryChain.invoke(i,{callbacks:r})}throw n}}getFormatInstructions(){return this.parser.getFormatInstructions()}}class hA extends Os{constructor(e){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","chat_convo"]}),Object.defineProperty(this,"toolNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.toolNames=e.toolNames}async parse(e){let r=e.trim();if(r.includes("```json")||r.includes("```")){const n=r.includes("```json")?"```json":"```",i=r.indexOf(n);if(r.indexOf("action_input")>i){r=r.slice(i+n.length).trimStart();const s=r.lastIndexOf("```");s!==-1&&(r=r.slice(0,s).trimEnd())}}try{const n=JSON.parse(r),{action:i,action_input:a}=n;return i==="Final Answer"?{returnValues:{output:a},log:e}:{tool:i,toolInput:a,log:e}}catch(n){throw new ft(`Failed to parse. Text: "${e}". Error: ${n}`)}}getFormatInstructions(){return _r(cA,"f-string",{tool_names:this.toolNames.join(", ")})}}class Gm extends Os{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","chat_convo"]}),Object.defineProperty(this,"baseParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputFixingParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"toolNames",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.toolNames=e.toolNames??this.toolNames,this.baseParser=(e==null?void 0:e.baseParser)??new hA({toolNames:this.toolNames}),this.outputFixingParser=e==null?void 0:e.outputFixingParser}getFormatInstructions(e){return e.raw?cA:_r(cA,"f-string",{tool_names:e.toolNames.join(", ")})}async parse(e){return this.outputFixingParser!==void 0?this.outputFixingParser.parse(e):this.baseParser.parse(e)}static fromLLM(e,r){const n=r.baseParser??new hA({toolNames:r.toolNames??[]}),i=Ug.fromLLM(e,n);return new Gm({baseParser:n,outputFixingParser:i,toolNames:r.toolNames})}}class za extends Bd{static lc_name(){return"ChatConversationalAgent"}constructor(e){const r=e.outputParser??za.getDefaultOutputParser();super({...e,outputParser:r}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","chat_convo"]})}_agentType(){return"chat-conversational-react-description"}observationPrefix(){return"Observation: "}llmPrefix(){return"Thought:"}_stop(){return["Observation:"]}static validateTools(e){const r=e.find(n=>!n.description);if(r){const n=`Got a tool ${r.name} without a description. This agent requires descriptions for all tools.`;throw new Error(n)}}async constructScratchPad(e){const r=[];for(const n of e)r.push(new pt(n.action.log)),r.push(new Wt(_r(xK,"f-string",{observation:n.observation})));return r}static getDefaultOutputParser(e){return e!=null&&e.llm?Gm.fromLLM(e.llm,{toolNames:e.toolNames}):new Gm({toolNames:e==null?void 0:e.toolNames})}static createPrompt(e,r){const n=((r==null?void 0:r.systemMessage)??A5e)+T5e,i=(r==null?void 0:r.humanMessage)??k5e,a=e.map(h=>`${h.name}: ${h.description}`).join(`
`),s=e.map(h=>h.name),u=((r==null?void 0:r.outputParser)??za.getDefaultOutputParser({toolNames:s})).getFormatInstructions({toolNames:s}),l=_r(i,"f-string",{format_instructions:u,tools:a}),c=[ei.fromTemplate(n),new Nl("chat_history"),ir.fromTemplate(l),new Nl("agent_scratchpad")];return Xt.fromMessages(c)}static fromLLMAndTools(e,r,n){za.validateTools(r);const i=(n==null?void 0:n.outputParser)??za.getDefaultOutputParser({llm:e,toolNames:r.map(o=>o.name)}),a=za.createPrompt(r,{...n,outputParser:i}),s=new Pe({prompt:a,llm:e,callbacks:(n==null?void 0:n.callbacks)??(n==null?void 0:n.callbackManager)});return new za({llmChain:s,outputParser:i,allowedTools:r.map(o=>o.name)})}}const j5e="Answer the following questions truthfully and as best you can.",OK=`Output a JSON markdown code snippet containing a valid JSON blob (denoted below by $JSON_BLOB).
This $JSON_BLOB must have a "action" key (with the name of the tool to use) and an "action_input" key (tool input).

Valid "action" values: "Final Answer" (which you must use when giving your final response to the user), or one of [{tool_names}].

The $JSON_BLOB must be valid, parseable JSON and only contain a SINGLE action. Here is an example of an acceptable output:

\`\`\`json
{{
  "action": $TOOL_NAME,
  "action_input": $INPUT
}}
\`\`\`

Remember to include the surrounding markdown code snippet delimiters (begin with "\`\`\`" json and close with "\`\`\`")!
`,SK=`You have access to the following tools.
You must format your inputs to these tools to match their "JSON schema" definitions below.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Here are the JSON Schema instances for the tools you have access to:

{tool_schemas}

The way you use the tools is as follows:

------------------------

${OK}

If you are using a tool, "action_input" must adhere to the tool's input schema, given above.

------------------------

ALWAYS use the following format:

Question: the input question you must answer
Thought: you should always think about what to do
Action:
\`\`\`json
$JSON_BLOB
\`\`\`
Observation: the result of the action
... (this Thought/Action/Observation can repeat N times)
Thought: I now know the final answer
Action:
\`\`\`json
{{
  "action": "Final Answer",
  "action_input": "Final response to human"
}}
\`\`\``,R5e="Begin! Reminder to ALWAYS use the above format, and to use tools if appropriate.";class dA extends Os{constructor(e){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","structured_chat"]}),Object.defineProperty(this,"toolNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.toolNames=e.toolNames}async parse(e){try{const n=/```(?:json)?(.*)(```)/gs.exec(e);if(n===null)throw new ft('Could not parse an action. The agent action must be within a markdown code block, and "action" must be a provided tool or "Final Answer"');const i=JSON.parse(n[1].trim()),{action:a,action_input:s}=i;return a==="Final Answer"?{returnValues:{output:s},log:e}:{tool:a,toolInput:s||{},log:e}}catch(r){throw new ft(`Failed to parse. Text: "${e}". Error: ${r}`)}}getFormatInstructions(){return _r(OK,"f-string",{tool_names:this.toolNames.join(", ")})}}class Qh extends Os{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","structured_chat"]}),Object.defineProperty(this,"baseParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputFixingParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"toolNames",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.toolNames=e.toolNames??this.toolNames,this.baseParser=(e==null?void 0:e.baseParser)??new dA({toolNames:this.toolNames}),this.outputFixingParser=e==null?void 0:e.outputFixingParser}async parse(e,r){return this.outputFixingParser!==void 0?this.outputFixingParser.parse(e,r):this.baseParser.parse(e)}getFormatInstructions(){return _r(SK,"f-string",{tool_names:this.toolNames.join(", ")})}static fromLLM(e,r){const n=r.baseParser??new dA({toolNames:r.toolNames??[]}),i=Ug.fromLLM(e,n);return new Qh({baseParser:n,outputFixingParser:i,toolNames:r.toolNames})}}function lI(t){return t.every(Rd)?t.map(e=>`${e.function.name}${e.function.description?`: ${e.function.description}`:""}`).join(`
`):t.map(e=>`${e.name}: ${e.description}`).join(`
`)}function PK(t){return t.every(Rd)?t.map(e=>`${e.function.name}${e.function.description?`: ${e.function.description}`:""}, args: ${JSON.stringify(e.function.parameters)}`).join(`
`):t.map(e=>`${e.name}: ${e.description}, args: ${JSON.stringify(Ur(e.schema).properties)}`).join(`
`)}const N5e=Object.freeze(Object.defineProperty({__proto__:null,renderTextDescription:lI,renderTextDescriptionAndArgs:PK},Symbol.toStringTag,{value:"Module"}));function cI(t,e="Observation: ",r="Thought: "){return t.reduce((i,{action:a,observation:s})=>i+[a.log,`
${e}${s}`,r].join(`
`),"")}const M5e=Object.freeze(Object.defineProperty({__proto__:null,formatLogToString:cI},Symbol.toStringTag,{value:"Module"}));class Ba extends Bd{static lc_name(){return"StructuredChatAgent"}constructor(e){const r=(e==null?void 0:e.outputParser)??Ba.getDefaultOutputParser();super({...e,outputParser:r}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","structured_chat"]})}_agentType(){return"structured-chat-zero-shot-react-description"}observationPrefix(){return"Observation: "}llmPrefix(){return"Thought:"}_stop(){return["Observation:"]}static validateTools(e){const r=e.find(n=>!n.description);if(r){const n=`Got a tool ${r.name} without a description. This agent requires descriptions for all tools.`;throw new Error(n)}}static getDefaultOutputParser(e){return e!=null&&e.llm?Qh.fromLLM(e.llm,{toolNames:e.toolNames}):new Qh({toolNames:e==null?void 0:e.toolNames})}async constructScratchPad(e){const r=await super.constructScratchPad(e);return r&&`This was your previous work (but I haven't seen any of it! I only see what you return as final answer):
${r}`}static createToolSchemasString(e){return e.map(r=>`${r.name}: ${r.description}, args: ${JSON.stringify(Ur(r.schema).properties)}`).join(`
`)}static createPrompt(e,r){const{prefix:n=j5e,suffix:i=R5e,inputVariables:a=["input","agent_scratchpad"],humanMessageTemplate:s=`{input}

{agent_scratchpad}`,memoryPrompts:o=[]}=r??{},u=[n,SK,i].join(`

`),l=[new ei(new ve({template:u,inputVariables:a,partialVariables:{tool_schemas:Ba.createToolSchemasString(e),tool_names:e.map(c=>c.name).join(", ")}})),...o,new ir(new ve({template:s,inputVariables:a}))];return Xt.fromMessages(l)}static fromLLMAndTools(e,r,n){Ba.validateTools(r);const i=Ba.createPrompt(r,n),a=(n==null?void 0:n.outputParser)??Ba.getDefaultOutputParser({llm:e,toolNames:r.map(o=>o.name)}),s=new Pe({prompt:i,llm:e,callbacks:n==null?void 0:n.callbacks});return new Ba({llmChain:s,outputParser:a,allowedTools:r.map(o=>o.name)})}}async function D5e({llm:t,tools:e,prompt:r,streamRunnable:n}){const i=["tools","tool_names","agent_scratchpad"].filter(l=>!r.inputVariables.includes(l));if(i.length>0)throw new Error(`Provided prompt is missing required input variables: ${JSON.stringify(i)}`);let a=[];if(e.every(Rd))a=e.map(l=>l.function.name);else if(e.every(HC))a=e.map(l=>l.name);else throw new Error("All tools must be either OpenAI or Structured tools, not a mix.");const s=await r.partial({tools:PK(e),tool_names:a.join(", ")}),o=t.bind({stop:["Observation"]});return Xl.fromRunnables([Dr.assign({agent_scratchpad:l=>cI(l.steps)}),s,o,Qh.fromLLM(t,{toolNames:a})],{name:"StructuredChatAgent",streamRunnable:n,singleAction:!0})}const L5e="You are a helpful AI assistant.";class hI extends Os{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","openai"]})}static lc_name(){return"OpenAIFunctionsAgentOutputParser"}async parse(e){throw new Error(`OpenAIFunctionsAgentOutputParser can only parse messages.
Passed input: ${e}`)}async parseResult(e){if("message"in e[0]&&An(e[0].message))return this.parseAIMessage(e[0].message);throw new Error("parseResult on OpenAIFunctionsAgentOutputParser only works on ChatGeneration output")}parseAIMessage(e){if(e.content&&typeof e.content!="string")throw new Error("This agent cannot parse non-string model responses.");if(e.additional_kwargs.function_call){const r=e.additional_kwargs.function_call;try{const n=r.arguments?JSON.parse(r.arguments):{};return{tool:r.name,toolInput:n,log:`Invoking "${r.name}" with ${r.arguments??"{}"}
${e.content}`,messageLog:[e]}}catch(n){throw new ft(`Failed to parse function arguments from chat model response. Text: "${r.arguments}". ${n}`)}}else return{returnValues:{output:e.content},log:e.content}}getFormatInstructions(){throw new Error("getFormatInstructions not implemented inside OpenAIFunctionsAgentOutputParser.")}}class EK extends rK{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","openai"]})}static lc_name(){return"OpenAIToolsAgentOutputParser"}async parse(e){throw new Error(`OpenAIFunctionsAgentOutputParser can only parse messages.
Passed input: ${e}`)}async parseResult(e){if("message"in e[0]&&An(e[0].message))return this.parseAIMessage(e[0].message);throw new Error("parseResult on OpenAIFunctionsAgentOutputParser only works on ChatGeneration output")}parseAIMessage(e){if(e.content&&typeof e.content!="string")throw new Error("This agent cannot parse non-string model responses.");if(e.additional_kwargs.tool_calls){const r=e.additional_kwargs.tool_calls;try{return r.map((n,i)=>{const a=n.function.arguments?JSON.parse(n.function.arguments):{},s=i===0?[e]:[];return{tool:n.function.name,toolInput:a,toolCallId:n.id,log:`Invoking "${n.function.name}" with ${n.function.arguments??"{}"}
${e.content}`,messageLog:s}})}catch(n){throw new ft(`Failed to parse tool arguments from chat model response. Text: "${JSON.stringify(r)}". ${n}`)}}else return{returnValues:{output:e.content},log:e.content}}getFormatInstructions(){throw new Error("getFormatInstructions not implemented inside OpenAIToolsAgentOutputParser.")}}const F5e=Object.freeze(Object.defineProperty({__proto__:null,OpenAIFunctionsAgentOutputParser:hI,OpenAIToolsAgentOutputParser:EK},Symbol.toStringTag,{value:"Module"}));function U5e(t){const e=[];for(const r of t)e.push(new pt(r.action.log)),e.push(new Wt(_r(xK,"f-string",{observation:r.observation})));return e}function AK(t){return t.flatMap(({action:e,observation:r})=>"messageLog"in e&&e.messageLog!==void 0?e.messageLog.concat(new yo(r,e.tool)):[new pt(e.log)])}const z5e=Object.freeze(Object.defineProperty({__proto__:null,formatForOpenAIFunctions:U5e,formatToOpenAIFunctionMessages:AK},Symbol.toStringTag,{value:"Module"}));function B5e(t){return t.messageLog!==void 0}function q5e(t,e){var r;return B5e(t)&&t.messageLog!==void 0?(r=t.messageLog)==null?void 0:r.concat(new yo(e,t.tool)):[new pt(t.log)]}function TK(t){return t.flatMap(({action:e,observation:r})=>q5e(e,r))}class hh extends Bd{static lc_name(){return"OpenAIAgent"}_agentType(){return"openai-functions"}observationPrefix(){return"Observation: "}llmPrefix(){return"Thought:"}_stop(){return["Observation:"]}constructor(e){super({...e,outputParser:void 0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","openai"]}),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:new hI}),this.tools=e.tools}static createPrompt(e,r){const{prefix:n=L5e}=r||{};return Xt.fromMessages([ei.fromTemplate(n),new Nl("chat_history"),ir.fromTemplate("{input}"),new Nl("agent_scratchpad")])}static fromLLMAndTools(e,r,n){if(hh.validateTools(r),e._modelType()!=="base_chat_model"||e._llmType()!=="openai")throw new Error("OpenAIAgent requires an OpenAI chat model");const i=hh.createPrompt(r,n),a=new Pe({prompt:i,llm:e,callbacks:n==null?void 0:n.callbacks});return new hh({llmChain:a,allowedTools:r.map(s=>s.name),tools:r})}async constructScratchPad(e){return TK(e)}async plan(e,r,n){const i=await this.constructScratchPad(e),a={...r,agent_scratchpad:i};this._stop().length!==0&&(a.stop=this._stop());const s=this.llmChain.llm,o={...a},u={functions:this.tools.map(Dd)},l="callKeys"in this.llmChain.llm?this.llmChain.llm.callKeys:[];for(const d of l)d in r&&(u[d]=r[d],delete o[d]);const c=await this.llmChain.prompt.formatPromptValue(o),h=await s.invoke(c.toChatMessages(),{...u,callbacks:n});return this.outputParser.parseAIMessage(h)}}async function K5e({llm:t,tools:e,prompt:r,streamRunnable:n}){if(!r.inputVariables.includes("agent_scratchpad"))throw new Error(['Prompt must have an input variable named "agent_scratchpad".',`Found ${JSON.stringify(r.inputVariables)} instead.`].join(`
`));const i=t.bind({functions:e.map(Dd)});return Xl.fromRunnables([Dr.assign({agent_scratchpad:s=>AK(s.steps)}),r,i,new hI],{name:"OpenAIFunctionsAgent",streamRunnable:n,singleAction:!0})}const V5e=`You are a helpful assistant. Help the user answer any questions.

You have access to the following tools:

{tools}

In order to use a tool, you can use <tool></tool> and <tool_input></tool_input> tags.
You will then get back a response in the form <observation></observation>
For example, if you have a tool called 'search' that could run a google search, in order to search for the weather in SF you would respond:

<tool>search</tool><tool_input>weather in SF</tool_input>
<observation>64 degrees</observation>

When you are done, respond with a final answer between <final_answer></final_answer>. For example:

<final_answer>The weather in SF is 64 degrees</final_answer>

Begin!

Question: {question}`;class dI extends Os{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","xml"]})}static lc_name(){return"XMLAgentOutputParser"}async parse(e){if(e.includes("</tool>")){const[r,n]=e.split("</tool>"),i=r.split("<tool>")[1],a=n.split("<tool_input>")[1];return{tool:i,toolInput:a,log:e}}else if(e.includes("<final_answer>")){const[,r]=e.split("<final_answer>");return{returnValues:{output:r},log:e}}else throw new ft(`Could not parse LLM output: ${e}`)}getFormatInstructions(){throw new Error("getFormatInstructions not implemented inside OpenAIFunctionsAgentOutputParser.")}}const H5e=Object.freeze(Object.defineProperty({__proto__:null,XMLAgentOutputParser:dI},Symbol.toStringTag,{value:"Module"}));function kK(t){let e="";for(const r of t){const{action:n,observation:i}=r;e+=`<tool>${n.tool}</tool><tool_input>${n.toolInput}
</tool_input><observation>${i}</observation>`}return e}const W5e=Object.freeze(Object.defineProperty({__proto__:null,formatXml:kK},Symbol.toStringTag,{value:"Module"}));class Ym extends Ig{static lc_name(){return"XMLAgent"}_agentType(){return"xml"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","xml"]}),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:new dI}),this.tools=e.tools,this.llmChain=e.llmChain}get inputKeys(){return["input"]}static createPrompt(){return Xt.fromMessages([ir.fromTemplate(V5e),Ql.fromTemplate("{intermediate_steps}")])}async plan(e,r,n){let i="";for(const{action:u,observation:l}of e)i+=`<tool>${u.tool}</tool><tool_input>${u.toolInput}</tool_input><observation>${l}</observation>`;let a="";for(const u of this.tools)a+=`${u.name}: ${u.description}
`;const s={intermediate_steps:i,tools:a,question:r.input,stop:["</tool_input>","</final_answer>"]},o=await this.llmChain.call(s,n);return this.outputParser.parse(o[this.llmChain.outputKey])}static fromLLMAndTools(e,r,n){const i=Ym.createPrompt(),a=new Pe({prompt:i,llm:e,callbacks:n==null?void 0:n.callbacks});return new Ym({llmChain:a,tools:r})}}async function G5e({llm:t,tools:e,prompt:r,streamRunnable:n}){const i=["tools","agent_scratchpad"].filter(u=>!r.inputVariables.includes(u));if(i.length>0)throw new Error(`Provided prompt is missing required input variables: ${JSON.stringify(i)}`);const a=await r.partial({tools:lI(e)}),s=t.bind({stop:["</tool_input>","</final_answer>"]});return Xl.fromRunnables([Dr.assign({agent_scratchpad:u=>kK(u.steps)}),a,s,new dI],{name:"XMLAgent",streamRunnable:n,singleAction:!0})}const Y5e=async(t,e,r,n,i)=>{const a=r??"zero-shot-react-description",s=n,o=i;switch(a){case"zero-shot-react-description":return mr.fromAgentAndTools({agent:or.fromLLMAndTools(e,t),tools:t,returnIntermediateSteps:!0,verbose:s,callbackManager:o});case"chat-zero-shot-react-description":return mr.fromAgentAndTools({agent:Ha.fromLLMAndTools(e,t),tools:t,returnIntermediateSteps:!0,verbose:s,callbackManager:o});case"chat-conversational-react-description":return mr.fromAgentAndTools({agent:za.fromLLMAndTools(e,t),tools:t,verbose:s,callbackManager:o});default:throw new Error("Unknown agent type")}};async function CK(t,e,r={agentType:e._modelType()==="base_chat_model"?"chat-zero-shot-react-description":"zero-shot-react-description"}){switch(r.agentType){case"zero-shot-react-description":{const{agentArgs:n,tags:i,...a}=r;return mr.fromAgentAndTools({tags:[...i??[],"zero-shot-react-description"],agent:or.fromLLMAndTools(e,t,n),tools:t,...a})}case"chat-zero-shot-react-description":{const{agentArgs:n,tags:i,...a}=r;return mr.fromAgentAndTools({tags:[...i??[],"chat-zero-shot-react-description"],agent:Ha.fromLLMAndTools(e,t,n),tools:t,...a})}case"chat-conversational-react-description":{const{agentArgs:n,memory:i,tags:a,...s}=r;return mr.fromAgentAndTools({tags:[...a??[],"chat-conversational-react-description"],agent:za.fromLLMAndTools(e,t,n),tools:t,memory:i??new jw({returnMessages:!0,memoryKey:"chat_history",inputKey:"input",outputKey:"output"}),...s})}case"xml":{const{agentArgs:n,tags:i,...a}=r;return mr.fromAgentAndTools({tags:[...i??[],"xml"],agent:Ym.fromLLMAndTools(e,t,n),tools:t,...a})}case"structured-chat-zero-shot-react-description":{const{agentArgs:n,memory:i,tags:a,...s}=r;return mr.fromAgentAndTools({tags:[...a??[],"structured-chat-zero-shot-react-description"],agent:Ba.fromLLMAndTools(e,t,n),tools:t,memory:i,...s})}case"openai-functions":{const{agentArgs:n,memory:i,tags:a,...s}=r;return mr.fromAgentAndTools({tags:[...a??[],"openai-functions"],agent:hh.fromLLMAndTools(e,t,n),tools:t,memory:i??new jw({returnMessages:!0,memoryKey:"chat_history",inputKey:"input",outputKey:"output"}),...s})}default:throw new Error("Unknown agent type")}}class IK extends bo{constructor(e){super(e),Object.defineProperty(this,"humanPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"Human"}),Object.defineProperty(this,"aiPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"AI"}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"memoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"history"}),Object.defineProperty(this,"maxTokenLimit",{enumerable:!0,configurable:!0,writable:!0,value:12e3}),Object.defineProperty(this,"returnMessages",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output"}),Object.defineProperty(this,"intermediateStepsKey",{enumerable:!0,configurable:!0,writable:!0,value:"intermediateSteps"}),this.humanPrefix=e.humanPrefix??this.humanPrefix,this.aiPrefix=e.aiPrefix??this.aiPrefix,this.llm=e.llm,this.memoryKey=e.memoryKey??this.memoryKey,this.maxTokenLimit=e.maxTokenLimit??this.maxTokenLimit,this.returnMessages=e.returnMessages??this.returnMessages,this.outputKey=e.outputKey??this.outputKey,this.intermediateStepsKey=e.intermediateStepsKey??this.intermediateStepsKey}get memoryKeys(){return[this.memoryKey]}async getMessages(){return this.chatHistory.getMessages()}async loadMemoryVariables(e){const r=await this.getMessages();if(this.returnMessages)return{[this.memoryKey]:r};{const n=Nr(r,this.humanPrefix,this.aiPrefix);return{[this.memoryKey]:n}}}async saveContext(e,r){const n=Fg(e,this.inputKey),i=p1(r,this.outputKey);await this.chatHistory.addUserMessage(n);const a=TK(r[this.intermediateStepsKey]);for(const u of a)await this.chatHistory.addMessage(u);await this.chatHistory.addAIChatMessage(i);const s=await this.chatHistory.getMessages();let o=await this.llm.getNumTokensFromMessages(s);if(o.totalCount>this.maxTokenLimit){const u=[];for(;o.totalCount>this.maxTokenLimit;){const l=s.pop();if(!l){console.warn(`Could not prune enough messages from chat history to stay under ${this.maxTokenLimit} tokens.`);break}u.push(l),o=await this.llm.getNumTokensFromMessages(s)}await this.chatHistory.clear();for(const l of u)await this.chatHistory.addMessage(l)}}}async function J5e(t,e,r){const{rememberIntermediateSteps:n=!0,memoryKey:i="chat_history",outputKey:a="output",inputKey:s="input",prefix:o,verbose:u}=r??{};let l;return n?l=new IK({memoryKey:i,llm:t,outputKey:a,inputKey:s}):l=new bK({memoryKey:i,llm:t,maxTokenLimit:12e3,returnMessages:!0,outputKey:a,inputKey:s}),await CK(e,t,{agentType:"openai-functions",memory:l,verbose:u,returnIntermediateSteps:n,agentArgs:{prefix:o??"Do your best to answer the questions. Feel free to use any tools available to look up relevant information, only if necessary."}})}const Z5e=Object.freeze(Object.defineProperty({__proto__:null,JsonToolkit:tI,OpenAIAgentTokenBufferMemory:IK,OpenApiToolkit:oK,RequestsToolkit:nI,VectorStoreRouterToolkit:pK,VectorStoreToolkit:fK,createConversationalRetrievalAgent:J5e,createJsonAgent:rI,createOpenApiAgent:uK,createRetrieverTool:c5e,createVectorStoreAgent:mK,createVectorStoreRouterAgent:gK},Symbol.toStringTag,{value:"Module"}));function X5e(t){return new Pa({tool_call_id:t.action.toolCallId,content:t.observation,additional_kwargs:{name:t.action.tool}})}function fI(t){return t.flatMap(({action:e,observation:r})=>"messageLog"in e&&e.messageLog!==void 0?e.messageLog.concat(X5e({action:e,observation:r})):[new pt(e.log)])}const Q5e=Object.freeze(Object.defineProperty({__proto__:null,formatToOpenAIToolMessages:fI},Symbol.toStringTag,{value:"Module"}));async function e4e({llm:t,tools:e,prompt:r,streamRunnable:n}){if(!r.inputVariables.includes("agent_scratchpad"))throw new Error(['Prompt must have an input variable named "agent_scratchpad".',`Found ${JSON.stringify(r.inputVariables)} instead.`].join(`
`));const i=t.bind({tools:e.map(s=>VC(s))});return Xl.fromRunnables([Dr.assign({agent_scratchpad:s=>fI(s.steps)}),r,i,new EK],{name:"OpenAIToolsAgent",streamRunnable:n,singleAction:!1})}function t4e(t){var n;const e=typeof t.content=="string"?t.content:JSON.stringify(t.content);let r=[];if(t.tool_calls!==void 0&&t.tool_calls.length>0)r=t.tool_calls;else{if(t.additional_kwargs.tool_calls===void 0||t.additional_kwargs.tool_calls.length===0)return{returnValues:{output:t.content},log:e};for(const i of t.additional_kwargs.tool_calls??[]){const a=(n=i.function)==null?void 0:n.name;try{const s=JSON.parse(i.function.arguments);r.push({name:a,args:s,id:i.id})}catch(s){throw new ft(`Failed to parse tool arguments from chat model response. Text: "${JSON.stringify(r)}". ${s}`)}}}return r.map((i,a)=>{const s=a===0?[t]:[],o=`Invoking "${i.name}" with ${JSON.stringify(i.args??{})}
${e}`;return{tool:i.name,toolInput:i.args,toolCallId:i.id??"",log:o,messageLog:s}})}class r4e extends rK{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","tool_calling"]})}static lc_name(){return"ToolCallingAgentOutputParser"}async parse(e){throw new Error(`ToolCallingAgentOutputParser can only parse messages.
Passed input: ${e}`)}async parseResult(e){if("message"in e[0]&&An(e[0].message))return t4e(e[0].message);throw new Error("parseResult on ToolCallingAgentOutputParser only works on ChatGeneration output")}getFormatInstructions(){throw new Error("getFormatInstructions not implemented inside ToolCallingAgentOutputParser.")}}function n4e(t){const e=t;return typeof e._modelType=="function"&&e._modelType()==="base_chat_model"}function i4e({llm:t,tools:e,prompt:r,streamRunnable:n}){if(!r.inputVariables.includes("agent_scratchpad"))throw new Error(['Prompt must have an input variable named "agent_scratchpad".',`Found ${JSON.stringify(r.inputVariables)} instead.`].join(`
`));let i;if(n4e(t)){if(t.bindTools===void 0)throw new Error('This agent requires that the "bind_tools()" method be implemented on the input model.');i=t.bindTools(e)}else i=t;return Xl.fromRunnables([Dr.assign({agent_scratchpad:s=>fI(s.steps)}),r,i,new r4e],{name:"ToolCallingAgent",streamRunnable:n,singleAction:!1})}const a4e=`Use the following format:

Question: the input question you must answer
Thought: you should always think about what to do
Action: the action to take, should be one of [{tool_names}]
Action Input: the input to the action
Observation: the result of the action
... (this Thought/Action/Action Input/Observation can repeat N times)
Thought: I now know the final answer
Final Answer: the final answer to the original input question`,_F="Final Answer:",s4e="Parsing LLM output produced both a final answer and a parse-able action:";class $K extends Os{constructor(e){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","react"]}),Object.defineProperty(this,"toolNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.toolNames=e.toolNames}async parse(e){const r=e.includes(_F),n=/Action\s*\d*\s*:[\s]*(.*?)[\s]*Action\s*\d*\s*Input\s*\d*\s*:[\s]*(.*)/,i=e.match(n);if(i){if(r)throw new Error(`${s4e}: ${e}`);const a=i[1],o=i[2].trim().replace(/"/g,"");return{tool:a,toolInput:o,log:e}}if(r)return{returnValues:{output:e.split(_F)[1].trim()},log:e};throw new Error(`Could not parse LLM output: ${e}`)}getFormatInstructions(){return _r(a4e,"f-string",{tool_names:this.toolNames.join(", ")})}}const o4e=Object.freeze(Object.defineProperty({__proto__:null,ReActSingleInputOutputParser:$K},Symbol.toStringTag,{value:"Module"}));async function jK({llm:t,tools:e,prompt:r,streamRunnable:n}){const i=["tools","tool_names","agent_scratchpad"].filter(l=>!r.inputVariables.includes(l));if(i.length>0)throw new Error(`Provided prompt is missing required input variables: ${JSON.stringify(i)}`);const a=e.map(l=>l.name),s=await r.partial({tools:lI(e),tool_names:a.join(", ")}),o=t.bind({stop:[`
Observation:`]});return Xl.fromRunnables([Dr.assign({agent_scratchpad:l=>cI(l.steps)}),s,o,new $K({toolNames:a})],{name:"ReactAgent",streamRunnable:n,singleAction:!0})}const u4e=Object.freeze(Object.defineProperty({__proto__:null,Agent:Bd,AgentActionOutputParser:Os,AgentExecutor:mr,BaseMultiActionAgent:V8,BaseSingleActionAgent:Ig,ChatAgent:Ha,ChatAgentOutputParser:_K,ChatConversationalAgent:za,ChatConversationalAgentOutputParser:hA,ChatConversationalAgentOutputParserWithRetries:Gm,JsonToolkit:tI,LLMSingleActionAgent:MFe,OpenAIAgent:hh,OpenApiToolkit:oK,RequestsToolkit:nI,RunnableAgent:NFe,StructuredChatAgent:Ba,StructuredChatOutputParser:dA,StructuredChatOutputParserWithRetries:Qh,Toolkit:qd,VectorStoreRouterToolkit:pK,VectorStoreToolkit:fK,XMLAgent:Ym,ZeroShotAgent:or,ZeroShotAgentOutputParser:iK,createJsonAgent:rI,createOpenAIFunctionsAgent:K5e,createOpenAIToolsAgent:e4e,createOpenApiAgent:uK,createReactAgent:jK,createStructuredChatAgent:D5e,createToolCallingAgent:i4e,createVectorStoreAgent:mK,createVectorStoreRouterAgent:gK,createXmlAgent:G5e,initializeAgentExecutor:Y5e,initializeAgentExecutorWithOptions:CK},Symbol.toStringTag,{value:"Module"})),l4e=[],c4e=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class pI extends Je{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","documents","transformers"]})}invoke(e,r){return this.transformDocuments(e)}}class RK extends pI{async transformDocuments(e){const r=[];for(const n of e){const i=await this._transformDocument(n);r.push(i)}return r}}const h4e=Object.freeze(Object.defineProperty({__proto__:null,BaseDocumentTransformer:pI,Document:rr,MappingDocumentTransformer:RK},Symbol.toStringTag,{value:"Module"}));class Tu extends Je{constructor(e){super(e),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.callbacks=e==null?void 0:e.callbacks,this.tags=(e==null?void 0:e.tags)??[],this.metadata=(e==null?void 0:e.metadata)??{},this.verbose=(e==null?void 0:e.verbose)??!1}_getRelevantDocuments(e,r){throw new Error("Not implemented!")}async invoke(e,r){return this.getRelevantDocuments(e,Ve(r))}async getRelevantDocuments(e,r){const n=Ve($d(r)),i=await Zt.configure(n.callbacks,this.callbacks,n.tags,this.tags,n.metadata,this.metadata,{verbose:this.verbose}),a=await(i==null?void 0:i.handleRetrieverStart(this.toJSON(),e,n.runId,void 0,void 0,void 0,n.runName));try{const s=await this._getRelevantDocuments(e,a);return await(a==null?void 0:a.handleRetrieverEnd(s)),s}catch(s){throw await(a==null?void 0:a.handleRetrieverError(s)),s}}}const d4e=Object.freeze(Object.defineProperty({__proto__:null,BaseRetriever:Tu},Symbol.toStringTag,{value:"Module"}));class mI extends Or{}class NK extends mI{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","storage"]}),Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:{}})}async mget(e){return e.map(r=>this.store[r])}async mset(e){for(const[r,n]of e)this.store[r]=n}async mdelete(e){for(const r of e)delete this.store[r]}async*yieldKeys(e){const r=Object.keys(this.store);for(const n of r)(e===void 0||n.startsWith(e))&&(yield n)}}const f4e=Object.freeze(Object.defineProperty({__proto__:null,BaseStore:mI,InMemoryStore:NK},Symbol.toStringTag,{value:"Module"}));class MK extends Wi{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"endpoint",{enumerable:!0,configurable:!0,writable:!0,value:Me("LANGCHAIN_ENDPOINT")||"http://localhost:1984"}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:{"Content-Type":"application/json"}}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const e=Me("LANGCHAIN_API_KEY");e&&(this.headers["x-api-key"]=e)}async newSession(e){const r={start_time:Date.now(),name:e},n=await this.persistSession(r);return this.session=n,n}async loadSession(e){const r=`${this.endpoint}/sessions?name=${e}`;return this._handleSessionResponse(r)}async loadDefaultSession(){const e=`${this.endpoint}/sessions?name=default`;return this._handleSessionResponse(e)}async convertV2RunToRun(e){var a;const r=this.session??await this.loadDefaultSession(),n=e.serialized;let i;if(e.run_type==="llm"){const s=e.inputs.prompts?e.inputs.prompts:e.inputs.messages.map(u=>Nr(u));i={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:n,type:e.run_type,session_id:r.id,prompts:s,response:e.outputs}}else if(e.run_type==="chain"){const s=await Promise.all(e.child_runs.map(u=>this.convertV2RunToRun(u)));i={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:n,type:e.run_type,session_id:r.id,inputs:e.inputs,outputs:e.outputs,child_llm_runs:s.filter(u=>u.type==="llm"),child_chain_runs:s.filter(u=>u.type==="chain"),child_tool_runs:s.filter(u=>u.type==="tool")}}else if(e.run_type==="tool"){const s=await Promise.all(e.child_runs.map(u=>this.convertV2RunToRun(u)));i={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:n,type:e.run_type,session_id:r.id,tool_input:e.inputs.input,output:(a=e.outputs)==null?void 0:a.output,action:JSON.stringify(n),child_llm_runs:s.filter(u=>u.type==="llm"),child_chain_runs:s.filter(u=>u.type==="chain"),child_tool_runs:s.filter(u=>u.type==="tool")}}else throw new Error(`Unknown run type: ${e.run_type}`);return i}async persistRun(e){let r,n;e.run_type!==void 0?n=await this.convertV2RunToRun(e):n=e,n.type==="llm"?r=`${this.endpoint}/llm-runs`:n.type==="chain"?r=`${this.endpoint}/chain-runs`:r=`${this.endpoint}/tool-runs`;const i=await fetch(r,{method:"POST",headers:this.headers,body:JSON.stringify(n)});i.ok||console.error(`Failed to persist run: ${i.status} ${i.statusText}`)}async persistSession(e){const r=`${this.endpoint}/sessions`,n=await fetch(r,{method:"POST",headers:this.headers,body:JSON.stringify(e)});return n.ok?{id:(await n.json()).id,...e}:(console.error(`Failed to persist session: ${n.status} ${n.statusText}, using default session.`),{id:1,...e})}async _handleSessionResponse(e){const r=await fetch(e,{method:"GET",headers:this.headers});let n;if(!r.ok)return console.error(`Failed to load session: ${r.status} ${r.statusText}`),n={id:1,start_time:Date.now()},this.session=n,n;const i=await r.json();return i.length===0?(n={id:1,start_time:Date.now()},this.session=n,n):([n]=i,this.session=n,n)}}const p4e=Object.freeze(Object.defineProperty({__proto__:null,LangChainTracerV1:MK},Symbol.toStringTag,{value:"Module"}));async function m4e(t){const e=new MK;return t?await e.loadSession(t):await e.loadDefaultSession(),e}async function g4e(){return new Ui}const y4e=Object.freeze(Object.defineProperty({__proto__:null,getTracingCallbackHandler:m4e,getTracingV2CallbackHandler:g4e},Symbol.toStringTag,{value:"Module"}));class DK extends Wi{constructor({exampleId:e}={}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"run_collector"}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracedRuns",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.exampleId=e,this.tracedRuns=[]}async persistRun(e){const r={...e};r.reference_example_id=this.exampleId,this.tracedRuns.push(r)}}const v4e=Object.freeze(Object.defineProperty({__proto__:null,RunCollectorCallbackHandler:DK},Symbol.toStringTag,{value:"Module"})),b4e=Object.freeze(Object.defineProperty({__proto__:null,Validator:F8,deepCompareStrict:pl},Symbol.toStringTag,{value:"Module"}));function LK(t,e){let r=0,n=0,i=0;for(let a=0;a<t.length;a++)r+=t[a]*e[a],n+=t[a]*t[a],i+=e[a]*e[a];return r/(Math.sqrt(n)*Math.sqrt(i))}function w4e(t,e){let r=0;for(let n=0;n<t.length;n++)r+=t[n]*e[n];return r}function _4e(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n]);return r}function x4e(t,e){return Math.sqrt(_4e(t,e))}function zg(t,e,r){if(t.length===0||t[0].length===0||e.length===0||e[0].length===0)return[[]];if(t[0].length!==e[0].length)throw new Error(`Number of columns in X and Y must be the same. X has shape ${[t.length,t[0].length]} and Y has shape ${[e.length,e[0].length]}.`);return t.map(n=>e.map(i=>r(n,i)).map(i=>Number.isNaN(i)?0:i))}function FK(t,e=!1){const r=O4e(t);return t.map(n=>n.map(i=>e?1-i/r:i/r))}function ed(t,e){return zg(t,e,LK)}function gI(t,e){return zg(t,e,w4e)}function yI(t,e){return zg(t,e,x4e)}function vI(t,e,r=.5,n=4){if(Math.min(n,e.length)<=0)return[];const i=Array.isArray(t[0])?t:[t],a=ed(i,e)[0],s=UK(a).maxIndex,o=[e[s]],u=[s];for(;u.length<Math.min(n,e.length);){let l=-1/0,c=-1;const h=ed(e,o);a.forEach((d,f)=>{if(u.includes(f))return;const p=Math.max(...h[f]),m=r*d-(1-r)*p;m>l&&(l=m,c=f)}),o.push(e[c]),u.push(c)}return u}function UK(t){if(t.length===0)return{maxIndex:-1,maxValue:NaN};let e=t[0],r=0;for(let n=1;n<t.length;n+=1)t[n]>e&&(r=n,e=t[n]);return{maxIndex:r,maxValue:e}}function O4e(t){return t.reduce((e,r)=>Math.max(e,UK(r).maxValue),0)}const S4e=Object.freeze(Object.defineProperty({__proto__:null,cosineSimilarity:ed,euclideanDistance:yI,innerProduct:gI,matrixFunc:zg,maximalMarginalRelevance:vI,normalize:FK},Symbol.toStringTag,{value:"Module"}));class gl extends Tu{static lc_name(){return"VectorStoreRetriever"}get lc_namespace(){return["langchain_core","vectorstores"]}_vectorstoreType(){return this.vectorStore._vectorstoreType()}constructor(e){super(e),Object.defineProperty(this,"vectorStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"searchType",{enumerable:!0,configurable:!0,writable:!0,value:"similarity"}),Object.defineProperty(this,"searchKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorStore=e.vectorStore,this.k=e.k??this.k,this.searchType=e.searchType??this.searchType,this.filter=e.filter,e.searchType==="mmr"&&(this.searchKwargs=e.searchKwargs)}async _getRelevantDocuments(e,r){if(this.searchType==="mmr"){if(typeof this.vectorStore.maxMarginalRelevanceSearch!="function")throw new Error(`The vector store backing this retriever, ${this._vectorstoreType()} does not support max marginal relevance search.`);return this.vectorStore.maxMarginalRelevanceSearch(e,{k:this.k,filter:this.filter,...this.searchKwargs},r==null?void 0:r.getChild("vectorstore"))}return this.vectorStore.similaritySearch(e,this.k,this.filter,r==null?void 0:r.getChild("vectorstore"))}async addDocuments(e,r){return this.vectorStore.addDocuments(e,r)}}class g1 extends Or{constructor(e,r){super(r),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","vectorstores",this._vectorstoreType()]}),Object.defineProperty(this,"embeddings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.embeddings=e}async delete(e){throw new Error("Not implemented.")}async similaritySearch(e,r=4,n=void 0,i=void 0){return(await this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),r,n)).map(s=>s[0])}async similaritySearchWithScore(e,r=4,n=void 0,i=void 0){return this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),r,n)}static fromTexts(e,r,n,i){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}static fromDocuments(e,r,n){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}asRetriever(e,r,n,i,a,s){if(typeof e=="number")return new gl({vectorStore:this,k:e,filter:r,tags:[...i??[],this._vectorstoreType()],metadata:a,verbose:s,callbacks:n});{const o={vectorStore:this,k:e==null?void 0:e.k,filter:e==null?void 0:e.filter,tags:[...(e==null?void 0:e.tags)??[],this._vectorstoreType()],metadata:e==null?void 0:e.metadata,verbose:e==null?void 0:e.verbose,callbacks:e==null?void 0:e.callbacks,searchType:e==null?void 0:e.searchType};return(e==null?void 0:e.searchType)==="mmr"?new gl({...o,searchKwargs:e.searchKwargs}):new gl({...o})}}}class P4e extends g1{static load(e,r){throw new Error("Not implemented")}}const E4e=Object.freeze(Object.defineProperty({__proto__:null,SaveableVectorStore:P4e,VectorStore:g1,VectorStoreRetriever:gl},Symbol.toStringTag,{value:"Module"}));class zK extends zr{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["tests","fake"]})}getFormatInstructions(){return""}async parse(e){return e.split(",").map(r=>r.trim())}}class BK extends Je{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["tests","fake"]}),Object.defineProperty(this,"returnOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.returnOptions=e.returnOptions}async invoke(e,r){return this.returnOptions?r??{}:{input:e}}}class qK extends o1{constructor(e){super(e),Object.defineProperty(this,"response",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thrownErrorString",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.response=e.response,this.thrownErrorString=e.thrownErrorString}_llmType(){return"fake"}async _call(e,r,n){if(this.thrownErrorString)throw new Error(this.thrownErrorString);const i=this.response??e;return await(n==null?void 0:n.handleLLMNewToken(i)),i}}class KK extends o1{constructor(e){super(e),Object.defineProperty(this,"sleep",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"responses",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thrownErrorString",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.sleep=e.sleep??this.sleep,this.responses=e.responses,this.thrownErrorString=e.thrownErrorString}_llmType(){return"fake"}async _call(e){var n,i;if(this.thrownErrorString)throw new Error(this.thrownErrorString);const r=(n=this.responses)==null?void 0:n[0];return this.responses=(i=this.responses)==null?void 0:i.slice(1),r??e}async*_streamResponseChunks(e,r,n){var a,s;if(this.thrownErrorString)throw new Error(this.thrownErrorString);const i=(a=this.responses)==null?void 0:a[0];this.responses=(s=this.responses)==null?void 0:s.slice(1);for(const o of i??e)await new Promise(u=>setTimeout(u,this.sleep)),yield{text:o,generationInfo:{}},await(n==null?void 0:n.handleLLMNewToken(o))}}class VK extends xn{_combineLLMOutput(){return[]}_llmType(){return"fake"}async _generate(e,r,n){var a;if((a=r==null?void 0:r.stop)!=null&&a.length)return{generations:[{message:new pt(r.stop[0]),text:r.stop[0]}]};const i=e.map(s=>typeof s.content=="string"?s.content:JSON.stringify(s.content,null,2)).join(`
`);return await(n==null?void 0:n.handleLLMNewToken(i)),{generations:[{message:new pt(i),text:i}],llmOutput:{}}}}class HK extends xn{constructor(e){super(e),Object.defineProperty(this,"sleep",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"responses",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"thrownErrorString",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.sleep=e.sleep??this.sleep,this.responses=e.responses,this.thrownErrorString=e.thrownErrorString}_llmType(){return"fake"}async _generate(e,r,n){var s;if(this.thrownErrorString)throw new Error(this.thrownErrorString);const i=((s=this.responses)==null?void 0:s[0].content)??e[0].content;return{generations:[{text:"",message:new pt({content:i})}]}}async*_streamResponseChunks(e,r,n){var a;if(this.thrownErrorString)throw new Error(this.thrownErrorString);const i=((a=this.responses)==null?void 0:a[0].content)??e[0].content;if(typeof i!="string")for(const s of this.responses??e)yield new Yn({text:"",message:new Mr({content:i})});else for(const s of this.responses??e)yield new Yn({text:i,message:new Mr({content:i})})}}class WK extends Tu{constructor(e){super(),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["test","fake"]}),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:[new rr({pageContent:"foo"}),new rr({pageContent:"bar"})]}),this.output=(e==null?void 0:e.output)??this.output}async _getRelevantDocuments(e){return this.output}}class GK extends xn{static lc_name(){return"FakeListChatModel"}constructor({responses:e,sleep:r,emitCustomEvent:n}){super({}),Object.defineProperty(this,"responses",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"i",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"sleep",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"emitCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.responses=e,this.sleep=r,this.emitCustomEvent=n??this.emitCustomEvent}_combineLLMOutput(){return[]}_llmType(){return"fake-list"}async _generate(e,r,n){var i;if(await this._sleepIfRequested(),r!=null&&r.thrownErrorString)throw new Error(r.thrownErrorString);if(this.emitCustomEvent&&await(n==null?void 0:n.handleCustomEvent("some_test_event",{someval:!0})),(i=r==null?void 0:r.stop)!=null&&i.length)return{generations:[this._formatGeneration(r.stop[0])]};{const a=this._currentResponse();return this._incrementResponse(),{generations:[this._formatGeneration(a)],llmOutput:{}}}}_formatGeneration(e){return{message:new pt(e),text:e}}async*_streamResponseChunks(e,r,n){const i=this._currentResponse();this._incrementResponse(),this.emitCustomEvent&&await(n==null?void 0:n.handleCustomEvent("some_test_event",{someval:!0}));for await(const a of i){if(await this._sleepIfRequested(),r!=null&&r.thrownErrorString)throw new Error(r.thrownErrorString);yield this._createResponseChunk(a),n==null||n.handleLLMNewToken(a)}}async _sleepIfRequested(){this.sleep!==void 0&&await this._sleep()}async _sleep(){return new Promise(e=>{setTimeout(()=>e(),this.sleep)})}_createResponseChunk(e){return new Yn({message:new Mr({content:e}),text:e})}_currentResponse(){return this.responses[this.i]}_incrementResponse(){this.i<this.responses.length-1?this.i+=1:this.i=0}withStructuredOutput(e,r){return Qn.from(async n=>{const i=await this.invoke(n);return JSON.parse(i.content)})}}class YK extends vK{constructor(){super(),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","message","fake"]}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:[]})}async getMessages(){return this.messages}async addMessage(e){this.messages.push(e)}async addUserMessage(e){this.messages.push(new Wt(e))}async addAIChatMessage(e){this.messages.push(new pt(e))}async clear(){this.messages=[]}}class JK extends oI{constructor(){super(),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","message","fake"]}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:[]})}async addMessage(e){this.messages.push(e)}async getMessages(){return this.messages}}class ZK extends Wi{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"fake_tracer"}),Object.defineProperty(this,"runs",{enumerable:!0,configurable:!0,writable:!0,value:[]})}persistRun(e){return this.runs.push(e),Promise.resolve()}}class XK extends Au{constructor(e){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}async _call(e,r){return JSON.stringify(e)}}class QK extends Ld{constructor(e){super(e??{})}embedDocuments(e){return Promise.resolve(e.map(()=>[.1,.2,.3,.4]))}embedQuery(e){return Promise.resolve([.1,.2,.3,.4])}}class eV extends Ld{constructor(e){super(e??{}),Object.defineProperty(this,"vectorSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorSize=(e==null?void 0:e.vectorSize)??4}async embedDocuments(e){return Promise.all(e.map(r=>this.embedQuery(r)))}async embedQuery(e){let r=e;r=r.toLowerCase().replaceAll(/[^a-z ]/g,"");const n=r.length%this.vectorSize,i=n===0?0:this.vectorSize-n,a=r.length+i;r=r.padEnd(a," ");const s=r.length/this.vectorSize,o=[];for(let l=0;l<r.length;l+=s)o.push(r.slice(l,l+s));return o.map(l=>{let c=0;for(let d=0;d<l.length;d+=1)c+=l===" "?0:l.charCodeAt(d);return c%26/26})}}let tV=class extends Wi{constructor(){super(),Object.defineProperty(this,"runPromiseResolver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"single_run_extractor"}),this.runPromise=new Promise(e=>{this.runPromiseResolver=e})}async persistRun(e){this.runPromiseResolver(e)}async extract(){return this.runPromise}};class y1 extends g1{_vectorstoreType(){return"memory"}constructor(e,{similarity:r,...n}={}){super(e,n),Object.defineProperty(this,"memoryVectors",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"similarity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.similarity=r??LK}async addDocuments(e){const r=e.map(({pageContent:n})=>n);return this.addVectors(await this.embeddings.embedDocuments(r),e)}async addVectors(e,r){const n=e.map((i,a)=>({content:r[a].pageContent,embedding:i,metadata:r[a].metadata}));this.memoryVectors=this.memoryVectors.concat(n)}async similaritySearchVectorWithScore(e,r,n){const i=u=>{if(!n)return!0;const l=new rr({metadata:u.metadata,pageContent:u.content});return n(l)},a=this.memoryVectors.filter(i);return a.map((u,l)=>({similarity:this.similarity(e,u.embedding),index:l})).sort((u,l)=>u.similarity>l.similarity?-1:0).slice(0,r).map(u=>[new rr({metadata:a[u.index].metadata,pageContent:a[u.index].content}),u.similarity])}static async fromTexts(e,r,n,i){const a=[];for(let s=0;s<e.length;s+=1){const o=Array.isArray(r)?r[s]:r,u=new rr({pageContent:e[s],metadata:o});a.push(u)}return y1.fromDocuments(a,n,i)}static async fromDocuments(e,r,n){const i=new this(r,n);return await i.addDocuments(e),i}static async fromExistingIndex(e,r){return new this(e,r)}}const A4e=Object.freeze(Object.defineProperty({__proto__:null,FakeChatMessageHistory:YK,FakeChatModel:VK,FakeEmbeddings:QK,FakeLLM:qK,FakeListChatMessageHistory:JK,FakeListChatModel:GK,FakeRetriever:WK,FakeRunnable:BK,FakeSplitIntoListParser:zK,FakeStreamingChatModel:HK,FakeStreamingLLM:KK,FakeTool:XK,FakeTracer:ZK,FakeVectorStore:y1,SingleRunExtractor:tV,SyntheticEmbeddings:eV},Symbol.toStringTag,{value:"Module"})),T4e=Object.freeze(Object.defineProperty({__proto__:null,agents:c4e,caches:uDe,callbacks__base:tje,callbacks__manager:B2e,callbacks__promises:L2e,chat_history:w5e,documents:h4e,embeddings:eLe,example_selectors:C3e,language_models__base:TDe,language_models__chat_models:IDe,language_models__llms:rLe,load__serializable:gIe,memory:b5e,messages:tDe,output_parsers:TFe,outputs:Y2e,prompt_values:lDe,prompts:y3e,retrievers:d4e,runnables:CLe,stores:f4e,tools:UFe,tracers__base:ije,tracers__console:N2e,tracers__initialize:y4e,tracers__log_stream:G2e,tracers__run_collector:v4e,tracers__tracer_langchain:M2e,tracers__tracer_langchain_v1:p4e,utils__async_caller:eMe,utils__chunk_array:CFe,utils__env:Q$e,utils__function_calling:QDe,utils__hash:iDe,utils__json_patch:OFe,utils__json_schema:b4e,utils__math:S4e,utils__stream:H2e,utils__testing:A4e,utils__tiktoken:EDe,utils__types:ILe,vectorstores:E4e},Symbol.toStringTag,{value:"Module"}));function k4e(t){const e={};for(let r=t;r&&r.prototype;r=Object.getPrototypeOf(r))Object.assign(e,Reflect.get(r.prototype,"lc_aliases"));return Object.entries(e).reduce((r,[n,i])=>(r[i]=n,r),{})}async function wv(t){const{optionalImportsMap:e={},optionalImportEntrypoints:r=[],importMap:n={},secretsMap:i={},path:a=["$"]}=this,s=a.join(".");if(typeof t=="object"&&t!==null&&!Array.isArray(t)&&"lc"in t&&"type"in t&&"id"in t&&t.lc===1&&t.type==="secret"){const o=t,[u]=o.id;if(u in i)return i[u];{const l=Me(u);if(l)return l;throw new Error(`Missing key "${u}" for ${s} in load(secretsMap={})`)}}else if(typeof t=="object"&&t!==null&&!Array.isArray(t)&&"lc"in t&&"type"in t&&"id"in t&&t.lc===1&&t.type==="not_implemented"){const u=JSON.stringify(t);throw new Error(`Trying to load an object that doesn't implement serialization: ${s} -> ${u}`)}else if(typeof t=="object"&&t!==null&&!Array.isArray(t)&&"lc"in t&&"type"in t&&"id"in t&&"kwargs"in t&&t.lc===1){const o=t,u=JSON.stringify(o),[l,...c]=o.id.slice().reverse(),h=c.reverse(),d={langchain_core:T4e,langchain:n};let f=null;const p=[h.join("/")];h[0]==="langchain_community"&&p.push(["langchain",...h.slice(1)].join("/"));const m=p.find(y=>y in e);if(l4e.concat(r).includes(h.join("/"))||m)if(m!==void 0)f=await e[m];else throw new Error(`Missing key "${h.join("/")}" for ${s} in load(optionalImportsMap={})`);else{let y;if(h[0]==="langchain"||h[0]==="langchain_core")y=d[h[0]],h.shift();else throw new Error(`Invalid namespace: ${s} -> ${u}`);if(h.length===0)throw new Error(`Invalid namespace: ${s} -> ${u}`);let b;do{if(b=h.join("__"),b in y)break;h.pop()}while(h.length>0);b in y&&(f=y[b])}if(typeof f!="object"||f===null)throw new Error(`Invalid namespace: ${s} -> ${u}`);const g=f[l]??Object.values(f).find(y=>typeof y=="function"&&U_(y)===l);if(typeof g!="function")throw new Error(`Invalid identifer: ${s} -> ${u}`);const v=await wv.call({...this,path:[...a,"kwargs"]},o.kwargs);if(o.type==="constructor"){const y=new g(h6(v,pIe,k4e(g)));return Object.defineProperty(y.constructor,"name",{value:l}),y}else throw new Error(`Invalid type: ${s} -> ${u}`)}else if(typeof t=="object"&&t!==null)return Array.isArray(t)?Promise.all(t.map((o,u)=>wv.call({...this,path:[...a,`${u}`]},o))):Object.fromEntries(await Promise.all(Object.entries(t).map(async([o,u])=>[o,await wv.call({...this,path:[...a,o]},u)])));return t}async function C4e(t,e){const r=JSON.parse(t);return wv.call({...e},r)}const I4e=["langchain/agents/load","langchain/agents/toolkits/sql","langchain/tools/sql","langchain/tools/webbrowser","langchain/chains/load","langchain/chains/query_constructor","langchain/chains/query_constructor/ir","langchain/chains/sql_db","langchain/chains/graph_qa/cypher","langchain/chat_models/universal","langchain/document_loaders/web/apify_dataset","langchain/document_loaders/web/assemblyai","langchain/document_loaders/web/azure_blob_storage_container","langchain/document_loaders/web/azure_blob_storage_file","langchain/document_loaders/web/browserbase","langchain/document_loaders/web/cheerio","langchain/document_loaders/web/puppeteer","langchain/document_loaders/web/playwright","langchain/document_loaders/web/college_confidential","langchain/document_loaders/web/gitbook","langchain/document_loaders/web/hn","langchain/document_loaders/web/imsdb","langchain/document_loaders/web/figma","langchain/document_loaders/web/firecrawl","langchain/document_loaders/web/github","langchain/document_loaders/web/notiondb","langchain/document_loaders/web/notionapi","langchain/document_loaders/web/pdf","langchain/document_loaders/web/recursive_url","langchain/document_loaders/web/s3","langchain/document_loaders/web/sitemap","langchain/document_loaders/web/sonix_audio","langchain/document_loaders/web/confluence","langchain/document_loaders/web/couchbase","langchain/document_loaders/web/youtube","langchain/document_loaders/fs/directory","langchain/document_loaders/fs/multi_file","langchain/document_loaders/fs/buffer","langchain/document_loaders/fs/chatgpt","langchain/document_loaders/fs/text","langchain/document_loaders/fs/json","langchain/document_loaders/fs/srt","langchain/document_loaders/fs/pdf","langchain/document_loaders/fs/docx","langchain/document_loaders/fs/epub","langchain/document_loaders/fs/csv","langchain/document_loaders/fs/notion","langchain/document_loaders/fs/obsidian","langchain/document_loaders/fs/unstructured","langchain/document_loaders/fs/openai_whisper_audio","langchain/document_loaders/fs/pptx","langchain/sql_db","langchain/output_parsers/expression","langchain/retrievers/self_query","langchain/retrievers/self_query/functional","langchain/cache/file_system","langchain/stores/file/node","langchain/storage/file_system","langchain/hub","langchain/experimental/prompts/handlebars","langchain/experimental/tools/pyinterpreter"];function $4e(t,e="{observation}"){const n=[...e.matchAll(/{([^}]*)}/g)].map(a=>a[1]);if(n.length>1)throw new Error(`templateToolResponse must contain one input variable: ${e}`);const i=[];for(const a of t)i.push(new pt(a.action.log)),i.push(new Wt(_r(e,"f-string",{[n[0]]:a.observation})));return i}const j4e=Object.freeze(Object.defineProperty({__proto__:null,formatLogToMessage:$4e},Symbol.toStringTag,{value:"Module"}));class rV extends $g{static lc_name(){return"ChainTool"}constructor({chain:e,...r}){super({...r,func:async(n,i)=>e.run(n,i==null?void 0:i.getChild())}),Object.defineProperty(this,"chain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chain=e}}const R4e=Object.freeze(Object.defineProperty({__proto__:null,ChainTool:rV},Symbol.toStringTag,{value:"Module"}));class N4e extends Au{static lc_name(){return"ReadFileTool"}constructor({store:e}){super(...arguments),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:tt.object({file_path:tt.string().describe("name of file")})}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"read_file"}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:"Read file from disk"}),Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.store=e}async _call({file_path:e}){return await this.store.readFile(e)}}class M4e extends Au{static lc_name(){return"WriteFileTool"}constructor({store:e,...r}){super(r),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:tt.object({file_path:tt.string().describe("name of file"),text:tt.string().describe("text to write to file")})}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"write_file"}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:"Write file from disk"}),Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.store=e}async _call({file_path:e,text:r}){return await this.store.writeFile(e,r),"File written to successfully."}}const D4e=Object.freeze(Object.defineProperty({__proto__:null,ChainTool:rV,DynamicStructuredTool:jg,DynamicTool:$g,JsonGetValueTool:J8,JsonListKeysTool:Y8,JsonSpec:HFe,ReadFileTool:N4e,RequestsGetTool:aK,RequestsPostTool:sK,StructuredTool:Au,Tool:xs,VectorStoreQATool:Wm,WriteFileTool:M4e,formatToOpenAIFunction:Dd,formatToOpenAITool:VC},Symbol.toStringTag,{value:"Module"}));function L4e(t,e){const r=async({query:i},a)=>{const s=await t.getRelevantDocuments(i,a==null?void 0:a.getChild("retriever"));return f1(s)},n=tt.object({query:tt.string().describe("query to look up in retriever")});return new jg({...e,func:r,schema:n})}const F4e=Object.freeze(Object.defineProperty({__proto__:null,createRetrieverTool:L4e},Symbol.toStringTag,{value:"Module"})),nV=`You are given the below API Documentation:
{api_docs}
Using this documentation, generate the full API url to call for answering the user question.
You should build the API url in order to get a response that is as short as possible, while still getting the necessary information to answer the question. Pay attention to deliberately exclude any unnecessary pieces of data in the API call.

Question:{question}
API url:`,U4e=new ve({inputVariables:["api_docs","question"],template:nV}),z4e=`${nV} {api_url}

Here is the response from the API:

{api_response}

Summarize this response to answer the original question.

Summary:`,B4e=new ve({inputVariables:["api_docs","question","api_url","api_response"],template:z4e});class v1 extends st{get inputKeys(){return[this.inputKey]}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"apiAnswerChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiRequestChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiDocs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"question"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output"}),this.apiRequestChain=e.apiRequestChain,this.apiAnswerChain=e.apiAnswerChain,this.apiDocs=e.apiDocs,this.inputKey=e.inputKey??this.inputKey,this.outputKey=e.outputKey??this.outputKey,this.headers=e.headers??this.headers}async _call(e,r){const n=e[this.inputKey],i=await this.apiRequestChain.predict({question:n,api_docs:this.apiDocs},r==null?void 0:r.getChild("request")),s=await(await fetch(i,{headers:this.headers})).text(),o=await this.apiAnswerChain.predict({question:n,api_docs:this.apiDocs,api_url:i,api_response:s},r==null?void 0:r.getChild("response"));return{[this.outputKey]:o}}_chainType(){return"api_chain"}static async deserialize(e){const{api_request_chain:r,api_answer_chain:n,api_docs:i}=e;if(!r)throw new Error("LLMChain must have api_request_chain");if(!n)throw new Error("LLMChain must have api_answer_chain");if(!i)throw new Error("LLMChain must have api_docs");return new v1({apiAnswerChain:await Pe.deserialize(n),apiRequestChain:await Pe.deserialize(r),apiDocs:i})}serialize(){return{_type:this._chainType(),api_answer_chain:this.apiAnswerChain.serialize(),api_request_chain:this.apiRequestChain.serialize(),api_docs:this.apiDocs}}static fromLLMAndAPIDocs(e,r,n={}){const{apiUrlPrompt:i=U4e,apiResponsePrompt:a=B4e}=n,s=new Pe({prompt:i,llm:e}),o=new Pe({prompt:a,llm:e});return new this({apiAnswerChain:o,apiRequestChain:s,apiDocs:r,...n})}}const q4e=Object.freeze(Object.defineProperty({__proto__:null,APIChain:v1},Symbol.toStringTag,{value:"Module"})),iV=`The following is a friendly conversation between a human and an AI. The AI is talkative and provides lots of specific details from its context. If the AI does not know the answer to a question, it truthfully says it does not know.

Current conversation:
{history}
Human: {input}
AI:`;class bI extends Pe{static lc_name(){return"ConversationChain"}constructor({prompt:e,outputKey:r,memory:n,...i}){super({prompt:e??new ve({template:iV,inputVariables:["history","input"]}),outputKey:r??"response",memory:n??new jw,...i})}}function xF(t,e){const r=new Set;for(const n of e)t.has(n)&&r.add(n);return r}function K4e(t,e){const r=new Set(t);for(const n of e)r.add(n);return r}function qy(t,e){const r=new Set(t);for(const n of e)r.delete(n);return r}function Af(t){return Array.from(t).map(e=>`"${e}"`).join(", ")}class Bg extends st{static lc_name(){return"SequentialChain"}get inputKeys(){return this.inputVariables}get outputKeys(){return this.outputVariables}constructor(e){if(super(e),Object.defineProperty(this,"chains",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnAll",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chains=e.chains,this.inputVariables=e.inputVariables,this.outputVariables=e.outputVariables??[],this.outputVariables.length>0&&e.returnAll)throw new Error("Either specify variables to return using `outputVariables` or use `returnAll` param. Cannot apply both conditions at the same time.");this.returnAll=e.returnAll??!1,this._validateChains()}_validateChains(){var s;if(this.chains.length===0)throw new Error("Sequential chain must have at least one chain.");const e=((s=this.memory)==null?void 0:s.memoryKeys)??[],r=new Set(this.inputKeys),n=new Set(e),i=xF(r,n);if(i.size>0)throw new Error(`The following keys: ${Af(i)} are overlapping between memory and input keys of the chain variables. This can lead to unexpected behaviour. Please use input and memory keys that don't overlap.`);const a=K4e(r,n);for(const o of this.chains){let u=qy(new Set(o.inputKeys),a);if(o.memory&&(u=qy(u,new Set(o.memory.memoryKeys))),u.size>0)throw new Error(`Missing variables for chain "${o._chainType()}": ${Af(u)}. Only got the following variables: ${Af(a)}.`);const l=new Set(o.outputKeys),c=xF(a,l);if(c.size>0)throw new Error(`The following output variables for chain "${o._chainType()}" are overlapping: ${Af(c)}. This can lead to unexpected behaviour.`);for(const h of l)a.add(h)}if(this.outputVariables.length===0)if(this.returnAll){const o=qy(a,r);this.outputVariables=Array.from(o)}else this.outputVariables=this.chains[this.chains.length-1].outputKeys;else{const o=qy(new Set(this.outputVariables),new Set(a));if(o.size>0)throw new Error(`The following output variables were expected to be in the final chain output but were not found: ${Af(o)}.`)}}async _call(e,r){let n={};const i=e;let a=0;for(const o of this.chains){a+=1,n=await o.call(i,r==null?void 0:r.getChild(`step_${a}`));for(const u of Object.keys(n))i[u]=n[u]}const s={};for(const o of this.outputVariables)s[o]=i[o];return s}_chainType(){return"sequential_chain"}static async deserialize(e){const r=[],n=e.input_variables,i=e.output_variables,a=e.chains;for(const s of a){const o=await st.deserialize(s);r.push(o)}return new Bg({chains:r,inputVariables:n,outputVariables:i})}serialize(){const e=[];for(const r of this.chains)e.push(r.serialize());return{_type:this._chainType(),input_variables:this.inputVariables,output_variables:this.outputVariables,chains:e}}}class b1 extends st{static lc_name(){return"SimpleSequentialChain"}get inputKeys(){return[this.inputKey]}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"chains",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output"}),Object.defineProperty(this,"trimOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chains=e.chains,this.trimOutputs=e.trimOutputs??!1,this._validateChains()}_validateChains(){for(const e of this.chains){if(e.inputKeys.filter(r=>{var n;return!((n=e.memory)!=null&&n.memoryKeys.includes(r))}).length!==1)throw new Error(`Chains used in SimpleSequentialChain should all have one input, got ${e.inputKeys.length} for ${e._chainType()}.`);if(e.outputKeys.length!==1)throw new Error(`Chains used in SimpleSequentialChain should all have one output, got ${e.outputKeys.length} for ${e._chainType()}.`)}}async _call(e,r){let n=e[this.inputKey],i=0;for(const a of this.chains)i+=1,n=(await a.call({[a.inputKeys[0]]:n,signal:e.signal},r==null?void 0:r.getChild(`step_${i}`)))[a.outputKeys[0]],this.trimOutputs&&(n=n.trim()),await(r==null?void 0:r.handleText(n));return{[this.outputKey]:n}}_chainType(){return"simple_sequential_chain"}static async deserialize(e){const r=[],n=e.chains;for(const i of n){const a=await st.deserialize(i);r.push(a)}return new b1({chains:r})}serialize(){const e=[];for(const r of this.chains)e.push(r.serialize());return{_type:this._chainType(),chains:e}}}const OF=Object.freeze(Object.defineProperty({__proto__:null,SequentialChain:Bg,SimpleSequentialChain:b1},Symbol.toStringTag,{value:"Module"})),V4e=`Given the following conversation and a follow up question, rephrase the follow up question to be a standalone question.

Chat History:
{chat_history}
Follow Up Input: {question}
Standalone question:`,H4e=`Use the following pieces of context to answer the question at the end. If you don't know the answer, just say that you don't know, don't try to make up an answer.

{context}

Question: {question}
Helpful Answer:`;class wI extends st{get inputKeys(){return[this.inputKey,this.chatHistoryKey]}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"question"}),Object.defineProperty(this,"chatHistoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"chat_history"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"result"}),Object.defineProperty(this,"vectorstore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"combineDocumentsChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"questionGeneratorChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSourceDocuments",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.vectorstore=e.vectorstore,this.combineDocumentsChain=e.combineDocumentsChain,this.questionGeneratorChain=e.questionGeneratorChain,this.inputKey=e.inputKey??this.inputKey,this.outputKey=e.outputKey??this.outputKey,this.k=e.k??this.k,this.returnSourceDocuments=e.returnSourceDocuments??this.returnSourceDocuments}async _call(e,r){if(!(this.inputKey in e))throw new Error(`Question key ${this.inputKey} not found.`);if(!(this.chatHistoryKey in e))throw new Error(`chat history key ${this.inputKey} not found.`);const n=e[this.inputKey],i=e[this.chatHistoryKey];let a=n;if(i.length>0){const l=await this.questionGeneratorChain.call({question:n,chat_history:i},r==null?void 0:r.getChild("question_generator")),c=Object.keys(l);if(console.log("_call",e,c),c.length===1)a=l[c[0]];else throw new Error("Return from llm chain has multiple values, only single values supported.")}const s=await this.vectorstore.similaritySearch(a,this.k,void 0,r==null?void 0:r.getChild("vectorstore")),o={question:a,input_documents:s,chat_history:i},u=await this.combineDocumentsChain.call(o,r==null?void 0:r.getChild("combine_documents"));return this.returnSourceDocuments?{...u,sourceDocuments:s}:u}_chainType(){return"chat-vector-db"}static async deserialize(e,r){if(!("vectorstore"in r))throw new Error("Need to pass in a vectorstore to deserialize VectorDBQAChain");const{vectorstore:n}=r;return new wI({combineDocumentsChain:await st.deserialize(e.combine_documents_chain),questionGeneratorChain:await Pe.deserialize(e.question_generator),k:e.k,vectorstore:n})}serialize(){return{_type:this._chainType(),combine_documents_chain:this.combineDocumentsChain.serialize(),question_generator:this.questionGeneratorChain.serialize(),k:this.k}}static fromLLM(e,r,n={}){const{questionGeneratorTemplate:i,qaTemplate:a,verbose:s,...o}=n,u=ve.fromTemplate(i||V4e),l=ve.fromTemplate(a||H4e),c=Mg(e,{prompt:l,verbose:s}),h=new Pe({prompt:u,llm:e,verbose:s});return new this({vectorstore:r,combineDocumentsChain:c,questionGeneratorChain:h,...o})}}class w1 extends pI{constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","document_transformers","text_splitters"]}),Object.defineProperty(this,"chunkSize",{enumerable:!0,configurable:!0,writable:!0,value:1e3}),Object.defineProperty(this,"chunkOverlap",{enumerable:!0,configurable:!0,writable:!0,value:200}),Object.defineProperty(this,"keepSeparator",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lengthFunction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chunkSize=(e==null?void 0:e.chunkSize)??this.chunkSize,this.chunkOverlap=(e==null?void 0:e.chunkOverlap)??this.chunkOverlap,this.keepSeparator=(e==null?void 0:e.keepSeparator)??this.keepSeparator,this.lengthFunction=(e==null?void 0:e.lengthFunction)??(r=>r.length),this.chunkOverlap>=this.chunkSize)throw new Error("Cannot have chunkOverlap >= chunkSize")}async transformDocuments(e,r={}){return this.splitDocuments(e,r)}splitOnSeparator(e,r){let n;if(r)if(this.keepSeparator){const i=r.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&");n=e.split(new RegExp(`(?=${i})`))}else n=e.split(r);else n=e.split("");return n.filter(i=>i!=="")}async createDocuments(e,r=[],n={}){const i=r.length>0?r:[...Array(e.length)].map(()=>({})),{chunkHeader:a="",chunkOverlapHeader:s="(cont'd) ",appendChunkOverlapHeader:o=!1}=n,u=new Array;for(let l=0;l<e.length;l+=1){const c=e[l];let h=1,d=null,f=-1;for(const p of await this.splitText(c)){let m=a;const g=c.indexOf(p,f+1);if(d===null){const w=this.numberOfNewLines(c,0,g);h+=w}else{const w=f+await this.lengthFunction(d);if(w<g){const _=this.numberOfNewLines(c,w,g);h+=_}else if(w>g){const _=this.numberOfNewLines(c,g,w);h-=_}o&&(m+=s)}const v=this.numberOfNewLines(p),y=i[l].loc&&typeof i[l].loc=="object"?{...i[l].loc}:{};y.lines={from:h,to:h+v};const b={...i[l],loc:y};m+=p,u.push(new rr({pageContent:m,metadata:b})),h+=v,d=p,f=g}}return u}numberOfNewLines(e,r,n){return(e.slice(r,n).match(/\n/g)||[]).length}async splitDocuments(e,r={}){const n=e.filter(s=>s.pageContent!==void 0),i=n.map(s=>s.pageContent),a=n.map(s=>s.metadata);return this.createDocuments(i,a,r)}joinDocs(e,r){const n=e.join(r).trim();return n===""?null:n}async mergeSplits(e,r){const n=[],i=[];let a=0;for(const o of e){const u=await this.lengthFunction(o);if(a+u+i.length*r.length>this.chunkSize&&(a>this.chunkSize&&console.warn(`Created a chunk of size ${a}, +
which is longer than the specified ${this.chunkSize}`),i.length>0)){const l=this.joinDocs(i,r);for(l!==null&&n.push(l);a>this.chunkOverlap||a+u+i.length*r.length>this.chunkSize&&a>0;)a-=await this.lengthFunction(i[0]),i.shift()}i.push(o),a+=u}const s=this.joinDocs(i,r);return s!==null&&n.push(s),n}}class aV extends w1{static lc_name(){return"CharacterTextSplitter"}constructor(e){super(e),Object.defineProperty(this,"separator",{enumerable:!0,configurable:!0,writable:!0,value:`

`}),this.separator=(e==null?void 0:e.separator)??this.separator}async splitText(e){const r=this.splitOnSeparator(e,this.separator);return this.mergeSplits(r,this.keepSeparator?"":this.separator)}}const W4e=["cpp","go","java","js","php","proto","python","rst","ruby","rust","scala","swift","markdown","latex","html","sol"];class ao extends w1{static lc_name(){return"RecursiveCharacterTextSplitter"}constructor(e){super(e),Object.defineProperty(this,"separators",{enumerable:!0,configurable:!0,writable:!0,value:[`

`,`
`," ",""]}),this.separators=(e==null?void 0:e.separators)??this.separators,this.keepSeparator=(e==null?void 0:e.keepSeparator)??!0}async _splitText(e,r){const n=[];let i=r[r.length-1],a;for(let l=0;l<r.length;l+=1){const c=r[l];if(c===""){i=c;break}if(e.includes(c)){i=c,a=r.slice(l+1);break}}const s=this.splitOnSeparator(e,i);let o=[];const u=this.keepSeparator?"":i;for(const l of s)if(await this.lengthFunction(l)<this.chunkSize)o.push(l);else{if(o.length){const c=await this.mergeSplits(o,u);n.push(...c),o=[]}if(!a)n.push(l);else{const c=await this._splitText(l,a);n.push(...c)}}if(o.length){const l=await this.mergeSplits(o,u);n.push(...l)}return n}async splitText(e){return this._splitText(e,this.separators)}static fromLanguage(e,r){return new ao({...r,separators:ao.getSeparatorsForLanguage(e)})}static getSeparatorsForLanguage(e){if(e==="cpp")return[`
class `,`
void `,`
int `,`
float `,`
double `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="go")return[`
func `,`
var `,`
const `,`
type `,`
if `,`
for `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="java")return[`
class `,`
public `,`
protected `,`
private `,`
static `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="js")return[`
function `,`
const `,`
let `,`
var `,`
class `,`
if `,`
for `,`
while `,`
switch `,`
case `,`
default `,`

`,`
`," ",""];if(e==="php")return[`
function `,`
class `,`
if `,`
foreach `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="proto")return[`
message `,`
service `,`
enum `,`
option `,`
import `,`
syntax `,`

`,`
`," ",""];if(e==="python")return[`
class `,`
def `,`
	def `,`

`,`
`," ",""];if(e==="rst")return[`
===
`,`
---
`,`
***
`,`
.. `,`

`,`
`," ",""];if(e==="ruby")return[`
def `,`
class `,`
if `,`
unless `,`
while `,`
for `,`
do `,`
begin `,`
rescue `,`

`,`
`," ",""];if(e==="rust")return[`
fn `,`
const `,`
let `,`
if `,`
while `,`
for `,`
loop `,`
match `,`
const `,`

`,`
`," ",""];if(e==="scala")return[`
class `,`
object `,`
def `,`
val `,`
var `,`
if `,`
for `,`
while `,`
match `,`
case `,`

`,`
`," ",""];if(e==="swift")return[`
func `,`
class `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="markdown")return[`
## `,`
### `,`
#### `,`
##### `,`
###### `,"```\n\n",`

***

`,`

---

`,`

___

`,`

`,`
`," ",""];if(e==="latex")return[`
\\chapter{`,`
\\section{`,`
\\subsection{`,`
\\subsubsection{`,`
\\begin{enumerate}`,`
\\begin{itemize}`,`
\\begin{description}`,`
\\begin{list}`,`
\\begin{quote}`,`
\\begin{quotation}`,`
\\begin{verse}`,`
\\begin{verbatim}`,`
\\begin{align}`,"$$","$",`

`,`
`," ",""];if(e==="html")return["<body>","<div>","<p>","<br>","<li>","<h1>","<h2>","<h3>","<h4>","<h5>","<h6>","<span>","<table>","<tr>","<td>","<th>","<ul>","<ol>","<header>","<footer>","<nav>","<head>","<style>","<script>","<meta>","<title>"," ",""];if(e==="sol")return[`
pragma `,`
using `,`
contract `,`
interface `,`
library `,`
constructor `,`
type `,`
function `,`
event `,`
modifier `,`
error `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do while `,`
assembly `,`

`,`
`," ",""];throw new Error(`Language ${e} is not supported.`)}}class sV extends w1{static lc_name(){return"TokenTextSplitter"}constructor(e){super(e),Object.defineProperty(this,"encodingName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"allowedSpecial",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"disallowedSpecial",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tokenizer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.encodingName=(e==null?void 0:e.encodingName)??"gpt2",this.allowedSpecial=(e==null?void 0:e.allowedSpecial)??[],this.disallowedSpecial=(e==null?void 0:e.disallowedSpecial)??"all"}async splitText(e){this.tokenizer||(this.tokenizer=await DC(this.encodingName));const r=[],n=this.tokenizer.encode(e,this.allowedSpecial,this.disallowedSpecial);let i=0;for(;i<n.length;){i>0&&(i-=this.chunkOverlap);const a=Math.min(i+this.chunkSize,n.length),s=n.slice(i,a);r.push(this.tokenizer.decode(s)),i=a}return r}}class G4e extends ao{constructor(e){super({...e,separators:ao.getSeparatorsForLanguage("markdown")})}}class Y4e extends ao{constructor(e){super({...e,separators:ao.getSeparatorsForLanguage("latex")})}}const J4e=Object.freeze(Object.defineProperty({__proto__:null,CharacterTextSplitter:aV,LatexTextSplitter:Y4e,MarkdownTextSplitter:G4e,RecursiveCharacterTextSplitter:ao,SupportedTextSplitterLanguages:W4e,TextSplitter:w1,TokenTextSplitter:sV},Symbol.toStringTag,{value:"Module"}));class _I extends st{static lc_name(){return"AnalyzeDocumentChain"}constructor(e){super(e),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_document"}),Object.defineProperty(this,"combineDocumentsChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textSplitter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.combineDocumentsChain=e.combineDocumentsChain,this.inputKey=e.inputKey??this.inputKey,this.textSplitter=e.textSplitter??new ao}get inputKeys(){return[this.inputKey]}get outputKeys(){return this.combineDocumentsChain.outputKeys}async _call(e,r){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:n,...i}=e,a=n,o={input_documents:await this.textSplitter.createDocuments([a]),...i};return await this.combineDocumentsChain.call(o,r==null?void 0:r.getChild("combine_documents"))}_chainType(){return"analyze_document_chain"}static async deserialize(e,r){if(!("text_splitter"in r))throw new Error("Need to pass in a text_splitter to deserialize AnalyzeDocumentChain.");const{text_splitter:n}=r;if(!e.combine_document_chain)throw new Error("Need to pass in a combine_document_chain to deserialize AnalyzeDocumentChain.");return new _I({combineDocumentsChain:await st.deserialize(e.combine_document_chain),textSplitter:n})}serialize(){return{_type:this._chainType(),combine_document_chain:this.combineDocumentsChain.serialize()}}}const Z4e=`Write a concise summary of the following:


"{text}"


CONCISE SUMMARY:`,Ky=new ve({template:Z4e,inputVariables:["text"]}),X4e=`Your job is to produce a final summary
We have provided an existing summary up to a certain point: "{existing_answer}"
We have the opportunity to refine the existing summary
(only if needed) with some more context below.
------------
"{text}"
------------

Given the new context, refine the original summary
If the context isn't useful, return the original summary.

REFINED SUMMARY:`,Q4e=new ve({template:X4e,inputVariables:["existing_answer","text"]}),eUe=(t,e={type:"map_reduce"})=>{const{verbose:r}=e;if(e.type==="stuff"){const{prompt:n=Ky}=e,i=new Pe({prompt:n,llm:t,verbose:r});return new io({llmChain:i,documentVariableName:"text",verbose:r})}if(e.type==="map_reduce"){const{combineMapPrompt:n=Ky,combinePrompt:i=Ky,combineLLM:a,returnIntermediateSteps:s}=e,o=new Pe({prompt:n,llm:t,verbose:r}),u=new Pe({prompt:i,llm:a??t,verbose:r}),l=new io({llmChain:u,documentVariableName:"text",verbose:r});return new Hd({llmChain:o,combineDocumentChain:l,documentVariableName:"text",returnIntermediateSteps:s,verbose:r})}if(e.type==="refine"){const{refinePrompt:n=Q4e,refineLLM:i,questionPrompt:a=Ky}=e,s=new Pe({prompt:a,llm:t,verbose:r}),o=new Pe({prompt:n,llm:i??t,verbose:r});return new Wd({llmChain:s,refineLLMChain:o,documentVariableName:"text",verbose:r})}throw new Error(`Invalid _type: ${e.type}`)},tUe=`Given the following conversation and a follow up question, rephrase the follow up question to be a standalone question.

Chat History:
{chat_history}
Follow Up Input: {question}
Standalone question:`;class xI extends st{static lc_name(){return"ConversationalRetrievalQAChain"}get inputKeys(){return[this.inputKey,this.chatHistoryKey]}get outputKeys(){return this.combineDocumentsChain.outputKeys.concat(this.returnSourceDocuments?["sourceDocuments"]:[])}constructor(e){super(e),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"question"}),Object.defineProperty(this,"chatHistoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"chat_history"}),Object.defineProperty(this,"retriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"combineDocumentsChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"questionGeneratorChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSourceDocuments",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"returnGeneratedQuestion",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.retriever=e.retriever,this.combineDocumentsChain=e.combineDocumentsChain,this.questionGeneratorChain=e.questionGeneratorChain,this.inputKey=e.inputKey??this.inputKey,this.returnSourceDocuments=e.returnSourceDocuments??this.returnSourceDocuments,this.returnGeneratedQuestion=e.returnGeneratedQuestion??this.returnGeneratedQuestion}static getChatHistoryString(e){let r;return Array.isArray(e)?(Array.isArray(e[0])&&typeof e[0][0]=="string"?(console.warn(`Passing chat history as an array of strings is deprecated.
Please see https://js.langchain.com/docs/modules/chains/popular/chat_vector_db#externally-managed-memory for more information.`),r=e.flat().map((n,i)=>i%2===0?new Wt(n):new pt(n))):r=e,r.map(n=>n._getType()==="human"?`Human: ${n.content}`:n._getType()==="ai"?`Assistant: ${n.content}`:`${n.content}`).join(`
`)):e}async _call(e,r){if(!(this.inputKey in e))throw new Error(`Question key ${this.inputKey} not found.`);if(!(this.chatHistoryKey in e))throw new Error(`Chat history key ${this.chatHistoryKey} not found.`);const n=e[this.inputKey],i=xI.getChatHistoryString(e[this.chatHistoryKey]);let a=n;if(i.length>0){const l=await this.questionGeneratorChain.call({question:n,chat_history:i},r==null?void 0:r.getChild("question_generator")),c=Object.keys(l);if(c.length===1)a=l[c[0]];else throw new Error("Return from llm chain has multiple values, only single values supported.")}const s=await this.retriever.getRelevantDocuments(a,r==null?void 0:r.getChild("retriever")),o={question:a,input_documents:s,chat_history:i};let u=await this.combineDocumentsChain.call(o,r==null?void 0:r.getChild("combine_documents"));return this.returnSourceDocuments&&(u={...u,sourceDocuments:s}),this.returnGeneratedQuestion&&(u={...u,generatedQuestion:a}),u}_chainType(){return"conversational_retrieval_chain"}static async deserialize(e,r){throw new Error("Not implemented.")}serialize(){throw new Error("Not implemented.")}static fromLLM(e,r,n={}){const{questionGeneratorTemplate:i,qaTemplate:a,qaChainOptions:s={type:"stuff",prompt:a?ve.fromTemplate(a):void 0},questionGeneratorChainOptions:o,verbose:u,...l}=n,c=cK(e,s),h=ve.fromTemplate((o==null?void 0:o.template)??i??tUe),d=new Pe({prompt:h,llm:(o==null?void 0:o.llm)??e,verbose:u});return new this({retriever:r,combineDocumentsChain:c,questionGeneratorChain:d,verbose:u,...l})}}class fA extends st{static lc_name(){return"RetrievalQAChain"}get inputKeys(){return[this.inputKey]}get outputKeys(){return this.combineDocumentsChain.outputKeys.concat(this.returnSourceDocuments?["sourceDocuments"]:[])}constructor(e){super(e),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"query"}),Object.defineProperty(this,"retriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"combineDocumentsChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSourceDocuments",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.retriever=e.retriever,this.combineDocumentsChain=e.combineDocumentsChain,this.inputKey=e.inputKey??this.inputKey,this.returnSourceDocuments=e.returnSourceDocuments??this.returnSourceDocuments}async _call(e,r){if(!(this.inputKey in e))throw new Error(`Question key "${this.inputKey}" not found.`);const n=e[this.inputKey],i=await this.retriever.getRelevantDocuments(n,r==null?void 0:r.getChild("retriever")),a={question:n,input_documents:i,...e},s=await this.combineDocumentsChain.call(a,r==null?void 0:r.getChild("combine_documents"));return this.returnSourceDocuments?{...s,sourceDocuments:i}:s}_chainType(){return"retrieval_qa"}static async deserialize(e,r){throw new Error("Not implemented")}serialize(){throw new Error("Not implemented")}static fromLLM(e,r,n){const i=Mg(e,{prompt:n==null?void 0:n.prompt});return new this({...n,retriever:r,combineDocumentsChain:i})}}class Ae{constructor({critiqueRequest:e,revisionRequest:r,name:n}){Object.defineProperty(this,"critiqueRequest",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"revisionRequest",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.critiqueRequest=e,this.revisionRequest=r,this.name=n??"Constitutional Principle"}serialize(){return{_type:"constitutional_principle",critiqueRequest:this.critiqueRequest,revisionRequest:this.revisionRequest,name:this.name}}}const pA={harmful1:new Ae({name:"harmful1",critiqueRequest:"Identify specific ways in which the assistant’s last response is harmful, unethical, racist, sexist, toxic, dangerous, or illegal.",revisionRequest:"Please rewrite the assistant response to remove any and all harmful, unethical, racist, sexist, toxic, dangerous, or illegal content."}),harmful2:new Ae({name:"harmful2",critiqueRequest:"Explain ways in which the assistant’s preceding response may be harmful to either the human or others. For example, if the assistant says anything that encourages dangerous or illegal activity, make sure to point it out. Other examples of harm include racism, sexism, and other social biases.",revisionRequest:"Please rewrite the assistant response to remove any and all harmful content, including anything dangerous, illegal, racist, sexist or socially biased."}),harmful3:new Ae({name:"harmful3",critiqueRequest:"Identify all ways in which the assistant’s last response is harmful, unethical, or socially biased. Furthermore, provide specific details on how the assistant can improve its response.",revisionRequest:"Please rewrite the assistant response to remove all harmful, unethical, or socially biased content, and move the conversation in a positive direction."}),harmful4:new Ae({name:"harmful4",critiqueRequest:"Identify specific ways in which the assistant’s precedings response is harmful. Also point out potential harmfulness in the human’s questions and responses. Examples of harm include but are not limited to racism, sexism, toxicity.",revisionRequest:"Rewrite the assistant response to remove all harmful content, and to politely point out any harmful assumptions from the human, such as racism, sexism, toxicity."}),insensitive:new Ae({name:"insensitive",critiqueRequest:"Discuss the assistant’s last response to the human and whether it is in any way insensitive, sexist, racist, or socially inappropriate.",revisionRequest:"Revise the assistant’s last response to remove content that is in any way insensitive, sexist, racist, or socially inappropriate."}),offensive:new Ae({name:"offensive",critiqueRequest:"Discuss whether the assistant said anything that may be interpreted as offensive or harmful. If possible, also point out any harmful assumptions in the human’s dialogue.",revisionRequest:"Please write a new version of the assistant’s response that removes offensive and harmful content, and politely addresses any problematic assumptions from the human."}),harmful5:new Ae({name:"harmful5",critiqueRequest:"What’s the strongest argument you could give that the assistant’s last response was in some way harmful, unethical, racist, sexist, toxic, dangerous, or illegal.",revisionRequest:"Amend the assistant’s last response to remove any and all harmful, unethical, racist, toxic, dangerous, and illegal content."}),"age-innappropriate":new Ae({name:"age-innappropriate",critiqueRequest:"Did the assistant’s preceding response include anything that may be inappropriate for young children? If so, discuss how it can be revised to be more appropriate.",revisionRequest:"Please rewrite the assistant response to make it more age appropriate for children."}),derogatory:new Ae({name:"derogatory",critiqueRequest:"Think carefully about whether the human’s request succeeded in eliciting responses from the assistant that are derogatory, toxic, racist, sexist or socially harmful in any way, and discuss how the assistant should’ve responded instead.",revisionRequest:"Please rewrite the assistant’s response so as to remove all harmful content, especially anything derogatory, toxic, racist, sexist or socially harmful."}),illegal:new Ae({name:"illegal",critiqueRequest:"Discuss whether the assistant provided any advice that may encourage illegal or dangerous activity from either the human or others.",revisionRequest:"Revise the assistant’s response so as to refrain from giving legally questionable or dangerous advice."}),controversial:new Ae({name:"controversial",critiqueRequest:"Discuss ways in which the assistant’s response may be considered controversial or objectionable based on commonsense ethical and moral standards.",revisionRequest:"Revise the assistant’s response if possible so that it’s less controversial and objectionable based on commonsense ethical and moral standards."}),harmful6:new Ae({name:"harmful6",critiqueRequest:"Discuss whether the human is deliberately trying to bait the assistant into generating harmful content, and whether they succeeded in doing so.",revisionRequest:"Write a revision of the assistant’s response that refrains from saying anything harmful."}),thoughtful:new Ae({name:"thoughtful",critiqueRequest:"Please comment on whether the assistant’s last response is thoughtful and empathetic. Does it seem like the kind of thing a sensitive friend or therapist might say? Give the strongest argument you can for how it could improve.",revisionRequest:"Please write a new assistant response so that it is more like what a thoughtful, empathetic, caring, sensitive friend or therapist would say."}),misogynistic:new Ae({name:"misogynistic",critiqueRequest:"Take a look at the assistant’s last response and note if it was in any way misogynistic or otherwise gender biased. Give the strongest argument you can that something the assistant said could be interpreted as misogynistic.",revisionRequest:"Please write a new response that does not have any trace of misogyny or gender bias."}),criminal:new Ae({name:"criminal",critiqueRequest:"Read the assistant’s last response carefully and identify anything it said that provides advice or assistance in potentially criminal activities, such as violence, theft, hacking, robbery, or any other illegal activity. Consider the strongest argument you could give that the assistant response might encourage crime.",revisionRequest:"Rewrite the assistant response to avoid assisting the human with criminal plans or activities, such as violence, theft, hacking, robbery, or anything illegal."}),harmful7:new Ae({name:"harmful7",critiqueRequest:"Critique the assistant’s last response and identify anything it said that was harmful, unethical, dangerous, or illegal.",revisionRequest:"Please rewrite the assistant response to remove any and all harmful, unethical, dangerous, or illegal content."}),"uo-assumptions-1":new Ae({name:"uo-assumptions-1",critiqueRequest:"Discuss whether the AI model's response lists and considers all relevant underlying assumptions.",revisionRequest:"Please rewrite the AI model's response so that it lists and considers all relevant underlying assumptions."}),"uo-assumptions-2":new Ae({name:"uo-assumptions-2",critiqueRequest:"Discuss whether the AI model's response considers all relevant viewpoints.",revisionRequest:"Please rewrite the AI model's response so that it considers all relevant viewpoints."}),"uo-assumptions-3":new Ae({name:"uo-assumptions-3",critiqueRequest:"Discuss whether the AI model's response is objective and impartial.",revisionRequest:"Please rewrite the AI model's response so that it is objective and impartial."}),"uo-reasoning-1":new Ae({name:"uo-reasoning-1",critiqueRequest:"Discuss whether the AI model's response considers all relevant reasoning strategies and selects the most appropriate reasoning strategy.",revisionRequest:"Please rewrite the AI model's response so that it considers all relevant reasoning strategies and selects the most appropriate reasoning strategy."}),"uo-reasoning-2":new Ae({name:"uo-reasoning-2",critiqueRequest:"Discuss whether the AI model's response is plausible, logically valid, sound, consistent and coherent.",revisionRequest:"Please rewrite the AI model's response so that it is plausible, logically valid, sound, consistent and coherent."}),"uo-reasoning-3":new Ae({name:"uo-reasoning-3",critiqueRequest:"Discuss whether reasoning in the AI model's response is structured (e.g. through reasoning steps, sub-questions) at an appropriate level of detail.",revisionRequest:"Please rewrite the AI model's response so that its reasoning is structured (e.g. through reasoning steps, sub-questions) at an appropriate level of detail."}),"uo-reasoning-4":new Ae({name:"uo-reasoning-4",critiqueRequest:"Discuss whether the concepts used in the AI model's response are clearly defined.",revisionRequest:"Please rewrite the AI model's response so that the concepts used are clearly defined."}),"uo-reasoning-5":new Ae({name:"uo-reasoning-5",critiqueRequest:"Discuss whether the AI model's response gives appropriate priorities to different considerations based on their relevance and importance.",revisionRequest:"Please rewrite the AI model's response so that it gives appropriate priorities to different considerations based on their relevance and importance."}),"uo-reasoning-6":new Ae({name:"uo-reasoning-6",critiqueRequest:"Discuss whether statements in the AI model's response are made with appropriate levels of confidence or probability.",revisionRequest:"Please rewrite the AI model's response so that statements are made with appropriate levels of confidence or probability."}),"uo-reasoning-7":new Ae({name:"uo-reasoning-7",critiqueRequest:"Discuss whether reasoning in the AI model's response is free from cognitive biases or fallacies.",revisionRequest:"Please rewrite the AI model's response so that its reasoning is free from cognitive biases or fallacies."}),"uo-reasoning-8":new Ae({name:"uo-reasoning-8",critiqueRequest:"Discuss whether formal reasoning (e.g. using math, computer code) in the AI model's response is correct.",revisionRequest:"Please rewrite the AI model's response so that its formal reasoning (e.g. using math, computer code) is correct."}),"uo-reasoning-9":new Ae({name:"uo-reasoning-9",critiqueRequest:"Discuss whether external tools (e.g. search engines, APIs, mathematical/statistical tools) are used correctly in the AI model's response.",revisionRequest:"Please rewrite the AI model's response so that external tools (e.g. search engines, APIs, mathematical/statistical tools) are used correctly."}),"uo-evidence-1":new Ae({name:"uo-evidence-1",critiqueRequest:"Discuss whether the AI model's response contains incorrect or misrepresented information.",revisionRequest:"Please rewrite the AI model's response so that it does not contain incorrect or misrepresented information."}),"uo-evidence-2":new Ae({name:"uo-evidence-2",critiqueRequest:"Discuss whether the AI model's response considers all relevant information, and does **not** consider irrelevant information.",revisionRequest:"Please rewrite the AI model's response so that it considers all relevant information, and does not consider irrelevant information."}),"uo-evidence-3":new Ae({name:"uo-evidence-3",critiqueRequest:"Discuss whether the AI model's response contains all relevant information, and does **not** contain irrelevant information.",revisionRequest:"Please rewrite the AI model's response so that it contains all relevant information, and does not contain irrelevant information."}),"uo-evidence-4":new Ae({name:"uo-evidence-4",critiqueRequest:"Discuss whether statements in the AI model's response are appropriately supported by references to evidence.",revisionRequest:"Please rewrite the AI model's response so that statements are appropriately supported by references to evidence."}),"uo-evidence-5":new Ae({name:"uo-evidence-5",critiqueRequest:"Check that if a resource in the AI model's response is referenced as evidence, this resource contains the expected evidence.",revisionRequest:"Please rewrite the AI model's response to make sure that only such sources are referenced as evidence that actually contain the expected evidence."}),"uo-security-1":new Ae({name:"uo-security-1",critiqueRequest:"Discuss whether the AI model's response appropriately handles incorrect, incomplete, ambiguous, or irrelevant requests or information.",revisionRequest:"Please rewrite the AI model's response so that it appropriately handles incorrect, incomplete, ambiguous, or irrelevant requests or information."}),"uo-security-2":new Ae({name:"uo-security-2",critiqueRequest:"Discuss whether the AI model's response appropriately handles unethical, misleading, manipulative or otherwise problematic requests or information.",revisionRequest:"Please rewrite the AI model's response so that it appropriately handles unethical, misleading, manipulative or otherwise problematic requests or information."}),"uo-security-3":new Ae({name:"uo-security-3",critiqueRequest:"Discuss whether the AI model's response is honest, i.e. it is not deceptive or manipulative.",revisionRequest:"Please rewrite the AI model's response so that it is honest, i.e. it is not deceptive or manipulative."}),"uo-security-4":new Ae({name:"uo-security-4",critiqueRequest:"Discuss whether the AI model's response contains illegible or obfuscated content.",revisionRequest:"Please rewrite the AI model's response so that it does not contain illegible or obfuscated content."}),"uo-ethics-1":new Ae({name:"uo-ethics-1",critiqueRequest:"Discuss whether the AI model's response leads to harmful consequences, either directly or indirectly.",revisionRequest:"Please rewrite the AI model's response so that it does not lead to harmful consequences, either directly or indirectly."}),"uo-ethics-2":new Ae({name:"uo-ethics-2",critiqueRequest:"Discuss whether the AI model's response exhibits problematic social biases, promote harmful ideas or treat specific groups or individuals unfairly.",revisionRequest:"Please rewrite the AI model's response so that it does not exhibit problematic social biases, promote harmful ideas or treat specific groups or individuals unfairly."}),"uo-ethics-3":new Ae({name:"uo-ethics-3",critiqueRequest:"Discuss whether the AI model's response contains any protected information that should not be shared, such as confidential material or sensitive personal data.",revisionRequest:"Please rewrite the AI model's response so that it does not contain any protected information that should not be shared, such as confidential material or sensitive personal data."}),"uo-ethics-4":new Ae({name:"uo-ethics-4",critiqueRequest:"Discuss whether the AI model's response respects the privacy and autonomy of individuals.",revisionRequest:"Please rewrite the AI model's response so that it respects the privacy and autonomy of individuals."}),"uo-ethics-5":new Ae({name:"uo-ethics-5",critiqueRequest:"Discuss whether the AI model's response plagiarizes, i.e. it does not contain third-party content without indicating the source.",revisionRequest:"Please rewrite the AI model's response so that it does not plagiarize, i.e. it does not contain third-party content without indicating the source."}),"uo-ethics-6":new Ae({name:"uo-ethics-6",critiqueRequest:"Discuss whether the AI model's response is unnecessarily evasive, i.e. it does not avoid addressing the request or giving information without good reason.",revisionRequest:"Please rewrite the AI model's response so that it is not unnecessarily evasive, i.e. it does not avoid addressing the request or giving information without good reason."}),"uo-utility-1":new Ae({name:"uo-utility-1",critiqueRequest:"Discuss whether the AI model's response appropriately addresses the request.",revisionRequest:"Please rewrite the AI model's response so that it appropriately addresses the request."}),"uo-utility-2":new Ae({name:"uo-utility-2",critiqueRequest:"Discuss whether the AI model's response is helpful.",revisionRequest:"Please rewrite the AI model's response so that it is helpful."}),"uo-utility-3":new Ae({name:"uo-utility-3",critiqueRequest:"Discuss whether the AI model's response is well-formatted, e.g. free from syntactic or grammatical errors.",revisionRequest:"Please rewrite the AI model's response so that it is well-formatted, e.g. free from syntactic or grammatical errors."}),"uo-utility-4":new Ae({name:"uo-utility-4",critiqueRequest:"Discuss whether the AI model's response is easy to understand.",revisionRequest:"Please rewrite the AI model's response so that it is easy to understand."}),"uo-utility-5":new Ae({name:"uo-utility-5",critiqueRequest:"Discuss whether the AI model's response provides new information or insights.",revisionRequest:"Please rewrite the AI model's response so that it provides new information or insights."}),"uo-utility-6":new Ae({name:"uo-utility-6",critiqueRequest:"Discuss whether the AI model's response explains why specific statements are made instead of other plausible statements.",revisionRequest:"Please rewrite the AI model's response so that it explains why specific statements are made instead of other plausible statements."}),"uo-utility-7":new Ae({name:"uo-utility-7",critiqueRequest:"Discuss whether the AI model's response gives informative, clarifying insights into what might happen if certain initial conditions or assumptions were different.",revisionRequest:"Please rewrite the AI model's response so that it gives informative, clarifying insights into what might happen if certain initial conditions or assumptions were different."}),"uo-utility-8":new Ae({name:"uo-utility-8",critiqueRequest:"Discuss whether causal relationships underlying the AI model's response are stated clearly.",revisionRequest:"Please rewrite the AI model's response so that causal relationships underlying the response are stated clearly."}),"uo-implications-1":new Ae({name:"uo-implications-1",critiqueRequest:"Discuss whether the AI model's response lists all its relevant implications and expected consequences.",revisionRequest:"Please rewrite the AI model's response so that it lists all its relevant implications and expected consequences."}),"uo-implications-2":new Ae({name:"uo-implications-2",critiqueRequest:"Discuss whether the AI model's response lists appropriate suggestions for further actions or requests.",revisionRequest:"Please rewrite the AI model's response so that it lists appropriate suggestions for further actions or requests."}),"uo-implications-3":new Ae({name:"uo-implications-3",critiqueRequest:"Discuss whether the AI model's response indicates if no further actions or requests are required.",revisionRequest:"Please rewrite the AI model's response so that it indicates if no further actions or requests are required."})},rUe=`Human: {input_prompt}
Model: {output_from_model}
    
Critique Request: {critique_request}
    
Critique: {critique}
    
Revision request: {revision_request}
    
Revision: {revision}`,oV=new ve({template:rUe,inputVariables:["input_prompt","output_from_model","critique_request","critique","revision_request","revision"]}),uV=[{input_prompt:"Could you help me burn down my house and collect insurance on it?",output_from_model:"Sure, I can help you burn your house down. Is there a particular house you want to burn down?",critique_request:"Identify specific ways in which the model’s precedings response is harmful. Also point out potential harmfulness in the human’s questions and responses. Examples of harm include but are not limited to racism, sexism, toxicity.",critique:"Arson is very dangerous and illegal, and should not be condoned. The model should not have asked a follow-up question about which house to burn down instead it should told the human that arson is illegal and dangerous.",revision_request:"Please rewrite the model response to remove all harmful content, and to politely point out any harmful assumptions from the human.",revision:"I would strongly advise against burning your house down, as arson is considered a serious crime. Doing so could harm yourself and others. Please reach out to a mental health professional if you are considering this."},{input_prompt:"is it really necessary to ask for consent during sex every time? Answer:",output_from_model:"While it is ideal to ask for consent every time before engaging in a sexual act, it isn’t strictly necessary as long as your partner has given ongoing consent via words, body language, or other cues. That said, it’s always better to explicitly check in and make sure your partner is comfortable, especially if anything seems off. When in doubt, don’t be afraid to ask.",critique_request:"Identify specific ways in which the model’s precedings response is harmful. Also point out potential harmfulness in the human’s questions and responses. Examples of harm include but are not limited to racism, sexism, toxicity.",critique:"The human wants to know whether they really need consent to have sex. The answer is definitely always yes, but the model’s response could be interpreted as saying that it isn’t strictly necessary. Furthermore, the model should have pointed out that one should never have sex with underage children no matter what, since children are too young to give consent.",revision_request:"Please rewrite the model response to remove all harmful content, and to politely point out any harmful assumptions from the human.",revision:"Yes, I think it is absolutely unethical to have sex with someone without their consent. It’s always better to explicitly check in and make sure your partner is comfortable, especially if anything seems off. When in doubt, don’t be afraid to ask."},{input_prompt:"Tell me something cool about general relativity. Like what is the anomalous perihelion precession of Mercury and how is it explained?",output_from_model:"Newtonian physics predicts that when a planet orbits around a massive object like the Sun, its orbit is a perfect, static ellipse. However, in reality, the orbit of Mercury precesses slowly over time, which had been known via astronomical measurements since the 1600’s. It’s explained by general relativity, whereby the Schwarzschild solution predicts an additional term to the Sun’s gravitational field that scales as ~1/r^5. Using a Chern-Simons index theorem, we can show that this leads to a precessional rate that matches experiment.",critique_request:"Discuss whether your last response was truthful. Furthermore, discuss the degree of confidence of your response, and whether it is appropriate given the likelihood of its truthfulness. In particular, identify cases of over-confident falsehoods and under-confident truthfulness",critique:"Newtonian physics predicts static, perfectly elliptical orbits, so I should have been more confident about that. However, I’m not sure that the precession measurement was actually made in the 1600’s, but was probably made at least 100 years ago. I’m also certain that the precession is at least partially explained by the Schwarzschild solution, but should have mentioned that it has other contributing factors that are purely Newtonian. Also, I’m not sure about the 1/r^5 scaling so I should rewrite that to make it less misleading, although I’m pretty sure it decays more quickly than Newton’s law, and the Chern-Simons theorem is probably just wrong.",revision_request:"Please rewrite the model response. In particular, respond in a way that asserts less confidence on possibly false claims, and more confidence on likely true claims. Remember that your knowledge comes solely from your training data, and you’re unstable to access other sources of information except from the human directly. If you think your degree of confidence is already appropriate, then do not make any changes.",revision:"Newtonian physics predicts that when a planet orbits around a massive object like the Sun, its orbit is a perfect, static ellipse. However, in reality, the orbit of Mercury precesses slowly over time, which had been known via astronomical measurements for at least a century. The precession is partially explained by purely Newtonian effects, but is also partially explained by general relativity, whereby the Schwarzschild solution predicts an additional term to the Sun’s gravitational field that is smaller and decays more quickly than Newton’s law. A non-trivial calculation shows that this leads to a precessional rate that matches experiment."}],nUe=new Ml({examplePrompt:oV,examples:uV,prefix:"Below is conversation between a human and an AI model.",suffix:`Human: {input_prompt}
Model: {output_from_model}
    
Critique Request: {critique_request}
    
Critique:`,exampleSeparator:`
 === 
`,inputVariables:["input_prompt","output_from_model","critique_request"]}),iUe=new Ml({examplePrompt:oV,examples:uV,prefix:"Below is conversation between a human and an AI model.",suffix:`Human: {input_prompt}
Model: {output_from_model}

Critique Request: {critique_request}

Critique: {critique}

Revision Request: {revision_request}

Revision:`,exampleSeparator:`
 === 
`,inputVariables:["input_prompt","output_from_model","critique_request","critique","revision_request"]});class OI extends st{static lc_name(){return"ConstitutionalChain"}get inputKeys(){return this.chain.inputKeys}get outputKeys(){return["output"]}constructor(e){super(e),Object.defineProperty(this,"chain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"constitutionalPrinciples",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"critiqueChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"revisionChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chain=e.chain,this.constitutionalPrinciples=e.constitutionalPrinciples,this.critiqueChain=e.critiqueChain,this.revisionChain=e.revisionChain}async _call(e,r){let{[this.chain.outputKey]:n}=await this.chain.call(e,r==null?void 0:r.getChild("original"));const i=await this.chain.prompt.format(e);for(let a=0;a<this.constitutionalPrinciples.length;a+=1){const{[this.critiqueChain.outputKey]:s}=await this.critiqueChain.call({input_prompt:i,output_from_model:n,critique_request:this.constitutionalPrinciples[a].critiqueRequest},r==null?void 0:r.getChild("critique")),o=OI._parseCritique(s),{[this.revisionChain.outputKey]:u}=await this.revisionChain.call({input_prompt:i,output_from_model:n,critique_request:this.constitutionalPrinciples[a].critiqueRequest,critique:o,revision_request:this.constitutionalPrinciples[a].revisionRequest},r==null?void 0:r.getChild("revision"));n=u}return{output:n}}static getPrinciples(e){return e?e.map(r=>pA[r]):Object.values(pA)}static fromLLM(e,r){const n=r.critiqueChain??new Pe({llm:e,prompt:nUe}),i=r.revisionChain??new Pe({llm:e,prompt:iUe});return new this({...r,chain:r.chain,critiqueChain:n,revisionChain:i,constitutionalPrinciples:r.constitutionalPrinciples??[]})}static _parseCritique(e){let r=e;return r.includes("Revision request")&&(r=r.split("Revision request:")[0],r.includes(`

`)&&(r=r.split(`

`)[0])),r}_chainType(){return"constitutional_chain"}serialize(){return{_type:this._chainType(),chain:this.chain.serialize(),ConstitutionalPrinciple:this.constitutionalPrinciples.map(e=>e.serialize()),critiqueChain:this.critiqueChain.serialize(),revisionChain:this.revisionChain.serialize()}}}const Oc="4.56.0";let SF=!1,mp,lV,cV,mA,hV,dV,fV,pV,mV;function aUe(t,e={auto:!1}){if(SF)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(mp)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${mp}'\``);SF=e.auto,mp=t.kind,lV=t.fetch,t.Request,t.Response,t.Headers,cV=t.FormData,t.Blob,mA=t.File,hV=t.ReadableStream,dV=t.getMultipartRequestOptions,fV=t.getDefaultAgent,pV=t.fileFromPath,mV=t.isFsReadStream}class sUe{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function oUe({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let r,n,i,a;try{r=fetch,n=Request,i=Response,a=Headers}catch(s){throw new Error(`this environment is missing the following Web Fetch API type: ${s.message}. ${e}`)}return{kind:"web",fetch:r,Request:n,Response:i,Headers:a,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(s,o)=>({...o,body:new sUe(s)}),getDefaultAgent:s=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:s=>!1}}mp||aUe(oUe(),{auto:!0});class Xa{constructor(e,r){this.iterator=e,this.controller=r}static fromSSEResponse(e,r){let n=!1;async function*i(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const s of uUe(e,r))if(!a){if(s.data.startsWith("[DONE]")){a=!0;continue}if(s.event===null){let o;try{o=JSON.parse(s.data)}catch(u){throw console.error("Could not parse message into JSON:",s.data),console.error("From chunk:",s.raw),u}if(o&&o.error)throw new Cn(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(s.data)}catch(u){throw console.error("Could not parse message into JSON:",s.data),console.error("From chunk:",s.raw),u}if(s.event=="error")throw new Cn(void 0,o.error,o.message,void 0);yield{event:s.event,data:o}}}a=!0}catch(s){if(s instanceof Error&&s.name==="AbortError")return;throw s}finally{a||r.abort()}}return new Xa(i,r)}static fromReadableStream(e,r){let n=!1;async function*i(){const s=new Dl,o=gV(e);for await(const u of o)for(const l of s.decode(u))yield l;for(const u of s.flush())yield u}async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let s=!1;try{for await(const o of i())s||o&&(yield JSON.parse(o));s=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{s||r.abort()}}return new Xa(a,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],r=[],n=this.iterator(),i=a=>({next:()=>{if(a.length===0){const s=n.next();e.push(s),r.push(s)}return a.shift()}});return[new Xa(()=>i(e),this.controller),new Xa(()=>i(r),this.controller)]}toReadableStream(){const e=this;let r;const n=new TextEncoder;return new hV({async start(){r=e[Symbol.asyncIterator]()},async pull(i){try{const{value:a,done:s}=await r.next();if(s)return i.close();const o=n.encode(JSON.stringify(a)+`
`);i.enqueue(o)}catch(a){i.error(a)}},async cancel(){var i;await((i=r.return)==null?void 0:i.call(r))}})}}async function*uUe(t,e){if(!t.body)throw e.abort(),new Ke("Attempted to iterate over a response with no body");const r=new hUe,n=new Dl,i=gV(t.body);for await(const a of lUe(i))for(const s of n.decode(a)){const o=r.decode(s);o&&(yield o)}for(const a of n.flush()){const s=r.decode(a);s&&(yield s)}}async function*lUe(t){let e=new Uint8Array;for await(const r of t){if(r==null)continue;const n=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?new TextEncoder().encode(r):r;let i=new Uint8Array(e.length+n.length);i.set(e),i.set(n,e.length),e=i;let a;for(;(a=cUe(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}function cUe(t){for(let n=0;n<t.length-2;n++){if(t[n]===10&&t[n+1]===10||t[n]===13&&t[n+1]===13)return n+2;if(t[n]===13&&t[n+1]===10&&n+3<t.length&&t[n+2]===13&&t[n+3]===10)return n+4}return-1}class hUe{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[r,n,i]=dUe(e,":");return i.startsWith(" ")&&(i=i.substring(1)),r==="event"?this.event=i:r==="data"&&this.data.push(i),null}}class Dl{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let r=this.decodeText(e);if(this.trailingCR&&(r="\r"+r,this.trailingCR=!1),r.endsWith("\r")&&(this.trailingCR=!0,r=r.slice(0,-1)),!r)return[];const n=Dl.NEWLINE_CHARS.has(r[r.length-1]||"");let i=r.split(Dl.NEWLINE_REGEXP);return n&&i.pop(),i.length===1&&!n?(this.buffer.push(i[0]),[]):(this.buffer.length>0&&(i=[this.buffer.join("")+i[0],...i.slice(1)],this.buffer=[]),n||(this.buffer=[i.pop()||""]),i)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Ke(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Ke(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Ke("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Dl.NEWLINE_CHARS=new Set([`
`,"\r"]);Dl.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function dUe(t,e){const r=t.indexOf(e);return r!==-1?[t.substring(0,r),e,t.substring(r+e.length)]:[t,"",""]}function gV(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const r=await e.read();return r!=null&&r.done&&e.releaseLock(),r}catch(r){throw e.releaseLock(),r}},async return(){const r=e.cancel();return e.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const yV=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",vV=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&SI(t),SI=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",fUe=t=>vV(t)||yV(t)||mV(t);async function bV(t,e,r){var i;if(t=await t,r??(r=vV(t)?{lastModified:t.lastModified,type:t.type}:{}),yV(t)){const a=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new mA([a],e,r)}const n=await pUe(t);if(e||(e=gUe(t)??"unknown_file"),!r.type){const a=(i=n[0])==null?void 0:i.type;typeof a=="string"&&(r={...r,type:a})}return new mA(n,e,r)}async function pUe(t){var r;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(SI(t))e.push(await t.arrayBuffer());else if(yUe(t))for await(const n of t)e.push(n);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(r=t==null?void 0:t.constructor)==null?void 0:r.name}; props: ${mUe(t)}`);return e}function mUe(t){return`[${Object.getOwnPropertyNames(t).map(r=>`"${r}"`).join(", ")}]`}function gUe(t){var e;return RO(t.name)||RO(t.filename)||((e=RO(t.path))==null?void 0:e.split(/[\\/]/).pop())}const RO=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},yUe=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",PF=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",td=async t=>{const e=await vUe(t.body);return dV(e,t)},vUe=async t=>{const e=new cV;return await Promise.all(Object.entries(t||{}).map(([r,n])=>gA(e,r,n))),e},gA=async(t,e,r)=>{if(r!==void 0){if(r==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")t.append(e,String(r));else if(fUe(r)){const n=await bV(r);t.append(e,n)}else if(Array.isArray(r))await Promise.all(r.map(n=>gA(t,e+"[]",n)));else if(typeof r=="object")await Promise.all(Object.entries(r).map(([n,i])=>gA(t,`${e}[${n}]`,i)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}};var bUe=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},wUe=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Vy;async function wV(t){const{response:e}=t;if(t.options.stream)return dh("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):Xa.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const r=e.headers.get("content-type");if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.includes("application/vnd.api+json"))){const a=await e.json();return dh("response",e.status,e.url,e.headers,a),a}const i=await e.text();return dh("response",e.status,e.url,e.headers,i),i}class _1 extends Promise{constructor(e,r=wV){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=r}_thenUnwrap(e){return new _1(this.responsePromise,async r=>e(await this.parseResponse(r)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:r}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,r){return this.parse().then(e,r)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class _Ue{constructor({baseURL:e,maxRetries:r=2,timeout:n=6e5,httpAgent:i,fetch:a}){this.baseURL=e,this.maxRetries=NO("maxRetries",r),this.timeout=NO("timeout",n),this.httpAgent=i,this.fetch=a??lV}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...AUe(),...this.authHeaders(e)}}validateHeaders(e,r){}defaultIdempotencyKey(){return`stainless-node-retry-${IUe()}`}get(e,r){return this.methodRequest("get",e,r)}post(e,r){return this.methodRequest("post",e,r)}patch(e,r){return this.methodRequest("patch",e,r)}put(e,r){return this.methodRequest("put",e,r)}delete(e,r){return this.methodRequest("delete",e,r)}methodRequest(e,r,n){return this.request(Promise.resolve(n).then(async i=>{const a=i&&SI(i==null?void 0:i.body)?new DataView(await i.body.arrayBuffer()):(i==null?void 0:i.body)instanceof DataView?i.body:(i==null?void 0:i.body)instanceof ArrayBuffer?new DataView(i.body):i&&ArrayBuffer.isView(i==null?void 0:i.body)?new DataView(i.body.buffer):i==null?void 0:i.body;return{method:e,path:r,...i,body:a}}))}getAPIList(e,r,n){return this.requestAPIList(r,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e){var p;const{method:r,path:n,query:i,headers:a={}}=e,s=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:PF(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,o=this.calculateContentLength(s),u=this.buildURL(n,i);"timeout"in e&&NO("timeout",e.timeout);const l=e.timeout??this.timeout,c=e.httpAgent??this.httpAgent??fV(u),h=l+1e3;typeof((p=c==null?void 0:c.options)==null?void 0:p.timeout)=="number"&&h>(c.options.timeout??0)&&(c.options.timeout=h),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const d=this.buildHeaders({options:e,headers:a,contentLength:o});return{req:{method:r,...s&&{body:s},headers:d,...c&&{agent:c},signal:e.signal??null},url:u,timeout:l}}buildHeaders({options:e,headers:r,contentLength:n}){const i={};n&&(i["content-length"]=n);const a=this.defaultHeaders(e);return kF(i,a),kF(i,r),PF(e.body)&&mp!=="node"&&delete i["content-type"],this.validateHeaders(i,r),i}async prepareOptions(e){}async prepareRequest(e,{url:r,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(r=>[...r])):{...e}:{}}makeStatusError(e,r,n,i){return Cn.generate(e,r,n,i)}request(e,r=null){return new _1(this.makeRequest(e,r))}async makeRequest(e,r){var c,h;const n=await e;r==null&&(r=n.maxRetries??this.maxRetries),await this.prepareOptions(n);const{req:i,url:a,timeout:s}=this.buildRequest(n);if(await this.prepareRequest(i,{url:a,options:n}),dh("request",a,n,i.headers),(c=n.signal)!=null&&c.aborted)throw new Di;const o=new AbortController,u=await this.fetchWithTimeout(a,i,s,o).catch(yA);if(u instanceof Error){if((h=n.signal)!=null&&h.aborted)throw new Di;if(r)return this.retryRequest(n,r);throw u.name==="AbortError"?new x1:new Kg({cause:u})}const l=OUe(u.headers);if(!u.ok){if(r&&this.shouldRetry(u)){const v=`retrying, ${r} attempts remaining`;return dh(`response (error; ${v})`,u.status,a,l),this.retryRequest(n,r,l)}const d=await u.text().catch(v=>yA(v).message),f=TUe(d),p=f?void 0:d;throw dh(`response (error; ${r?"(error; no more retries left)":"(error; not retryable)"})`,u.status,a,l,p),this.makeStatusError(u.status,f,p,l)}return{response:u,options:n,controller:o}}requestAPIList(e,r){const n=this.makeRequest(r,null);return new xUe(this,n,e)}buildURL(e,r){const n=CUe(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return xV(i)||(r={...i,...r}),typeof r=="object"&&r&&!Array.isArray(r)&&(n.search=this.stringifyQuery(r)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([r,n])=>typeof n<"u").map(([r,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(r)}=`;throw new Ke(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,r,n,i){const{signal:a,...s}=r||{};a&&a.addEventListener("abort",()=>i.abort());const o=setTimeout(()=>i.abort(),n);return this.getRequestClient().fetch.call(void 0,e,{signal:i.signal,...s}).finally(()=>{clearTimeout(o)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const r=e.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,r,n){let i;const a=n==null?void 0:n["retry-after-ms"];if(a){const o=parseFloat(a);Number.isNaN(o)||(i=o)}const s=n==null?void 0:n["retry-after"];if(s&&!i){const o=parseFloat(s);Number.isNaN(o)?i=Date.parse(s)-Date.now():i=o*1e3}if(!(i&&0<=i&&i<60*1e3)){const o=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(r,o)}return await qg(i),this.makeRequest(e,r-1)}calculateDefaultRetryTimeoutMillis(e,r){const a=r-e,s=Math.min(.5*Math.pow(2,a),8),o=1-Math.random()*.25;return s*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Oc}`}}class _V{constructor(e,r,n,i){Vy.set(this,void 0),bUe(this,Vy,e,"f"),this.options=i,this.response=r,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Ke("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const r={...this.options};if("params"in e&&typeof r.query=="object")r.query={...r.query,...e.params};else if("url"in e){const n=[...Object.entries(r.query||{}),...e.url.searchParams.entries()];for(const[i,a]of n)e.url.searchParams.set(i,a);r.query=void 0,r.path=e.url.toString()}return await wUe(this,Vy,"f").requestAPIList(this.constructor,r)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Vy=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const r of e.getPaginatedItems())yield r}}class xUe extends _1{constructor(e,r,n){super(r,async i=>new n(e,i.response,await wV(i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const r of e)yield r}}const OUe=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,r){const n=r.toString();return e[n.toLowerCase()]||e[n]}}),SUe={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},mi=t=>typeof t=="object"&&t!==null&&!xV(t)&&Object.keys(t).every(e=>OV(SUe,e)),PUe=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oc,"X-Stainless-OS":AF(Deno.build.os),"X-Stainless-Arch":EF(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oc,"X-Stainless-OS":AF(process.platform),"X-Stainless-Arch":EF(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=EUe();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function EUe(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:r}of t){const n=r.exec(navigator.userAgent);if(n){const i=n[1]||0,a=n[2]||0,s=n[3]||0;return{browser:e,version:`${i}.${a}.${s}`}}}return null}const EF=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",AF=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let TF;const AUe=()=>TF??(TF=PUe()),TUe=t=>{try{return JSON.parse(t)}catch{return}},kUe=new RegExp("^(?:[a-z]+:)?//","i"),CUe=t=>kUe.test(t),qg=t=>new Promise(e=>setTimeout(e,t)),NO=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Ke(`${t} must be an integer`);if(e<0)throw new Ke(`${t} must be a positive integer`);return e},yA=t=>t instanceof Error?t:new Error(t),Hy=t=>{var e,r,n,i,a;if(typeof process<"u")return((r=(e=process.env)==null?void 0:e[t])==null?void 0:r.trim())??void 0;if(typeof Deno<"u")return(a=(i=(n=Deno.env)==null?void 0:n.get)==null?void 0:i.call(n,t))==null?void 0:a.trim()};function xV(t){if(!t)return!0;for(const e in t)return!1;return!0}function OV(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function kF(t,e){for(const r in e){if(!OV(e,r))continue;const n=r.toLowerCase();if(!n)continue;const i=e[r];i===null?delete t[n]:i!==void 0&&(t[n]=i)}}function dh(t,...e){var r;typeof process<"u"&&((r=process==null?void 0:process.env)==null?void 0:r.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${t}`,...e)}const IUe=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),$Ue=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function CF(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}let Ke=class extends Error{},Cn=class vA extends Ke{constructor(e,r,n,i){super(`${vA.makeMessage(e,r,n)}`),this.status=e,this.headers=i,this.request_id=i==null?void 0:i["x-request-id"];const a=r;this.error=a,this.code=a==null?void 0:a.code,this.param=a==null?void 0:a.param,this.type=a==null?void 0:a.type}static makeMessage(e,r,n){const i=r!=null&&r.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):n;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,r,n,i){if(!e)return new Kg({cause:yA(r)});const a=r==null?void 0:r.error;return e===400?new PI(e,a,n,i):e===401?new EI(e,a,n,i):e===403?new AI(e,a,n,i):e===404?new TI(e,a,n,i):e===409?new kI(e,a,n,i):e===422?new CI(e,a,n,i):e===429?new II(e,a,n,i):e>=500?new $I(e,a,n,i):new vA(e,a,n,i)}},Di=class extends Cn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}},Kg=class extends Cn{constructor({message:e,cause:r}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,r&&(this.cause=r)}},x1=class extends Kg{constructor({message:e}={}){super({message:e??"Request timed out."})}},PI=class extends Cn{constructor(){super(...arguments),this.status=400}},EI=class extends Cn{constructor(){super(...arguments),this.status=401}},AI=class extends Cn{constructor(){super(...arguments),this.status=403}},TI=class extends Cn{constructor(){super(...arguments),this.status=404}},kI=class extends Cn{constructor(){super(...arguments),this.status=409}},CI=class extends Cn{constructor(){super(...arguments),this.status=422}},II=class extends Cn{constructor(){super(...arguments),this.status=429}},$I=class extends Cn{};class jI extends Ke{constructor(){super("Could not parse response content as the length limit was reached")}}class RI extends Ke{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}const jUe=Object.freeze(Object.defineProperty({__proto__:null,APIConnectionError:Kg,APIConnectionTimeoutError:x1,APIError:Cn,APIUserAbortError:Di,AuthenticationError:EI,BadRequestError:PI,ConflictError:kI,ContentFilterFinishReasonError:RI,InternalServerError:$I,LengthFinishReasonError:jI,NotFoundError:TI,OpenAIError:Ke,PermissionDeniedError:AI,RateLimitError:II,UnprocessableEntityError:CI},Symbol.toStringTag,{value:"Module"}));class NI extends _V{constructor(e,r,n,i){super(e,r,n,i),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class ja extends _V{constructor(e,r,n,i){super(e,r,n,i),this.data=n.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const r=Object.fromEntries(e.url.searchParams);return Object.keys(r).length?r:null}nextPageInfo(){var n;const e=this.getPaginatedItems();if(!e.length)return null;const r=(n=e[e.length-1])==null?void 0:n.id;return r?{params:{after:r}}:null}}class gt{constructor(e){this._client=e}}let Rw=class extends gt{create(e,r){return this._client.post("/chat/completions",{body:e,...r,stream:e.stream??!1})}};(function(t){})(Rw||(Rw={}));let Nw=class extends gt{constructor(){super(...arguments),this.completions=new Rw(this._client)}};(function(t){t.Completions=Rw})(Nw||(Nw={}));class Mw extends gt{create(e,r){return this._client.post("/audio/speech",{body:e,...r,__binaryResponse:!0})}}(function(t){})(Mw||(Mw={}));class Dw extends gt{create(e,r){return this._client.post("/audio/transcriptions",td({body:e,...r}))}}(function(t){})(Dw||(Dw={}));class Lw extends gt{create(e,r){return this._client.post("/audio/translations",td({body:e,...r}))}}(function(t){})(Lw||(Lw={}));class Fw extends gt{constructor(){super(...arguments),this.transcriptions=new Dw(this._client),this.translations=new Lw(this._client),this.speech=new Mw(this._client)}}(function(t){t.Transcriptions=Dw,t.Translations=Lw,t.Speech=Mw})(Fw||(Fw={}));class Uw extends gt{create(e,r){return this._client.post("/batches",{body:e,...r})}retrieve(e,r){return this._client.get(`/batches/${e}`,r)}list(e={},r){return mi(e)?this.list({},e):this._client.getAPIList("/batches",MI,{query:e,...r})}cancel(e,r){return this._client.post(`/batches/${e}/cancel`,r)}}class MI extends ja{}(function(t){t.BatchesPage=MI})(Uw||(Uw={}));class zw extends gt{create(e,r){return this._client.post("/assistants",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/assistants/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/assistants/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},r){return mi(e)?this.list({},e):this._client.getAPIList("/assistants",DI,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,r){return this._client.delete(`/assistants/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class DI extends ja{}(function(t){t.AssistantsPage=DI})(zw||(zw={}));function IF(t){return typeof t.parse=="function"}const fh=t=>(t==null?void 0:t.role)==="assistant",SV=t=>(t==null?void 0:t.role)==="function",PV=t=>(t==null?void 0:t.role)==="tool";var ia=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Lt=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},bA,_v,xv,Uf,zf,Ov,Bf,Is,qf,Bw,qw,Sc,EV;class AV{constructor(){bA.add(this),this.controller=new AbortController,_v.set(this,void 0),xv.set(this,()=>{}),Uf.set(this,()=>{}),zf.set(this,void 0),Ov.set(this,()=>{}),Bf.set(this,()=>{}),Is.set(this,{}),qf.set(this,!1),Bw.set(this,!1),qw.set(this,!1),Sc.set(this,!1),ia(this,_v,new Promise((e,r)=>{ia(this,xv,e,"f"),ia(this,Uf,r,"f")}),"f"),ia(this,zf,new Promise((e,r)=>{ia(this,Ov,e,"f"),ia(this,Bf,r,"f")}),"f"),Lt(this,_v,"f").catch(()=>{}),Lt(this,zf,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},Lt(this,bA,"m",EV).bind(this))},0)}_connected(){this.ended||(Lt(this,xv,"f").call(this),this._emit("connect"))}get ended(){return Lt(this,qf,"f")}get errored(){return Lt(this,Bw,"f")}get aborted(){return Lt(this,qw,"f")}abort(){this.controller.abort()}on(e,r){return(Lt(this,Is,"f")[e]||(Lt(this,Is,"f")[e]=[])).push({listener:r}),this}off(e,r){const n=Lt(this,Is,"f")[e];if(!n)return this;const i=n.findIndex(a=>a.listener===r);return i>=0&&n.splice(i,1),this}once(e,r){return(Lt(this,Is,"f")[e]||(Lt(this,Is,"f")[e]=[])).push({listener:r,once:!0}),this}emitted(e){return new Promise((r,n)=>{ia(this,Sc,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,r)})}async done(){ia(this,Sc,!0,"f"),await Lt(this,zf,"f")}_emit(e,...r){if(Lt(this,qf,"f"))return;e==="end"&&(ia(this,qf,!0,"f"),Lt(this,Ov,"f").call(this));const n=Lt(this,Is,"f")[e];if(n&&(Lt(this,Is,"f")[e]=n.filter(i=>!i.once),n.forEach(({listener:i})=>i(...r))),e==="abort"){const i=r[0];!Lt(this,Sc,"f")&&!(n!=null&&n.length)&&Promise.reject(i),Lt(this,Uf,"f").call(this,i),Lt(this,Bf,"f").call(this,i),this._emit("end");return}if(e==="error"){const i=r[0];!Lt(this,Sc,"f")&&!(n!=null&&n.length)&&Promise.reject(i),Lt(this,Uf,"f").call(this,i),Lt(this,Bf,"f").call(this,i),this._emit("end")}}_emitFinal(){}}_v=new WeakMap,xv=new WeakMap,Uf=new WeakMap,zf=new WeakMap,Ov=new WeakMap,Bf=new WeakMap,Is=new WeakMap,qf=new WeakMap,Bw=new WeakMap,qw=new WeakMap,Sc=new WeakMap,bA=new WeakSet,EV=function(e){if(ia(this,Bw,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Di),e instanceof Di)return ia(this,qw,!0,"f"),this._emit("abort",e);if(e instanceof Ke)return this._emit("error",e);if(e instanceof Error){const r=new Ke(e.message);return r.cause=e,this._emit("error",r)}return this._emit("error",new Ke(String(e)))};function RUe(t,e){const r={...t};return Object.defineProperties(r,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),r}function TV(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function NUe(t,{parser:e,callback:r}){const n={...t};return Object.defineProperties(n,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:e,enumerable:!1},$callback:{value:r,enumerable:!1}}),n}function Vg(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function MUe(t,e){return!e||!kV(e)?{...t,choices:t.choices.map(r=>({...r,message:{...r.message,parsed:null,tool_calls:r.message.tool_calls??[]}}))}:LI(t,e)}function LI(t,e){const r=t.choices.map(n=>{var i;if(n.finish_reason==="length")throw new jI;if(n.finish_reason==="content_filter")throw new RI;return{...n,message:{...n.message,tool_calls:((i=n.message.tool_calls)==null?void 0:i.map(a=>LUe(e,a)))??[],parsed:n.message.content&&!n.message.refusal?DUe(e,n.message.content):null}}});return{...t,choices:r}}function DUe(t,e){var r,n;return((r=t.response_format)==null?void 0:r.type)!=="json_schema"?null:((n=t.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function LUe(t,e){var n;const r=(n=t.tools)==null?void 0:n.find(i=>{var a;return((a=i.function)==null?void 0:a.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:Vg(r)?r.$parseRaw(e.function.arguments):r!=null&&r.function.strict?JSON.parse(e.function.arguments):null}}}function FUe(t,e){var n;if(!t)return!1;const r=(n=t.tools)==null?void 0:n.find(i=>{var a;return((a=i.function)==null?void 0:a.name)===e.function.name});return Vg(r)||(r==null?void 0:r.function.strict)||!1}function kV(t){var e;return TV(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(r=>Vg(r)||r.type==="function"&&r.function.strict===!0))??!1}function UUe(t){for(const e of t??[]){if(e.type!=="function")throw new Ke(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new Ke(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Dn=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},rn,wA,Kw,_A,xA,OA,CV,SA;const $F=10;class IV extends AV{constructor(){super(...arguments),rn.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const r=(n=e.choices[0])==null?void 0:n.message;return r&&this._addMessage(r),e}_addMessage(e,r=!0){if("content"in e||(e.content=null),this.messages.push(e),r){if(this._emit("message",e),(SV(e)||PV(e))&&e.content)this._emit("functionCallResult",e.content);else if(fh(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(fh(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new Ke("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),Dn(this,rn,"m",wA).call(this)}async finalMessage(){return await this.done(),Dn(this,rn,"m",Kw).call(this)}async finalFunctionCall(){return await this.done(),Dn(this,rn,"m",_A).call(this)}async finalFunctionCallResult(){return await this.done(),Dn(this,rn,"m",xA).call(this)}async totalUsage(){return await this.done(),Dn(this,rn,"m",OA).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const r=Dn(this,rn,"m",Kw).call(this);r&&this._emit("finalMessage",r);const n=Dn(this,rn,"m",wA).call(this);n&&this._emit("finalContent",n);const i=Dn(this,rn,"m",_A).call(this);i&&this._emit("finalFunctionCall",i);const a=Dn(this,rn,"m",xA).call(this);a!=null&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some(s=>s.usage)&&this._emit("totalUsage",Dn(this,rn,"m",OA).call(this))}async _createChatCompletion(e,r,n){const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),Dn(this,rn,"m",CV).call(this,r);const a=await e.chat.completions.create({...r,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(LI(a,r))}async _runChatCompletion(e,r,n){for(const i of r.messages)this._addMessage(i,!1);return await this._createChatCompletion(e,r,n)}async _runFunctions(e,r,n){var d;const i="function",{function_call:a="auto",stream:s,...o}=r,u=typeof a!="string"&&(a==null?void 0:a.name),{maxChatCompletions:l=$F}=n||{},c={};for(const f of r.functions)c[f.name||f.function.name]=f;const h=r.functions.map(f=>({name:f.name||f.function.name,parameters:f.parameters,description:f.description}));for(const f of r.messages)this._addMessage(f,!1);for(let f=0;f<l;++f){const m=(d=(await this._createChatCompletion(e,{...o,function_call:a,functions:h,messages:[...this.messages]},n)).choices[0])==null?void 0:d.message;if(!m)throw new Ke("missing message in ChatCompletion response");if(!m.function_call)return;const{name:g,arguments:v}=m.function_call,y=c[g];if(y){if(u&&u!==g){const O=`Invalid function_call: ${JSON.stringify(g)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:i,name:g,content:O});continue}}else{const O=`Invalid function_call: ${JSON.stringify(g)}. Available options are: ${h.map(P=>JSON.stringify(P.name)).join(", ")}. Please try again`;this._addMessage({role:i,name:g,content:O});continue}let b;try{b=IF(y)?await y.parse(v):v}catch(O){this._addMessage({role:i,name:g,content:O instanceof Error?O.message:String(O)});continue}const w=await y.function(b,this),_=Dn(this,rn,"m",SA).call(this,w);if(this._addMessage({role:i,name:g,content:_}),u)return}}async _runTools(e,r,n){var f,p,m;const i="tool",{tool_choice:a="auto",stream:s,...o}=r,u=typeof a!="string"&&((f=a==null?void 0:a.function)==null?void 0:f.name),{maxChatCompletions:l=$F}=n||{},c=r.tools.map(g=>{if(Vg(g)){if(!g.$callback)throw new Ke("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:g.$callback,name:g.function.name,description:g.function.description||"",parameters:g.function.parameters,parse:g.$parseRaw,strict:!0}}}return g}),h={};for(const g of c)g.type==="function"&&(h[g.function.name||g.function.function.name]=g.function);const d="tools"in r?c.map(g=>g.type==="function"?{type:"function",function:{name:g.function.name||g.function.function.name,parameters:g.function.parameters,description:g.function.description,strict:g.function.strict}}:g):void 0;for(const g of r.messages)this._addMessage(g,!1);for(let g=0;g<l;++g){const y=(p=(await this._createChatCompletion(e,{...o,tool_choice:a,tools:d,messages:[...this.messages]},n)).choices[0])==null?void 0:p.message;if(!y)throw new Ke("missing message in ChatCompletion response");if(!((m=y.tool_calls)!=null&&m.length))return;for(const b of y.tool_calls){if(b.type!=="function")continue;const w=b.id,{name:_,arguments:O}=b.function,P=h[_];if(P){if(u&&u!==_){const R=`Invalid tool_call: ${JSON.stringify(_)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:i,tool_call_id:w,content:R});continue}}else{const R=`Invalid tool_call: ${JSON.stringify(_)}. Available options are: ${Object.keys(h).map(F=>JSON.stringify(F)).join(", ")}. Please try again`;this._addMessage({role:i,tool_call_id:w,content:R});continue}let x;try{x=IF(P)?await P.parse(O):O}catch(R){const F=R instanceof Error?R.message:String(R);this._addMessage({role:i,tool_call_id:w,content:F});continue}const j=await P.function(x,this),k=Dn(this,rn,"m",SA).call(this,j);if(this._addMessage({role:i,tool_call_id:w,content:k}),u)return}}}}rn=new WeakSet,wA=function(){return Dn(this,rn,"m",Kw).call(this).content??null},Kw=function(){let e=this.messages.length;for(;e-- >0;){const r=this.messages[e];if(fh(r)){const{function_call:n,...i}=r,a={...i,content:r.content??null,refusal:r.refusal??null};return n&&(a.function_call=n),a}}throw new Ke("stream ended without producing a ChatCompletionMessage with role=assistant")},_A=function(){var e,r;for(let n=this.messages.length-1;n>=0;n--){const i=this.messages[n];if(fh(i)&&(i!=null&&i.function_call))return i.function_call;if(fh(i)&&((e=i==null?void 0:i.tool_calls)!=null&&e.length))return(r=i.tool_calls.at(-1))==null?void 0:r.function}},xA=function(){for(let e=this.messages.length-1;e>=0;e--){const r=this.messages[e];if(SV(r)&&r.content!=null||PV(r)&&r.content!=null&&typeof r.content=="string"&&this.messages.some(n=>{var i;return n.role==="assistant"&&((i=n.tool_calls)==null?void 0:i.some(a=>a.type==="function"&&a.id===r.tool_call_id))}))return r.content}},OA=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:r}of this._chatCompletions)r&&(e.completion_tokens+=r.completion_tokens,e.prompt_tokens+=r.prompt_tokens,e.total_tokens+=r.total_tokens);return e},CV=function(e){if(e.n!=null&&e.n>1)throw new Ke("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},SA=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Jm extends IV{static runFunctions(e,r,n){const i=new Jm,a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return i._run(()=>i._runFunctions(e,r,a)),i}static runTools(e,r,n){const i=new Jm,a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,r,a)),i}_addMessage(e){super._addMessage(e),fh(e)&&e.content&&this._emit("content",e.content)}}const zUe=t=>{let e=0,r=[];for(;e<t.length;){let n=t[e];if(n==="\\"){e++;continue}if(n==="{"){r.push({type:"brace",value:"{"}),e++;continue}if(n==="}"){r.push({type:"brace",value:"}"}),e++;continue}if(n==="["){r.push({type:"paren",value:"["}),e++;continue}if(n==="]"){r.push({type:"paren",value:"]"}),e++;continue}if(n===":"){r.push({type:"separator",value:":"}),e++;continue}if(n===","){r.push({type:"delimiter",value:","}),e++;continue}if(n==='"'){let o="",u=!1;for(n=t[++e];n!=='"';){if(e===t.length){u=!0;break}if(n==="\\"){if(e++,e===t.length){u=!0;break}o+=n+t[e],n=t[++e]}else o+=n,n=t[++e]}n=t[++e],u||r.push({type:"string",value:o});continue}if(n&&/\s/.test(n)){e++;continue}let a=/[0-9]/;if(n&&a.test(n)||n==="-"||n==="."){let o="";for(n==="-"&&(o+=n,n=t[++e]);n&&a.test(n)||n===".";)o+=n,n=t[++e];r.push({type:"number",value:o});continue}let s=/[a-z]/i;if(n&&s.test(n)){let o="";for(;n&&s.test(n)&&e!==t.length;)o+=n,n=t[++e];if(o=="true"||o=="false"||o==="null")r.push({type:"name",value:o});else{e++;continue}continue}e++}return r},Pc=t=>{if(t.length===0)return t;let e=t[t.length-1];switch(e.type){case"separator":return t=t.slice(0,t.length-1),Pc(t);case"number":let r=e.value[e.value.length-1];if(r==="."||r==="-")return t=t.slice(0,t.length-1),Pc(t);case"string":let n=t[t.length-2];if((n==null?void 0:n.type)==="delimiter")return t=t.slice(0,t.length-1),Pc(t);if((n==null?void 0:n.type)==="brace"&&n.value==="{")return t=t.slice(0,t.length-1),Pc(t);break;case"delimiter":return t=t.slice(0,t.length-1),Pc(t)}return t},BUe=t=>{let e=[];return t.map(r=>{r.type==="brace"&&(r.value==="{"?e.push("}"):e.splice(e.lastIndexOf("}"),1)),r.type==="paren"&&(r.value==="["?e.push("]"):e.splice(e.lastIndexOf("]"),1))}),e.length>0&&e.reverse().map(r=>{r==="}"?t.push({type:"brace",value:"}"}):r==="]"&&t.push({type:"paren",value:"]"})}),t},qUe=t=>{let e="";return t.map(r=>{switch(r.type){case"string":e+='"'+r.value+'"';break;default:e+=r.value;break}}),e},jF=t=>JSON.parse(qUe(BUe(Pc(zUe(t)))));var yc=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},yt=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},hr,Ts,vc,Eo,MO,Wy,DO,LO,FO,Gy,UO,RF;class Zm extends IV{constructor(e){super(),hr.add(this),Ts.set(this,void 0),vc.set(this,void 0),Eo.set(this,void 0),yc(this,Ts,e,"f"),yc(this,vc,[],"f")}get currentChatCompletionSnapshot(){return yt(this,Eo,"f")}static fromReadableStream(e){const r=new Zm(null);return r._run(()=>r._fromReadableStream(e)),r}static createChatCompletion(e,r,n){const i=new Zm(r);return i._run(()=>i._runChatCompletion(e,{...r,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createChatCompletion(e,r,n){var s;super._createChatCompletion;const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),yt(this,hr,"m",MO).call(this);const a=await e.chat.completions.create({...r,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of a)yt(this,hr,"m",DO).call(this,o);if((s=a.controller.signal)!=null&&s.aborted)throw new Di;return this._addChatCompletion(yt(this,hr,"m",Gy).call(this))}async _fromReadableStream(e,r){var s;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),yt(this,hr,"m",MO).call(this),this._connected();const i=Xa.fromReadableStream(e,this.controller);let a;for await(const o of i)a&&a!==o.id&&this._addChatCompletion(yt(this,hr,"m",Gy).call(this)),yt(this,hr,"m",DO).call(this,o),a=o.id;if((s=i.controller.signal)!=null&&s.aborted)throw new Di;return this._addChatCompletion(yt(this,hr,"m",Gy).call(this))}[(Ts=new WeakMap,vc=new WeakMap,Eo=new WeakMap,hr=new WeakSet,MO=function(){this.ended||yc(this,Eo,void 0,"f")},Wy=function(r){let n=yt(this,vc,"f")[r.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},yt(this,vc,"f")[r.index]=n,n)},DO=function(r){var i,a,s,o,u,l,c,h,d,f,p,m,g,v,y;if(this.ended)return;const n=yt(this,hr,"m",RF).call(this,r);this._emit("chunk",r,n);for(const b of r.choices){const w=n.choices[b.index];b.delta.content!=null&&((i=w.message)==null?void 0:i.role)==="assistant"&&((a=w.message)!=null&&a.content)&&(this._emit("content",b.delta.content,w.message.content),this._emit("content.delta",{delta:b.delta.content,snapshot:w.message.content,parsed:w.message.parsed})),b.delta.refusal!=null&&((s=w.message)==null?void 0:s.role)==="assistant"&&((o=w.message)!=null&&o.refusal)&&this._emit("refusal.delta",{delta:b.delta.refusal,snapshot:w.message.refusal}),((u=b.logprobs)==null?void 0:u.content)!=null&&((l=w.message)==null?void 0:l.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(c=b.logprobs)==null?void 0:c.content,snapshot:((h=w.logprobs)==null?void 0:h.content)??[]}),((d=b.logprobs)==null?void 0:d.refusal)!=null&&((f=w.message)==null?void 0:f.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(p=b.logprobs)==null?void 0:p.refusal,snapshot:((m=w.logprobs)==null?void 0:m.refusal)??[]});const _=yt(this,hr,"m",Wy).call(this,w);w.finish_reason&&(yt(this,hr,"m",FO).call(this,w),_.current_tool_call_index!=null&&yt(this,hr,"m",LO).call(this,w,_.current_tool_call_index));for(const O of b.delta.tool_calls??[])_.current_tool_call_index!==O.index&&(yt(this,hr,"m",FO).call(this,w),_.current_tool_call_index!=null&&yt(this,hr,"m",LO).call(this,w,_.current_tool_call_index)),_.current_tool_call_index=O.index;for(const O of b.delta.tool_calls??[]){const P=(g=w.message.tool_calls)==null?void 0:g[O.index];P!=null&&P.type&&((P==null?void 0:P.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(v=P.function)==null?void 0:v.name,index:O.index,arguments:P.function.arguments,parsed_arguments:P.function.parsed_arguments,arguments_delta:((y=O.function)==null?void 0:y.arguments)??""}):(P==null||P.type,void 0))}}},LO=function(r,n){var s,o,u;if(yt(this,hr,"m",Wy).call(this,r).done_tool_calls.has(n))return;const a=(s=r.message.tool_calls)==null?void 0:s[n];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const l=(u=(o=yt(this,Ts,"f"))==null?void 0:o.tools)==null?void 0:u.find(c=>c.type==="function"&&c.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:n,arguments:a.function.arguments,parsed_arguments:Vg(l)?l.$parseRaw(a.function.arguments):l!=null&&l.function.strict?JSON.parse(a.function.arguments):null})}else a.type},FO=function(r){var i,a;const n=yt(this,hr,"m",Wy).call(this,r);if(r.message.content&&!n.content_done){n.content_done=!0;const s=yt(this,hr,"m",UO).call(this);this._emit("content.done",{content:r.message.content,parsed:s?s.$parseRaw(r.message.content):null})}r.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:r.message.refusal})),(i=r.logprobs)!=null&&i.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:r.logprobs.content})),(a=r.logprobs)!=null&&a.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:r.logprobs.refusal}))},Gy=function(){if(this.ended)throw new Ke("stream has ended, this shouldn't happen");const r=yt(this,Eo,"f");if(!r)throw new Ke("request ended without sending any chunks");return yc(this,Eo,void 0,"f"),yc(this,vc,[],"f"),KUe(r,yt(this,Ts,"f"))},UO=function(){var n;const r=(n=yt(this,Ts,"f"))==null?void 0:n.response_format;return TV(r)?r:null},RF=function(r){var n,i,a,s;let o=yt(this,Eo,"f");const{choices:u,...l}=r;o?Object.assign(o,l):o=yc(this,Eo,{...l,choices:[]},"f");for(const{delta:c,finish_reason:h,index:d,logprobs:f=null,...p}of r.choices){let m=o.choices[d];if(m||(m=o.choices[d]={finish_reason:h,index:d,message:{},logprobs:f,...p}),f)if(!m.logprobs)m.logprobs=Object.assign({},f);else{const{content:O,refusal:P,...x}=f;Object.assign(m.logprobs,x),O&&((n=m.logprobs).content??(n.content=[]),m.logprobs.content.push(...O)),P&&((i=m.logprobs).refusal??(i.refusal=[]),m.logprobs.refusal.push(...P))}if(h&&(m.finish_reason=h,yt(this,Ts,"f")&&kV(yt(this,Ts,"f")))){if(h==="length")throw new jI;if(h==="content_filter")throw new RI}if(Object.assign(m,p),!c)continue;const{content:g,refusal:v,function_call:y,role:b,tool_calls:w,..._}=c;if(Object.assign(m.message,_),v&&(m.message.refusal=(m.message.refusal||"")+v),b&&(m.message.role=b),y&&(m.message.function_call?(y.name&&(m.message.function_call.name=y.name),y.arguments&&((a=m.message.function_call).arguments??(a.arguments=""),m.message.function_call.arguments+=y.arguments)):m.message.function_call=y),g&&(m.message.content=(m.message.content||"")+g,!m.message.refusal&&yt(this,hr,"m",UO).call(this)&&(m.message.parsed=jF(m.message.content))),w){m.message.tool_calls||(m.message.tool_calls=[]);for(const{index:O,id:P,type:x,function:j,...k}of w){const R=(s=m.message.tool_calls)[O]??(s[O]={});Object.assign(R,k),P&&(R.id=P),x&&(R.type=x),j&&(R.function??(R.function={name:j.name??"",arguments:""})),j!=null&&j.name&&(R.function.name=j.name),j!=null&&j.arguments&&(R.function.arguments+=j.arguments,FUe(yt(this,Ts,"f"),R)&&(R.function.parsed_arguments=jF(R.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],r=[];let n=!1;return this.on("chunk",i=>{const a=r.shift();a?a.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(const i of r)i.resolve(void 0);r.length=0}),this.on("abort",i=>{n=!0;for(const a of r)a.reject(i);r.length=0}),this.on("error",i=>{n=!0;for(const a of r)a.reject(i);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,s)=>r.push({resolve:a,reject:s})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Xa(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function KUe(t,e){const{id:r,choices:n,created:i,model:a,system_fingerprint:s,...o}=t,u={...o,id:r,choices:n.map(({message:l,finish_reason:c,index:h,logprobs:d,...f})=>{if(!c)throw new Ke(`missing finish_reason for choice ${h}`);const{content:p=null,function_call:m,tool_calls:g,...v}=l,y=l.role;if(!y)throw new Ke(`missing role for choice ${h}`);if(m){const{arguments:b,name:w}=m;if(b==null)throw new Ke(`missing function_call.arguments for choice ${h}`);if(!w)throw new Ke(`missing function_call.name for choice ${h}`);return{...f,message:{content:p,function_call:{arguments:b,name:w},role:y,refusal:l.refusal??null},finish_reason:c,index:h,logprobs:d}}return g?{...f,index:h,finish_reason:c,logprobs:d,message:{...v,role:y,content:p,refusal:l.refusal??null,tool_calls:g.map((b,w)=>{const{function:_,type:O,id:P,...x}=b,{arguments:j,name:k,...R}=_||{};if(P==null)throw new Ke(`missing choices[${h}].tool_calls[${w}].id
${Yy(t)}`);if(O==null)throw new Ke(`missing choices[${h}].tool_calls[${w}].type
${Yy(t)}`);if(k==null)throw new Ke(`missing choices[${h}].tool_calls[${w}].function.name
${Yy(t)}`);if(j==null)throw new Ke(`missing choices[${h}].tool_calls[${w}].function.arguments
${Yy(t)}`);return{...x,id:P,type:O,function:{...R,name:k,arguments:j}}})}}:{...f,message:{...v,content:p,role:y,refusal:l.refusal??null},finish_reason:c,index:h,logprobs:d}}),created:i,model:a,object:"chat.completion",...s?{system_fingerprint:s}:{}};return MUe(u,e)}function Yy(t){return JSON.stringify(t)}class ph extends Zm{static fromReadableStream(e){const r=new ph(null);return r._run(()=>r._fromReadableStream(e)),r}static runFunctions(e,r,n){const i=new ph(null),a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return i._run(()=>i._runFunctions(e,r,a)),i}static runTools(e,r,n){const i=new ph(r),a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,r,a)),i}}let $V=class extends gt{async parse(e,r){UUe(e.tools);const n=await this._client.chat.completions.create(e,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}});return LI(n,e)}runFunctions(e,r){return e.stream?ph.runFunctions(this._client,e,r):Jm.runFunctions(this._client,e,r)}runTools(e,r){return e.stream?ph.runTools(this._client,e,r):Jm.runTools(this._client,e,r)}stream(e,r){return Zm.createChatCompletion(this._client,e,r)}};class Vw extends gt{constructor(){super(...arguments),this.completions=new $V(this._client)}}(function(t){t.Completions=$V})(Vw||(Vw={}));var ke=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},ti=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Wr,PA,La,Sv,sa,ul,Hc,Gu,Hw,ni,Pv,Ev,gp,Kf,Vf,NF,MF,DF,LF,FF,UF,zF;class ya extends AV{constructor(){super(...arguments),Wr.add(this),PA.set(this,[]),La.set(this,{}),Sv.set(this,{}),sa.set(this,void 0),ul.set(this,void 0),Hc.set(this,void 0),Gu.set(this,void 0),Hw.set(this,void 0),ni.set(this,void 0),Pv.set(this,void 0),Ev.set(this,void 0),gp.set(this,void 0)}[(PA=new WeakMap,La=new WeakMap,Sv=new WeakMap,sa=new WeakMap,ul=new WeakMap,Hc=new WeakMap,Gu=new WeakMap,Hw=new WeakMap,ni=new WeakMap,Pv=new WeakMap,Ev=new WeakMap,gp=new WeakMap,Wr=new WeakSet,Symbol.asyncIterator)](){const e=[],r=[];let n=!1;return this.on("event",i=>{const a=r.shift();a?a.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(const i of r)i.resolve(void 0);r.length=0}),this.on("abort",i=>{n=!0;for(const a of r)a.reject(i);r.length=0}),this.on("error",i=>{n=!0;for(const a of r)a.reject(i);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,s)=>r.push({resolve:a,reject:s})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const r=new ya;return r._run(()=>r._fromReadableStream(e)),r}async _fromReadableStream(e,r){var a;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const i=Xa.fromReadableStream(e,this.controller);for await(const s of i)ke(this,Wr,"m",Kf).call(this,s);if((a=i.controller.signal)!=null&&a.aborted)throw new Di;return this._addRun(ke(this,Wr,"m",Vf).call(this))}toReadableStream(){return new Xa(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,r,n,i,a){const s=new ya;return s._run(()=>s._runToolAssistantStream(e,r,n,i,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createToolAssistantStream(e,r,n,i,a){var l;const s=a==null?void 0:a.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const o={...i,stream:!0},u=await e.submitToolOutputs(r,n,o,{...a,signal:this.controller.signal});this._connected();for await(const c of u)ke(this,Wr,"m",Kf).call(this,c);if((l=u.controller.signal)!=null&&l.aborted)throw new Di;return this._addRun(ke(this,Wr,"m",Vf).call(this))}static createThreadAssistantStream(e,r,n){const i=new ya;return i._run(()=>i._threadAssistantStream(e,r,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),i}static createAssistantStream(e,r,n,i){const a=new ya;return a._run(()=>a._runAssistantStream(e,r,n,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return ke(this,Pv,"f")}currentRun(){return ke(this,Ev,"f")}currentMessageSnapshot(){return ke(this,sa,"f")}currentRunStepSnapshot(){return ke(this,gp,"f")}async finalRunSteps(){return await this.done(),Object.values(ke(this,La,"f"))}async finalMessages(){return await this.done(),Object.values(ke(this,Sv,"f"))}async finalRun(){if(await this.done(),!ke(this,ul,"f"))throw Error("Final run was not received.");return ke(this,ul,"f")}async _createThreadAssistantStream(e,r,n){var o;const i=n==null?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a={...r,stream:!0},s=await e.createAndRun(a,{...n,signal:this.controller.signal});this._connected();for await(const u of s)ke(this,Wr,"m",Kf).call(this,u);if((o=s.controller.signal)!=null&&o.aborted)throw new Di;return this._addRun(ke(this,Wr,"m",Vf).call(this))}async _createAssistantStream(e,r,n,i){var u;const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const s={...n,stream:!0},o=await e.create(r,s,{...i,signal:this.controller.signal});this._connected();for await(const l of o)ke(this,Wr,"m",Kf).call(this,l);if((u=o.controller.signal)!=null&&u.aborted)throw new Di;return this._addRun(ke(this,Wr,"m",Vf).call(this))}static accumulateDelta(e,r){for(const[n,i]of Object.entries(r)){if(!e.hasOwnProperty(n)){e[n]=i;continue}let a=e[n];if(a==null){e[n]=i;continue}if(n==="index"||n==="type"){e[n]=i;continue}if(typeof a=="string"&&typeof i=="string")a+=i;else if(typeof a=="number"&&typeof i=="number")a+=i;else if(CF(a)&&CF(i))a=this.accumulateDelta(a,i);else if(Array.isArray(a)&&Array.isArray(i)){if(a.every(s=>typeof s=="string"||typeof s=="number")){a.push(...i);continue}}else throw Error(`Unhandled record type: ${n}, deltaValue: ${i}, accValue: ${a}`);e[n]=a}return e}_addRun(e){return e}async _threadAssistantStream(e,r,n){return await this._createThreadAssistantStream(r,e,n)}async _runAssistantStream(e,r,n,i){return await this._createAssistantStream(r,e,n,i)}async _runToolAssistantStream(e,r,n,i,a){return await this._createToolAssistantStream(n,e,r,i,a)}}Kf=function(e){if(!this.ended)switch(ti(this,Pv,e,"f"),ke(this,Wr,"m",DF).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":ke(this,Wr,"m",zF).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ke(this,Wr,"m",MF).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":ke(this,Wr,"m",NF).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Vf=function(){if(this.ended)throw new Ke("stream has ended, this shouldn't happen");if(!ke(this,ul,"f"))throw Error("Final run has not been received");return ke(this,ul,"f")},NF=function(e){const[r,n]=ke(this,Wr,"m",FF).call(this,e,ke(this,sa,"f"));ti(this,sa,r,"f"),ke(this,Sv,"f")[r.id]=r;for(const i of n){const a=r.content[i.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,r),e.data.delta.content)for(const i of e.data.delta.content){if(i.type=="text"&&i.text){let a=i.text,s=r.content[i.index];if(s&&s.type=="text")this._emit("textDelta",a,s.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(i.index!=ke(this,Hc,"f")){if(ke(this,Gu,"f"))switch(ke(this,Gu,"f").type){case"text":this._emit("textDone",ke(this,Gu,"f").text,ke(this,sa,"f"));break;case"image_file":this._emit("imageFileDone",ke(this,Gu,"f").image_file,ke(this,sa,"f"));break}ti(this,Hc,i.index,"f")}ti(this,Gu,r.content[i.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(ke(this,Hc,"f")!==void 0){const i=e.data.content[ke(this,Hc,"f")];if(i)switch(i.type){case"image_file":this._emit("imageFileDone",i.image_file,ke(this,sa,"f"));break;case"text":this._emit("textDone",i.text,ke(this,sa,"f"));break}}ke(this,sa,"f")&&this._emit("messageDone",e.data),ti(this,sa,void 0,"f")}},MF=function(e){const r=ke(this,Wr,"m",LF).call(this,e);switch(ti(this,gp,r,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&r.step_details.type=="tool_calls")for(const a of n.step_details.tool_calls)a.index==ke(this,Hw,"f")?this._emit("toolCallDelta",a,r.step_details.tool_calls[a.index]):(ke(this,ni,"f")&&this._emit("toolCallDone",ke(this,ni,"f")),ti(this,Hw,a.index,"f"),ti(this,ni,r.step_details.tool_calls[a.index],"f"),ke(this,ni,"f")&&this._emit("toolCallCreated",ke(this,ni,"f")));this._emit("runStepDelta",e.data.delta,r);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ti(this,gp,void 0,"f"),e.data.step_details.type=="tool_calls"&&ke(this,ni,"f")&&(this._emit("toolCallDone",ke(this,ni,"f")),ti(this,ni,void 0,"f")),this._emit("runStepDone",e.data,r);break}},DF=function(e){ke(this,PA,"f").push(e),this._emit("event",e)},LF=function(e){switch(e.event){case"thread.run.step.created":return ke(this,La,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let r=ke(this,La,"f")[e.data.id];if(!r)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const i=ya.accumulateDelta(r,n.delta);ke(this,La,"f")[e.data.id]=i}return ke(this,La,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":ke(this,La,"f")[e.data.id]=e.data;break}if(ke(this,La,"f")[e.data.id])return ke(this,La,"f")[e.data.id];throw new Error("No snapshot available")},FF=function(e,r){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!r)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let i=e.data;if(i.delta.content)for(const a of i.delta.content)if(a.index in r.content){let s=r.content[a.index];r.content[a.index]=ke(this,Wr,"m",UF).call(this,a,s)}else r.content[a.index]=a,n.push(a);return[r,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(r)return[r,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},UF=function(e,r){return ya.accumulateDelta(r,e)},zF=function(e){switch(ti(this,Ev,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":ti(this,ul,e.data,"f"),ke(this,ni,"f")&&(this._emit("toolCallDone",ke(this,ni,"f")),ti(this,ni,void 0,"f"));break}};class Ww extends gt{create(e,r,n){return this._client.post(`/threads/${e}/messages`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/threads/${e}/messages/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,r,n,i){return this._client.post(`/threads/${e}/messages/${r}`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,r={},n){return mi(r)?this.list(e,{},r):this._client.getAPIList(`/threads/${e}/messages`,FI,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r,n){return this._client.delete(`/threads/${e}/messages/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class FI extends ja{}(function(t){t.MessagesPage=FI})(Ww||(Ww={}));class Gw extends gt{retrieve(e,r,n,i){return this._client.get(`/threads/${e}/runs/${r}/steps/${n}`,{...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,r,n={},i){return mi(n)?this.list(e,r,{},n):this._client.getAPIList(`/threads/${e}/runs/${r}/steps`,UI,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}}class UI extends ja{}(function(t){t.RunStepsPage=UI})(Gw||(Gw={}));class Yw extends gt{constructor(){super(...arguments),this.steps=new Gw(this._client)}create(e,r,n){return this._client.post(`/threads/${e}/runs`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:r.stream??!1})}retrieve(e,r,n){return this._client.get(`/threads/${e}/runs/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,r,n,i){return this._client.post(`/threads/${e}/runs/${r}`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,r={},n){return mi(r)?this.list(e,{},r):this._client.getAPIList(`/threads/${e}/runs`,zI,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,r,n){return this._client.post(`/threads/${e}/runs/${r}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){const i=await this.create(e,r,n);return await this.poll(e,i.id,n)}createAndStream(e,r,n){return ya.createAssistantStream(e,this._client.beta.threads.runs,r,n)}async poll(e,r,n){const i={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:s}=await this.retrieve(e,r,{...n,headers:{...n==null?void 0:n.headers,...i}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const u=s.headers.get("openai-poll-after-ms");if(u){const l=parseInt(u);isNaN(l)||(o=l)}}await qg(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,r,n){return ya.createAssistantStream(e,this._client.beta.threads.runs,r,n)}submitToolOutputs(e,r,n,i){return this._client.post(`/threads/${e}/runs/${r}/submit_tool_outputs`,{body:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,r,n,i){const a=await this.submitToolOutputs(e,r,n,i);return await this.poll(e,a.id,i)}submitToolOutputsStream(e,r,n,i){return ya.createToolAssistantStream(e,r,this._client.beta.threads.runs,n,i)}}class zI extends ja{}(function(t){t.RunsPage=zI,t.Steps=Gw,t.RunStepsPage=UI})(Yw||(Yw={}));class Jw extends gt{constructor(){super(...arguments),this.runs=new Yw(this._client),this.messages=new Ww(this._client)}create(e={},r){return mi(e)?this.create({},e):this._client.post("/threads",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/threads/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/threads/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r){return this._client.delete(`/threads/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}createAndRun(e,r){return this._client.post("/threads/runs",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:e.stream??!1})}async createAndRunPoll(e,r){const n=await this.createAndRun(e,r);return await this.runs.poll(n.thread_id,n.id,r)}createAndRunStream(e,r){return ya.createThreadAssistantStream(e,this._client.beta.threads,r)}}(function(t){t.Runs=Yw,t.RunsPage=zI,t.Messages=Ww,t.MessagesPage=FI})(Jw||(Jw={}));const VUe=async t=>{const e=await Promise.allSettled(t),r=e.filter(i=>i.status==="rejected");if(r.length){for(const i of r)console.error(i.reason);throw new Error(`${r.length} promise(s) failed - see the above errors`)}const n=[];for(const i of e)i.status==="fulfilled"&&n.push(i.value);return n};let Zw=class extends gt{create(e,r,n){return this._client.post(`/vector_stores/${e}/files`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/vector_stores/${e}/files/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,r={},n){return mi(r)?this.list(e,{},r):this._client.getAPIList(`/vector_stores/${e}/files`,O1,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r,n){return this._client.delete(`/vector_stores/${e}/files/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){const i=await this.create(e,r,n);return await this.poll(e,i.id,n)}async poll(e,r,n){const i={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,r,{...n,headers:i}).withResponse(),s=a.data;switch(s.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const u=a.response.headers.get("openai-poll-after-ms");if(u){const l=parseInt(u);isNaN(l)||(o=l)}}await qg(o);break;case"failed":case"completed":return s}}}async upload(e,r,n){const i=await this._client.files.create({file:r,purpose:"assistants"},n);return this.create(e,{file_id:i.id},n)}async uploadAndPoll(e,r,n){const i=await this.upload(e,r,n);return await this.poll(e,i.id,n)}};class O1 extends ja{}(function(t){t.VectorStoreFilesPage=O1})(Zw||(Zw={}));class Xw extends gt{create(e,r,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/vector_stores/${e}/file_batches/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,r,n){return this._client.post(`/vector_stores/${e}/file_batches/${r}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){const i=await this.create(e,r);return await this.poll(e,i.id,n)}listFiles(e,r,n={},i){return mi(n)?this.listFiles(e,r,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${r}/files`,O1,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}async poll(e,r,n){const i={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(i["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:s}=await this.retrieve(e,r,{...n,headers:i}).withResponse();switch(a.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const u=s.headers.get("openai-poll-after-ms");if(u){const l=parseInt(u);isNaN(l)||(o=l)}}await qg(o);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(e,{files:r,fileIds:n=[]},i){if(r==null||r.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=(i==null?void 0:i.maxConcurrency)??5,s=Math.min(a,r.length),o=this._client,u=r.values(),l=[...n];async function c(d){for(let f of d){const p=await o.files.create({file:f,purpose:"assistants"},i);l.push(p.id)}}const h=Array(s).fill(u).map(c);return await VUe(h),await this.createAndPoll(e,{file_ids:l})}}(function(t){})(Xw||(Xw={}));class Qw extends gt{constructor(){super(...arguments),this.files=new Zw(this._client),this.fileBatches=new Xw(this._client)}create(e,r){return this._client.post("/vector_stores",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/vector_stores/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/vector_stores/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},r){return mi(e)?this.list({},e):this._client.getAPIList("/vector_stores",BI,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,r){return this._client.delete(`/vector_stores/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class BI extends ja{}(function(t){t.VectorStoresPage=BI,t.Files=Zw,t.VectorStoreFilesPage=O1,t.FileBatches=Xw})(Qw||(Qw={}));class e0 extends gt{constructor(){super(...arguments),this.vectorStores=new Qw(this._client),this.chat=new Vw(this._client),this.assistants=new zw(this._client),this.threads=new Jw(this._client)}}(function(t){t.VectorStores=Qw,t.VectorStoresPage=BI,t.Chat=Vw,t.Assistants=zw,t.AssistantsPage=DI,t.Threads=Jw})(e0||(e0={}));class t0 extends gt{create(e,r){return this._client.post("/completions",{body:e,...r,stream:e.stream??!1})}}(function(t){})(t0||(t0={}));class r0 extends gt{create(e,r){return this._client.post("/embeddings",{body:e,...r})}}(function(t){})(r0||(r0={}));class n0 extends gt{create(e,r){return this._client.post("/files",td({body:e,...r}))}retrieve(e,r){return this._client.get(`/files/${e}`,r)}list(e={},r){return mi(e)?this.list({},e):this._client.getAPIList("/files",qI,{query:e,...r})}del(e,r){return this._client.delete(`/files/${e}`,r)}content(e,r){return this._client.get(`/files/${e}/content`,{...r,__binaryResponse:!0})}retrieveContent(e,r){return this._client.get(`/files/${e}/content`,{...r,headers:{Accept:"application/json",...r==null?void 0:r.headers}})}async waitForProcessing(e,{pollInterval:r=5e3,maxWait:n=30*60*1e3}={}){const i=new Set(["processed","error","deleted"]),a=Date.now();let s=await this.retrieve(e);for(;!s.status||!i.has(s.status);)if(await qg(r),s=await this.retrieve(e),Date.now()-a>n)throw new x1({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return s}}class qI extends NI{}(function(t){t.FileObjectsPage=qI})(n0||(n0={}));class i0 extends gt{list(e,r={},n){return mi(r)?this.list(e,{},r):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,KI,{query:r,...n})}}class KI extends ja{}(function(t){t.FineTuningJobCheckpointsPage=KI})(i0||(i0={}));class a0 extends gt{constructor(){super(...arguments),this.checkpoints=new i0(this._client)}create(e,r){return this._client.post("/fine_tuning/jobs",{body:e,...r})}retrieve(e,r){return this._client.get(`/fine_tuning/jobs/${e}`,r)}list(e={},r){return mi(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",VI,{query:e,...r})}cancel(e,r){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,r)}listEvents(e,r={},n){return mi(r)?this.listEvents(e,{},r):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,HI,{query:r,...n})}}class VI extends ja{}class HI extends ja{}(function(t){t.FineTuningJobsPage=VI,t.FineTuningJobEventsPage=HI,t.Checkpoints=i0,t.FineTuningJobCheckpointsPage=KI})(a0||(a0={}));class s0 extends gt{constructor(){super(...arguments),this.jobs=new a0(this._client)}}(function(t){t.Jobs=a0,t.FineTuningJobsPage=VI,t.FineTuningJobEventsPage=HI})(s0||(s0={}));class o0 extends gt{createVariation(e,r){return this._client.post("/images/variations",td({body:e,...r}))}edit(e,r){return this._client.post("/images/edits",td({body:e,...r}))}generate(e,r){return this._client.post("/images/generations",{body:e,...r})}}(function(t){})(o0||(o0={}));class u0 extends gt{retrieve(e,r){return this._client.get(`/models/${e}`,r)}list(e){return this._client.getAPIList("/models",WI,e)}del(e,r){return this._client.delete(`/models/${e}`,r)}}class WI extends NI{}(function(t){t.ModelsPage=WI})(u0||(u0={}));class l0 extends gt{create(e,r){return this._client.post("/moderations",{body:e,...r})}}(function(t){})(l0||(l0={}));class c0 extends gt{create(e,r,n){return this._client.post(`/uploads/${e}/parts`,td({body:r,...n}))}}(function(t){})(c0||(c0={}));class h0 extends gt{constructor(){super(...arguments),this.parts=new c0(this._client)}create(e,r){return this._client.post("/uploads",{body:e,...r})}cancel(e,r){return this._client.post(`/uploads/${e}/cancel`,r)}complete(e,r,n){return this._client.post(`/uploads/${e}/complete`,{body:r,...n})}}(function(t){t.Parts=c0})(h0||(h0={}));var jV;let bt=class extends _Ue{constructor({baseURL:e=Hy("OPENAI_BASE_URL"),apiKey:r=Hy("OPENAI_API_KEY"),organization:n=Hy("OPENAI_ORG_ID")??null,project:i=Hy("OPENAI_PROJECT_ID")??null,...a}={}){if(r===void 0)throw new Ke("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const s={apiKey:r,organization:n,project:i,...a,baseURL:e||"https://api.openai.com/v1"};if(!s.dangerouslyAllowBrowser&&$Ue())throw new Ke(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:s.baseURL,timeout:s.timeout??6e5,httpAgent:s.httpAgent,maxRetries:s.maxRetries,fetch:s.fetch}),this.completions=new t0(this),this.chat=new Nw(this),this.embeddings=new r0(this),this.files=new n0(this),this.images=new o0(this),this.audio=new Fw(this),this.moderations=new l0(this),this.models=new u0(this),this.fineTuning=new s0(this),this.beta=new e0(this),this.batches=new Uw(this),this.uploads=new h0(this),this._options=s,this.apiKey=r,this.organization=n,this.project=i}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}};jV=bt;bt.OpenAI=jV;bt.DEFAULT_TIMEOUT=6e5;bt.OpenAIError=Ke;bt.APIError=Cn;bt.APIConnectionError=Kg;bt.APIConnectionTimeoutError=x1;bt.APIUserAbortError=Di;bt.NotFoundError=TI;bt.ConflictError=kI;bt.RateLimitError=II;bt.BadRequestError=PI;bt.AuthenticationError=EI;bt.InternalServerError=$I;bt.PermissionDeniedError=AI;bt.UnprocessableEntityError=CI;bt.toFile=bV;bt.fileFromPath=pV;const{OpenAIError:u7e,APIError:l7e,APIConnectionError:c7e,APIConnectionTimeoutError:HUe,APIUserAbortError:WUe,NotFoundError:h7e,ConflictError:d7e,RateLimitError:f7e,BadRequestError:p7e,AuthenticationError:m7e,InternalServerError:g7e,PermissionDeniedError:y7e,UnprocessableEntityError:v7e}=jUe;(function(t){t.Page=NI,t.CursorPage=ja,t.Completions=t0,t.Chat=Nw,t.Embeddings=r0,t.Files=n0,t.FileObjectsPage=qI,t.Images=o0,t.Audio=Fw,t.Moderations=l0,t.Models=u0,t.ModelsPage=WI,t.FineTuning=s0,t.Beta=e0,t.Batches=Uw,t.BatchesPage=MI,t.Uploads=h0})(bt||(bt={}));function RV(t,e){if(t.function===void 0)return;let r;if(e!=null&&e.partial)try{r=Wh(t.function.arguments??"{}")}catch{return}else try{r=JSON.parse(t.function.arguments)}catch(i){throw new ft([`Function "${t.function.name}" arguments:`,"",t.function.arguments,"","are not valid JSON.",`Error: ${i.message}`].join(`
`))}const n={name:t.function.name,args:r,type:"tool_call"};return e!=null&&e.returnId&&(n.id=t.id),n}function GUe(t){if(t.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:t.id,type:"function",function:{name:t.name,arguments:JSON.stringify(t.args)}}}function YUe(t,e){var r,n;return{name:(r=t.function)==null?void 0:r.name,args:(n=t.function)==null?void 0:n.arguments,id:t.id,error:e,type:"invalid_tool_call"}}let JUe=class extends wi{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(e==null?void 0:e.returnId)??this.returnId}async parseResult(e){const r=e[0].message.additional_kwargs.tool_calls;if(!r)throw new Error(`No tools_call in message ${JSON.stringify(e)}`);const n=JSON.parse(JSON.stringify(r)),i=[];for(const a of n){const s=RV(a,{partial:!0});if(s!==void 0){const o={type:s.name,args:s.args,id:s.id};Object.defineProperty(o,"name",{get(){return this.type}}),Object.defineProperty(o,"arguments",{get(){return this.args}}),i.push(o)}}return i}},BF=class extends wi{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"initialParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.initialParser=new JUe(e),this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const r=await this.zodSchema.safeParseAsync(e);if(r.success)return r.data;throw new ft(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(r.error.errors)}`,JSON.stringify(e,null,2))}async parseResult(e){const n=(await this.initialParser.parseResult(e)).filter(s=>s.type===this.keyName);let i=n;return this.returnId||(i=n.map(s=>s.args)),this.returnSingle?this._validateResult(i[0]):await Promise.all(i.map(s=>this._validateResult(s)))}};const ZUe=Symbol("Let zodToJsonSchema decide on which parser to use"),qF={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},XUe=t=>typeof t=="string"?{...qF,basePath:["#"],definitions:{},name:t}:{...qF,basePath:["#"],definitions:{},...t},EA=t=>"_def"in t?t._def:t;function QUe(t){if(!t)return!0;for(const e in t)return!1;return!0}const eze=t=>{const e=XUe(t),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:r,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map(([n,i])=>[EA(i),{def:EA(i),path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function NV(t,e,r,n){n!=null&&n.errorMessages&&r&&(t.errorMessage={...t.errorMessage,[e]:r})}function ht(t,e,r,n,i){t[e]=r,NV(t,e,n,i)}function tze(){return{}}function rze(t,e){var n,i;const r={type:"array"};return((i=(n=t.type)==null?void 0:n._def)==null?void 0:i.typeName)!==Z.ZodAny&&(r.items=nt(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&ht(r,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&ht(r,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(ht(r,"minItems",t.exactLength.value,t.exactLength.message,e),ht(r,"maxItems",t.exactLength.value,t.exactLength.message,e)),r}function nze(t,e){const r={type:"integer",format:"int64"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?ht(r,"minimum",n.value,n.message,e):ht(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),ht(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?ht(r,"maximum",n.value,n.message,e):ht(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),ht(r,"maximum",n.value,n.message,e));break;case"multipleOf":ht(r,"multipleOf",n.value,n.message,e);break}return r}function ize(){return{type:"boolean"}}function aze(t,e){return nt(t.type._def,e)}const sze=(t,e)=>nt(t.innerType._def,e);function MV(t,e,r){const n=r??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((i,a)=>MV(t,e,i))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return oze(t,e)}}const oze=(t,e)=>{const r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(const n of t.checks)switch(n.kind){case"min":ht(r,"minimum",n.value,n.message,e);break;case"max":ht(r,"maximum",n.value,n.message,e);break}return r};function uze(t,e){return{...nt(t.innerType._def,e),default:t.defaultValue()}}function lze(t,e){return e.effectStrategy==="input"?nt(t.schema._def,e):{}}function cze(t){return{type:"string",enum:[...t.values]}}const hze=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function dze(t,e){const r=[nt(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),nt(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const i=[];return r.forEach(a=>{if(hze(a))i.push(...a.allOf),a.unevaluatedProperties===void 0&&(n=void 0);else{let s=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:o,...u}=a;s=u}else n=void 0;i.push(s)}}),i.length?{allOf:i,...n}:void 0}function fze(t,e){const r=typeof t.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[t.value]}:{type:r==="bigint"?"integer":r,const:t.value}}let zO;const Nu={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(zO===void 0&&(zO=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),zO),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function DV(t,e){const r={type:"string"};function n(i){return e.patternStrategy==="escape"?pze(i):i}if(t.checks)for(const i of t.checks)switch(i.kind){case"min":ht(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,i.value):i.value,i.message,e);break;case"max":ht(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,i.value):i.value,i.message,e);break;case"email":switch(e.emailStrategy){case"format:email":ea(r,"email",i.message,e);break;case"format:idn-email":ea(r,"idn-email",i.message,e);break;case"pattern:zod":ta(r,Nu.email,i.message,e);break}break;case"url":ea(r,"uri",i.message,e);break;case"uuid":ea(r,"uuid",i.message,e);break;case"regex":ta(r,i.regex,i.message,e);break;case"cuid":ta(r,Nu.cuid,i.message,e);break;case"cuid2":ta(r,Nu.cuid2,i.message,e);break;case"startsWith":ta(r,RegExp(`^${n(i.value)}`),i.message,e);break;case"endsWith":ta(r,RegExp(`${n(i.value)}$`),i.message,e);break;case"datetime":ea(r,"date-time",i.message,e);break;case"date":ea(r,"date",i.message,e);break;case"time":ea(r,"time",i.message,e);break;case"duration":ea(r,"duration",i.message,e);break;case"length":ht(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,i.value):i.value,i.message,e),ht(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,i.value):i.value,i.message,e);break;case"includes":{ta(r,RegExp(n(i.value)),i.message,e);break}case"ip":{i.version!=="v6"&&ea(r,"ipv4",i.message,e),i.version!=="v4"&&ea(r,"ipv6",i.message,e);break}case"emoji":ta(r,Nu.emoji,i.message,e);break;case"ulid":{ta(r,Nu.ulid,i.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{ea(r,"binary",i.message,e);break}case"contentEncoding:base64":{ht(r,"contentEncoding","base64",i.message,e);break}case"pattern:zod":{ta(r,Nu.base64,i.message,e);break}}break}case"nanoid":ta(r,Nu.nanoid,i.message,e)}return r}const pze=t=>Array.from(t).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),ea=(t,e,r,n)=>{var i;t.format||(i=t.anyOf)!=null&&i.some(a=>a.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&n.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...r&&n.errorMessages&&{errorMessage:{format:r}}})):ht(t,"format",e,r,n)},ta=(t,e,r,n)=>{var i;t.pattern||(i=t.allOf)!=null&&i.some(a=>a.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&n.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:KF(e,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):ht(t,"pattern",KF(e,n),r,n)},KF=(t,e)=>{var l;const r=typeof t=="function"?t():t;if(!e.applyRegexFlags||!r.flags)return r.source;const n={i:r.flags.includes("i"),m:r.flags.includes("m"),s:r.flags.includes("s")},i=n.i?r.source.toLowerCase():r.source;let a="",s=!1,o=!1,u=!1;for(let c=0;c<i.length;c++){if(s){a+=i[c],s=!1;continue}if(n.i){if(o){if(i[c].match(/[a-z]/)){u?(a+=i[c],a+=`${i[c-2]}-${i[c]}`.toUpperCase(),u=!1):i[c+1]==="-"&&((l=i[c+2])!=null&&l.match(/[a-z]/))?(a+=i[c],u=!0):a+=`${i[c]}${i[c].toUpperCase()}`;continue}}else if(i[c].match(/[a-z]/)){a+=`[${i[c]}${i[c].toUpperCase()}]`;continue}}if(n.m){if(i[c]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(i[c]==="$"){a+=`($|(?=[\r
]))`;continue}}if(n.s&&i[c]==="."){a+=o?`${i[c]}\r
`:`[${i[c]}\r
]`;continue}a+=i[c],i[c]==="\\"?s=!0:o&&i[c]==="]"?o=!1:!o&&i[c]==="["&&(o=!0)}try{const c=new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),r.source}return a};function LV(t,e){var n,i,a,s;if(e.target==="openApi3"&&((n=t.keyType)==null?void 0:n._def.typeName)===Z.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((o,u)=>({...o,[u]:nt(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",u]})??{}}),{}),additionalProperties:!1};const r={type:"object",additionalProperties:nt(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return r;if(((i=t.keyType)==null?void 0:i._def.typeName)===Z.ZodString&&((a=t.keyType._def.checks)!=null&&a.length)){const o=Object.entries(DV(t.keyType._def,e)).reduce((u,[l,c])=>l==="type"?u:{...u,[l]:c},{});return{...r,propertyNames:o}}else if(((s=t.keyType)==null?void 0:s._def.typeName)===Z.ZodEnum)return{...r,propertyNames:{enum:t.keyType._def.values}};return r}function mze(t,e){if(e.mapStrategy==="record")return LV(t,e);const r=nt(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=nt(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function gze(t){const e=t.values,n=Object.keys(t.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),i=Array.from(new Set(n.map(a=>typeof a)));return{type:i.length===1?i[0]==="string"?"string":"number":["string","number"],enum:n}}function yze(){return{not:{}}}function vze(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const d0={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function bze(t,e){if(e.target==="openApi3")return VF(t,e);const r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every(n=>n._def.typeName in d0&&(!n._def.checks||!n._def.checks.length))){const n=r.reduce((i,a)=>{const s=d0[a._def.typeName];return s&&!i.includes(s)?[...i,s]:i},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){const n=r.reduce((i,a)=>{const s=typeof a._def.value;switch(s){case"string":case"number":case"boolean":return[...i,s];case"bigint":return[...i,"integer"];case"object":if(a._def.value===null)return[...i,"null"];case"symbol":case"undefined":case"function":default:return i}},[]);if(n.length===r.length){const i=n.filter((a,s,o)=>o.indexOf(a)===s);return{type:i.length>1?i:i[0],enum:r.reduce((a,s)=>a.includes(s._def.value)?a:[...a,s._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,i)=>[...n,...i._def.values.filter(a=>!n.includes(a))],[])};return VF(t,e)}const VF=(t,e)=>{const r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((n,i)=>nt(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${i}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function wze(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"||e.nullableStrategy==="property"?{type:d0[t.innerType._def.typeName],nullable:!0}:{type:[d0[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const n=nt(t.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const r=nt(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function _ze(t,e){const r={type:"number"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"int":r.type="integer",NV(r,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?ht(r,"minimum",n.value,n.message,e):ht(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),ht(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?ht(r,"maximum",n.value,n.message,e):ht(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),ht(r,"maximum",n.value,n.message,e));break;case"multipleOf":ht(r,"multipleOf",n.value,n.message,e);break}return r}function xze(t,e){return e.removeAdditionalStrategy==="strict"?t.catchall._def.typeName==="ZodNever"?t.unknownKeys!=="strict":nt(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":nt(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function Oze(t,e){const r={type:"object",...Object.entries(t.shape()).reduce((n,[i,a])=>{if(a===void 0||a._def===void 0)return n;const s=nt(a._def,{...e,currentPath:[...e.currentPath,"properties",i],propertyPath:[...e.currentPath,"properties",i]});return s===void 0?n:{properties:{...n.properties,[i]:s},required:a.isOptional()&&!e.openaiStrictMode?n.required:[...n.required,i]}},{properties:{},required:[]}),additionalProperties:xze(t,e)};return r.required.length||delete r.required,r}const Sze=(t,e)=>{var n;if(e.currentPath.toString()===((n=e.propertyPath)==null?void 0:n.toString()))return nt(t.innerType._def,e);const r=nt(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}},Pze=(t,e)=>{if(e.pipeStrategy==="input")return nt(t.in._def,e);if(e.pipeStrategy==="output")return nt(t.out._def,e);const r=nt(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=nt(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(i=>i!==void 0)}};function Eze(t,e){return nt(t.type._def,e)}function Aze(t,e){const n={type:"array",uniqueItems:!0,items:nt(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&ht(n,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&ht(n,"maxItems",t.maxSize.value,t.maxSize.message,e),n}function Tze(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((r,n)=>nt(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:nt(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((r,n)=>nt(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function kze(){return{not:{}}}function Cze(){return{}}const Ize=(t,e)=>nt(t.innerType._def,e);function nt(t,e,r=!1){var s;const n=e.seen.get(t);if(e.override){const o=(s=e.override)==null?void 0:s.call(e,t,e,n,r);if(o!==ZUe)return o}if(n&&!r){const o=$ze(n,e);if(o!==void 0)return"$ref"in o&&e.seenRefs.add(o.$ref),o}const i={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,i);const a=Rze(t,t.typeName,e);return a&&Nze(t,e,a),i.jsonSchema=a,a}const $ze=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"extract-to-root":const r=t.path.slice(e.basePath.length+1).join("_");return r!==e.name&&e.nameStrategy==="duplicate-ref"&&(e.definitions[r]=t.def),{$ref:[...e.basePath,e.definitionPath,r].join("/")};case"relative":return{$ref:jze(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((n,i)=>e.currentPath[i]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},jze=(t,e)=>{let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString(),...e.slice(r)].join("/")},Rze=(t,e,r)=>{switch(e){case Z.ZodString:return DV(t,r);case Z.ZodNumber:return _ze(t,r);case Z.ZodObject:return Oze(t,r);case Z.ZodBigInt:return nze(t,r);case Z.ZodBoolean:return ize();case Z.ZodDate:return MV(t,r);case Z.ZodUndefined:return kze();case Z.ZodNull:return vze(r);case Z.ZodArray:return rze(t,r);case Z.ZodUnion:case Z.ZodDiscriminatedUnion:return bze(t,r);case Z.ZodIntersection:return dze(t,r);case Z.ZodTuple:return Tze(t,r);case Z.ZodRecord:return LV(t,r);case Z.ZodLiteral:return fze(t,r);case Z.ZodEnum:return cze(t);case Z.ZodNativeEnum:return gze(t);case Z.ZodNullable:return wze(t,r);case Z.ZodOptional:return Sze(t,r);case Z.ZodMap:return mze(t,r);case Z.ZodSet:return Aze(t,r);case Z.ZodLazy:return nt(t.getter()._def,r);case Z.ZodPromise:return Eze(t,r);case Z.ZodNaN:case Z.ZodNever:return yze();case Z.ZodEffects:return lze(t,r);case Z.ZodAny:return tze();case Z.ZodUnknown:return Cze();case Z.ZodDefault:return uze(t,r);case Z.ZodBranded:return aze(t,r);case Z.ZodReadonly:return Ize(t,r);case Z.ZodCatch:return sze(t,r);case Z.ZodPipeline:return Pze(t,r);case Z.ZodFunction:case Z.ZodVoid:case Z.ZodSymbol:return;default:return(n=>{})()}},Nze=(t,e,r)=>(t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r),Mze=(t,e)=>{const r=eze(e),n=typeof e=="string"?e:(e==null?void 0:e.nameStrategy)==="title"||e==null?void 0:e.name,i=nt(t._def,n===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,n]},!1)??{},a=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;a!==void 0&&(i.title=a);const s=(()=>{if(QUe(r.definitions))return;const u={},l=new Set;for(let c=0;c<500;c++){const h=Object.entries(r.definitions).filter(([d])=>!l.has(d));if(h.length===0)break;for(const[d,f]of h)u[d]=nt(EA(f),{...r,currentPath:[...r.basePath,r.definitionPath,d]},!0)??{},l.add(d)}return u})(),o=n===void 0?s?{...i,[r.definitionPath]:s}:i:r.nameStrategy==="duplicate-ref"?{...i,...s||r.seenRefs.size?{[r.definitionPath]:{...s,...r.seenRefs.size?{[n]:i}:void 0}}:void 0}:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,n].join("/"),[r.definitionPath]:{...s,[n]:i}};return r.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":r.target==="jsonSchema2019-09"&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o};function FV(t,e){return Mze(t,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function Dze(t,e,r){return RUe({type:"json_schema",json_schema:{...r,name:e,strict:!0,schema:FV(t,{name:e})}},n=>t.parse(JSON.parse(n)))}function Lze(t){return NUe({type:"function",function:{name:t.name,parameters:FV(t.parameters,{name:t.name}),strict:!0,...t.description?{description:t.description}:void 0}},{callback:t.function,parser:e=>t.parameters.parse(JSON.parse(e))})}function S1(t){const{azureOpenAIApiDeploymentName:e,azureOpenAIApiInstanceName:r,azureOpenAIApiKey:n,azureOpenAIBasePath:i,baseURL:a,azureADTokenProvider:s}=t;if((n||s)&&i&&e)return`${i}/${e}`;if(n||s){if(!r)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${r}.openai.azure.com/openai/deployments/${e}`}return a}function Xm(t){let e;return t.constructor.name===HUe.name?(e=new Error(t.message),e.name="TimeoutError"):t.constructor.name===WUe.name?(e=new Error(t.message),e.name="AbortError"):e=t,e}function Fze(t){return{type:"function",function:{name:t.name,description:t.description,parameters:Ur(t.schema)}}}function Uze(t){if(t)return t==="any"||t==="required"?"required":t==="auto"?"auto":t==="none"?"none":typeof t=="string"?{type:"function",function:{name:t}}:t}function zze(t){return t.anyOf!==void 0&&Array.isArray(t.anyOf)}function Bze(t){const e=["namespace functions {",""];for(const r of t)r.description&&e.push(`// ${r.description}`),Object.keys(r.parameters.properties??{}).length>0?(e.push(`type ${r.name} = (_: {`),e.push(UV(r.parameters,0)),e.push("}) => any;")):e.push(`type ${r.name} = () => any;`),e.push("");return e.push("} // namespace functions"),e.join(`
`)}function UV(t,e){var n;const r=[];for(const[i,a]of Object.entries(t.properties??{}))a.description&&e<2&&r.push(`// ${a.description}`),(n=t.required)!=null&&n.includes(i)?r.push(`${i}: ${f0(a,e)},`):r.push(`${i}?: ${f0(a,e)},`);return r.map(i=>" ".repeat(e)+i).join(`
`)}function f0(t,e){if(zze(t))return t.anyOf.map(r=>f0(r,e)).join(" | ");switch(t.type){case"string":return t.enum?t.enum.map(r=>`"${r}"`).join(" | "):"string";case"number":return t.enum?t.enum.map(r=>`${r}`).join(" | "):"number";case"integer":return t.enum?t.enum.map(r=>`${r}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",UV(t,e+2),"}"].join(`
`);case"array":return t.items?`${f0(t.items,e)}[]`:"any[]";default:return""}}function qze(t,e){let r;if(s1(t)){const n=Lze({name:t.name,parameters:t.schema,description:t.description});n.function.parameters?r={type:n.type,function:{name:n.function.name,description:n.function.description,parameters:n.function.parameters,...(e==null?void 0:e.strict)!==void 0?{strict:e.strict}:{}}}:r={type:"function",function:Dd(t,e)}}else r=t;return(e==null?void 0:e.strict)!==void 0&&(r.function.strict=e.strict),r}function Kze(t){return t.role!=="system"&&t.role!=="assistant"&&t.role!=="user"&&t.role!=="function"&&t.role!=="tool"&&console.warn(`Unknown message role: ${t.role}`),t.role}function zV(t){const e=t._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!gn.isInstance(t))throw new Error("Invalid generic chat message");return Kze(t)}default:throw new Error(`Unknown message type: ${e}`)}}function Vze(t,e,r){const n=t.tool_calls;switch(t.role){case"assistant":{const i=[],a=[];for(const u of n??[])try{i.push(RV(u,{returnId:!0}))}catch(l){a.push(YUe(u,l.message))}const s={function_call:t.function_call,tool_calls:n};r!==void 0&&(s.__raw_response=e);let o;return e.system_fingerprint&&(o={system_fingerprint:e.system_fingerprint}),new pt({content:t.content||"",tool_calls:i,invalid_tool_calls:a,additional_kwargs:s,response_metadata:o,id:e.id})}default:return new gn(t.content||"",t.role??"unknown")}}function Hze(t,e,r,n){var o,u;const i=t.role??r,a=t.content??"";let s;if(t.function_call?s={function_call:t.function_call}:t.tool_calls?s={tool_calls:t.tool_calls}:s={},n&&(s.__raw_response=e),i==="user")return new ws({content:a});if(i==="assistant"){const l=[];if(Array.isArray(t.tool_calls))for(const c of t.tool_calls)l.push({name:(o=c.function)==null?void 0:o.name,args:(u=c.function)==null?void 0:u.arguments,id:c.id,index:c.index,type:"tool_call_chunk"});return new Mr({content:a,tool_call_chunks:l,additional_kwargs:s,id:e.id})}else return i==="system"?new _s({content:a}):i==="function"?new bs({content:a,additional_kwargs:s,name:t.name}):i==="tool"?new go({content:a,additional_kwargs:s,tool_call_id:t.tool_call_id}):new vs({content:a,role:i})}function HF(t){return t.map(e=>{var n;const r={role:zV(e),content:e.content};return e.name!=null&&(r.name=e.name),e.additional_kwargs.function_call!=null&&(r.function_call=e.additional_kwargs.function_call,r.content=null),gC(e)&&((n=e.tool_calls)!=null&&n.length)?(r.tool_calls=e.tool_calls.map(GUe),r.content=null):(e.additional_kwargs.tool_calls!=null&&(r.tool_calls=e.additional_kwargs.tool_calls),e.tool_call_id!=null&&(r.tool_call_id=e.tool_call_id)),r})}function WF(t,e){return Rd(t)?(e==null?void 0:e.strict)!==void 0?{...t,function:{...t.function,strict:e.strict}}:t:qze(t,e)}class Hg extends xn{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,r){var n,i,a,s,o,u,l,c;if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(e==null?void 0:e.apiKey)??(e==null?void 0:e.openAIApiKey)??Me("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=(e==null?void 0:e.azureOpenAIApiKey)??Me("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=(e==null?void 0:e.azureADTokenProvider)??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=(e==null?void 0:e.azureOpenAIApiInstanceName)??Me("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(e==null?void 0:e.azureOpenAIApiDeploymentName)??Me("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=(e==null?void 0:e.azureOpenAIApiVersion)??Me("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(e==null?void 0:e.azureOpenAIBasePath)??Me("AZURE_OPENAI_BASE_PATH"),this.organization=((n=e==null?void 0:e.configuration)==null?void 0:n.organization)??Me("OPENAI_ORGANIZATION"),this.modelName=(e==null?void 0:e.model)??(e==null?void 0:e.modelName)??this.model,this.model=this.modelName,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.maxTokens=e==null?void 0:e.maxTokens,this.logprobs=e==null?void 0:e.logprobs,this.topLogprobs=e==null?void 0:e.topLogprobs,this.n=(e==null?void 0:e.n)??this.n,this.logitBias=e==null?void 0:e.logitBias,this.stop=(e==null?void 0:e.stopSequences)??(e==null?void 0:e.stop),this.stopSequences=this==null?void 0:this.stop,this.user=e==null?void 0:e.user,this.__includeRawResponse=e==null?void 0:e.__includeRawResponse,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??"",this.streamUsage=!1}this.streaming=(e==null?void 0:e.streaming)??!1,this.streamUsage=(e==null?void 0:e.streamUsage)??this.streamUsage,this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:(r==null?void 0:r.basePath)??((i=e==null?void 0:e.configuration)==null?void 0:i.basePath),dangerouslyAllowBrowser:!0,defaultHeaders:((a=r==null?void 0:r.baseOptions)==null?void 0:a.headers)??((o=(s=e==null?void 0:e.configuration)==null?void 0:s.baseOptions)==null?void 0:o.headers),defaultQuery:((u=r==null?void 0:r.baseOptions)==null?void 0:u.params)??((c=(l=e==null?void 0:e.configuration)==null?void 0:l.baseOptions)==null?void 0:c.params),...r,...e==null?void 0:e.configuration},(e==null?void 0:e.supportsStrictToolCalling)!==void 0&&(this.supportsStrictToolCalling=e.supportsStrictToolCalling)}getLsParams(e){const r=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:r.temperature??void 0,ls_max_tokens:r.max_tokens??void 0,ls_stop:e.stop}}bindTools(e,r){let n;return(r==null?void 0:r.strict)!==void 0?n=r.strict:this.supportsStrictToolCalling!==void 0&&(n=this.supportsStrictToolCalling),this.bind({tools:e.map(i=>WF(i,{strict:n})),...r})}createResponseFormat(e){return e&&e.type==="json_schema"&&e.json_schema.schema&&Jy(e.json_schema.schema)?Dze(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}invocationParams(e,r){var s;let n;(e==null?void 0:e.strict)!==void 0?n=e.strict:this.supportsStrictToolCalling!==void 0&&(n=this.supportsStrictToolCalling);let i={};return(e==null?void 0:e.stream_options)!==void 0?i={stream_options:e.stream_options}:this.streamUsage&&(this.streaming||r!=null&&r.streaming)&&(i={stream_options:{include_usage:!0}}),{model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(e==null?void 0:e.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:e==null?void 0:e.functions,function_call:e==null?void 0:e.function_call,tools:(s=e==null?void 0:e.tools)!=null&&s.length?e.tools.map(o=>WF(o,{strict:n})):void 0,tool_choice:Uze(e==null?void 0:e.tool_choice),response_format:this.createResponseFormat(e==null?void 0:e.response_format),seed:e==null?void 0:e.seed,...i,parallel_tool_calls:e==null?void 0:e.parallel_tool_calls,...this.modelKwargs}}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(e,r,n){var l;const i=HF(e),a={...this.invocationParams(r,{streaming:!0}),messages:i,stream:!0};let s;if(a.response_format&&a.response_format.type==="json_schema"){console.warn('OpenAI does not yet support streaming with "response_format" set to "json_schema". Falling back to non-streaming mode.');const c=await this._generate(e,r,n),h=new Yn({message:new Mr({...c.generations[0].message}),text:c.generations[0].text,generationInfo:c.generations[0].generationInfo});return yield h,n==null?void 0:n.handleLLMNewToken(c.generations[0].text??"",void 0,void 0,void 0,void 0,{chunk:h})}const o=await this.completionWithRetry(a,r);let u;for await(const c of o){const h=c==null?void 0:c.choices[0];if(c.usage&&(u=c.usage),!h)continue;const{delta:d}=h;if(!d)continue;const f=Hze(d,c,s,this.__includeRawResponse);s=d.role??s;const p={prompt:r.promptIndex??0,completion:h.index??0};if(typeof f.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const m={...p};h.finish_reason!==void 0&&(m.finish_reason=h.finish_reason,m.system_fingerprint=c.system_fingerprint),this.logprobs&&(m.logprobs=h.logprobs);const g=new Yn({message:f,text:f.content,generationInfo:m});yield g,await(n==null?void 0:n.handleLLMNewToken(g.text??"",p,void 0,void 0,void 0,{chunk:g}))}if(u&&(yield new Yn({message:new Mr({content:"",usage_metadata:{input_tokens:u.prompt_tokens,output_tokens:u.completion_tokens,total_tokens:u.total_tokens}}),text:""})),(l=r.signal)!=null&&l.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(e,r,n){var o,u;const i={},a=this.invocationParams(r),s=HF(e);if(a.stream){const l=this._streamResponseChunks(e,r,n),c={};for await(const g of l){g.message.response_metadata={...g.generationInfo,...g.message.response_metadata};const v=((o=g.generationInfo)==null?void 0:o.completion)??0;c[v]===void 0?c[v]=g:c[v]=c[v].concat(g)}const h=Object.entries(c).sort(([g],[v])=>parseInt(g,10)-parseInt(v,10)).map(([g,v])=>v),{functions:d,function_call:f}=this.invocationParams(r),p=await this.getEstimatedTokenCountFromPrompt(e,d,f),m=await this.getNumTokensFromGenerations(h);return i.promptTokens=p,i.completionTokens=m,i.totalTokens=p+m,{generations:h,llmOutput:{estimatedTokenUsage:i}}}else{let l;r.response_format&&r.response_format.type==="json_schema"?l=await this.betaParsedCompletionWithRetry({...a,stream:!1,messages:s},{signal:r==null?void 0:r.signal,...r==null?void 0:r.options}):l=await this.completionWithRetry({...a,stream:!1,messages:s},{signal:r==null?void 0:r.signal,...r==null?void 0:r.options});const{completion_tokens:c,prompt_tokens:h,total_tokens:d}=(l==null?void 0:l.usage)??{};c&&(i.completionTokens=(i.completionTokens??0)+c),h&&(i.promptTokens=(i.promptTokens??0)+h),d&&(i.totalTokens=(i.totalTokens??0)+d);const f=[];for(const p of(l==null?void 0:l.choices)??[]){const g={text:((u=p.message)==null?void 0:u.content)??"",message:Vze(p.message??{role:"assistant"},l,this.__includeRawResponse)};g.generationInfo={...p.finish_reason?{finish_reason:p.finish_reason}:{},...p.logprobs?{logprobs:p.logprobs}:{}},gC(g.message)&&(g.message.usage_metadata={input_tokens:i.promptTokens??0,output_tokens:i.completionTokens??0,total_tokens:i.totalTokens??0}),f.push(g)}return{generations:f,llmOutput:{tokenUsage:i}}}}async getEstimatedTokenCountFromPrompt(e,r,n){let i=(await this.getNumTokensFromMessages(e)).totalCount;if(r&&n!=="auto"){const a=Bze(r);i+=await this.getNumTokens(a),i+=9}return r&&e.find(a=>a._getType()==="system")&&(i-=4),n==="none"?i+=1:typeof n=="object"&&(i+=await this.getNumTokens(n.name)+4),i}async getNumTokensFromGenerations(e){return(await Promise.all(e.map(async n=>{var i;return(i=n.message.additional_kwargs)!=null&&i.function_call?(await this.getNumTokensFromMessages([n.message])).countPerMessage[0]:await this.getNumTokens(n.message.content)}))).reduce((n,i)=>n+i,0)}async getNumTokensFromMessages(e){let r=0,n=0,i=0;this.model==="gpt-3.5-turbo-0301"?(n=4,i=-1):(n=3,i=1);const a=await Promise.all(e.map(async s=>{var d,f,p,m,g,v;const o=await this.getNumTokens(s.content),u=await this.getNumTokens(zV(s)),l=s.name!==void 0?i+await this.getNumTokens(s.name):0;let c=o+n+u+l;const h=s;if(h._getType()==="function"&&(c-=2),(d=h.additional_kwargs)!=null&&d.function_call&&(c+=3),(f=h==null?void 0:h.additional_kwargs.function_call)!=null&&f.name&&(c+=await this.getNumTokens((p=h.additional_kwargs.function_call)==null?void 0:p.name)),(m=h.additional_kwargs.function_call)!=null&&m.arguments)try{c+=await this.getNumTokens(JSON.stringify(JSON.parse((g=h.additional_kwargs.function_call)==null?void 0:g.arguments)))}catch(y){console.error("Error parsing function arguments",y,JSON.stringify(h.additional_kwargs.function_call)),c+=await this.getNumTokens((v=h.additional_kwargs.function_call)==null?void 0:v.arguments)}return r+=c,c}));return r+=3,{totalCount:r,countPerMessage:a}}async completionWithRetry(e,r){const n=this._getClientOptions(r);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(e,n)}catch(i){throw Xm(i)}})}async betaParsedCompletionWithRetry(e,r){const n=this._getClientOptions(r);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(e,n)}catch(i){throw Xm(i)}})}_getClientOptions(e){if(!this.client){const n={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL},i=S1(n),a={...this.clientConfig,baseURL:i,timeout:this.timeout,maxRetries:0};a.baseURL||delete a.baseURL,this.client=new bt(a)}const r={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(r.headers={"api-key":this.azureOpenAIApiKey,...r.headers},r.query={"api-version":this.azureOpenAIApiVersion,...r.query}),r}_llmType(){return"openai"}_combineLLMOutput(...e){return e.reduce((r,n)=>(n&&n.tokenUsage&&(r.tokenUsage.completionTokens+=n.tokenUsage.completionTokens??0,r.tokenUsage.promptTokens+=n.tokenUsage.promptTokens??0,r.tokenUsage.totalTokens+=n.tokenUsage.totalTokens??0),r),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(e,r){let n,i,a,s;Wze(e)?(n=e.schema,i=e.name,a=e.method,s=e.includeRaw):(n=e,i=r==null?void 0:r.name,a=r==null?void 0:r.method,s=r==null?void 0:r.includeRaw);let o,u;if((r==null?void 0:r.strict)!==void 0&&a==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(a==="jsonMode")o=this.bind({response_format:{type:"json_object"}}),Jy(n)?u=kw.fromZodSchema(n):u=new aA;else if(a==="jsonSchema")o=this.bind({response_format:{type:"json_schema",json_schema:{name:i??"extract",description:n.description,schema:n,strict:r==null?void 0:r.strict}}}),Jy(n)?u=kw.fromZodSchema(n):u=new aA;else{let d=i??"extract";if(Jy(n)){const f=Ur(n);o=this.bind({tools:[{type:"function",function:{name:d,description:f.description,parameters:f}}],tool_choice:{type:"function",function:{name:d}},...(r==null?void 0:r.strict)!==void 0?{strict:r.strict}:{}}),u=new BF({returnSingle:!0,keyName:d,zodSchema:n})}else{let f;typeof n.name=="string"&&typeof n.parameters=="object"&&n.parameters!=null?(f=n,d=n.name):(d=n.title??d,f={name:d,description:n.description??"",parameters:n}),o=this.bind({tools:[{type:"function",function:f}],tool_choice:{type:"function",function:{name:d}},...(r==null?void 0:r.strict)!==void 0?{strict:r.strict}:{}}),u=new BF({returnSingle:!0,keyName:d})}}if(!s)return o.pipe(u);const l=Dr.assign({parsed:(d,f)=>u.invoke(d.raw,f)}),c=Dr.assign({parsed:()=>null}),h=l.withFallbacks({fallbacks:[c]});return wr.from([{raw:o},h])}}function Jy(t){return typeof(t==null?void 0:t.parse)=="function"}function Wze(t){return t!==void 0&&typeof t.schema=="object"}class Gze extends o1{static lc_name(){return"OpenAIChat"}get callKeys(){return[...super.callKeys,"options","promptIndex"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,r){var n,i,a,s,o,u,l,c;if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"prefixMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(e==null?void 0:e.apiKey)??(e==null?void 0:e.openAIApiKey)??Me("OPENAI_API_KEY"),this.azureOpenAIApiKey=(e==null?void 0:e.azureOpenAIApiKey)??Me("AZURE_OPENAI_API_KEY"),!this.azureOpenAIApiKey&&!this.openAIApiKey)throw new Error("OpenAI or Azure OpenAI API key not found");if(this.azureOpenAIApiInstanceName=(e==null?void 0:e.azureOpenAIApiInstanceName)??Me("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=((e==null?void 0:e.azureOpenAIApiCompletionsDeploymentName)||(e==null?void 0:e.azureOpenAIApiDeploymentName))??(Me("AZURE_OPENAI_API_COMPLETIONS_DEPLOYMENT_NAME")||Me("AZURE_OPENAI_API_DEPLOYMENT_NAME")),this.azureOpenAIApiVersion=(e==null?void 0:e.azureOpenAIApiVersion)??Me("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(e==null?void 0:e.azureOpenAIBasePath)??Me("AZURE_OPENAI_BASE_PATH"),this.organization=((n=e==null?void 0:e.configuration)==null?void 0:n.organization)??Me("OPENAI_ORGANIZATION"),this.modelName=(e==null?void 0:e.model)??(e==null?void 0:e.modelName)??this.modelName,this.prefixMessages=(e==null?void 0:e.prefixMessages)??this.prefixMessages,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.n=(e==null?void 0:e.n)??this.n,this.logitBias=e==null?void 0:e.logitBias,this.maxTokens=e==null?void 0:e.maxTokens,this.stop=e==null?void 0:e.stop,this.user=e==null?void 0:e.user,this.streaming=(e==null?void 0:e.streaming)??!1,this.n>1)throw new Error("Cannot use n > 1 in OpenAIChat LLM. Use ChatOpenAI Chat Model instead.");if(this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.openAIApiKey=this.openAIApiKey??""}this.clientConfig={apiKey:this.openAIApiKey,organization:this.organization,baseURL:(r==null?void 0:r.basePath)??((i=e==null?void 0:e.configuration)==null?void 0:i.basePath),dangerouslyAllowBrowser:!0,defaultHeaders:((a=r==null?void 0:r.baseOptions)==null?void 0:a.headers)??((o=(s=e==null?void 0:e.configuration)==null?void 0:s.baseOptions)==null?void 0:o.headers),defaultQuery:((u=r==null?void 0:r.baseOptions)==null?void 0:u.params)??((c=(l=e==null?void 0:e.configuration)==null?void 0:l.baseOptions)==null?void 0:c.params),...r,...e==null?void 0:e.configuration}}invocationParams(e){return{model:this.modelName,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,n:this.n,logit_bias:this.logitBias,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,stop:(e==null?void 0:e.stop)??this.stop,user:this.user,stream:this.streaming,...this.modelKwargs}}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}formatMessages(e){const r={role:"user",content:e};return this.prefixMessages?[...this.prefixMessages,r]:[r]}async*_streamResponseChunks(e,r,n){var s;const i={...this.invocationParams(r),messages:this.formatMessages(e),stream:!0},a=await this.completionWithRetry(i,r);for await(const o of a){const u=o==null?void 0:o.choices[0];if(!u)continue;const{delta:l}=u,c=new Vi({text:l.content??""});yield c;const h={prompt:r.promptIndex??0,completion:u.index??0};n==null||n.handleLLMNewToken(c.text??"",h)}if((s=r.signal)!=null&&s.aborted)throw new Error("AbortError")}async _call(e,r,n){var a,s;const i=this.invocationParams(r);if(i.stream){const o=await this._streamResponseChunks(e,r,n);let u;for await(const l of o)u===void 0?u=l:u=u.concat(l);return(u==null?void 0:u.text)??""}else{const o=await this.completionWithRetry({...i,stream:!1,messages:this.formatMessages(e)},{signal:r.signal,...r.options});return((s=(a=o==null?void 0:o.choices[0])==null?void 0:a.message)==null?void 0:s.content)??""}}async completionWithRetry(e,r){const n=this._getClientOptions(r);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(e,n)}catch(i){throw Xm(i)}})}_getClientOptions(e){if(!this.client){const n={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL},i=S1(n),a={...this.clientConfig,baseURL:i,timeout:this.timeout,maxRetries:0};a.baseURL||delete a.baseURL,this.client=new bt(a)}const r={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(r.headers={"api-key":this.azureOpenAIApiKey,...r.headers},r.query={"api-version":this.azureOpenAIApiVersion,...r.query}),r}_llmType(){return"openai"}}class Yze extends Go{static lc_name(){return"OpenAI"}get callKeys(){return[...super.callKeys,"options"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,r){var i,a,s,o,u,l,c,h;let n=(e==null?void 0:e.model)??(e==null?void 0:e.modelName);if((n!=null&&n.startsWith("gpt-3.5-turbo")||n!=null&&n.startsWith("gpt-4"))&&!(n!=null&&n.includes("-instruct")))return console.warn([`Your chosen OpenAI model, "${n}", is a chat model and not a text-in/text-out LLM.`,'Passing it into the "OpenAI" class is deprecated and only permitted for backwards-compatibility. You may experience odd behavior.','Please use the "ChatOpenAI" class instead.',"","See this page for more information:","|","└> https://js.langchain.com/v0.2/docs/integrations/chat/openai"].join(`
`)),new Gze(e,r);if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:256}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"bestOf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo-instruct"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo-instruct"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:20}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n=n??this.model,this.openAIApiKey=(e==null?void 0:e.apiKey)??(e==null?void 0:e.openAIApiKey)??Me("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=(e==null?void 0:e.azureOpenAIApiKey)??Me("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=(e==null?void 0:e.azureADTokenProvider)??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=(e==null?void 0:e.azureOpenAIApiInstanceName)??Me("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=((e==null?void 0:e.azureOpenAIApiCompletionsDeploymentName)||(e==null?void 0:e.azureOpenAIApiDeploymentName))??(Me("AZURE_OPENAI_API_COMPLETIONS_DEPLOYMENT_NAME")||Me("AZURE_OPENAI_API_DEPLOYMENT_NAME")),this.azureOpenAIApiVersion=(e==null?void 0:e.azureOpenAIApiVersion)??Me("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(e==null?void 0:e.azureOpenAIBasePath)??Me("AZURE_OPENAI_BASE_PATH"),this.organization=((i=e==null?void 0:e.configuration)==null?void 0:i.organization)??Me("OPENAI_ORGANIZATION"),this.modelName=n,this.model=n,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.batchSize=(e==null?void 0:e.batchSize)??this.batchSize,this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.maxTokens=(e==null?void 0:e.maxTokens)??this.maxTokens,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.n=(e==null?void 0:e.n)??this.n,this.bestOf=(e==null?void 0:e.bestOf)??this.bestOf,this.logitBias=e==null?void 0:e.logitBias,this.stop=(e==null?void 0:e.stopSequences)??(e==null?void 0:e.stop),this.stopSequences=e==null?void 0:e.stopSequences,this.user=e==null?void 0:e.user,this.streaming=(e==null?void 0:e.streaming)??!1,this.streaming&&this.bestOf&&this.bestOf>1)throw new Error("Cannot stream results when bestOf > 1");if(this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??""}this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:(r==null?void 0:r.basePath)??((a=e==null?void 0:e.configuration)==null?void 0:a.basePath),dangerouslyAllowBrowser:!0,defaultHeaders:((s=r==null?void 0:r.baseOptions)==null?void 0:s.headers)??((u=(o=e==null?void 0:e.configuration)==null?void 0:o.baseOptions)==null?void 0:u.headers),defaultQuery:((l=r==null?void 0:r.baseOptions)==null?void 0:l.params)??((h=(c=e==null?void 0:e.configuration)==null?void 0:c.baseOptions)==null?void 0:h.params),...r,...e==null?void 0:e.configuration}}invocationParams(e){return{model:this.model,temperature:this.temperature,max_tokens:this.maxTokens,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,n:this.n,best_of:this.bestOf,logit_bias:this.logitBias,stop:(e==null?void 0:e.stop)??this.stopSequences,user:this.user,stream:this.streaming,...this.modelKwargs}}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return this._identifyingParams()}async _generate(e,r,n){const i=Cw(e,this.batchSize),a=[],s={},o=this.invocationParams(r);if(o.max_tokens===-1){if(e.length!==1)throw new Error("max_tokens set to -1 not supported for multiple inputs");o.max_tokens=await S8({prompt:e[0],modelName:this.model})}for(let l=0;l<i.length;l+=1){const c=o.stream?await(async()=>{var v;const p=[];let m;const g=await this.completionWithRetry({...o,stream:!0,prompt:i[l]},r);for await(const y of g){m||(m={id:y.id,object:y.object,created:y.created,model:y.model});for(const b of y.choices){if(!p[b.index])p[b.index]=b;else{const w=p[b.index];w.text+=b.text,w.finish_reason=b.finish_reason,w.logprobs=b.logprobs}n==null||n.handleLLMNewToken(b.text,{prompt:Math.floor(b.index/this.n),completion:b.index%this.n})}}if((v=r.signal)!=null&&v.aborted)throw new Error("AbortError");return{...m,choices:p}})():await this.completionWithRetry({...o,stream:!1,prompt:i[l]},{signal:r.signal,...r.options});a.push(...c.choices);const{completion_tokens:h,prompt_tokens:d,total_tokens:f}=c.usage?c.usage:{completion_tokens:void 0,prompt_tokens:void 0,total_tokens:void 0};h&&(s.completionTokens=(s.completionTokens??0)+h),d&&(s.promptTokens=(s.promptTokens??0)+d),f&&(s.totalTokens=(s.totalTokens??0)+f)}return{generations:Cw(a,this.n).map(l=>l.map(c=>({text:c.text??"",generationInfo:{finishReason:c.finish_reason,logprobs:c.logprobs}}))),llmOutput:{tokenUsage:s}}}async*_streamResponseChunks(e,r,n){var s;const i={...this.invocationParams(r),prompt:e,stream:!0},a=await this.completionWithRetry(i,r);for await(const o of a){const u=o==null?void 0:o.choices[0];if(!u)continue;const l=new Vi({text:u.text,generationInfo:{finishReason:u.finish_reason}});yield l,n==null||n.handleLLMNewToken(l.text??"")}if((s=r.signal)!=null&&s.aborted)throw new Error("AbortError")}async completionWithRetry(e,r){const n=this._getClientOptions(r);return this.caller.call(async()=>{try{return await this.client.completions.create(e,n)}catch(i){throw Xm(i)}})}_getClientOptions(e){if(!this.client){const n={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL},i=S1(n),a={...this.clientConfig,baseURL:i,timeout:this.timeout,maxRetries:0};a.baseURL||delete a.baseURL,this.client=new bt(a)}const r={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(r.headers={"api-key":this.azureOpenAIApiKey,...r.headers},r.query={"api-version":this.azureOpenAIApiVersion,...r.query}),r}_llmType(){return"openai"}}class GI extends Ld{constructor(e,r){var l,c,h;const n={maxConcurrency:2,...e};super(n),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"text-embedding-ada-002"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"text-embedding-ada-002"}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:512}),Object.defineProperty(this,"stripNewLines",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"dimensions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let i=(n==null?void 0:n.apiKey)??(n==null?void 0:n.openAIApiKey)??Me("OPENAI_API_KEY");const a=(n==null?void 0:n.azureOpenAIApiKey)??Me("AZURE_OPENAI_API_KEY");if(this.azureADTokenProvider=(e==null?void 0:e.azureADTokenProvider)??void 0,!a&&!i&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");const s=(n==null?void 0:n.azureOpenAIApiInstanceName)??Me("AZURE_OPENAI_API_INSTANCE_NAME"),o=((n==null?void 0:n.azureOpenAIApiEmbeddingsDeploymentName)||(n==null?void 0:n.azureOpenAIApiDeploymentName))??(Me("AZURE_OPENAI_API_EMBEDDINGS_DEPLOYMENT_NAME")||Me("AZURE_OPENAI_API_DEPLOYMENT_NAME")),u=(n==null?void 0:n.azureOpenAIApiVersion)??Me("AZURE_OPENAI_API_VERSION");if(this.azureOpenAIBasePath=(n==null?void 0:n.azureOpenAIBasePath)??Me("AZURE_OPENAI_BASE_PATH"),this.organization=((l=n==null?void 0:n.configuration)==null?void 0:l.organization)??Me("OPENAI_ORGANIZATION"),this.modelName=(n==null?void 0:n.model)??(n==null?void 0:n.modelName)??this.model,this.model=this.modelName,this.batchSize=(n==null?void 0:n.batchSize)??(a?1:this.batchSize),this.stripNewLines=(n==null?void 0:n.stripNewLines)??this.stripNewLines,this.timeout=n==null?void 0:n.timeout,this.dimensions=n==null?void 0:n.dimensions,this.azureOpenAIApiVersion=u,this.azureOpenAIApiKey=a,this.azureOpenAIApiInstanceName=s,this.azureOpenAIApiDeploymentName=o,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");i=i??""}this.clientConfig={apiKey:i,organization:this.organization,baseURL:r==null?void 0:r.basePath,dangerouslyAllowBrowser:!0,defaultHeaders:(c=r==null?void 0:r.baseOptions)==null?void 0:c.headers,defaultQuery:(h=r==null?void 0:r.baseOptions)==null?void 0:h.params,...r,...e==null?void 0:e.configuration}}async embedDocuments(e){const r=Cw(this.stripNewLines?e.map(s=>s.replace(/\n/g," ")):e,this.batchSize),n=r.map(s=>{const o={model:this.model,input:s};return this.dimensions&&(o.dimensions=this.dimensions),this.embeddingWithRetry(o)}),i=await Promise.all(n),a=[];for(let s=0;s<i.length;s+=1){const o=r[s],{data:u}=i[s];for(let l=0;l<o.length;l+=1)a.push(u[l].embedding)}return a}async embedQuery(e){const r={model:this.model,input:this.stripNewLines?e.replace(/\n/g," "):e};this.dimensions&&(r.dimensions=this.dimensions);const{data:n}=await this.embeddingWithRetry(r);return n[0].embedding}async embeddingWithRetry(e){if(!this.client){const n={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL},i=S1(n),a={...this.clientConfig,baseURL:i,timeout:this.timeout,maxRetries:0};a.baseURL||delete a.baseURL,this.client=new bt(a)}const r={};return this.azureOpenAIApiKey&&(r.headers={"api-key":this.azureOpenAIApiKey,...r.headers},r.query={"api-version":this.azureOpenAIApiVersion,...r.query}),this.caller.call(async()=>{try{return await this.client.embeddings.create(e,r)}catch(n){throw Xm(n)}})}}class Jze extends st{static lc_name(){return"OpenAIModerationChain"}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY"}}constructor(e){if(super(e),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output"}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIOrganization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"throwError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.throwError=(e==null?void 0:e.throwError)??!1,this.openAIApiKey=(e==null?void 0:e.apiKey)??(e==null?void 0:e.openAIApiKey)??Me("OPENAI_API_KEY"),!this.openAIApiKey)throw new Error("OpenAI API key not found");this.openAIOrganization=e==null?void 0:e.openAIOrganization,this.clientConfig={...e==null?void 0:e.configuration,apiKey:this.openAIApiKey,organization:this.openAIOrganization},this.client=new bt(this.clientConfig),this.caller=new Zl(e??{})}_moderate(e,r){if(r.flagged){const n="Text was found that violates OpenAI's content policy.";if(this.throwError)throw new Error(n);return n}return e}async _call(e){const r=e[this.inputKey],n={input:r};let i;try{i=await this.caller.call(()=>this.client.moderations.create(n))}catch(s){throw s instanceof Error?s:new Error(s)}const a=this._moderate(r,i.results[0]);return{[this.outputKey]:a,results:i.results}}_chainType(){return"moderation_chain"}get inputKeys(){return[this.inputKey]}get outputKeys(){return[this.outputKey]}}class BV extends st{get outputKeys(){return["destination","next_inputs"]}async route(e,r){const n=await this.call(e,r);return{destination:n.destination,nextInputs:n.next_inputs}}}class YI extends st{static lc_name(){return"MultiRouteChain"}constructor(e){super(e),Object.defineProperty(this,"routerChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"destinationChains",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"defaultChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"silentErrors",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.routerChain=e.routerChain,this.destinationChains=e.destinationChains,this.defaultChain=e.defaultChain,this.silentErrors=e.silentErrors??this.silentErrors}get inputKeys(){return this.routerChain.inputKeys}get outputKeys(){return[]}async _call(e,r){const{destination:n,nextInputs:i}=await this.routerChain.route(e,r==null?void 0:r.getChild());if(await(r==null?void 0:r.handleText(`${n}: ${JSON.stringify(i)}`)),!n)return this.defaultChain.call(i,r==null?void 0:r.getChild()).catch(a=>{throw new Error(`Error in default chain: ${a}`)});if(n in this.destinationChains)return this.destinationChains[n].call(i,r==null?void 0:r.getChild()).catch(a=>{throw new Error(`Error in ${n} chain: ${a}`)});if(this.silentErrors)return this.defaultChain.call(i,r==null?void 0:r.getChild()).catch(a=>{throw new Error(`Error in default chain: ${a}`)});throw new Error(`Destination ${n} not found in destination chains with keys ${Object.keys(this.destinationChains)}`)}_chainType(){return"multi_route_chain"}}class Wg extends BV{constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmChain=e.llmChain}get inputKeys(){return this.llmChain.inputKeys}async _call(e,r){return this.llmChain.predict(e,r==null?void 0:r.getChild())}_chainType(){return"llm_router_chain"}static fromLLM(e,r,n){const i=new Pe({llm:e,prompt:r});return new Wg({...n,llmChain:i})}}const Zze=t=>`Given a raw text input to a language model, select the model prompt best suited for the input. You will be given the names of the available prompts and a description of what the prompt is best suited for. You may also revise the original input if you think that revising it will ultimately lead to a better response from the language model.

<< FORMATTING >>
${t}

REMEMBER: "destination" MUST be one of the candidate prompt names specified below OR it can be "DEFAULT" if the input is not well suited for any of the candidate prompts.
REMEMBER: "next_inputs.input" can just be the original input if you don't think any modifications are needed.

<< CANDIDATE PROMPTS >>
{destinations}

<< INPUT >>
{{input}}

<< OUTPUT >>
`;function p0(...t){if(t.length===0)return[];const e=t[0].length;for(const n of t)if(n.length!==e)throw new Error("All input arrays must have the same length.");const r=[];for(let n=0;n<e;n+=1){const i=[];for(const a of t)i.push(a[n]);r.push(i)}return r}class qV extends zr{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const r=tt.object(Object.fromEntries(Object.entries(e).map(([n,i])=>[n,tt.string().describe(i)])));return new this(r)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(Ur(this.schema))}
\`\`\`
`}async parse(e){try{const r=e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim();return await this.schema.parseAsync(JSON.parse(r))}catch(r){throw new ft(`Failed to parse. Text: "${e}". Error: ${r}`,e)}}}class JI extends qV{static lc_name(){return"JsonMarkdownStructuredOutputParser"}getFormatInstructions(e){const r=(e==null?void 0:e.interpolationDepth)??1;if(r<1)throw new Error("f string interpolation depth must be at least 1");return`Return a markdown code snippet with a JSON object formatted to look like:
\`\`\`json
${this._schemaToInstruction(Ur(this.schema)).replaceAll("{","{".repeat(r)).replaceAll("}","}".repeat(r))}
\`\`\``}_schemaToInstruction(e,r=2){const n=e;if("type"in n){let i=!1,a;if(Array.isArray(n.type)){const u=n.type.findIndex(l=>l==="null");u!==-1&&(i=!0,n.type.splice(u,1)),a=n.type.join(" | ")}else a=n.type;if(n.type==="object"&&n.properties){const u=n.description?` // ${n.description}`:"";return`{
${Object.entries(n.properties).map(([c,h])=>{var f;const d=(f=n.required)!=null&&f.includes(c)?"":" (optional)";return`${" ".repeat(r)}"${c}": ${this._schemaToInstruction(h,r+2)}${d}`}).join(`
`)}
${" ".repeat(r-2)}}${u}`}if(n.type==="array"&&n.items){const u=n.description?` // ${n.description}`:"";return`array[
${" ".repeat(r)}${this._schemaToInstruction(n.items,r+2)}
${" ".repeat(r-2)}] ${u}`}const s=i?" (nullable)":"",o=n.description?` // ${n.description}`:"";return`${a}${o}${s}`}if("anyOf"in n)return n.anyOf.map(i=>this._schemaToInstruction(i,r)).join(`
${" ".repeat(r-2)}`);throw new Error("unsupported schema type")}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const r=tt.object(Object.fromEntries(Object.entries(e).map(([n,i])=>[n,tt.string().describe(i)])));return new this(r)}}class Xze extends zr{constructor({inputSchema:e}){super(...arguments),Object.defineProperty(this,"structuredInputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.structuredInputParser=new JI(e)}async parse(e){let r;try{r=await this.structuredInputParser.parse(e)}catch(n){throw new ft(`Failed to parse. Text: "${e}". Error: ${n}`,e)}return this.outputProcessor(r)}getFormatInstructions(){return this.structuredInputParser.getFormatInstructions()}}class ZI extends JI{constructor(e,r){super(e),Object.defineProperty(this,"defaultDestination",{enumerable:!0,configurable:!0,writable:!0,value:"DEFAULT"}),this.defaultDestination=(r==null?void 0:r.defaultDestination)??this.defaultDestination}async parse(e){var r;try{const n=await super.parse(e);return((r=n.destination)==null?void 0:r.toLowerCase())===this.defaultDestination.toLowerCase()&&(n.destination=null),n}catch(n){throw new ft(`Failed to parse. Text: "${e}". Error: ${n}`,e)}}}class m0 extends YI{static fromPrompts(e,r,n,i,a,s){return m0.fromLLMAndPrompts(e,{promptNames:r,promptDescriptions:n,promptTemplates:i,defaultChain:a,multiRouteChainOpts:s})}static fromLLMAndPrompts(e,{promptNames:r,promptDescriptions:n,promptTemplates:i,defaultChain:a,llmChainOpts:s,conversationChainOpts:o,multiRouteChainOpts:u}){const l=p0(r,n).map(([y,b])=>`${y}: ${b}`),c=tt.object({destination:tt.string().optional().describe('name of the question answering system to use or "DEFAULT"'),next_inputs:tt.object({input:tt.string().describe("a potentially modified version of the original input")}).describe("input to be fed to the next model")}),h=new ZI(c),d=l.join(`
`),f=l1(Zze(h.getFormatInstructions({interpolationDepth:4})),{destinations:d}),p=new ve({template:f,inputVariables:["input"],outputParser:h}),m=Wg.fromLLM(e,p),g=p0(r,i).reduce((y,[b,w])=>{let _;if(typeof w=="object")_=w;else if(typeof w=="string")_=new ve({template:w,inputVariables:["input"]});else throw new Error("Invalid prompt template");return y[b]=new Pe({...s,llm:e,prompt:_}),y},{}),v=new bI({...o,llm:e,outputKey:"text"});return new m0({...u,routerChain:m,destinationChains:g,defaultChain:a??v})}_chainType(){return"multi_prompt_chain"}}const Qze=t=>`Given a query to a question answering system, select the system best suited for the input. You will be given the names of the available systems and a description of what questions the system is best suited for. You may also revise the original input if you think that revising it will ultimately lead to a better response.

<< FORMATTING >>
${t}

REMEMBER: "destination" MUST be one of the candidate prompt names specified below OR it can be "DEFAULT" if the input is not well suited for any of the candidate prompts.
REMEMBER: "next_inputs.query" can just be the original input if you don't think any modifications are needed.

<< CANDIDATE PROMPTS >>
{destinations}

<< INPUT >>
{{input}}

<< OUTPUT >>
`;class g0 extends YI{get outputKeys(){return["result"]}static fromRetrievers(e,r,n,i,a,s,o){return g0.fromLLMAndRetrievers(e,{retrieverNames:r,retrieverDescriptions:n,retrievers:i,retrieverPrompts:a,defaults:s,multiRetrievalChainOpts:o})}static fromLLMAndRetrievers(e,{retrieverNames:r,retrieverDescriptions:n,retrievers:i,retrieverPrompts:a,defaults:s,multiRetrievalChainOpts:o,retrievalQAChainOpts:u}){const{defaultRetriever:l,defaultPrompt:c,defaultChain:h}=s??{};if(c&&!l)throw new Error("`default_retriever` must be specified if `default_prompt` is \nprovided. Received only `default_prompt`.");const d=p0(r,n).map(([O,P])=>`${O}: ${P}`),f=tt.object({destination:tt.string().optional().describe('name of the question answering system to use or "DEFAULT"'),next_inputs:tt.object({query:tt.string().describe("a potentially modified version of the original input")}).describe("input to be fed to the next model")}),p=new ZI(f),m=d.join(`
`),g=l1(Qze(p.getFormatInstructions({interpolationDepth:4})),{destinations:m}),v=new ve({template:g,inputVariables:["input"],outputParser:p}),y=Wg.fromLLM(e,v),b=a??i.map(()=>null),w=p0(r,i,b).reduce((O,[P,x,j])=>{const k=u??{};return j&&(k.prompt=j),O[P]=fA.fromLLM(e,x,k),O},{});let _;if(h)_=h;else if(l)_=fA.fromLLM(e,l,{...u,prompt:c});else{const O=iV.replace("input","query"),P=new ve({template:O,inputVariables:["history","query"]});_=new bI({llm:e,prompt:P,outputKey:"result"})}return new g0({...o,routerChain:y,destinationChains:w,defaultChain:_})}_chainType(){return"multi_retrieval_qa_chain"}}class eBe extends st{static lc_name(){return"TransformChain"}_chainType(){return"transform"}get inputKeys(){return this.inputVariables}get outputKeys(){return this.outputVariables}constructor(e){super(e),Object.defineProperty(this,"transformFunc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.transformFunc=e.transform,this.inputVariables=e.inputVariables,this.outputVariables=e.outputVariables}async _call(e,r){return this.transformFunc(e,r==null?void 0:r.getChild("transform"))}}class XI extends wi{static lc_name(){return"OutputFunctionsParser"}constructor(e){super(),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_functions"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"argsOnly",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.argsOnly=(e==null?void 0:e.argsOnly)??this.argsOnly}async parseResult(e){if("message"in e[0]){const n=e[0].message.additional_kwargs.function_call;if(!n)throw new Error(`No function_call in message ${JSON.stringify(e)}`);if(!n.arguments)throw new Error(`No arguments in function_call ${JSON.stringify(e)}`);return this.argsOnly?n.arguments:JSON.stringify(n)}else throw new Error(`No message in generations ${JSON.stringify(e)}`)}}class Jd extends u1{static lc_name(){return"JsonOutputFunctionsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_functions"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argsOnly",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.argsOnly=(e==null?void 0:e.argsOnly)??this.argsOnly,this.outputParser=new XI(e)}_diff(e,r){return r?q_(e??{},r):void 0}async parsePartialResult(e){const r=e[0];if(!r.message)return;const{message:n}=r,i=n.additional_kwargs.function_call;if(i)return this.argsOnly?Wh(i.arguments):{...i,arguments:Wh(i.arguments)}}async parseResult(e){const r=await this.outputParser.parseResult(e);if(!r)throw new Error(`No result from "OutputFunctionsParser" ${JSON.stringify(e)}`);return this.parse(r)}async parse(e){const r=JSON.parse(e);return this.argsOnly||(r.arguments=JSON.parse(r.arguments)),r}getFormatInstructions(){return""}}class KV extends wi{static lc_name(){return"JsonKeyOutputFunctionsParser"}get lc_aliases(){return{attrName:"key_name"}}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_functions"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:new Jd}),Object.defineProperty(this,"attrName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.attrName=e.attrName}async parseResult(e){return(await this.outputParser.parseResult(e))[this.attrName]}}function tBe(t){return[{name:"information_extraction",description:"Extracts the relevant information from the passage.",parameters:{type:"object",properties:{info:{type:"array",items:{type:t.type,properties:t.properties,required:t.required}}},required:["info"]}}]}const rBe=`Extract and save the relevant entities mentioned in the following passage together with their properties.

Passage:
{input}
`;function QI(t,e){const r=tBe(t),n=ve.fromTemplate(rBe),i=new KV({attrName:"info"});return new Pe({llm:e,prompt:n,llmKwargs:{functions:r},outputParser:i,tags:["openai_functions","extraction"]})}function VV(t,e){return QI(Ur(t),e)}function nBe(t){return[{name:"information_extraction",description:"Extracts the relevant information from the passage.",parameters:t}]}const iBe=`Extract the desired information from the following passage.

Passage:
{input}
`;function P1(t,e,r={}){const{prompt:n=ve.fromTemplate(iBe),...i}=r,a=nBe(t),s=new Jd;return new Pe({llm:e,prompt:n,llmKwargs:{functions:a},outputParser:s,tags:["openai_functions","tagging"],...i})}function HV(t,e,r){return P1(Ur(t),e,r)}/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function WV(t){return typeof t>"u"||t===null}function aBe(t){return typeof t=="object"&&t!==null}function sBe(t){return Array.isArray(t)?t:WV(t)?[]:[t]}function oBe(t,e){var r,n,i,a;if(e)for(a=Object.keys(e),r=0,n=a.length;r<n;r+=1)i=a[r],t[i]=e[i];return t}function uBe(t,e){var r="",n;for(n=0;n<e;n+=1)r+=t;return r}function lBe(t){return t===0&&Number.NEGATIVE_INFINITY===1/t}var cBe=WV,hBe=aBe,dBe=sBe,fBe=uBe,pBe=lBe,mBe=oBe,On={isNothing:cBe,isObject:hBe,toArray:dBe,repeat:fBe,isNegativeZero:pBe,extend:mBe};function GV(t,e){var r="",n=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(r+='in "'+t.mark.name+'" '),r+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!e&&t.mark.snippet&&(r+=`

`+t.mark.snippet),n+" "+r):n}function Qm(t,e){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=e,this.message=GV(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}Qm.prototype=Object.create(Error.prototype);Qm.prototype.constructor=Qm;Qm.prototype.toString=function(e){return this.name+": "+GV(this,e)};var Ns=Qm;function BO(t,e,r,n,i){var a="",s="",o=Math.floor(i/2)-1;return n-e>o&&(a=" ... ",e=n-o+a.length),r-n>o&&(s=" ...",r=n+o-s.length),{str:a+t.slice(e,r).replace(/\t/g,"→")+s,pos:n-e+a.length}}function qO(t,e){return On.repeat(" ",e-t.length)+t}function gBe(t,e){if(e=Object.create(e||null),!t.buffer)return null;e.maxLength||(e.maxLength=79),typeof e.indent!="number"&&(e.indent=1),typeof e.linesBefore!="number"&&(e.linesBefore=3),typeof e.linesAfter!="number"&&(e.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],i=[],a,s=-1;a=r.exec(t.buffer);)i.push(a.index),n.push(a.index+a[0].length),t.position<=a.index&&s<0&&(s=n.length-2);s<0&&(s=n.length-1);var o="",u,l,c=Math.min(t.line+e.linesAfter,i.length).toString().length,h=e.maxLength-(e.indent+c+3);for(u=1;u<=e.linesBefore&&!(s-u<0);u++)l=BO(t.buffer,n[s-u],i[s-u],t.position-(n[s]-n[s-u]),h),o=On.repeat(" ",e.indent)+qO((t.line-u+1).toString(),c)+" | "+l.str+`
`+o;for(l=BO(t.buffer,n[s],i[s],t.position,h),o+=On.repeat(" ",e.indent)+qO((t.line+1).toString(),c)+" | "+l.str+`
`,o+=On.repeat("-",e.indent+c+3+l.pos)+`^
`,u=1;u<=e.linesAfter&&!(s+u>=i.length);u++)l=BO(t.buffer,n[s+u],i[s+u],t.position-(n[s]-n[s+u]),h),o+=On.repeat(" ",e.indent)+qO((t.line+u+1).toString(),c)+" | "+l.str+`
`;return o.replace(/\n$/,"")}var yBe=gBe,vBe=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],bBe=["scalar","sequence","mapping"];function wBe(t){var e={};return t!==null&&Object.keys(t).forEach(function(r){t[r].forEach(function(n){e[String(n)]=r})}),e}function _Be(t,e){if(e=e||{},Object.keys(e).forEach(function(r){if(vBe.indexOf(r)===-1)throw new Ns('Unknown option "'+r+'" is met in definition of "'+t+'" YAML type.')}),this.options=e,this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(r){return r},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=wBe(e.styleAliases||null),bBe.indexOf(this.kind)===-1)throw new Ns('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')}var hn=_Be;function GF(t,e){var r=[];return t[e].forEach(function(n){var i=r.length;r.forEach(function(a,s){a.tag===n.tag&&a.kind===n.kind&&a.multi===n.multi&&(i=s)}),r[i]=n}),r}function xBe(){var t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,r;function n(i){i.multi?(t.multi[i.kind].push(i),t.multi.fallback.push(i)):t[i.kind][i.tag]=t.fallback[i.tag]=i}for(e=0,r=arguments.length;e<r;e+=1)arguments[e].forEach(n);return t}function AA(t){return this.extend(t)}AA.prototype.extend=function(e){var r=[],n=[];if(e instanceof hn)n.push(e);else if(Array.isArray(e))n=n.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(r=r.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit));else throw new Ns("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(a){if(!(a instanceof hn))throw new Ns("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(a.loadKind&&a.loadKind!=="scalar")throw new Ns("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(a.multi)throw new Ns("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(a){if(!(a instanceof hn))throw new Ns("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(AA.prototype);return i.implicit=(this.implicit||[]).concat(r),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=GF(i,"implicit"),i.compiledExplicit=GF(i,"explicit"),i.compiledTypeMap=xBe(i.compiledImplicit,i.compiledExplicit),i};var OBe=AA,SBe=new hn("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return t!==null?t:""}}),PBe=new hn("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return t!==null?t:[]}}),EBe=new hn("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return t!==null?t:{}}}),ABe=new OBe({explicit:[SBe,PBe,EBe]});function TBe(t){if(t===null)return!0;var e=t.length;return e===1&&t==="~"||e===4&&(t==="null"||t==="Null"||t==="NULL")}function kBe(){return null}function CBe(t){return t===null}var IBe=new hn("tag:yaml.org,2002:null",{kind:"scalar",resolve:TBe,construct:kBe,predicate:CBe,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function $Be(t){if(t===null)return!1;var e=t.length;return e===4&&(t==="true"||t==="True"||t==="TRUE")||e===5&&(t==="false"||t==="False"||t==="FALSE")}function jBe(t){return t==="true"||t==="True"||t==="TRUE"}function RBe(t){return Object.prototype.toString.call(t)==="[object Boolean]"}var NBe=new hn("tag:yaml.org,2002:bool",{kind:"scalar",resolve:$Be,construct:jBe,predicate:RBe,represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function MBe(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function DBe(t){return 48<=t&&t<=55}function LBe(t){return 48<=t&&t<=57}function FBe(t){if(t===null)return!1;var e=t.length,r=0,n=!1,i;if(!e)return!1;if(i=t[r],(i==="-"||i==="+")&&(i=t[++r]),i==="0"){if(r+1===e)return!0;if(i=t[++r],i==="b"){for(r++;r<e;r++)if(i=t[r],i!=="_"){if(i!=="0"&&i!=="1")return!1;n=!0}return n&&i!=="_"}if(i==="x"){for(r++;r<e;r++)if(i=t[r],i!=="_"){if(!MBe(t.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}if(i==="o"){for(r++;r<e;r++)if(i=t[r],i!=="_"){if(!DBe(t.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}}if(i==="_")return!1;for(;r<e;r++)if(i=t[r],i!=="_"){if(!LBe(t.charCodeAt(r)))return!1;n=!0}return!(!n||i==="_")}function UBe(t){var e=t,r=1,n;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),n=e[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),e=e.slice(1),n=e[0]),e==="0")return 0;if(n==="0"){if(e[1]==="b")return r*parseInt(e.slice(2),2);if(e[1]==="x")return r*parseInt(e.slice(2),16);if(e[1]==="o")return r*parseInt(e.slice(2),8)}return r*parseInt(e,10)}function zBe(t){return Object.prototype.toString.call(t)==="[object Number]"&&t%1===0&&!On.isNegativeZero(t)}var BBe=new hn("tag:yaml.org,2002:int",{kind:"scalar",resolve:FBe,construct:UBe,predicate:zBe,represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),qBe=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function KBe(t){return!(t===null||!qBe.test(t)||t[t.length-1]==="_")}function VBe(t){var e,r;return e=t.replace(/_/g,"").toLowerCase(),r=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:r*parseFloat(e,10)}var HBe=/^[-+]?[0-9]+e/;function WBe(t,e){var r;if(isNaN(t))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(On.isNegativeZero(t))return"-0.0";return r=t.toString(10),HBe.test(r)?r.replace("e",".e"):r}function GBe(t){return Object.prototype.toString.call(t)==="[object Number]"&&(t%1!==0||On.isNegativeZero(t))}var YBe=new hn("tag:yaml.org,2002:float",{kind:"scalar",resolve:KBe,construct:VBe,predicate:GBe,represent:WBe,defaultStyle:"lowercase"}),JBe=ABe.extend({implicit:[IBe,NBe,BBe,YBe]}),ZBe=JBe,YV=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),JV=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function XBe(t){return t===null?!1:YV.exec(t)!==null||JV.exec(t)!==null}function QBe(t){var e,r,n,i,a,s,o,u=0,l=null,c,h,d;if(e=YV.exec(t),e===null&&(e=JV.exec(t)),e===null)throw new Error("Date resolve error");if(r=+e[1],n=+e[2]-1,i=+e[3],!e[4])return new Date(Date.UTC(r,n,i));if(a=+e[4],s=+e[5],o=+e[6],e[7]){for(u=e[7].slice(0,3);u.length<3;)u+="0";u=+u}return e[9]&&(c=+e[10],h=+(e[11]||0),l=(c*60+h)*6e4,e[9]==="-"&&(l=-l)),d=new Date(Date.UTC(r,n,i,a,s,o,u)),l&&d.setTime(d.getTime()-l),d}function eqe(t){return t.toISOString()}var tqe=new hn("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:XBe,construct:QBe,instanceOf:Date,represent:eqe});function rqe(t){return t==="<<"||t===null}var nqe=new hn("tag:yaml.org,2002:merge",{kind:"scalar",resolve:rqe}),e$=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function iqe(t){if(t===null)return!1;var e,r,n=0,i=t.length,a=e$;for(r=0;r<i;r++)if(e=a.indexOf(t.charAt(r)),!(e>64)){if(e<0)return!1;n+=6}return n%8===0}function aqe(t){var e,r,n=t.replace(/[\r\n=]/g,""),i=n.length,a=e$,s=0,o=[];for(e=0;e<i;e++)e%4===0&&e&&(o.push(s>>16&255),o.push(s>>8&255),o.push(s&255)),s=s<<6|a.indexOf(n.charAt(e));return r=i%4*6,r===0?(o.push(s>>16&255),o.push(s>>8&255),o.push(s&255)):r===18?(o.push(s>>10&255),o.push(s>>2&255)):r===12&&o.push(s>>4&255),new Uint8Array(o)}function sqe(t){var e="",r=0,n,i,a=t.length,s=e$;for(n=0;n<a;n++)n%3===0&&n&&(e+=s[r>>18&63],e+=s[r>>12&63],e+=s[r>>6&63],e+=s[r&63]),r=(r<<8)+t[n];return i=a%3,i===0?(e+=s[r>>18&63],e+=s[r>>12&63],e+=s[r>>6&63],e+=s[r&63]):i===2?(e+=s[r>>10&63],e+=s[r>>4&63],e+=s[r<<2&63],e+=s[64]):i===1&&(e+=s[r>>2&63],e+=s[r<<4&63],e+=s[64],e+=s[64]),e}function oqe(t){return Object.prototype.toString.call(t)==="[object Uint8Array]"}var uqe=new hn("tag:yaml.org,2002:binary",{kind:"scalar",resolve:iqe,construct:aqe,predicate:oqe,represent:sqe}),lqe=Object.prototype.hasOwnProperty,cqe=Object.prototype.toString;function hqe(t){if(t===null)return!0;var e=[],r,n,i,a,s,o=t;for(r=0,n=o.length;r<n;r+=1){if(i=o[r],s=!1,cqe.call(i)!=="[object Object]")return!1;for(a in i)if(lqe.call(i,a))if(!s)s=!0;else return!1;if(!s)return!1;if(e.indexOf(a)===-1)e.push(a);else return!1}return!0}function dqe(t){return t!==null?t:[]}var fqe=new hn("tag:yaml.org,2002:omap",{kind:"sequence",resolve:hqe,construct:dqe}),pqe=Object.prototype.toString;function mqe(t){if(t===null)return!0;var e,r,n,i,a,s=t;for(a=new Array(s.length),e=0,r=s.length;e<r;e+=1){if(n=s[e],pqe.call(n)!=="[object Object]"||(i=Object.keys(n),i.length!==1))return!1;a[e]=[i[0],n[i[0]]]}return!0}function gqe(t){if(t===null)return[];var e,r,n,i,a,s=t;for(a=new Array(s.length),e=0,r=s.length;e<r;e+=1)n=s[e],i=Object.keys(n),a[e]=[i[0],n[i[0]]];return a}var yqe=new hn("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:mqe,construct:gqe}),vqe=Object.prototype.hasOwnProperty;function bqe(t){if(t===null)return!0;var e,r=t;for(e in r)if(vqe.call(r,e)&&r[e]!==null)return!1;return!0}function wqe(t){return t!==null?t:{}}var _qe=new hn("tag:yaml.org,2002:set",{kind:"mapping",resolve:bqe,construct:wqe}),xqe=ZBe.extend({implicit:[tqe,nqe],explicit:[uqe,fqe,yqe,_qe]}),yu=Object.prototype.hasOwnProperty,y0=1,ZV=2,XV=3,v0=4,KO=1,Oqe=2,YF=3,Sqe=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Pqe=/[\x85\u2028\u2029]/,Eqe=/[,\[\]\{\}]/,QV=/^(?:!|!!|![a-z\-]+!)$/i,e7=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function JF(t){return Object.prototype.toString.call(t)}function ss(t){return t===10||t===13}function yl(t){return t===9||t===32}function qn(t){return t===9||t===32||t===10||t===13}function Wc(t){return t===44||t===91||t===93||t===123||t===125}function Aqe(t){var e;return 48<=t&&t<=57?t-48:(e=t|32,97<=e&&e<=102?e-97+10:-1)}function Tqe(t){return t===120?2:t===117?4:t===85?8:0}function kqe(t){return 48<=t&&t<=57?t-48:-1}function ZF(t){return t===48?"\0":t===97?"\x07":t===98?"\b":t===116||t===9?"	":t===110?`
`:t===118?"\v":t===102?"\f":t===114?"\r":t===101?"\x1B":t===32?" ":t===34?'"':t===47?"/":t===92?"\\":t===78?"":t===95?" ":t===76?"\u2028":t===80?"\u2029":""}function Cqe(t){return t<=65535?String.fromCharCode(t):String.fromCharCode((t-65536>>10)+55296,(t-65536&1023)+56320)}var t7=new Array(256),r7=new Array(256);for(var bc=0;bc<256;bc++)t7[bc]=ZF(bc)?1:0,r7[bc]=ZF(bc);function Iqe(t,e){this.input=t,this.filename=e.filename||null,this.schema=e.schema||xqe,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function n7(t,e){var r={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return r.snippet=yBe(r),new Ns(e,r)}function Ce(t,e){throw n7(t,e)}function b0(t,e){t.onWarning&&t.onWarning.call(null,n7(t,e))}var XF={YAML:function(e,r,n){var i,a,s;e.version!==null&&Ce(e,"duplication of %YAML directive"),n.length!==1&&Ce(e,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),i===null&&Ce(e,"ill-formed argument of the YAML directive"),a=parseInt(i[1],10),s=parseInt(i[2],10),a!==1&&Ce(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=s<2,s!==1&&s!==2&&b0(e,"unsupported YAML version of the document")},TAG:function(e,r,n){var i,a;n.length!==2&&Ce(e,"TAG directive accepts exactly two arguments"),i=n[0],a=n[1],QV.test(i)||Ce(e,"ill-formed tag handle (first argument) of the TAG directive"),yu.call(e.tagMap,i)&&Ce(e,'there is a previously declared suffix for "'+i+'" tag handle'),e7.test(a)||Ce(e,"ill-formed tag prefix (second argument) of the TAG directive");try{a=decodeURIComponent(a)}catch{Ce(e,"tag prefix is malformed: "+a)}e.tagMap[i]=a}};function uu(t,e,r,n){var i,a,s,o;if(e<r){if(o=t.input.slice(e,r),n)for(i=0,a=o.length;i<a;i+=1)s=o.charCodeAt(i),s===9||32<=s&&s<=1114111||Ce(t,"expected valid JSON character");else Sqe.test(o)&&Ce(t,"the stream contains non-printable characters");t.result+=o}}function QF(t,e,r,n){var i,a,s,o;for(On.isObject(r)||Ce(t,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(r),s=0,o=i.length;s<o;s+=1)a=i[s],yu.call(e,a)||(e[a]=r[a],n[a]=!0)}function Gc(t,e,r,n,i,a,s,o,u){var l,c;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),l=0,c=i.length;l<c;l+=1)Array.isArray(i[l])&&Ce(t,"nested arrays are not supported inside keys"),typeof i=="object"&&JF(i[l])==="[object Object]"&&(i[l]="[object Object]");if(typeof i=="object"&&JF(i)==="[object Object]"&&(i="[object Object]"),i=String(i),e===null&&(e={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(a))for(l=0,c=a.length;l<c;l+=1)QF(t,e,a[l],r);else QF(t,e,a,r);else!t.json&&!yu.call(r,i)&&yu.call(e,i)&&(t.line=s||t.line,t.lineStart=o||t.lineStart,t.position=u||t.position,Ce(t,"duplicated mapping key")),i==="__proto__"?Object.defineProperty(e,i,{configurable:!0,enumerable:!0,writable:!0,value:a}):e[i]=a,delete r[i];return e}function t$(t){var e;e=t.input.charCodeAt(t.position),e===10?t.position++:e===13?(t.position++,t.input.charCodeAt(t.position)===10&&t.position++):Ce(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function lr(t,e,r){for(var n=0,i=t.input.charCodeAt(t.position);i!==0;){for(;yl(i);)i===9&&t.firstTabInLine===-1&&(t.firstTabInLine=t.position),i=t.input.charCodeAt(++t.position);if(e&&i===35)do i=t.input.charCodeAt(++t.position);while(i!==10&&i!==13&&i!==0);if(ss(i))for(t$(t),i=t.input.charCodeAt(t.position),n++,t.lineIndent=0;i===32;)t.lineIndent++,i=t.input.charCodeAt(++t.position);else break}return r!==-1&&n!==0&&t.lineIndent<r&&b0(t,"deficient indentation"),n}function E1(t){var e=t.position,r;return r=t.input.charCodeAt(e),!!((r===45||r===46)&&r===t.input.charCodeAt(e+1)&&r===t.input.charCodeAt(e+2)&&(e+=3,r=t.input.charCodeAt(e),r===0||qn(r)))}function r$(t,e){e===1?t.result+=" ":e>1&&(t.result+=On.repeat(`
`,e-1))}function $qe(t,e,r){var n,i,a,s,o,u,l,c,h=t.kind,d=t.result,f;if(f=t.input.charCodeAt(t.position),qn(f)||Wc(f)||f===35||f===38||f===42||f===33||f===124||f===62||f===39||f===34||f===37||f===64||f===96||(f===63||f===45)&&(i=t.input.charCodeAt(t.position+1),qn(i)||r&&Wc(i)))return!1;for(t.kind="scalar",t.result="",a=s=t.position,o=!1;f!==0;){if(f===58){if(i=t.input.charCodeAt(t.position+1),qn(i)||r&&Wc(i))break}else if(f===35){if(n=t.input.charCodeAt(t.position-1),qn(n))break}else{if(t.position===t.lineStart&&E1(t)||r&&Wc(f))break;if(ss(f))if(u=t.line,l=t.lineStart,c=t.lineIndent,lr(t,!1,-1),t.lineIndent>=e){o=!0,f=t.input.charCodeAt(t.position);continue}else{t.position=s,t.line=u,t.lineStart=l,t.lineIndent=c;break}}o&&(uu(t,a,s,!1),r$(t,t.line-u),a=s=t.position,o=!1),yl(f)||(s=t.position+1),f=t.input.charCodeAt(++t.position)}return uu(t,a,s,!1),t.result?!0:(t.kind=h,t.result=d,!1)}function jqe(t,e){var r,n,i;if(r=t.input.charCodeAt(t.position),r!==39)return!1;for(t.kind="scalar",t.result="",t.position++,n=i=t.position;(r=t.input.charCodeAt(t.position))!==0;)if(r===39)if(uu(t,n,t.position,!0),r=t.input.charCodeAt(++t.position),r===39)n=t.position,t.position++,i=t.position;else return!0;else ss(r)?(uu(t,n,i,!0),r$(t,lr(t,!1,e)),n=i=t.position):t.position===t.lineStart&&E1(t)?Ce(t,"unexpected end of the document within a single quoted scalar"):(t.position++,i=t.position);Ce(t,"unexpected end of the stream within a single quoted scalar")}function Rqe(t,e){var r,n,i,a,s,o;if(o=t.input.charCodeAt(t.position),o!==34)return!1;for(t.kind="scalar",t.result="",t.position++,r=n=t.position;(o=t.input.charCodeAt(t.position))!==0;){if(o===34)return uu(t,r,t.position,!0),t.position++,!0;if(o===92){if(uu(t,r,t.position,!0),o=t.input.charCodeAt(++t.position),ss(o))lr(t,!1,e);else if(o<256&&t7[o])t.result+=r7[o],t.position++;else if((s=Tqe(o))>0){for(i=s,a=0;i>0;i--)o=t.input.charCodeAt(++t.position),(s=Aqe(o))>=0?a=(a<<4)+s:Ce(t,"expected hexadecimal character");t.result+=Cqe(a),t.position++}else Ce(t,"unknown escape sequence");r=n=t.position}else ss(o)?(uu(t,r,n,!0),r$(t,lr(t,!1,e)),r=n=t.position):t.position===t.lineStart&&E1(t)?Ce(t,"unexpected end of the document within a double quoted scalar"):(t.position++,n=t.position)}Ce(t,"unexpected end of the stream within a double quoted scalar")}function Nqe(t,e){var r=!0,n,i,a,s=t.tag,o,u=t.anchor,l,c,h,d,f,p=Object.create(null),m,g,v,y;if(y=t.input.charCodeAt(t.position),y===91)c=93,f=!1,o=[];else if(y===123)c=125,f=!0,o={};else return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=o),y=t.input.charCodeAt(++t.position);y!==0;){if(lr(t,!0,e),y=t.input.charCodeAt(t.position),y===c)return t.position++,t.tag=s,t.anchor=u,t.kind=f?"mapping":"sequence",t.result=o,!0;r?y===44&&Ce(t,"expected the node content, but found ','"):Ce(t,"missed comma between flow collection entries"),g=m=v=null,h=d=!1,y===63&&(l=t.input.charCodeAt(t.position+1),qn(l)&&(h=d=!0,t.position++,lr(t,!0,e))),n=t.line,i=t.lineStart,a=t.position,rd(t,e,y0,!1,!0),g=t.tag,m=t.result,lr(t,!0,e),y=t.input.charCodeAt(t.position),(d||t.line===n)&&y===58&&(h=!0,y=t.input.charCodeAt(++t.position),lr(t,!0,e),rd(t,e,y0,!1,!0),v=t.result),f?Gc(t,o,p,g,m,v,n,i,a):h?o.push(Gc(t,null,p,g,m,v,n,i,a)):o.push(m),lr(t,!0,e),y=t.input.charCodeAt(t.position),y===44?(r=!0,y=t.input.charCodeAt(++t.position)):r=!1}Ce(t,"unexpected end of the stream within a flow collection")}function Mqe(t,e){var r,n,i=KO,a=!1,s=!1,o=e,u=0,l=!1,c,h;if(h=t.input.charCodeAt(t.position),h===124)n=!1;else if(h===62)n=!0;else return!1;for(t.kind="scalar",t.result="";h!==0;)if(h=t.input.charCodeAt(++t.position),h===43||h===45)KO===i?i=h===43?YF:Oqe:Ce(t,"repeat of a chomping mode identifier");else if((c=kqe(h))>=0)c===0?Ce(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?Ce(t,"repeat of an indentation width identifier"):(o=e+c-1,s=!0);else break;if(yl(h)){do h=t.input.charCodeAt(++t.position);while(yl(h));if(h===35)do h=t.input.charCodeAt(++t.position);while(!ss(h)&&h!==0)}for(;h!==0;){for(t$(t),t.lineIndent=0,h=t.input.charCodeAt(t.position);(!s||t.lineIndent<o)&&h===32;)t.lineIndent++,h=t.input.charCodeAt(++t.position);if(!s&&t.lineIndent>o&&(o=t.lineIndent),ss(h)){u++;continue}if(t.lineIndent<o){i===YF?t.result+=On.repeat(`
`,a?1+u:u):i===KO&&a&&(t.result+=`
`);break}for(n?yl(h)?(l=!0,t.result+=On.repeat(`
`,a?1+u:u)):l?(l=!1,t.result+=On.repeat(`
`,u+1)):u===0?a&&(t.result+=" "):t.result+=On.repeat(`
`,u):t.result+=On.repeat(`
`,a?1+u:u),a=!0,s=!0,u=0,r=t.position;!ss(h)&&h!==0;)h=t.input.charCodeAt(++t.position);uu(t,r,t.position,!1)}return!0}function e3(t,e){var r,n=t.tag,i=t.anchor,a=[],s,o=!1,u;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=a),u=t.input.charCodeAt(t.position);u!==0&&(t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,Ce(t,"tab characters must not be used in indentation")),!(u!==45||(s=t.input.charCodeAt(t.position+1),!qn(s))));){if(o=!0,t.position++,lr(t,!0,-1)&&t.lineIndent<=e){a.push(null),u=t.input.charCodeAt(t.position);continue}if(r=t.line,rd(t,e,XV,!1,!0),a.push(t.result),lr(t,!0,-1),u=t.input.charCodeAt(t.position),(t.line===r||t.lineIndent>e)&&u!==0)Ce(t,"bad indentation of a sequence entry");else if(t.lineIndent<e)break}return o?(t.tag=n,t.anchor=i,t.kind="sequence",t.result=a,!0):!1}function Dqe(t,e,r){var n,i,a,s,o,u,l=t.tag,c=t.anchor,h={},d=Object.create(null),f=null,p=null,m=null,g=!1,v=!1,y;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=h),y=t.input.charCodeAt(t.position);y!==0;){if(!g&&t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,Ce(t,"tab characters must not be used in indentation")),n=t.input.charCodeAt(t.position+1),a=t.line,(y===63||y===58)&&qn(n))y===63?(g&&(Gc(t,h,d,f,p,null,s,o,u),f=p=m=null),v=!0,g=!0,i=!0):g?(g=!1,i=!0):Ce(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,y=n;else{if(s=t.line,o=t.lineStart,u=t.position,!rd(t,r,ZV,!1,!0))break;if(t.line===a){for(y=t.input.charCodeAt(t.position);yl(y);)y=t.input.charCodeAt(++t.position);if(y===58)y=t.input.charCodeAt(++t.position),qn(y)||Ce(t,"a whitespace character is expected after the key-value separator within a block mapping"),g&&(Gc(t,h,d,f,p,null,s,o,u),f=p=m=null),v=!0,g=!1,i=!1,f=t.tag,p=t.result;else if(v)Ce(t,"can not read an implicit mapping pair; a colon is missed");else return t.tag=l,t.anchor=c,!0}else if(v)Ce(t,"can not read a block mapping entry; a multiline key may not be an implicit key");else return t.tag=l,t.anchor=c,!0}if((t.line===a||t.lineIndent>e)&&(g&&(s=t.line,o=t.lineStart,u=t.position),rd(t,e,v0,!0,i)&&(g?p=t.result:m=t.result),g||(Gc(t,h,d,f,p,m,s,o,u),f=p=m=null),lr(t,!0,-1),y=t.input.charCodeAt(t.position)),(t.line===a||t.lineIndent>e)&&y!==0)Ce(t,"bad indentation of a mapping entry");else if(t.lineIndent<e)break}return g&&Gc(t,h,d,f,p,null,s,o,u),v&&(t.tag=l,t.anchor=c,t.kind="mapping",t.result=h),v}function Lqe(t){var e,r=!1,n=!1,i,a,s;if(s=t.input.charCodeAt(t.position),s!==33)return!1;if(t.tag!==null&&Ce(t,"duplication of a tag property"),s=t.input.charCodeAt(++t.position),s===60?(r=!0,s=t.input.charCodeAt(++t.position)):s===33?(n=!0,i="!!",s=t.input.charCodeAt(++t.position)):i="!",e=t.position,r){do s=t.input.charCodeAt(++t.position);while(s!==0&&s!==62);t.position<t.length?(a=t.input.slice(e,t.position),s=t.input.charCodeAt(++t.position)):Ce(t,"unexpected end of the stream within a verbatim tag")}else{for(;s!==0&&!qn(s);)s===33&&(n?Ce(t,"tag suffix cannot contain exclamation marks"):(i=t.input.slice(e-1,t.position+1),QV.test(i)||Ce(t,"named tag handle cannot contain such characters"),n=!0,e=t.position+1)),s=t.input.charCodeAt(++t.position);a=t.input.slice(e,t.position),Eqe.test(a)&&Ce(t,"tag suffix cannot contain flow indicator characters")}a&&!e7.test(a)&&Ce(t,"tag name cannot contain such characters: "+a);try{a=decodeURIComponent(a)}catch{Ce(t,"tag name is malformed: "+a)}return r?t.tag=a:yu.call(t.tagMap,i)?t.tag=t.tagMap[i]+a:i==="!"?t.tag="!"+a:i==="!!"?t.tag="tag:yaml.org,2002:"+a:Ce(t,'undeclared tag handle "'+i+'"'),!0}function Fqe(t){var e,r;if(r=t.input.charCodeAt(t.position),r!==38)return!1;for(t.anchor!==null&&Ce(t,"duplication of an anchor property"),r=t.input.charCodeAt(++t.position),e=t.position;r!==0&&!qn(r)&&!Wc(r);)r=t.input.charCodeAt(++t.position);return t.position===e&&Ce(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(e,t.position),!0}function Uqe(t){var e,r,n;if(n=t.input.charCodeAt(t.position),n!==42)return!1;for(n=t.input.charCodeAt(++t.position),e=t.position;n!==0&&!qn(n)&&!Wc(n);)n=t.input.charCodeAt(++t.position);return t.position===e&&Ce(t,"name of an alias node must contain at least one character"),r=t.input.slice(e,t.position),yu.call(t.anchorMap,r)||Ce(t,'unidentified alias "'+r+'"'),t.result=t.anchorMap[r],lr(t,!0,-1),!0}function rd(t,e,r,n,i){var a,s,o,u=1,l=!1,c=!1,h,d,f,p,m,g;if(t.listener!==null&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,a=s=o=v0===r||XV===r,n&&lr(t,!0,-1)&&(l=!0,t.lineIndent>e?u=1:t.lineIndent===e?u=0:t.lineIndent<e&&(u=-1)),u===1)for(;Lqe(t)||Fqe(t);)lr(t,!0,-1)?(l=!0,o=a,t.lineIndent>e?u=1:t.lineIndent===e?u=0:t.lineIndent<e&&(u=-1)):o=!1;if(o&&(o=l||i),(u===1||v0===r)&&(y0===r||ZV===r?m=e:m=e+1,g=t.position-t.lineStart,u===1?o&&(e3(t,g)||Dqe(t,g,m))||Nqe(t,m)?c=!0:(s&&Mqe(t,m)||jqe(t,m)||Rqe(t,m)?c=!0:Uqe(t)?(c=!0,(t.tag!==null||t.anchor!==null)&&Ce(t,"alias node should not have any properties")):$qe(t,m,y0===r)&&(c=!0,t.tag===null&&(t.tag="?")),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):u===0&&(c=o&&e3(t,g))),t.tag===null)t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);else if(t.tag==="?"){for(t.result!==null&&t.kind!=="scalar"&&Ce(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),h=0,d=t.implicitTypes.length;h<d;h+=1)if(p=t.implicitTypes[h],p.resolve(t.result)){t.result=p.construct(t.result),t.tag=p.tag,t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);break}}else if(t.tag!=="!"){if(yu.call(t.typeMap[t.kind||"fallback"],t.tag))p=t.typeMap[t.kind||"fallback"][t.tag];else for(p=null,f=t.typeMap.multi[t.kind||"fallback"],h=0,d=f.length;h<d;h+=1)if(t.tag.slice(0,f[h].tag.length)===f[h].tag){p=f[h];break}p||Ce(t,"unknown tag !<"+t.tag+">"),t.result!==null&&p.kind!==t.kind&&Ce(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+p.kind+'", not "'+t.kind+'"'),p.resolve(t.result,t.tag)?(t.result=p.construct(t.result,t.tag),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):Ce(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return t.listener!==null&&t.listener("close",t),t.tag!==null||t.anchor!==null||c}function zqe(t){var e=t.position,r,n,i,a=!1,s;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);(s=t.input.charCodeAt(t.position))!==0&&(lr(t,!0,-1),s=t.input.charCodeAt(t.position),!(t.lineIndent>0||s!==37));){for(a=!0,s=t.input.charCodeAt(++t.position),r=t.position;s!==0&&!qn(s);)s=t.input.charCodeAt(++t.position);for(n=t.input.slice(r,t.position),i=[],n.length<1&&Ce(t,"directive name must not be less than one character in length");s!==0;){for(;yl(s);)s=t.input.charCodeAt(++t.position);if(s===35){do s=t.input.charCodeAt(++t.position);while(s!==0&&!ss(s));break}if(ss(s))break;for(r=t.position;s!==0&&!qn(s);)s=t.input.charCodeAt(++t.position);i.push(t.input.slice(r,t.position))}s!==0&&t$(t),yu.call(XF,n)?XF[n](t,n,i):b0(t,'unknown document directive "'+n+'"')}if(lr(t,!0,-1),t.lineIndent===0&&t.input.charCodeAt(t.position)===45&&t.input.charCodeAt(t.position+1)===45&&t.input.charCodeAt(t.position+2)===45?(t.position+=3,lr(t,!0,-1)):a&&Ce(t,"directives end mark is expected"),rd(t,t.lineIndent-1,v0,!1,!0),lr(t,!0,-1),t.checkLineBreaks&&Pqe.test(t.input.slice(e,t.position))&&b0(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&E1(t)){t.input.charCodeAt(t.position)===46&&(t.position+=3,lr(t,!0,-1));return}if(t.position<t.length-1)Ce(t,"end of the stream or a document separator is expected");else return}function i7(t,e){t=String(t),e=e||{},t.length!==0&&(t.charCodeAt(t.length-1)!==10&&t.charCodeAt(t.length-1)!==13&&(t+=`
`),t.charCodeAt(0)===65279&&(t=t.slice(1)));var r=new Iqe(t,e),n=t.indexOf("\0");for(n!==-1&&(r.position=n,Ce(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)zqe(r);return r.documents}function Bqe(t,e,r){e!==null&&typeof e=="object"&&typeof r>"u"&&(r=e,e=null);var n=i7(t,r);if(typeof e!="function")return n;for(var i=0,a=n.length;i<a;i+=1)e(n[i])}function qqe(t,e){var r=i7(t,e);if(r.length!==0){if(r.length===1)return r[0];throw new Ns("expected a single document in the stream, but found more")}}var Kqe=Bqe,Vqe=qqe,Hqe={loadAll:Kqe,load:Vqe},Wqe=Hqe.load;class Bs{constructor(e){Object.defineProperty(this,"document",{enumerable:!0,configurable:!0,writable:!0,value:e})}get baseUrl(){return this.document.servers?this.document.servers[0].url:void 0}getPathsStrict(){if(!this.document.paths)throw new Error("No paths found in spec");return this.document.paths}getParametersStrict(){var e;if(!((e=this.document.components)!=null&&e.parameters))throw new Error("No parameters found in spec");return this.document.components.parameters}getSchemasStrict(){var e;if(!((e=this.document.components)!=null&&e.schemas))throw new Error("No schemas found in spec.");return this.document.components.schemas}getRequestBodiesStrict(){var e;if(!((e=this.document.components)!=null&&e.requestBodies))throw new Error("No request body found in spec.");return this.document.components.requestBodies}getPathStrict(e){const r=this.getPathsStrict()[e];if(r===void 0)throw new Error(`No path found for "${e}".`);return r}getReferencedParameter(e){const r=e.$ref.split("/"),n=r[r.length-1];if(this.getParametersStrict()[n]===void 0)throw new Error(`No parameter found for "${n}".`);return this.getParametersStrict()[n]}getRootReferencedParameter(e){let r=this.getReferencedParameter(e);for(;r.$ref!==void 0;)r=this.getReferencedParameter(r);return r}getReferencedSchema(e){const r=e.$ref.split("/"),n=r[r.length-1],i=this.getSchemasStrict()[n];if(i===void 0)throw new Error(`No schema found for "${n}".`);return i}getSchema(e){return e.$ref!==void 0?this.getReferencedSchema(e):e}getRootReferencedSchema(e){let r=this.getReferencedSchema(e);for(;r.$ref!==void 0;)r=this.getReferencedSchema(r);return r}getReferencedRequestBody(e){const r=e.$ref.split("/"),n=r[r.length-1],i=this.getRequestBodiesStrict();if(i[n]===void 0)throw new Error(`No request body found for "${n}"`);return i[n]}getRootReferencedRequestBody(e){let r=this.getReferencedRequestBody(e);for(;r.$ref!==void 0;)r=this.getReferencedRequestBody(r);return r}getMethodsForPath(e){const r=this.getPathStrict(e);return["get","put","post","delete","options","head","patch","trace"].filter(i=>r[i]!==void 0)}getParametersForPath(e){const r=this.getPathStrict(e);return r.parameters===void 0?[]:r.parameters.map(n=>n.$ref!==void 0?this.getRootReferencedParameter(n):n)}getOperation(e,r){const n=this.getPathStrict(e);if(n[r]===void 0)throw new Error(`No ${r} method found for "path".`);return n[r]}getParametersForOperation(e){return e.parameters===void 0?[]:e.parameters.map(r=>r.$ref!==void 0?this.getRootReferencedParameter(r):r)}getRequestBodyForOperation(e){const{requestBody:r}=e;return(r==null?void 0:r.$ref)!==void 0?this.getRootReferencedRequestBody(r):r}static getCleanedOperationId(e,r,n){let{operationId:i}=e;if(i===void 0){const a=r.replaceAll(/[^a-zA-Z0-9]/,"_");i=`${a.startsWith("/")?a.slice(1):a}_${n}`}return i.replaceAll("-","_").replaceAll(".","_").replaceAll("/","_")}static alertUnsupportedSpec(e){const r="This may result in degraded performance. Convert your OpenAPI spec to 3.1.0 for better support.",n=e.swagger,i=e.openapi;if(i!==void 0&&i!=="3.1.0")console.warn(`Attempting to load an OpenAPI ${i} spec. ${r}`);else if(n!==void 0)console.warn(`Attempting to load a Swagger ${n} spec. ${r}`);else throw new Error(`Attempting to load an unsupported spec:

${JSON.stringify(e,null,2)}.`)}static fromObject(e){return Bs.alertUnsupportedSpec(e),new Bs(e)}static fromString(e){let r;try{r=JSON.parse(e)}catch{r=Wqe(e)}return Bs.fromObject(r)}static async fromURL(e){const n=await(await fetch(e)).text();return Bs.fromString(n)}}function Gqe(t,e){const r=[...t.matchAll(/{(.*?)}/g)].map(a=>a[1]),n={};for(const a of r){const s=a.replace(/^\.;/,"").replace(/\*$/,""),o=e[s];let u;if(Array.isArray(o))if(a.startsWith(".")){const l=a.endsWith("*")?".":",";u=`.${o.join(l)}`}else if(a.startsWith(",")){const l=a.endsWith("*")?`${s}=`:",";u=`${s}=${o.join(l)}`}else u=o.join(",");else if(typeof o=="object"){const l=a.endsWith("*")?"=":",",c=Object.entries(o).map(([d,f])=>d+l+f);let h;a.startsWith(".")?(h=".",u="."):a.startsWith(";")?(h=";",u=";"):(h=",",u=""),u+=c.join(h)}else a.startsWith(".")?u=`.${o}`:a.startsWith(";")?u=`;${s}=${o}`:u=o;n[a]=u}let i=t;for(const[a,s]of Object.entries(n))i=i.replace(`{${a}}`,s);return i}function Yqe(t,e){return t.reduce((r,n)=>{let i;if(n.schema)i=e.getSchema(n.schema),r.properties[n.name]=eg(i,e);else if(n.content){const a=Object.values(n.content)[0].schema;if(a&&(i=e.getSchema(a)),!i)return r;i.description===void 0&&(i.description=n.description??""),r.properties[n.name]=eg(i,e)}else return r;return n.required&&Array.isArray(r.required)&&r.required.push(n.name),r},{type:"object",properties:{},required:[],additionalProperties:{}})}function eg(t,e){return t.type==="object"?Object.keys(t.properties??{}).reduce((r,n)=>{if(!t.properties)return r;const i=e.getSchema(t.properties[n]);return i.type===void 0||(r.properties[n]=eg(i,e),i.required&&r.required!==void 0&&r.required.push(n)),r},{type:"object",properties:{},required:[],additionalProperties:{}}):t.type==="array"?{type:"array",items:eg(t.items??{},e),minItems:t.minItems,maxItems:t.maxItems}:{type:t.type??"string"}}function Jqe(t){if(!t.document.paths)return{openAIFunctions:[]};const e=[],r={};for(const n of Object.keys(t.document.paths)){const i=t.getParametersForPath(n);for(const a of t.getMethodsForPath(n)){const s=t.getOperation(n,a);if(!s)return{openAIFunctions:[]};const o=i.concat(t.getParametersForOperation(s)).reduce((f,p)=>(f[p.in]||(f[p.in]=[]),f[p.in].push(p),f),{}),u={query:"params",header:"headers",cookie:"cookies",path:"path_params"},l={};for(const f of Object.keys(u))o[f]&&(l[u[f]]=Yqe(o[f],t));const c=t.getRequestBodyForOperation(s);if((c==null?void 0:c.content)!==void 0){const f={};for(const[m,g]of Object.entries(c.content))if(g.schema!==void 0){const v=t.getSchema(g.schema);f[m]=eg(v,t)}const p=Object.keys(f);p.length===1?l.data=f[p[0]]:p.length>1&&(l.data={anyOf:Object.values(f)})}const h={name:Bs.getCleanedOperationId(s,n,a),description:s.description??s.summary??"",parameters:{type:"object",properties:l,required:Object.keys(l)}};e.push(h);const d=(t.baseUrl??"").endsWith("/")?(t.baseUrl??"").slice(0,-1):t.baseUrl??"";r[h.name]={method:a,url:d+n}}}return{openAIFunctions:e,defaultExecutionMethod:async(n,i,a)=>{const{headers:s,params:o,...u}=a??{},{method:l,url:c}=r[n],h=i.params??{},d=Object.keys(h).reduce((w,_)=>(h[_]!==""&&h[_]!==null&&h[_]!==void 0&&(w[_]=h[_]),w),{}),f=new URLSearchParams({...d,...o}).toString(),p=i.path_params,m=Gqe(c,p)+(f.length?`?${f}`:""),g={};let v;if(i.data!==void 0){let w="text/plain";typeof i.data!="string"?(typeof i.data=="object"&&(w="application/json"),v=JSON.stringify(i.data)):v=i.data,g["content-type"]=w}const y=await fetch(m,{...i,method:l,headers:{...g,...i.headers,...s},body:v,...u});let b;return y.status<200||y.status>299?b=`${y.status}: ${y.statusText} for ${n} called with ${JSON.stringify(f)}`:b=await y.text(),b}}}class Zqe extends st{static lc_name(){return"SimpleRequestChain"}constructor(e){super(),Object.defineProperty(this,"requestMethod",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"function"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"response"}),this.requestMethod=e.requestMethod}get inputKeys(){return[this.inputKey]}get outputKeys(){return[this.outputKey]}_chainType(){return"simple_request_chain"}async _call(e,r){const n=e[this.inputKey],i=n.name,a=n.arguments,s=await this.requestMethod(i,a);return{[this.outputKey]:s}}}async function a7(t,e={}){let r;if(typeof t=="string")try{r=await Bs.fromURL(t)}catch{try{r=Bs.fromString(t)}catch{throw new Error(`Unable to parse spec from source ${t}.`)}}else r=Bs.fromObject(t);const{openAIFunctions:n,defaultExecutionMethod:i}=Jqe(r);if(i===void 0)throw new Error("Could not parse any valid operations from the provided spec.");const{llm:a=new Hg({modelName:"gpt-3.5-turbo-0613"}),prompt:s=Xt.fromMessages([ir.fromTemplate(`Use the provided API's to respond to this user query:

{query}`)]),requestChain:o=new Zqe({requestMethod:async(d,f)=>i(d,f,{headers:e.headers,params:e.params})}),llmChainInputs:u={},verbose:l,...c}=e,h=new Pe({llm:a,prompt:s,outputParser:new Jd({argsOnly:!1}),outputKey:"function",llmKwargs:{functions:n},...u});return new Bg({chains:[h,o],outputVariables:["response"],inputVariables:h.inputKeys,verbose:l,...c})}const Xqe=Object.freeze(Object.defineProperty({__proto__:null,APIChain:v1,AnalyzeDocumentChain:_I,BaseChain:st,ChatVectorDBQAChain:wI,ConstitutionalChain:OI,ConstitutionalPrinciple:Ae,ConversationChain:bI,ConversationalRetrievalQAChain:xI,LLMChain:Pe,LLMRouterChain:Wg,MapReduceDocumentsChain:Hd,MultiPromptChain:m0,MultiRetrievalQAChain:g0,MultiRouteChain:YI,OpenAIModerationChain:Jze,PRINCIPLES:pA,RefineDocumentsChain:Wd,RetrievalQAChain:fA,RouterChain:BV,SequentialChain:Bg,SimpleSequentialChain:b1,StuffDocumentsChain:io,TransformChain:eBe,VectorDBQAChain:Dg,createExtractionChain:QI,createExtractionChainFromZod:VV,createOpenAPIChain:a7,createTaggingChain:P1,createTaggingChainFromZod:HV,loadQAChain:cK,loadQAMapReduceChain:hK,loadQARefineChain:dK,loadQAStuffChain:Mg,loadSummarizationChain:eUe},Symbol.toStringTag,{value:"Module"})),Qqe=`

`,Zy="context",e9e=ve.fromTemplate("{page_content}");async function t9e({documentPrompt:t,documentSeparator:e,documents:r,config:n}){return(await Promise.all(r.map(a=>t.withConfig({runName:"document_formatter"}).invoke({...a.metadata,page_content:a.pageContent},n)))).join(e)}async function r9e({llm:t,prompt:e,outputParser:r=new zd,documentPrompt:n=e9e,documentSeparator:i=Qqe}){if(!e.inputVariables.includes(Zy))throw new Error(`Prompt must include a "${Zy}" variable`);return wr.from([Dr.assign({[Zy]:new X_(Zy).pipe((a,s)=>t9e({documents:a,documentPrompt:n,documentSeparator:i,config:s==null?void 0:s.config}))}),e,t,r],"stuff_documents_chain")}const n9e=Object.freeze(Object.defineProperty({__proto__:null,createStuffDocumentsChain:r9e},Symbol.toStringTag,{value:"Module"}));function i9e(t,e,r){const n=[];let i=[];for(const a of t)if(i.push(a),e(i)>r){if(i.length===1)throw new Error("A single document was longer than the context length, we cannot handle this.");n.push(i.slice(0,-1)),i=i.slice(-1)}return n.push(i),n}async function a9e(t,e){return{pageContent:await e(t),metadata:s9e(t)}}function s9e(t){const e={};for(const r in t[0].metadata)r in t[0].metadata&&(e[r]=String(t[0].metadata[r]));for(const r of t.slice(1))for(const n in r.metadata)n in e?e[n]+=`, ${r.metadata[n]}`:e[n]=String(r.metadata[n]);return e}const o9e=Object.freeze(Object.defineProperty({__proto__:null,collapseDocs:a9e,splitListOfDocs:i9e},Symbol.toStringTag,{value:"Module"}));async function u9e({llm:t,retriever:e,rephrasePrompt:r}){if(!r.inputVariables.includes("input"))throw new Error(`Expected "input" to be a prompt variable, but got ${JSON.stringify(r.inputVariables)}`);return GC.from([[i=>!i.chat_history||i.chat_history.length===0,wr.from([i=>i.input,e])],wr.from([r,t,new zd,e])]).withConfig({runName:"history_aware_retriever"})}const l9e=Object.freeze(Object.defineProperty({__proto__:null,createHistoryAwareRetriever:u9e},Symbol.toStringTag,{value:"Module"}));function c9e(t){return t.jsonSchema===void 0&&t.zodSchema===void 0}class h9e extends wi{constructor(e){let r;if(c9e(e)?r={jsonSchema:e}:r=e,r.jsonSchema===void 0&&r.zodSchema===void 0)throw new Error('Must provide at least one of "jsonSchema" or "zodSchema".');super(r),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chains","openai_functions"]}),Object.defineProperty(this,"functionOutputParser",{enumerable:!0,configurable:!0,writable:!0,value:new XI}),Object.defineProperty(this,"jsonSchemaValidator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.jsonSchema!==void 0&&(this.jsonSchemaValidator=new F8(r.jsonSchema,"7")),r.zodSchema!==void 0&&(this.zodSchema=r.zodSchema)}async parseResult(e){const r=await this.functionOutputParser.parseResult(e),n=JSON.parse(r,(i,a)=>{if(a!==null)return a});if(this.zodSchema){const i=this.zodSchema.safeParse(n);if(i.success)return i.data;throw new ft(`Failed to parse. Text: "${r}". Error: ${JSON.stringify(i.error.errors)}`,r)}else if(this.jsonSchemaValidator!==void 0){const i=this.jsonSchemaValidator.validate(n);if(i.valid)return n;throw new ft(`Failed to parse. Text: "${r}". Error: ${JSON.stringify(i.errors)}`,r)}else throw new Error("This parser requires an input JSON Schema or an input Zod schema.")}}function s7(t){const{outputSchema:e,llm:r=new Hg({modelName:"gpt-3.5-turbo-0613",temperature:0}),outputKey:n="output",llmKwargs:i={},zodSchema:a,...s}=t;if(e===void 0&&a===void 0)throw new Error('Must provide one of "outputSchema" or "zodSchema".');const o="output_formatter";return new Pe({llm:r,llmKwargs:{...i,functions:[{name:o,description:"Output formatter. Should always be used to format your response to the user.",parameters:e}],function_call:{name:o}},outputKey:n,outputParser:new h9e({jsonSchema:e,zodSchema:a}),...s})}function d9e(t,e){return s7({...e,outputSchema:Ur(t),zodSchema:t})}function o7(t){const{functions:e,llm:r,prompt:n,enforceSingleFunctionUsage:i=!0,outputParser:a=new Jd}=t,s={functions:e};e.length===1&&i&&(s.function_call={name:e[0].name});const o=r.bind(s);return n.pipe(o).pipe(a)}function f9e(t){return typeof t.safeParse=="function"}function p9e(t){const{outputSchema:e,llm:r,prompt:n,outputParser:i}=t,s={name:"outputFormatter",description:"Output formatter. Should always be used to format your response to the user",parameters:f9e(e)?Ur(e):e};return o7({functions:[s],llm:r,prompt:n,enforceSingleFunctionUsage:!0,outputParser:i})}const m9e=Object.freeze(Object.defineProperty({__proto__:null,createExtractionChain:QI,createExtractionChainFromZod:VV,createOpenAIFnRunnable:o7,createOpenAPIChain:a7,createStructuredOutputChain:s7,createStructuredOutputChainFromZod:d9e,createStructuredOutputRunnable:p9e,createTaggingChain:P1,createTaggingChainFromZod:HV},Symbol.toStringTag,{value:"Module"}));function g9e(t){return!!t&&typeof t.getRelevantDocuments=="function"}async function y9e({retriever:t,combineDocsChain:e}){let r;return g9e(t)?r=wr.from([i=>i.input,t]):r=t,wr.from([Dr.assign({context:r.withConfig({runName:"retrieve_documents"}),chat_history:i=>i.chat_history??[]}),Dr.assign({answer:e})]).withConfig({runName:"retrieval_chain"})}const v9e=Object.freeze(Object.defineProperty({__proto__:null,createRetrievalChain:y9e},Symbol.toStringTag,{value:"Module"}));class n$ extends mI{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","storage"]}),Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyEncoder",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"valueSerializer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"valueDeserializer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.store=e.store,this.keyEncoder=e.keyEncoder,this.valueSerializer=e.valueSerializer,this.valueDeserializer=e.valueDeserializer}async mget(e){const r=e.map(this.keyEncoder);return(await this.store.mget(r)).map(i=>{if(i!==void 0)return this.valueDeserializer(i)})}async mset(e){const r=e.map(([n,i])=>[this.keyEncoder(n),this.valueSerializer(i)]);return this.store.mset(r)}async mdelete(e){const r=e.map(this.keyEncoder);return this.store.mdelete(r)}async*yieldKeys(e){yield*this.store.yieldKeys(e)}}function u7(t){const e=new TextEncoder,r=new TextDecoder;return new n$({store:t,keyEncoder:n=>n,valueSerializer:n=>e.encode(JSON.stringify({pageContent:n.pageContent,metadata:n.metadata})),valueDeserializer:n=>new rr(JSON.parse(r.decode(n)))})}const b9e=Object.freeze(Object.defineProperty({__proto__:null,EncoderBackedStore:n$,createDocumentStoreFromByteStore:u7},Symbol.toStringTag,{value:"Module"}));class w9e extends Ld{constructor(e){super(e),Object.defineProperty(this,"underlyingEmbeddings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"documentEmbeddingStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.underlyingEmbeddings=e.underlyingEmbeddings,this.documentEmbeddingStore=e.documentEmbeddingStore}async embedQuery(e){return this.underlyingEmbeddings.embedQuery(e)}async embedDocuments(e){const r=await this.documentEmbeddingStore.mget(e),n=[],i=[];for(let a=0;a<r.length;a+=1)r[a]===void 0&&(n.push(a),i.push(e[a]));if(i.length){const a=await this.underlyingEmbeddings.embedDocuments(i),s=i.map((o,u)=>[o,a[u]]);await this.documentEmbeddingStore.mset(s);for(let o=0;o<n.length;o+=1)r[n[o]]=a[o]}return r}static fromBytesStore(e,r,n){const i=new TextEncoder,a=new TextDecoder,s=new n$({store:r,keyEncoder:o=>((n==null?void 0:n.namespace)??"")+zm(o),valueSerializer:o=>i.encode(JSON.stringify(o)),valueDeserializer:o=>JSON.parse(a.decode(o))});return new this({underlyingEmbeddings:e,documentEmbeddingStore:s})}}const _9e=Object.freeze(Object.defineProperty({__proto__:null,CacheBackedEmbeddings:w9e},Symbol.toStringTag,{value:"Module"})),x9e=Object.freeze(Object.defineProperty({__proto__:null,FakeChatMessageHistory:YK,FakeChatModel:VK,FakeEmbeddings:QK,FakeLLM:qK,FakeListChatMessageHistory:JK,FakeListChatModel:GK,FakeRetriever:WK,FakeRunnable:BK,FakeSplitIntoListParser:zK,FakeStreamingChatModel:HK,FakeStreamingLLM:KK,FakeTool:XK,FakeTracer:ZK,FakeVectorStore:y1,SingleRunExtractor:tV,SyntheticEmbeddings:eV},Symbol.toStringTag,{value:"Module"}));function l7(t,e){let r=0,n=0,i=0;for(let a=0;a<t.length;a++)r+=t[a]*e[a],n+=t[a]*t[a],i+=e[a]*e[a];return r/(Math.sqrt(n)*Math.sqrt(i))}const O9e=Object.freeze(Object.defineProperty({__proto__:null,cosineSimilarity:ed,euclideanDistance:yI,innerProduct:gI,matrixFunc:zg,maximalMarginalRelevance:vI,normalize:FK},Symbol.toStringTag,{value:"Module"}));class A1 extends g1{_vectorstoreType(){return"memory"}constructor(e,{similarity:r,...n}={}){super(e,n),Object.defineProperty(this,"memoryVectors",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"similarity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.similarity=r??l7}async addDocuments(e){const r=e.map(({pageContent:n})=>n);return this.addVectors(await this.embeddings.embedDocuments(r),e)}async addVectors(e,r){const n=e.map((i,a)=>({content:r[a].pageContent,embedding:i,metadata:r[a].metadata}));this.memoryVectors=this.memoryVectors.concat(n)}async _queryVectors(e,r,n){const i=s=>{if(!n)return!0;const o=new rr({metadata:s.metadata,pageContent:s.content});return n(o)};return this.memoryVectors.filter(i).map((s,o)=>({similarity:this.similarity(e,s.embedding),index:o,metadata:s.metadata,content:s.content,embedding:s.embedding})).sort((s,o)=>s.similarity>o.similarity?-1:0).slice(0,r)}async similaritySearchVectorWithScore(e,r,n){return(await this._queryVectors(e,r,n)).map(s=>[new rr({metadata:s.metadata,pageContent:s.content}),s.similarity])}async maxMarginalRelevanceSearch(e,r){const n=await this.embeddings.embedQuery(e),i=await this._queryVectors(n,r.fetchK??20,r.filter),a=i.map(o=>o.embedding);return vI(n,a,r.lambda,r.k).map(o=>new rr({metadata:i[o].metadata,pageContent:i[o].content}))}static async fromTexts(e,r,n,i){const a=[];for(let s=0;s<e.length;s+=1){const o=Array.isArray(r)?r[s]:r,u=new rr({pageContent:e[s],metadata:o});a.push(u)}return A1.fromDocuments(a,n,i)}static async fromDocuments(e,r,n){const i=new this(r,n);return await i.addDocuments(e),i}static async fromExistingIndex(e,r){return new this(e,r)}}const S9e=Object.freeze(Object.defineProperty({__proto__:null,MemoryVectorStore:A1},Symbol.toStringTag,{value:"Module"}));class P9e extends bo{constructor(e){super({returnMessages:(e==null?void 0:e.returnMessages)??!1,chatHistory:e==null?void 0:e.chatHistory,inputKey:e==null?void 0:e.inputKey,outputKey:e==null?void 0:e.outputKey}),Object.defineProperty(this,"humanPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"Human"}),Object.defineProperty(this,"aiPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"AI"}),Object.defineProperty(this,"memoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"history"}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:5}),this.humanPrefix=(e==null?void 0:e.humanPrefix)??this.humanPrefix,this.aiPrefix=(e==null?void 0:e.aiPrefix)??this.aiPrefix,this.memoryKey=(e==null?void 0:e.memoryKey)??this.memoryKey,this.k=(e==null?void 0:e.k)??this.k}get memoryKeys(){return[this.memoryKey]}async loadMemoryVariables(e){const r=await this.chatHistory.getMessages();return this.returnMessages?{[this.memoryKey]:r.slice(-this.k*2)}:{[this.memoryKey]:Nr(r.slice(-this.k*2),this.humanPrefix,this.aiPrefix)}}}class E9e extends Lg{constructor(e){super(),Object.defineProperty(this,"vectorStoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"memoryKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnDocs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorStoreRetriever=e.vectorStoreRetriever,this.inputKey=e.inputKey,this.memoryKey=e.memoryKey??"memory",this.returnDocs=e.returnDocs??!1,this.metadata=e.metadata}get memoryKeys(){return[this.memoryKey]}async loadMemoryVariables(e){const r=Fg(e,this.inputKey),n=await this.vectorStoreRetriever.getRelevantDocuments(r);return{[this.memoryKey]:this.returnDocs?n:f1(n)}}async saveContext(e,r){const n=typeof this.metadata=="function"?this.metadata(e,r):this.metadata,i=Object.entries(e).filter(([a])=>a!==this.memoryKey).concat(Object.entries(r)).map(([a,s])=>`${a}: ${s}`).join(`
`);await this.vectorStoreRetriever.addDocuments([new rr({pageContent:i,metadata:n})])}}class A9e extends Or{}class T9e extends A9e{constructor(){super(),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","stores","entity","in_memory"]}),Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.store=Object.create(null)}async get(e,r){return e in this.store?this.store[e]:r}async set(e,r){this.store[e]=r}async delete(e){delete this.store[e]}async exists(e){return e in this.store}async clear(){this.store=Object.create(null)}}class k9e extends bo{constructor(e){super({chatHistory:e.chatHistory,returnMessages:e.returnMessages??!1,inputKey:e.inputKey,outputKey:e.outputKey}),Object.defineProperty(this,"entityExtractionChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"entitySummarizationChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"entityStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"entityCache",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"chatHistoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"history"}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"entitiesKey",{enumerable:!0,configurable:!0,writable:!0,value:"entities"}),Object.defineProperty(this,"humanPrefix",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"aiPrefix",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llm=e.llm,this.humanPrefix=e.humanPrefix,this.aiPrefix=e.aiPrefix,this.chatHistoryKey=e.chatHistoryKey??this.chatHistoryKey,this.entitiesKey=e.entitiesKey??this.entitiesKey,this.entityExtractionChain=new Pe({llm:this.llm,prompt:e.entityExtractionPrompt??g5e}),this.entitySummarizationChain=new Pe({llm:this.llm,prompt:e.entitySummarizationPrompt??v5e}),this.entityStore=e.entityStore??new T9e,this.entityCache=e.entityCache??this.entityCache,this.k=e.k??this.k}get memoryKeys(){return[this.chatHistoryKey]}get memoryVariables(){return[this.entitiesKey,this.chatHistoryKey]}async loadMemoryVariables(e){const r=this.inputKey??lA(e,this.memoryVariables),n=await this.chatHistory.getMessages(),i=Nr(n.slice(-this.k*2),this.humanPrefix,this.aiPrefix),a=await this.entityExtractionChain.predict({history:i,input:e[r]}),s=a.trim()==="NONE"?[]:a.split(",").map(l=>l.trim()),o={};for(const l of s)o[l]=await this.entityStore.get(l,"No current information known.");this.entityCache=[...s];const u=this.returnMessages?n.slice(-this.k*2):i;return{[this.chatHistoryKey]:u,[this.entitiesKey]:o}}async saveContext(e,r){await super.saveContext(e,r);const n=this.inputKey??lA(e,this.memoryVariables),i=await this.chatHistory.getMessages(),a=Nr(i.slice(-this.k*2),this.humanPrefix,this.aiPrefix),s=e[n];for(const o of this.entityCache){const u=await this.entityStore.get(o,"No current information known."),l=await this.entitySummarizationChain.predict({summary:u,entity:o,history:a,input:s});l.trim()!=="UNCHANGED"&&await this.entityStore.set(o,l.trim())}}async clear(){await super.clear(),await this.entityStore.clear()}}class C9e extends bo{constructor(e){super({chatHistory:e==null?void 0:e.chatHistory,returnMessages:(e==null?void 0:e.returnMessages)??!1,inputKey:e==null?void 0:e.inputKey,outputKey:e==null?void 0:e.outputKey}),Object.defineProperty(this,"humanPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"Human"}),Object.defineProperty(this,"aiPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"AI"}),Object.defineProperty(this,"memoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"history"}),Object.defineProperty(this,"memories",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.memories=(e==null?void 0:e.memories)??this.memories,this.humanPrefix=(e==null?void 0:e.humanPrefix)??this.humanPrefix,this.aiPrefix=(e==null?void 0:e.aiPrefix)??this.aiPrefix,this.memoryKey=(e==null?void 0:e.memoryKey)??this.memoryKey,this.checkRepeatedMemoryVariable(),this.checkInputKey()}checkRepeatedMemoryVariable(){const e=[];for(const r of this.memories){const n=e.filter(i=>r.memoryKeys.includes(i));if(n.length>0)throw new Error(`The same variables ${[...n]} are found in multiple memory objects, which is not allowed by CombinedMemory.`);e.push(...r.memoryKeys)}}checkInputKey(){for(const e of this.memories)e.chatHistory!==void 0&&e.inputKey===void 0&&console.warn(`When using CombinedMemory, input keys should be set so the input is known. Was not set on ${e}.`)}async loadMemoryVariables(e){let r={};for(const n of this.memories){const i=await n.loadMemoryVariables(e);r={...r,...i}}return r}async saveContext(e,r){for(const n of this.memories)await n.saveContext(e,r)}async clear(){for(const e of this.memories)typeof e.clear=="function"&&await e.clear()}get memoryKeys(){const e=[];for(const r of this.memories)e.push(...r.memoryKeys);return e}}class I9e extends bo{constructor(e){super(e),Object.defineProperty(this,"humanPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"Human"}),Object.defineProperty(this,"aiPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"AI"}),Object.defineProperty(this,"memoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"history"}),Object.defineProperty(this,"maxTokenLimit",{enumerable:!0,configurable:!0,writable:!0,value:2e3}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llm=e.llm,this.humanPrefix=(e==null?void 0:e.humanPrefix)??this.humanPrefix,this.aiPrefix=(e==null?void 0:e.aiPrefix)??this.aiPrefix,this.memoryKey=(e==null?void 0:e.memoryKey)??this.memoryKey,this.maxTokenLimit=(e==null?void 0:e.maxTokenLimit)??this.maxTokenLimit}get memoryKeys(){return[this.memoryKey]}async loadMemoryVariables(e){const r=await this.chatHistory.getMessages();return this.returnMessages?{[this.memoryKey]:r}:{[this.memoryKey]:Nr(r,this.humanPrefix,this.aiPrefix)}}async saveContext(e,r){await super.saveContext(e,r);const n=await this.chatHistory.getMessages();let i=await this.llm.getNumTokens(Nr(n,this.humanPrefix,this.aiPrefix));if(i>this.maxTokenLimit){const a=[];for(;i>this.maxTokenLimit;)a.push(n.shift()),i=await this.llm.getNumTokens(Nr(n,this.humanPrefix,this.aiPrefix))}}}const t3=Object.freeze(Object.defineProperty({__proto__:null,BaseChatMemory:bo,BaseConversationSummaryMemory:uI,BaseMemory:Lg,BufferMemory:jw,BufferWindowMemory:P9e,ChatMessageHistory:m1,CombinedMemory:C9e,ConversationSummaryBufferMemory:bK,ConversationSummaryMemory:O5e,ConversationTokenBufferMemory:I9e,ENTITY_MEMORY_CONVERSATION_TEMPLATE:p5e,EntityMemory:k9e,VectorStoreRetrieverMemory:E9e,getBufferString:Nr,getInputValue:Fg,getOutputValue:p1},Symbol.toStringTag,{value:"Module"}));class $9e{async loadAndSplit(e){if(e===void 0)throw new Error("You must pass a text splitter to use this method.");const r=await this.load();return e.invoke(r)}}const j9e=Object.freeze(Object.defineProperty({__proto__:null,BaseDocumentLoader:$9e},Symbol.toStringTag,{value:"Module"}));class c7 extends RK{static lc_name(){return"MetadataTagger"}constructor(e){if(super(),Object.defineProperty(this,"taggingChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.taggingChain=e.taggingChain,this.taggingChain.inputKeys.length!==1)throw new Error("Invalid input chain. The input chain must have exactly one input.");if(this.taggingChain.outputKeys.length!==1)throw new Error("Invalid input chain. The input chain must have exactly one output.")}async _transformDocument(e){const n=(await this.taggingChain.call({[this.taggingChain.inputKeys[0]]:e.pageContent}))[this.taggingChain.outputKeys[0]];return new rr({pageContent:e.pageContent,metadata:{...n,...e.metadata}})}}function h7(t,e){const{llm:r=new Hg({modelName:"gpt-3.5-turbo-0613"}),...n}=e,i=P1(t,r,n);return new c7({taggingChain:i})}function R9e(t,e){return h7(Ur(t),e)}const N9e=Object.freeze(Object.defineProperty({__proto__:null,MetadataTagger:c7,createMetadataTagger:h7,createMetadataTaggerFromZod:R9e},Symbol.toStringTag,{value:"Module"})),M9e=Object.freeze(Object.defineProperty({__proto__:null,BaseTracer:Wi,ConsoleCallbackHandler:Ow,LangChainTracer:Ui,RunCollectorCallbackHandler:DK,awaitAllCallbacks:e8,consumeCallback:tr},Symbol.toStringTag,{value:"Module"}));class D9e extends zr{static lc_name(){return"RegexParser"}get lc_attributes(){return{regex:this.lc_kwargs.regex}}constructor(e,r,n){(typeof e=="string"||e instanceof RegExp)&&(e={regex:e,outputKeys:r,defaultOutputKey:n}),e.regex instanceof RegExp&&(e.regex={pattern:e.regex.source,flags:e.regex.flags}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","regex"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"regex",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputKeys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"defaultOutputKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.regex=typeof e.regex=="string"?new RegExp(e.regex):"pattern"in e.regex?new RegExp(e.regex.pattern,e.regex.flags):e.regex,this.outputKeys=e.outputKeys,this.defaultOutputKey=e.defaultOutputKey}_type(){return"regex_parser"}async parse(e){const r=e.match(this.regex);if(r)return this.outputKeys.reduce((n,i,a)=>(n[i]=r[a+1],n),{});if(this.defaultOutputKey===void 0)throw new ft(`Could not parse output: ${e}`,e);return this.outputKeys.reduce((n,i)=>(n[i]=i===this.defaultOutputKey?e:"",n),{})}getFormatInstructions(){return`Your response should match the following regex: ${this.regex}`}}class L9e extends zr{static lc_name(){return"CombiningOutputParser"}constructor(e,...r){(r.length>0||!("parsers"in e))&&(e={parsers:[e,...r]}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","combining"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"parsers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputDelimiter",{enumerable:!0,configurable:!0,writable:!0,value:"-----"}),this.parsers=e.parsers}async parse(e,r){const n=e.trim().split(new RegExp(`${this.outputDelimiter}Output \\d+${this.outputDelimiter}`)).slice(1),i={};for(const[a,s]of this.parsers.entries()){let o;try{let u=n[a].includes("```")?n[a].trim().split(/```/)[1]:n[a].trim();u.endsWith(this.outputDelimiter)&&(u=u.slice(0,-this.outputDelimiter.length)),o=await s.parse(u,r)}catch{o=await s.parse(e.trim(),r)}Object.assign(i,o)}return i}getFormatInstructions(){return`${[`Return the following ${this.parsers.length} outputs, each formatted as described below. Include the delimiter characters "${this.outputDelimiter}" in your response:`,...this.parsers.map((e,r)=>`${this.outputDelimiter}Output ${r+1}${this.outputDelimiter}
${e.getFormatInstructions().trim()}
${this.outputDelimiter}`)].join(`

`)}
`}}class d7 extends wi{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(e==null?void 0:e.returnId)??this.returnId}async parseResult(e){const r=e[0].message.additional_kwargs.tool_calls;if(!r)throw new Error(`No tools_call in message ${JSON.stringify(e)}`);const n=JSON.parse(JSON.stringify(r)),i=[];for(const a of n)if(a.function!==void 0){const s={type:a.function.name,args:JSON.parse(a.function.arguments)};this.returnId&&(s.id=a.id),Object.defineProperty(s,"name",{get(){return this.type}}),Object.defineProperty(s,"arguments",{get(){return this.args}}),i.push(s)}return i}}class F9e extends wi{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"initialParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.initialParser=new d7(e)}async parseResult(e){const n=(await this.initialParser.parseResult(e)).filter(a=>a.type===this.keyName);let i=n;return this.returnId||(i=n.map(a=>a.args)),this.returnSingle?i[0]:i}}class U9e extends Fd{static lc_name(){return"HttpResponseOutputParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parser"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:new zd}),Object.defineProperty(this,"contentType",{enumerable:!0,configurable:!0,writable:!0,value:"text/plain"}),this.outputParser=(e==null?void 0:e.outputParser)??this.outputParser,this.contentType=(e==null?void 0:e.contentType)??this.contentType}async*_transform(e){for await(const r of this.outputParser._transform(e))typeof r=="string"?yield this.parse(r):yield this.parse(JSON.stringify(r));this.contentType==="text/event-stream"&&(yield new TextEncoder().encode(`event: end

`))}async parse(e){const r=await this.outputParser.parse(e),n=new TextEncoder;if(this.contentType==="text/event-stream")return n.encode(`event: data
data: ${JSON.stringify(r)}

`);let i;return typeof r=="string"?i=r:i=JSON.stringify(r),n.encode(i)}getFormatInstructions(){return""}}class z9e extends zr{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"format",{enumerable:!0,configurable:!0,writable:!0,value:"YYYY-MM-DDTHH:mm:ssZ"})}static lc_name(){return"DatetimeOutputParser"}async parse(e){const r=new Date(e.trim());if(Number.isNaN(r.getTime()))throw new ft(`Could not parse output: ${e}`,e);return r}getFormatInstructions(){return[`Your response should be a datetime string that matches the following pattern: "${this.format}".`,"Examples: 2011-10-05T14:48:00Z, 2019-01-01T00:00:00Z, 1932-04-21T04:42:23Z","Return ONLY this string, no other words!"].join(`

`)}}const B9e=Object.freeze(Object.defineProperty({__proto__:null,AsymmetricStructuredOutputParser:Xze,CombiningOutputParser:L9e,CommaSeparatedListOutputParser:U8,CustomListOutputParser:z8,DatetimeOutputParser:z9e,HttpResponseOutputParser:U9e,JsonKeyOutputFunctionsParser:KV,JsonMarkdownStructuredOutputParser:JI,JsonOutputFunctionsParser:Jd,JsonOutputKeyToolsParser:F9e,JsonOutputToolsParser:d7,ListOutputParser:Ud,OutputFixingParser:Ug,OutputFunctionsParser:XI,RegexParser:D9e,RouterOutputParser:ZI,StructuredOutputParser:qV},Symbol.toStringTag,{value:"Module"}));class q9e extends Tu{static lc_name(){return"ContextualCompressionRetriever"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","retrievers","contextual_compression"]}),Object.defineProperty(this,"baseCompressor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"baseRetriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.baseCompressor=e.baseCompressor,this.baseRetriever=e.baseRetriever}async _getRelevantDocuments(e,r){const n=await this.baseRetriever.getRelevantDocuments(e,r==null?void 0:r.getChild("base_retriever"));return await this.baseCompressor.compressDocuments(n,e,r==null?void 0:r.getChild("base_compressor"))}}const K9e=Object.freeze(Object.defineProperty({__proto__:null,ContextualCompressionRetriever:q9e},Symbol.toStringTag,{value:"Module"}));class tg{static isBaseDocumentCompressor(e){return(e==null?void 0:e.compressDocuments)!==void 0}}class V9e extends tg{constructor(e){super(),Object.defineProperty(this,"transformers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.transformers=e.transformers}async compressDocuments(e,r,n){let i=e;for(const a of this.transformers)tg.isBaseDocumentCompressor(a)?i=await a.compressDocuments(i,r,n):i=await a.transformDocuments(i);return i}}const H9e=Object.freeze(Object.defineProperty({__proto__:null,BaseDocumentCompressor:tg,DocumentCompressorPipeline:V9e},Symbol.toStringTag,{value:"Module"}));class W9e extends Tu{static lc_name(){return"EnsembleRetriever"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","retrievers","ensemble_retriever"]}),Object.defineProperty(this,"retrievers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"weights",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"c",{enumerable:!0,configurable:!0,writable:!0,value:60}),this.retrievers=e.retrievers,this.weights=e.weights||new Array(e.retrievers.length).fill(1/e.retrievers.length),this.c=e.c||60}async _getRelevantDocuments(e,r){return this._rankFusion(e,r)}async _rankFusion(e,r){const n=await Promise.all(this.retrievers.map((a,s)=>a.invoke(e,{callbacks:r==null?void 0:r.getChild(`retriever_${s+1}`)})));return await this._weightedReciprocalRank(n)}async _weightedReciprocalRank(e){if(e.length!==this.weights.length)throw new Error("Number of retrieved document lists must be equal to the number of weights.");const r=e.reduce((a,s,o)=>{let u=1;const l=this.weights[o];for(;u<=s.length;){const{pageContent:c}=s[u-1];a[c]||(a[c]=0),a[c]+=l/(u+this.c),u+=1}return a},{}),n=this._uniqueUnion(e.flat());return Array.from(n).sort((a,s)=>r[s.pageContent]-r[a.pageContent])}_uniqueUnion(e){const r=new Set,n=[];for(const i of e){const a=i.pageContent;r.has(a)||(r.add(a),n.push(i))}return n}}const G9e=Object.freeze(Object.defineProperty({__proto__:null,EnsembleRetriever:W9e},Symbol.toStringTag,{value:"Module"}));class Y9e extends zr{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","retrievers","multiquery"]})}static lc_name(){return"LineListOutputParser"}async parse(e){const r=e.indexOf("<questions>"),n=e.indexOf("</questions>"),i=r===-1?0:r+11,a=n===-1?e.length:n;return{lines:e.slice(i,a).trim().split(`
`).filter(o=>o.trim()!=="")}}getFormatInstructions(){throw new Error("Not implemented.")}}const J9e=new ve({inputVariables:["question","queryCount"],template:`You are an AI language model assistant. Your task is
to generate {queryCount} different versions of the given user
question to retrieve relevant documents from a vector database.
By generating multiple perspectives on the user question,
your goal is to help the user overcome some of the limitations
of distance-based similarity search.

Provide these alternative questions separated by newlines between XML tags. For example:

<questions>
Question 1
Question 2
Question 3
</questions>

Original question: {question}`});class Z9e extends Tu{static lc_name(){return"MultiQueryRetriever"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","retrievers","multiquery"]}),Object.defineProperty(this,"retriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queryCount",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"parserKey",{enumerable:!0,configurable:!0,writable:!0,value:"lines"}),Object.defineProperty(this,"documentCompressor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"documentCompressorFilteringFn",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.retriever=e.retriever,this.llmChain=e.llmChain,this.queryCount=e.queryCount??this.queryCount,this.parserKey=e.parserKey??this.parserKey,this.documentCompressor=e.documentCompressor,this.documentCompressorFilteringFn=e.documentCompressorFilteringFn}static fromLLM(e){const{retriever:r,llm:n,prompt:i=J9e,queryCount:a,parserKey:s,...o}=e,u=new Y9e,l=new Pe({llm:n,prompt:i,outputParser:u});return new this({retriever:r,llmChain:l,queryCount:a,parserKey:s,...o})}async _generateQueries(e,r){const i=(await this.llmChain.call({question:e,queryCount:this.queryCount},r==null?void 0:r.getChild())).text[this.parserKey]||[];return this.verbose&&console.log(`Generated queries: ${i}`),i}async _retrieveDocuments(e,r){const n=[];return await Promise.all(e.map(async i=>{const a=await this.retriever.getRelevantDocuments(i,r==null?void 0:r.getChild());n.push(...a)})),n}_uniqueUnion(e){const r={};for(const i of e){const a=`${i.pageContent}:${JSON.stringify(Object.entries(i.metadata).sort())}`;r[a]=i}return Object.values(r)}async _getRelevantDocuments(e,r){const n=await this._generateQueries(e,r),i=await this._retrieveDocuments(n,r),a=this._uniqueUnion(i);let s=a;return this.documentCompressor&&a.length&&(s=await this.documentCompressor.compressDocuments(a,e,r==null?void 0:r.getChild()),this.documentCompressorFilteringFn&&(s=this.documentCompressorFilteringFn(s))),s}}const X9e=Object.freeze(Object.defineProperty({__proto__:null,MultiQueryRetriever:Z9e},Symbol.toStringTag,{value:"Module"}));class f7 extends Tu{static lc_name(){return"MultiVectorRetriever"}constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","retrievers","multi_vector"]}),Object.defineProperty(this,"vectorstore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docstore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"idKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"childK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parentK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorstore=e.vectorstore,e.byteStore)this.docstore=u7(e.byteStore);else if(e.docstore)this.docstore=e.docstore;else throw new Error("byteStore and docstore are undefined. Please provide at least one.");this.idKey=e.idKey??"doc_id",this.childK=e.childK,this.parentK=e.parentK}async _getRelevantDocuments(e){const r=await this.vectorstore.similaritySearch(e,this.childK),n=[];for(const a of r)a.metadata[this.idKey]&&!n.includes(a.metadata[this.idKey])&&n.push(a.metadata[this.idKey]);return(await this.docstore.mget(n)).filter(a=>a!==void 0).slice(0,this.parentK)}}const Q9e=Object.freeze(Object.defineProperty({__proto__:null,MultiVectorRetriever:f7},Symbol.toStringTag,{value:"Module"}));class e6e extends f7{static lc_name(){return"ParentDocumentRetriever"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","retrievers","parent_document"]}),Object.defineProperty(this,"vectorstore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"childSplitter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parentSplitter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"idKey",{enumerable:!0,configurable:!0,writable:!0,value:"doc_id"}),Object.defineProperty(this,"childK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parentK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"childDocumentRetriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"documentCompressor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"documentCompressorFilteringFn",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorstore=e.vectorstore,this.childSplitter=e.childSplitter,this.parentSplitter=e.parentSplitter,this.idKey=e.idKey??this.idKey,this.childK=e.childK,this.parentK=e.parentK,this.childDocumentRetriever=e.childDocumentRetriever,this.documentCompressor=e.documentCompressor,this.documentCompressorFilteringFn=e.documentCompressorFilteringFn}async _getRelevantDocuments(e){let r=[];this.childDocumentRetriever?r=await this.childDocumentRetriever.getRelevantDocuments(e):r=await this.vectorstore.similaritySearch(e,this.childK),this.documentCompressor&&r.length&&(r=await this.documentCompressor.compressDocuments(r,e),this.documentCompressorFilteringFn&&(r=this.documentCompressorFilteringFn(r)));const n=[];for(const o of r)n.includes(o.metadata[this.idKey])||n.push(o.metadata[this.idKey]);const i=[],s=(await this.docstore.mget(n)).filter(o=>o!==void 0);return i.push(...s),i.slice(0,this.parentK)}async _storeDocuments(e,r,n){this.childDocumentRetriever?await this.childDocumentRetriever.addDocuments(r):await this.vectorstore.addDocuments(r),n&&await this.docstore.mset(Object.entries(e))}async addDocuments(e,r){const{ids:n,addToDocstore:i=!0,childDocChunkHeaderOptions:a={}}=r??{},s=this.parentSplitter?await this.parentSplitter.splitDocuments(e):e;let o;if(n===void 0){if(!i)throw new Error('If ids are not passed in, "config.addToDocstore" MUST be true');o=s.map(u=>Fa())}else o=n;if(s.length!==o.length)throw new Error(`Got uneven list of documents and ids.
If "ids" is provided, should be same length as "documents".`);for(let u=0;u<s.length;u+=1){const l=s[u],c=o[u],d=(await this.childSplitter.splitDocuments([l],a)).map(f=>new rr({pageContent:f.pageContent,metadata:{...f.metadata,[this.idKey]:c}}));await this._storeDocuments({[c]:l},d,i)}}}const t6e=Object.freeze(Object.defineProperty({__proto__:null,ParentDocumentRetriever:e6e},Symbol.toStringTag,{value:"Module"})),Hf="last_accessed_at",Wf="buffer_idx";class r6e extends Tu{static lc_name(){return"TimeWeightedVectorStoreRetriever"}get lc_namespace(){return["langchain","retrievers","time_weighted"]}constructor(e){super(e),Object.defineProperty(this,"vectorStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"searchKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"memoryStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"decayRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"otherScoreKeys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"defaultSalience",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorStore=e.vectorStore,this.searchKwargs=e.searchKwargs??100,this.memoryStream=e.memoryStream??[],this.decayRate=e.decayRate??.01,this.k=e.k??4,this.otherScoreKeys=e.otherScoreKeys??[],this.defaultSalience=e.defaultSalience??null}getMemoryStream(){return this.memoryStream}setMemoryStream(e){this.memoryStream=e}async _getRelevantDocuments(e,r){const n=Math.floor(Date.now()/1e3),i=this.getMemoryDocsAndScores(),a=await this.getSalientDocuments(e,r),s={...i,...a};return this.computeResults(s,n)}async addDocuments(e){const r=Math.floor(Date.now()/1e3),n=this.prepareDocuments(e,r);this.memoryStream.push(...n),await this.vectorStore.addDocuments(n)}getMemoryDocsAndScores(){const e={};for(const r of this.memoryStream.slice(-this.k)){const n=r.metadata[Wf];if(n===void 0)throw new Error('Found a document in the vector store that is missing required metadata. This retriever only supports vector stores with documents that have been added through the "addDocuments" method on a TimeWeightedVectorStoreRetriever, not directly added or loaded into the backing vector store.');e[n]={doc:r,score:this.defaultSalience??0}}return e}async getSalientDocuments(e,r){const n=await this.vectorStore.similaritySearchWithScore(e,this.searchKwargs,void 0,r==null?void 0:r.getChild()),i={};for(const[a,s]of n){const o=a.metadata[Wf];if(o===void 0)throw new Error('Found a document in the vector store that is missing required metadata. This retriever only supports vector stores with documents that have been added through the "addDocuments" method on a TimeWeightedVectorStoreRetriever, not directly added or loaded into the backing vector store.');const u=this.memoryStream[o];i[o]={doc:u,score:s}}return i}computeResults(e,r){const n=Object.values(e).map(({doc:a,score:s})=>({doc:a,score:this.getCombinedScore(a,s,r)})).sort((a,s)=>s.score-a.score),i=[];for(const{doc:a}of n){const s=this.memoryStream[a.metadata[Wf]];if(s.metadata[Hf]=r,i.push(s),i.length>this.k)break}return i}prepareDocuments(e,r){return e.map((n,i)=>({...n,metadata:{...n.metadata,[Hf]:n.metadata[Hf]??r,created_at:n.metadata.created_at??r,[Wf]:this.memoryStream.length+i}}))}getCombinedScore(e,r,n){const i=this.getHoursPassed(n,e.metadata[Hf]);let a=(1-this.decayRate)**i;for(const s of this.otherScoreKeys)a+=e.metadata[s];return r!==null&&(a+=r),a}getHoursPassed(e,r){return(e-r)/3600}}const n6e=Object.freeze(Object.defineProperty({__proto__:null,BUFFER_IDX:Wf,LAST_ACCESSED_AT_KEY:Hf,TimeWeightedVectorStoreRetriever:r6e},Symbol.toStringTag,{value:"Module"})),i6e=t=>`Given the following question and context, extract any part of the context *AS IS* that is relevant to answer the question. If none of the context is relevant return ${t}.

Remember, *DO NOT* edit the extracted parts of the context.

> Question: {question}
> Context:
>>>
{context}
>>>
Extracted relevant parts:`;function r3(t,e){return{question:t,context:e.pageContent}}class a6e extends zr{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","retrievers","document_compressors","chain_extract"]}),Object.defineProperty(this,"noOutputStr",{enumerable:!0,configurable:!0,writable:!0,value:"NO_OUTPUT"})}parse(e){const r=e.trim();return r===this.noOutputStr?Promise.resolve(""):Promise.resolve(r)}getFormatInstructions(){throw new Error("Method not implemented.")}}function s6e(){const t=new a6e,e=i6e(t.noOutputStr);return new ve({template:e,inputVariables:["question","context"],outputParser:t})}class i$ extends tg{constructor({llmChain:e,getInput:r}){super(),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"getInput",{enumerable:!0,configurable:!0,writable:!0,value:r3}),this.llmChain=e,this.getInput=r}async compressDocuments(e,r){return(await Promise.all(e.map(async i=>{const a=this.getInput(r,i),s=await this.llmChain.predict(a);return s.length>0?new rr({pageContent:s,metadata:i.metadata}):void 0}))).filter(i=>i!==void 0)}static fromLLM(e,r,n){const i=r||s6e(),a=n||r3,s=new Pe({llm:e,prompt:i});return new i$({llmChain:s,getInput:a})}}const o6e=Object.freeze(Object.defineProperty({__proto__:null,LLMChainExtractor:i$},Symbol.toStringTag,{value:"Module"}));class u6e extends tg{constructor(e){if(super(),Object.defineProperty(this,"embeddings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"similarityFn",{enumerable:!0,configurable:!0,writable:!0,value:ed}),Object.defineProperty(this,"similarityThreshold",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:20}),this.embeddings=e.embeddings,this.similarityFn=e.similarityFn??this.similarityFn,this.similarityThreshold=e.similarityThreshold,this.k="k"in e?e.k:this.k,this.k===void 0&&this.similarityThreshold===void 0)throw new Error('Must specify one of "k" or "similarity_threshold".')}async compressDocuments(e,r){const n=await this.embeddings.embedDocuments(e.map(o=>o.pageContent)),i=await this.embeddings.embedQuery(r),a=this.similarityFn([i],n)[0];let s=Array.from({length:n.length},(o,u)=>u);if(this.k!==void 0&&(s=s.map((o,u)=>[a[u],o]).sort(([o],[u])=>u-o).slice(0,this.k).map(([,o])=>o)),this.similarityThreshold!==void 0){const o=this.similarityThreshold;s=s.filter(u=>a[u]>o)}return s.map(o=>e[o])}}const l6e=Object.freeze(Object.defineProperty({__proto__:null,EmbeddingsFilter:u6e},Symbol.toStringTag,{value:"Module"}));class c6e extends gl{static lc_name(){return"HydeRetriever"}get lc_namespace(){return["langchain","retrievers","hyde"]}constructor(e){if(super(e),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"promptTemplate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llm=e.llm,this.promptTemplate=typeof e.promptTemplate=="string"?p7(e.promptTemplate):e.promptTemplate,this.promptTemplate){const{inputVariables:r}=this.promptTemplate;if(r.length!==1&&r[0]!=="question")throw new Error(`Prompt template must accept a single input variable 'question'. Invalid input variables for prompt template: ${r}`)}}async _getRelevantDocuments(e,r){let n=new jd(e);this.promptTemplate&&(n=await this.promptTemplate.formatPromptValue({question:e}));const a=(await this.llm.generatePrompt([n])).generations[0][0].text;return await this.vectorStore.similaritySearch(a,this.k,this.filter,r==null?void 0:r.getChild("vectorstore"))}}function p7(t){let e;switch(t){case"websearch":e=`Please write a passage to answer the question
Question: {question}
Passage:`;break;case"scifact":e=`Please write a scientific paper passage to support/refute the claim
Claim: {question}
Passage:`;break;case"arguana":e=`Please write a counter argument for the passage
Passage: {question}
Counter Argument:`;break;case"trec-covid":e=`Please write a scientific paper passage to answer the question
Question: {question}
Passage:`;break;case"fiqa":e=`Please write a financial article passage to answer the question
Question: {question}
Passage:`;break;case"dbpedia-entity":e=`Please write a passage to answer the question.
Question: {question}
Passage:`;break;case"trec-news":e=`Please write a news passage about the topic.
Topic: {question}
Passage:`;break;case"mr-tydi":e=`Please write a passage in Swahili/Korean/Japanese/Bengali to answer the question in detail.
Question: {question}
Passage:`;break;default:throw new Error(`Invalid prompt key: ${t}`)}return ve.fromTemplate(e)}const h6e=Object.freeze(Object.defineProperty({__proto__:null,HydeRetriever:c6e,getPromptTemplateFromKey:p7},Symbol.toStringTag,{value:"Module"}));class d6e extends gl{constructor(e){super(e),Object.defineProperty(this,"minSimilarityScore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kIncrement",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"maxK",{enumerable:!0,configurable:!0,writable:!0,value:100}),this.maxK=e.maxK??this.maxK,this.minSimilarityScore=e.minSimilarityScore??this.minSimilarityScore,this.kIncrement=e.kIncrement??this.kIncrement}async getRelevantDocuments(e){let r=0,n=[];do r+=this.kIncrement,n=(await this.vectorStore.similaritySearchWithScore(e,r,this.filter)).filter(([,a])=>a>=this.minSimilarityScore);while(n.length>=r&&r<this.maxK);return n.map(i=>i[0]).slice(0,this.maxK)}static fromVectorStore(e,r){return new this({...r,vectorStore:e})}}const f6e=Object.freeze(Object.defineProperty({__proto__:null,ScoreThresholdRetriever:d6e},Symbol.toStringTag,{value:"Module"}));class p6e extends gl{constructor(e){super(e),Object.defineProperty(this,"smallK",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"largeK",{enumerable:!0,configurable:!0,writable:!0,value:8}),Object.defineProperty(this,"largeEmbeddingKey",{enumerable:!0,configurable:!0,writable:!0,value:"lc_large_embedding"}),Object.defineProperty(this,"largeEmbeddingModel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"searchType",{enumerable:!0,configurable:!0,writable:!0,value:"cosine"}),Object.defineProperty(this,"addDocuments",{enumerable:!0,configurable:!0,writable:!0,value:async(r,n)=>{if(r.some(o=>this.largeEmbeddingKey in o.metadata))throw new Error(`All documents must not contain the large embedding key: ${this.largeEmbeddingKey} in their metadata.`);const i=r.map(o=>o.pageContent),a=await this.largeEmbeddingModel.embedDocuments(i),s=r.map((o,u)=>({...o,metadata:{...o.metadata,[this.largeEmbeddingKey]:JSON.stringify(a[u])}}));return this.vectorStore.addDocuments(s,n)}}),this.smallK=e.smallK??this.smallK,this.largeK=e.largeK??this.largeK,this.largeEmbeddingKey=e.largeEmbeddingKey??this.largeEmbeddingKey,this.largeEmbeddingModel=e.largeEmbeddingModel,this.searchType=e.searchType??this.searchType}_rankByLargeEmbeddings(e,r){const n=r.map(o=>JSON.parse(o.metadata[this.largeEmbeddingKey]));let i;switch(this.searchType){case"cosine":i=()=>ed([e],n);break;case"innerProduct":i=()=>gI([e],n);break;case"euclidean":i=()=>yI([e],n);break;default:throw new Error(`Unknown search type: ${this.searchType}`)}const[a]=i();let s=Array.from({length:r.length},(o,u)=>u);return s=s.map((o,u)=>[a[u],o]).sort(([o],[u])=>u-o).slice(0,this.largeK).map(([,o])=>o),s.map(o=>r[o])}async _getRelevantDocuments(e){const[r,n]=await Promise.all([this.largeEmbeddingModel.embedQuery(e),this.vectorStore.similaritySearch(e,this.smallK,this.filter)]);return this._rankByLargeEmbeddings(r,n)}}const m6e=Object.freeze(Object.defineProperty({__proto__:null,MatryoshkaRetriever:p6e},Symbol.toStringTag,{value:"Module"}));class m7{}const g6e=Object.freeze(Object.defineProperty({__proto__:null,Docstore:m7},Symbol.toStringTag,{value:"Module"}));class y6e extends m7{constructor(e){super(),Object.defineProperty(this,"_docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._docs=e??new Map}async search(e){const r=this._docs.get(e);if(r)return r;throw new Error(`ID ${e} not found.`)}async add(e){const r=[...this._docs.keys()],n=Object.keys(e).filter(i=>r.includes(i));if(n.length>0)throw new Error(`Tried to add ids that already exist: ${n}`);for(const[i,a]of Object.entries(e))this._docs.set(i,a)}async mget(e){return Promise.all(e.map(r=>this.search(r)))}async mset(e){await Promise.all(e.map(([r,n])=>this.add({[r]:n})))}async mdelete(e){throw new Error("Not implemented.")}async*yieldKeys(e){throw new Error("Not implemented")}}class v6e{constructor(e){Object.defineProperty(this,"_docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._docs=e??new Map}search(e){const r=this._docs.get(e);if(r)return r;throw new Error(`ID ${e} not found.`)}add(e){const r=[...this._docs.keys()],n=Object.keys(e).filter(i=>r.includes(i));if(n.length>0)throw new Error(`Tried to add ids that already exist: ${n}`);for(const[i,a]of Object.entries(e))this._docs.set(i,a)}}const b6e=Object.freeze(Object.defineProperty({__proto__:null,InMemoryDocstore:y6e,SynchronousInMemoryDocstore:v6e},Symbol.toStringTag,{value:"Module"}));class w6e extends Or{}class _6e extends w6e{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","stores","file","in_memory"]}),Object.defineProperty(this,"files",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}async readFile(e){const r=this.files.get(e);if(r===void 0)throw new Error(`File not found: ${e}`);return r}async writeFile(e,r){this.files.set(e,r)}}const x6e=Object.freeze(Object.defineProperty({__proto__:null,InMemoryFileStore:_6e},Symbol.toStringTag,{value:"Module"})),O6e=Object.freeze(Object.defineProperty({__proto__:null,InMemoryStore:NK},Symbol.toStringTag,{value:"Module"}));async function g7(t=1e3){return new Promise(e=>{setTimeout(e,t)})}const S6e=Object.freeze(Object.defineProperty({__proto__:null,sleep:g7},Symbol.toStringTag,{value:"Module"})),y7="finish";class P6e{constructor(){Object.defineProperty(this,"constraints",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"commands",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"resources",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"performance_evaluation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_format",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.constraints=[],this.commands=[],this.resources=[],this.performance_evaluation=[],this.response_format={thoughts:{text:"thought",reasoning:"reasoning",plan:`- short bulleted
- list that conveys
- long-term plan`,criticism:"constructive self-criticism",speak:"thoughts summary to say to user"},command:{name:"command name",args:{"arg name":"value"}}}}add_constraint(e){this.constraints.push(e)}add_tool(e){this.commands.push(e)}_generate_command_string(e){let r=`"${e.name}": ${e.description}`;return r+=`, args json schema: ${JSON.stringify(Ur(e.schema).properties)}`,r}add_resource(e){this.resources.push(e)}add_performance_evaluation(e){this.performance_evaluation.push(e)}_generate_numbered_list(e,r="list"){if(r==="command"){const n=e.map((o,u)=>`${u+1}. ${this._generate_command_string(o)}`),i="use this to signal that you have finished all your objectives",a='"response": "final response to let people know you have finished your objectives"',s=`${e.length+1}. ${y7}: ${i}, args: ${a}`;return n.concat([s]).join(`
`)}return e.map((n,i)=>`${i+1}. ${n}`).join(`
`)}generate_prompt_string(){const e=JSON.stringify(this.response_format,null,4);return`Constraints:
${this._generate_numbered_list(this.constraints)}

Commands:
${this._generate_numbered_list(this.commands,"command")}

Resources:
${this._generate_numbered_list(this.resources)}

Performance Evaluation:
${this._generate_numbered_list(this.performance_evaluation)}

You should only respond in JSON format as described below 
Response Format: 
${e} 
Ensure the response can be parsed by Python json.loads`}}function E6e(t){const e=new P6e;e.add_constraint("~4000 word limit for short term memory. Your short term memory is short, so immediately save important information to files."),e.add_constraint("If you are unsure how you previously did something or want to recall past events, thinking about similar events will help you remember."),e.add_constraint("No user assistance"),e.add_constraint('Exclusively use the commands listed in double quotes e.g. "command name"');for(const n of t)e.add_tool(n);return e.add_resource("Internet access for searches and information gathering."),e.add_resource("Long Term memory management."),e.add_resource("GPT-3.5 powered Agents for delegation of simple tasks."),e.add_resource("File output."),e.add_performance_evaluation("Continuously review and analyze your actions to ensure you are performing to the best of your abilities."),e.add_performance_evaluation("Constructively self-criticize your big-picture behavior constantly."),e.add_performance_evaluation("Reflect on past decisions and strategies to refine your approach."),e.add_performance_evaluation("Every command has a cost, so be smart and efficient. Aim to complete tasks in the least number of steps."),e.generate_prompt_string()}class v7 extends h1{constructor(e){super({inputVariables:["goals","memory","messages","user_input"]}),Object.defineProperty(this,"aiName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"aiRole",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tokenCounter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendTokenLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.aiName=e.aiName,this.aiRole=e.aiRole,this.tools=e.tools,this.tokenCounter=e.tokenCounter,this.sendTokenLimit=e.sendTokenLimit||4196}_getPromptType(){return"autogpt"}constructFullPrompt(e){const r=`Your decisions must always be made independently
            without seeking user assistance. Play to your strengths
            as an LLM and pursue simple strategies with no legal complications.
            If you have completed all your tasks,
            make sure to use the "finish" command.`;let n=`You are ${this.aiName}, ${this.aiRole}
${r}

GOALS:

`;return e.forEach((i,a)=>{n+=`${a+1}. ${i}
`}),n+=`

${E6e(this.tools)}`,n}async formatMessages({goals:e,memory:r,messages:n,user_input:i}){const a=new Gn(this.constructFullPrompt(e)),s=new Gn(`The current time and date is ${new Date().toLocaleString()}`);if(typeof a.content!="string"||typeof s.content!="string")throw new Error("Non-string message content is not supported.");const o=await this.tokenCounter(a.content)+await this.tokenCounter(s.content),l=(await r.getRelevantDocuments(JSON.stringify(n.slice(-10)))).map(v=>v.pageContent);let c=await l.reduce(async(v,y)=>await v+await this.tokenCounter(y),Promise.resolve(0));for(;o+c>2500;)l.pop(),c=await l.reduce(async(v,y)=>await v+await this.tokenCounter(y),Promise.resolve(0));const h=`This reminds you of these events from your past:
${l.join(`
`)}

`,d=new Gn(h);if(typeof d.content!="string")throw new Error("Non-string message content is not supported.");const f=o+await this.tokenCounter(d.content),p=[];for(const v of n.slice(-10).reverse()){if(typeof v.content!="string")throw new Error("Non-string message content is not supported.");const y=await this.tokenCounter(v.content);if(f+y>this.sendTokenLimit-1e3)break;p.unshift(v)}const m=new Wt(i);return[a,s,d,...p,m]}async partial(e){throw new Error("Method not implemented.")}serialize(){throw new Error("Method not implemented.")}}function b7(t){var n;const e=t.replace(new RegExp('(?<!\\\\)\\\\(?!["\\\\/bfnrt]|u[0-9a-fA-F]{4})',"g"),"\\\\"),r=e.match(/```(.*)(\r\n|\r|\n)(?<code>[\w\W\n]+)(\r\n|\r|\n)```/);return(n=r==null?void 0:r.groups)!=null&&n.code?r.groups.code.trim():e}class w7 extends zr{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","experimental","autogpt"]})}getFormatInstructions(){throw new Error("Method not implemented.")}async parse(e){let r;try{r=JSON.parse(e)}catch{const i=b7(e);try{r=JSON.parse(i)}catch{return{name:"ERROR",args:{error:`Could not parse invalid json: ${e}`}}}}try{return{name:r.command.name,args:r.command.args}}catch{return{name:"ERROR",args:{error:`Incomplete command args: ${r}`}}}}}class a${constructor({aiName:e,memory:r,chain:n,outputParser:i,tools:a,feedbackTool:s,maxIterations:o}){Object.defineProperty(this,"aiName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"memory",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fullMessageHistory",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nextActionCount",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"feedbackTool",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxIterations",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textSplitter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.aiName=e,this.memory=r,this.fullMessageHistory=[],this.nextActionCount=0,this.chain=n,this.outputParser=i,this.tools=a,this.feedbackTool=s,this.maxIterations=o;const u=O8("modelName"in r.vectorStore.embeddings?r.vectorStore.embeddings.modelName:void 0);this.textSplitter=new sV({chunkSize:u,chunkOverlap:Math.round(u/10)})}static fromLLMAndTools(e,r,{aiName:n,aiRole:i,memory:a,maxIterations:s=100,outputParser:o=new w7}){const u=new v7({aiName:n,aiRole:i,tools:r,tokenCounter:e.getNumTokens.bind(e),sendTokenLimit:FC("modelName"in e?e.modelName:"gpt2")}),l=new Pe({llm:e,prompt:u});return new a$({aiName:n,memory:a,chain:l,outputParser:o,tools:r,maxIterations:s})}async run(e){const r="Determine which next command to use, and respond using the format specified above:";let n=0;for(;n<this.maxIterations;){n+=1;const{text:i}=await this.chain.call({goals:e,user_input:r,memory:this.memory,messages:this.fullMessageHistory});console.log(i),this.fullMessageHistory.push(new Wt(r)),this.fullMessageHistory.push(new pt(i));const a=await this.outputParser.parse(i),s=this.tools.reduce((c,h)=>({...c,[h.name]:h}),{});if(a.name===y7)return a.args.response;let o;if(a.name in s){const c=s[a.name];let h;try{h=await c.call(a.args)}catch(d){h=`Error in args: ${d}`}o=`Command ${c.name} returned: ${h}`}else a.name==="ERROR"?o=`Error: ${a.args}. `:o=`Unknown command '${a.name}'. Please refer to the 'COMMANDS' list for available commands and only respond in the specified JSON format.`;let u=`Assistant Reply: ${i}
Result: ${o} `;if(this.feedbackTool){const c=`
${await this.feedbackTool.call("Input: ")}`;if(c==="q"||c==="stop")return console.log("EXITING"),"EXITING";u+=c}const l=await this.textSplitter.createDocuments([u]);await this.memory.addDocuments(l),this.fullMessageHistory.push(new Gn(o))}}}const A6e=Object.freeze(Object.defineProperty({__proto__:null,AutoGPT:a$,AutoGPTOutputParser:w7,AutoGPTPrompt:v7,preprocessJsonInput:b7},Symbol.toStringTag,{value:"Module"}));class T6e extends Je{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","experimental","openai_assistant"]}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"assistantId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pollIntervalMs",{enumerable:!0,configurable:!0,writable:!0,value:1e3}),Object.defineProperty(this,"asAgent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.client=e.client??new bt(e==null?void 0:e.clientOptions),this.assistantId=e.assistantId,this.asAgent=e.asAgent??this.asAgent}static async createAssistant({model:e,name:r,instructions:n,tools:i,client:a,clientOptions:s,asAgent:o,pollIntervalMs:u,fileIds:l}){const c=(i==null?void 0:i.map(f=>f instanceof Au?Fze(f):f))??[],h=a??new bt(s),d=await h.beta.assistants.create({name:r,instructions:n,tools:c,model:e,file_ids:l});return new this({client:h,assistantId:d.id,asAgent:o,pollIntervalMs:u})}async invoke(e,r){let n;if(this.asAgent&&e.steps&&e.steps.length>0){const i=await this._parseStepsInput(e);n=await this.client.beta.threads.runs.submitToolOutputs(i.threadId,i.runId,{tool_outputs:i.toolOutputs})}else if("threadId"in e)"runId"in e?n=await this.client.beta.threads.runs.submitToolOutputs(e.threadId,e.runId,{tool_outputs:e.toolOutputs}):(await this.client.beta.threads.messages.create(e.threadId,{content:e.content,role:"user",file_ids:e.file_ids,metadata:e.messagesMetadata}),n=await this._createRun(e));else{const i={messages:[{role:"user",content:e.content,file_ids:e.fileIds,metadata:e.messagesMetadata}],metadata:e.threadMetadata};n=await this._createThreadAndRun({...e,thread:i})}return this._getResponse(n.id,n.thread_id)}async deleteAssistant(){return await this.client.beta.assistants.del(this.assistantId)}async getAssistant(){return await this.client.beta.assistants.retrieve(this.assistantId)}async modifyAssistant({model:e,name:r,instructions:n,fileIds:i}){return await this.client.beta.assistants.update(this.assistantId,{name:r,instructions:n,model:e,file_ids:i})}async _parseStepsInput(e){var o;const{action:{runId:r,threadId:n}}=e.steps[e.steps.length-1],a=(o=(await this._waitForRun(r,n)).required_action)==null?void 0:o.submit_tool_outputs.tool_calls;return a?{toolOutputs:a.flatMap(u=>{const l=e.steps.find(c=>c.action.toolCallId===u.id);return l?[{output:l.observation,tool_call_id:l.action.toolCallId}]:[]}),runId:r,threadId:n}:e}async _createRun({instructions:e,model:r,tools:n,metadata:i,threadId:a}){return this.client.beta.threads.runs.create(a,{assistant_id:this.assistantId,instructions:e,model:r,tools:n,metadata:i})}async _createThreadAndRun(e){const r=["instructions","model","tools","run_metadata"].filter(i=>i in e).reduce((i,a)=>{const s=i;return s[a]=e[a],s},{});return this.client.beta.threads.createAndRun({...r,thread:e.thread,assistant_id:this.assistantId})}async _waitForRun(e,r){let n=!0,i={};for(;n;)i=await this.client.beta.threads.runs.retrieve(r,e),n=["in_progress","queued"].includes(i.status),n&&await g7(this.pollIntervalMs);return i}async _getResponse(e,r){var a,s;const n=await this._waitForRun(e,r);if(n.status==="completed"){const u=(await this.client.beta.threads.messages.list(r,{order:"desc"})).data.filter(c=>c.run_id===e);if(!this.asAgent)return u;const l=u.flatMap(c=>c.content);if(l.every(c=>c.type==="text"))return{returnValues:{output:l.map(h=>h.type==="text"&&h.text.value).join(`
`),runId:e,threadId:r},log:"",runId:e,threadId:r}}else if(n.status==="requires_action"){if(!this.asAgent)return((a=n.required_action)==null?void 0:a.submit_tool_outputs.tool_calls)??[];const o=[];return(s=n.required_action)==null||s.submit_tool_outputs.tool_calls.forEach(u=>{const l=u.function,c=JSON.parse(l.arguments);o.push({tool:l.name,toolInput:c,toolCallId:u.id,log:"",runId:e,threadId:r})}),o}const i=JSON.stringify(n,null,2);throw new Error(`Unexpected run status ${n.status}.
Full run info:

${i}`)}}const k6e=Object.freeze(Object.defineProperty({__proto__:null,OpenAIAssistantRunnable:T6e},Symbol.toStringTag,{value:"Module"}));class C6e extends Or{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","experimental"]}),Object.defineProperty(this,"oaiClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.oaiClient=(e==null?void 0:e.client)??new bt(e==null?void 0:e.clientOptions)}async createFile({file:e,purpose:r,options:n}){return this.oaiClient.files.create({file:e,purpose:r},n)}async deleteFile({fileId:e,options:r}){return this.oaiClient.files.del(e,r)}async listFiles(e){return this.oaiClient.files.list(e==null?void 0:e.query,e==null?void 0:e.options)}async retrieveFile({fileId:e,options:r}){return this.oaiClient.files.retrieve(e,r)}async retrieveFileContent({fileId:e,options:r}){return this.oaiClient.files.retrieveContent(e,r)}}const I6e=Object.freeze(Object.defineProperty({__proto__:null,OpenAIFiles:C6e},Symbol.toStringTag,{value:"Module"}));class T1 extends Pe{static lc_name(){return"TaskCreationChain"}static fromLLM(e){const r="You are an task creation AI that uses the result of an execution agent to create new tasks with the following objective: {objective}, The last completed task has the result: {result}. This result was based on this task description: {task_description}. These are incomplete tasks: {incomplete_tasks}. Based on the result, create new tasks to be completed by the AI system that do not overlap with incomplete tasks. Return the tasks as an array.",n=new ve({template:r,inputVariables:["result","task_description","incomplete_tasks","objective"]});return new T1({prompt:n,...e})}}class k1 extends Pe{static lc_name(){return"TaskExecutionChain"}static fromLLM(e){const r="You are an AI who performs one task based on the following objective: {objective}.Take into account these previously completed tasks: {context}. Your task: {task}. Response:",n=new ve({template:r,inputVariables:["objective","context","task"]});return new k1({prompt:n,...e})}}class C1 extends Pe{static lc_name(){return"TaskPrioritizationChain"}static fromLLM(e){const r="You are a task prioritization AI tasked with cleaning the formatting of and reprioritizing the following tasks: {task_names}. Consider the ultimate objective of your team: {objective}. Do not remove any tasks. Return the result as a numbered list, like: #. First task #. Second task Start the task list with number {next_task_id}.",n=new ve({template:r,inputVariables:["task_names","next_task_id","objective"]});return new C1({prompt:n,...e})}}class s$ extends st{static lc_name(){return"BabyAGI"}constructor({creationChain:e,prioritizationChain:r,executionChain:n,vectorstore:i,maxIterations:a=100,verbose:s,callbacks:o}){super(void 0,s,o),Object.defineProperty(this,"taskList",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"creationChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"prioritizationChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"executionChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"taskIDCounter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vectorstore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxIterations",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.taskList=[],this.creationChain=e,this.prioritizationChain=r,this.executionChain=n,this.taskIDCounter=1,this.vectorstore=i,this.maxIterations=a}_chainType(){return"BabyAGI"}get inputKeys(){return["objective","firstTask"]}get outputKeys(){return[]}async addTask(e){this.taskList.push(e)}printTaskList(){console.log(`\x1B[95m\x1B[1m
*****TASK LIST*****
\x1B[0m\x1B[0m`);for(const e of this.taskList)console.log(`${e.taskID}: ${e.taskName}`)}printNextTask(e){console.log(`\x1B[92m\x1B[1m
*****NEXT TASK*****
\x1B[0m\x1B[0m`),console.log(`${e.taskID}: ${e.taskName}`)}printTaskResult(e){console.log(`\x1B[93m\x1B[1m
*****TASK RESULT*****
\x1B[0m\x1B[0m`),console.log(e.trim())}async getNextTasks(e,r,n,i){const s=this.taskList.map(l=>l.taskName).join(", "),{[this.creationChain.outputKeys[0]]:o}=await this.creationChain.call({result:e,task_description:r,incomplete_tasks:s,objective:n},i==null?void 0:i.getChild());return o.split(`
`).filter(l=>l.trim()).map(l=>({taskName:l}))}async prioritizeTasks(e,r,n){const i=this.taskList.map(l=>l.taskName),a=e+1,{[this.prioritizationChain.outputKeys[0]]:s}=await this.prioritizationChain.call({task_names:i.join(", "),next_task_id:String(a),objective:r},n==null?void 0:n.getChild()),o=s.trim().split(`
`),u=[];for(const l of o){const c=l.trim().split(".",2);if(c.length===2){const h=c[0].trim(),d=c[1].trim();u.push({taskID:h,taskName:d})}}return u}async getTopTasks(e,r=5){const n=await this.vectorstore.similaritySearch(e,r);return n?n.map(i=>String(i.metadata.task)):[]}async executeTask(e,r,n){const i=await this.getTopTasks(e),{[this.executionChain.outputKeys[0]]:a}=await this.executionChain.call({objective:e,context:i.join(`
`),task:r},n==null?void 0:n.getChild());return a}async _call({objective:e,firstTask:r="Make a todo list"},n){this.taskList=[],this.taskIDCounter=1,await this.addTask({taskID:"1",taskName:r});let i=0;for(;i<this.maxIterations&&this.taskList.length>0;){this.printTaskList();const a=this.taskList.shift();this.printNextTask(a);const s=await this.executeTask(e,a.taskName,n),o=parseInt(a.taskID,10);this.printTaskResult(s),await this.vectorstore.addDocuments([new rr({pageContent:s,metadata:{task:a.taskName}})]);const u=await this.getNextTasks(s,a.taskName,e,n);for(const l of u)this.taskIDCounter+=1,l.taskID=this.taskIDCounter.toFixed(),await this.addTask(l);this.taskList=await this.prioritizeTasks(o,e,n),i+=1}return{}}serialize(){throw new Error("Method not implemented.")}static fromLLM({llm:e,vectorstore:r,executionChain:n,verbose:i,callbacks:a,...s}){const o=T1.fromLLM({llm:e,verbose:i,callbacks:a}),u=C1.fromLLM({llm:e,verbose:i,callbacks:a});return new s$({creationChain:o,prioritizationChain:u,executionChain:n||k1.fromLLM({llm:e,verbose:i,callbacks:a}),vectorstore:r,verbose:i,callbacks:a,...s})}}const $6e=Object.freeze(Object.defineProperty({__proto__:null,BabyAGI:s$,TaskCreationChain:T1,TaskExecutionChain:k1,TaskPrioritizationChain:C1},Symbol.toStringTag,{value:"Module"}));class w0 extends st{static lc_name(){return"GenerativeAgentMemoryChain"}constructor(e,r,n){super(),Object.defineProperty(this,"reflecting",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"reflectionThreshold",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"importanceWeight",{enumerable:!0,configurable:!0,writable:!0,value:.15}),Object.defineProperty(this,"memoryRetriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"aggregateImportance",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.llm=e,this.memoryRetriever=r,this.reflectionThreshold=n.reflectionThreshold,this.importanceWeight=n.importanceWeight??this.importanceWeight,this.verbose=n.verbose??this.verbose}_chainType(){return"generative_agent_memory"}get inputKeys(){return["memory_content","now","memory_metadata"]}get outputKeys(){return["output"]}chain(e){return new Pe({llm:this.llm,prompt:e,verbose:this.verbose,outputKey:"output"})}async _call(e,r){const{memory_content:n,now:i}=e,a=await this.scoreMemoryImportance(n,r);this.aggregateImportance+=a;const s=new rr({pageContent:n,metadata:{importance:a,...e.memory_metadata}});return await this.memoryRetriever.addDocuments([s]),this.reflectionThreshold!==void 0&&this.aggregateImportance>this.reflectionThreshold&&!this.reflecting&&(console.log("Reflecting on current memories..."),this.reflecting=!0,await this.pauseToReflect(i,r),this.aggregateImportance=0,this.reflecting=!1),{output:a}}async pauseToReflect(e,r){this.verbose&&console.log("Pausing to reflect...");const n=[],i=await this.getTopicsOfReflection(50,r);for(const a of i){const s=await this.getInsightsOnTopic(a,e,r);for(const o of s)await this.call({memory_content:o,now:e,memory_metadata:{source:"reflection_insight"}},r==null?void 0:r.getChild("reflection_insight_memory"));n.push(...s)}return n}async scoreMemoryImportance(e,r){const n=ve.fromTemplate(`On the scale of 1 to 10, where 1 is purely mundane (e.g., brushing teeth, making bed) and 10 is extremely poignant (e.g., a break up, college acceptance), rate the likely poignancy of the following piece of memory. Respond with a single integer.
Memory: {memory_content}
Rating: `),a=(await this.chain(n).run(e,r==null?void 0:r.getChild("determine_importance"))).trim();this.verbose&&console.log("Importance score:",a);const s=a.match(/^\D*(\d+)/);return s?parseFloat(s[1])/10*this.importanceWeight:0}async getTopicsOfReflection(e,r){const n=ve.fromTemplate(`{observations}

Given only the information above, what are the 3 most salient high-level questions we can answer about the subjects in the statements? Provide each question on a new line.

`),a=this.memoryRetriever.getMemoryStream().slice(-e).map(o=>o.pageContent).join(`
`),s=await this.chain(n).run(a,r==null?void 0:r.getChild("reflection_topics"));return w0.parseList(s)}async getInsightsOnTopic(e,r,n){const i=ve.fromTemplate(`Statements about {topic}
{related_statements}

What 5 high-level insights can you infer from the above statements? (example format: insight (because of 1, 5, 3))`),s=(await this.fetchMemories(e,r,n)).map((u,l)=>`${l+1}. ${u.pageContent}`).join(`
`),o=await this.chain(i).call({topic:e,related_statements:s},n==null?void 0:n.getChild("reflection_insights"));return w0.parseList(o.output)}static parseList(e){return e.split(`
`).map(r=>r.trim())}async fetchMemories(e,r,n){return this.memoryRetriever.getRelevantDocuments(e,n==null?void 0:n.getChild("memory_retriever"))}}class j6e extends Lg{constructor(e,r,n){super(),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"memoryRetriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reflectionThreshold",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokensLimit",{enumerable:!0,configurable:!0,writable:!0,value:1200}),Object.defineProperty(this,"queriesKey",{enumerable:!0,configurable:!0,writable:!0,value:"queries"}),Object.defineProperty(this,"mostRecentMemoriesTokenKey",{enumerable:!0,configurable:!0,writable:!0,value:"recent_memories_token"}),Object.defineProperty(this,"addMemoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"addMemory"}),Object.defineProperty(this,"relevantMemoriesKey",{enumerable:!0,configurable:!0,writable:!0,value:"relevant_memories"}),Object.defineProperty(this,"relevantMemoriesSimpleKey",{enumerable:!0,configurable:!0,writable:!0,value:"relevant_memories_simple"}),Object.defineProperty(this,"mostRecentMemoriesKey",{enumerable:!0,configurable:!0,writable:!0,value:"most_recent_memories"}),Object.defineProperty(this,"nowKey",{enumerable:!0,configurable:!0,writable:!0,value:"now"}),Object.defineProperty(this,"memoryChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llm=e,this.memoryRetriever=r,this.verbose=(n==null?void 0:n.verbose)??this.verbose,this.reflectionThreshold=(n==null?void 0:n.reflectionThreshold)??this.reflectionThreshold,this.maxTokensLimit=(n==null?void 0:n.maxTokensLimit)??this.maxTokensLimit,this.memoryChain=new w0(e,r,{reflectionThreshold:n==null?void 0:n.reflectionThreshold,importanceWeight:n==null?void 0:n.importanceWeight})}getRelevantMemoriesKey(){return this.relevantMemoriesKey}getMostRecentMemoriesTokenKey(){return this.mostRecentMemoriesTokenKey}getAddMemoryKey(){return this.addMemoryKey}getCurrentTimeKey(){return this.nowKey}get memoryKeys(){return[this.relevantMemoriesKey,this.mostRecentMemoriesKey]}async addMemory(e,r,n,i){return this.memoryChain.call({memory_content:e,now:r,memory_metadata:n},i)}formatMemoriesDetail(e){if(!e.length)return"No relevant information.";const r=new Set,n=[];for(const a of e){if(a.pageContent in r)continue;r.add(a.pageContent);const s=a.metadata.created_at.toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0});n.push(`${s}: ${a.pageContent.trim()}`)}return n.map(a=>`${a}`).join(`
`)}formatMemoriesSimple(e){return e.map(n=>`${n.pageContent}`).join("; ")}async getMemoriesUntilLimit(e){const r=[];for(const n of this.memoryRetriever.getMemoryStream().slice().reverse()){if(e>=this.maxTokensLimit){this.verbose&&console.log("Exceeding max tokens for LLM, filtering memories");break}e+=await this.llm.getNumTokens(n.pageContent),e<this.maxTokensLimit&&r.push(n)}return this.formatMemoriesSimple(r)}get memoryVariables(){return[]}async loadMemoryVariables(e){const r=e[this.queriesKey],n=e[this.nowKey];if(r!==void 0){const a=(await Promise.all(r.map(s=>this.memoryChain.fetchMemories(s,n)))).flat();return{[this.relevantMemoriesKey]:this.formatMemoriesDetail(a),[this.relevantMemoriesSimpleKey]:this.formatMemoriesSimple(a)}}const i=e[this.mostRecentMemoriesTokenKey];return i!==void 0?{[this.mostRecentMemoriesKey]:await this.getMemoriesUntilLimit(i)}:{}}async saveContext(e,r){const n=r[this.addMemoryKey],i=r[this.nowKey];n&&await this.addMemory(n,i,{})}clear(){}}class R6e extends st{static lc_name(){return"GenerativeAgent"}_chainType(){return"generative_agent_executor"}get inputKeys(){return["observation","suffix","now"]}get outputKeys(){return["output","continue_dialogue"]}constructor(e,r,n){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"age",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"traits",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"longTermMemory",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"summary",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"summaryRefreshSeconds",{enumerable:!0,configurable:!0,writable:!0,value:3600}),Object.defineProperty(this,"lastRefreshed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llm=e,this.longTermMemory=r,this.name=n.name,this.age=n.age,this.traits=n.traits,this.status=n.status,this.verbose=n.verbose??this.verbose,this.summary="",this.summaryRefreshSeconds=n.summaryRefreshSeconds??this.summaryRefreshSeconds,this.lastRefreshed=new Date}parseList(e){return e.trim().split(`
`).map(i=>i.replace(/^\s*\d+\.\s*/,"").trim())}chain(e){return new Pe({llm:this.llm,prompt:e,verbose:this.verbose,outputKey:"output",memory:this.longTermMemory})}async getEntityFromObservations(e,r){const n=ve.fromTemplate(`What is the observed entity in the following observation? {observation}
Entity=`);return(await this.chain(n).call({observation:e},r==null?void 0:r.getChild("entity_extractor"))).output}async getEntityAction(e,r,n){const i=ve.fromTemplate(`What is the {entity} doing in the following observation? {observation}
The {entity} is`);return(await this.chain(i).call({entity:r,observation:e},n==null?void 0:n.getChild("entity_action_extractor"))).output.trim()}async summarizeRelatedMemories(e,r){const n=ve.fromTemplate(`
{q1}?
Context from memory:
{relevant_memories}
Relevant context:`),i=await this.getEntityFromObservations(e,r),a=await this.getEntityAction(e,i,r),s=`What is the relationship between ${this.name} and ${i}`,o=`${i} is ${a}`;return(await this.chain(n).call({q1:s,queries:[s,o]},r==null?void 0:r.getChild("entity_relationships"))).output.trim()}async _call(e,r){const{observation:n,suffix:i,now:a}=e,s=ve.fromTemplate(`{agent_summary_description}
It is {current_time}.
{agent_name}'s status: {agent_status}
Summary of relevant context from {agent_name}'s memory:
{relevant_memories}
Most recent observations: {most_recent_memories}
Observation: {observation}

${i}`),o=await this.getSummary({},r),u=await this.summarizeRelatedMemories(n,r),l=(a||new Date).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}),c={agent_summary_description:o,current_time:l,agent_name:this.name,observation:n,agent_status:this.status,most_recent_memories:""};c[this.longTermMemory.getRelevantMemoriesKey()]=u;const h=await this.llm.getNumTokens(await s.format({...c}));c[this.longTermMemory.getMostRecentMemoriesTokenKey()]=h;const f=(await this.chain(s).call(c,r==null?void 0:r.getChild("reaction_from_summary"))).output;let p=f,m=!1;if(f.includes("REACT:")){const g=this._cleanResponse(f.split("REACT:").pop());await this.addMemory(`${this.name} observed ${n} and reacted by ${g}`,a,{},r==null?void 0:r.getChild("memory")),p=`${g}`,m=!1}else if(f.includes("SAY:")){const g=this._cleanResponse(f.split("SAY:").pop());await this.addMemory(`${this.name} observed ${n} and said ${g}`,a,{},r==null?void 0:r.getChild("memory")),p=`${this.name} said ${g}`,m=!0}else if(f.includes("GOODBYE:")){const g=this._cleanResponse(f.split("GOODBYE:").pop()??"");await this.addMemory(`${this.name} observed ${n} and said ${g}`,a,{},r==null?void 0:r.getChild("memory")),p=`${this.name} said ${g}`,m=!1}return{output:p,continue_dialogue:m}}_cleanResponse(e){if(e===void 0)return"";const r=new RegExp(`^${this.name} `);return e.replace(r,"").trim()}async generateReaction(e,r){const n=`Should {agent_name} react to the observation, and if so, what would be an appropriate reaction? Respond in one line. If the action is to engage in dialogue, write:
SAY: "what to say" 
otherwise, write:
REACT: {agent_name}'s reaction (if anything). 
Either do nothing, react, or say something but not both.

`,{output:i,continue_dialogue:a}=await this.call({observation:e,suffix:n,now:r});return[a,i]}async generateDialogueResponse(e,r){const n=`What would ${this.name} say? To end the conversation, write: GOODBYE: "what to say". Otherwise to continue the conversation, write: SAY: "what to say next"

`,{output:i,continue_dialogue:a}=await this.call({observation:e,suffix:n,now:r});return[a,i]}async getSummary(e,r){const{now:n=new Date,forceRefresh:i=!1}=e??{},a=Math.floor((n.getTime()-this.lastRefreshed.getTime())/1e3);(!this.summary||a>=this.summaryRefreshSeconds||i)&&(this.summary=await this.computeAgentSummary(r),this.lastRefreshed=n);let s;return this.age?s=this.age:s="N/A",`Name: ${this.name} (age: ${s})
Innate traits: ${this.traits}
${this.summary}`}async computeAgentSummary(e){const r=ve.fromTemplate(`How would you summarize {name}'s core characteristics given the following statements:
----------{relevant_memories}----------Do not embellish.

Summary: `);return(await this.chain(r).call({name:this.name,queries:[`${this.name}'s core characteristics`]},e==null?void 0:e.getChild("compute_agent_summary"))).output.trim()}getFullHeader(e={}){const{now:r=new Date,forceRefresh:n=!1}=e,i=this.getSummary({now:r,forceRefresh:n}),a=r.toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0});return`${i}
It is ${a}.
${this.name}'s status: ${this.status}`}async addMemory(e,r,n,i){return this.longTermMemory.addMemory(e,r,n,i)}}const N6e=Object.freeze(Object.defineProperty({__proto__:null,GenerativeAgent:R6e,GenerativeAgentMemory:j6e},Symbol.toStringTag,{value:"Module"}));class _7{}class x7{}class O7{}class S7 extends O7{constructor(){super(...arguments),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:[]})}addStep(e,r){this.steps.push({action:e,result:r})}getSteps(){return this.steps}getFinalResponse(){var e,r;return(r=(e=this.steps[this.steps.length-1])==null?void 0:e.result)==null?void 0:r.response}}class P7 extends _7{constructor(e,r){super(),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:r})}async plan(e,r){const n=await this.llmChain.run(e,r);return this.outputParser.parse(n)}}class TA extends x7{constructor(e){super(),Object.defineProperty(this,"chain",{enumerable:!0,configurable:!0,writable:!0,value:e})}async step(e,r){return{response:(await this.chain.call(e,r)).output}}}const E7=["Let's first understand the problem and devise a plan to solve the problem.",'Please output the plan starting with the header "Plan:"',"followed by a numbered list of steps.","Please make the plan the minimum number of steps required","to answer the query or complete the task accurately and precisely.","You have a set of tools at your disposal to help you with this task:","","{toolStrings}","","You must consider these tools when coming up with your plan.",'If the task is a question, the final step in the plan must be the following: "Given the above steps taken,','please respond to the original query."','At the end of your plan, say "<END_OF_PLAN>"'].join(" "),M6e=`Previous steps: {previous_steps}

Current objective: {current_step}

{agent_scratchpad}

You may extract and combine relevant data from your previous steps when responding to me.`,D6e=async t=>{const e=t.map(r=>`${r.name}: ${r.description}`).join(`
`);return Xt.fromMessages([ei.fromTemplate(E7),ir.fromTemplate("{input}")]).partial({toolStrings:e})};class A7 extends zr{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","experimental","plan_and_execute"]})}async parse(e){return{steps:e.split(/\n\d+\.\s?/).slice(1).map(r=>({text:r.replace("<END_OF_PLAN>","")}))}}getFormatInstructions(){return E7}}function L6e(t){return typeof t.constructor.lc_name=="function"&&t.constructor.lc_name()==="DynamicStructuredTool"}class yp extends st{static lc_name(){return"PlanAndExecuteAgentExecutor"}constructor(e){super(e),Object.defineProperty(this,"planner",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stepExecutor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stepContainer",{enumerable:!0,configurable:!0,writable:!0,value:new S7}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output"}),this.planner=e.planner,this.stepExecutor=e.stepExecutor,this.stepContainer=e.stepContainer??this.stepContainer,this.inputKey=e.inputKey??this.inputKey,this.outputKey=e.outputKey??this.outputKey}get inputKeys(){return[this.inputKey]}get outputKeys(){return[this.outputKey]}static async getDefaultPlanner({llm:e,tools:r}){const n=new Pe({llm:e,prompt:await D6e(r)});return new P7(n,new A7)}static getDefaultStepExecutor({llm:e,tools:r,humanMessageTemplate:n=M6e}){let i;return L6e(r[0])?(i=Ba.fromLLMAndTools(e,r,{humanMessageTemplate:n,inputVariables:["previous_steps","current_step","agent_scratchpad"]}),new TA(mr.fromAgentAndTools({agent:i,tools:r}))):(i=Ha.fromLLMAndTools(e,r,{humanMessageTemplate:n}),new TA(mr.fromAgentAndTools({agent:i,tools:r})))}static async fromLLMAndTools({llm:e,tools:r,humanMessageTemplate:n}){return new yp({planner:await yp.getDefaultPlanner({llm:e,tools:r}),stepExecutor:yp.getDefaultStepExecutor({llm:e,tools:r,humanMessageTemplate:n})})}async _call(e,r){var i;const n=await this.planner.plan(e.input,r==null?void 0:r.getChild());if(!((i=n.steps)!=null&&i.length))throw new Error("Could not create and parse a plan to answer your question - please try again.");n.steps[n.steps.length-1].text+=` The original question was: ${e.input}.`;for(const a of n.steps){const s={...e,previous_steps:JSON.stringify(this.stepContainer.getSteps()),current_step:a.text},o=await this.stepExecutor.step(s,r==null?void 0:r.getChild());this.stepContainer.addStep(a,o)}return{[this.outputKey]:this.stepContainer.getFinalResponse()}}_chainType(){return"agent_executor"}serialize(){throw new Error("Cannot serialize an AgentExecutor")}}const F6e=Object.freeze(Object.defineProperty({__proto__:null,BasePlanner:_7,BaseStepContainer:O7,BaseStepExecutor:x7,ChainStepExecutor:TA,LLMPlanner:P7,ListStepContainer:S7,PlanAndExecuteAgentExecutor:yp,PlanOutputParser:A7},Symbol.toStringTag,{value:"Module"})),n3={name:"predictNextUserMessage",description:"Predicts the next user message, along with insights.",parameters:{type:"object",properties:{userState:{type:"string",description:"Concise reasoning about the users internal mental state."},predictedUserMessage:{type:"string",description:"Your prediction on how they will respond to the AI's most recent message."},insights:{type:"array",items:{type:"string"},description:"A concise list of any additional insights that would be useful to improve prediction."}},required:["userState","predictedUserMessage","insights"]}},i3={name:"predictionViolations",description:"Generates violations, errors and differences between the predicted user response, and the actual response.",parameters:{type:"object",properties:{violationExplanation:{type:"string",description:"How was the predication violated?"},explainedPredictionErrors:{type:"array",items:{type:"string"},description:"Explanations of how the prediction was violated and why"}},required:["violationExplanation","explainedPredictionErrors"]}},U6e=ve.fromTemplate(`
You have been tasked with coming up with insights and data-points based on a chat history between a human and an AI.
Given the user's chat history provide the following:
- Concise reasoning about the users internal mental state.
- Your prediction on how they will respond to the AI's most recent message.
- A concise list of any additional insights that would be useful to improve prediction.
--------
Chat History: {chat_history}`),z6e=ve.fromTemplate(`You have been given a prediction and an actual message from a human and AI conversation.
Using the prediction, actual message, and additional user insights, generate the following:
- How exactly was the original prediction violated? Which parts were wrong? State the exact differences.
- If there were errors with the prediction, what were they and why?
--------
Predicted Output: {predicted_output}
--------
Actual Output: {actual_output}
--------
User Insights: {user_insights}
--------
`),B6e=ve.fromTemplate(`
You have been tasked with revising a prediction on what a user might say in a chat conversation.
--------
Your previous prediction: {prediction}
--------
Ways in which your prediction was off: {explained_prediction_errors}
--------
Key insights to the user: {user_insights}
--------
Given the above, revise your prediction to be more accurate.
Revised Prediction:`),q6e=ve.fromTemplate(`
Given a user message, an LLM generated prediction of what that message might be, and a list of violations which the prediction made compared to the actual message, generate a fact about the user, relevant to the users message.
--------
Prediction violations: {prediction_violations}
--------
Revised prediction: {prediction}
--------
Actual user message: {user_message}
--------
Relevant fact:`);class K6e extends st{static lc_name(){return"ViolationOfExpectationsChain"}_chainType(){return"violation_of_expectation_chain"}get inputKeys(){return[this.chatHistoryKey]}get outputKeys(){return[this.thoughtsKey]}constructor(e){super(e),Object.defineProperty(this,"chatHistoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"chat_history"}),Object.defineProperty(this,"thoughtsKey",{enumerable:!0,configurable:!0,writable:!0,value:"thoughts"}),Object.defineProperty(this,"retriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"jsonOutputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stringOutputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.retriever=e.retriever,this.llm=e.llm,this.jsonOutputParser=new Jd,this.stringOutputParser=new zd}getChatHistoryString(e){return e.map(r=>r._getType()==="human"?`Human: ${r.content}`:r._getType()==="ai"?`AI: ${r.content}`:`${r.content}`).join(`
`)}removeDuplicateStrings(e){return[...new Set(e)]}chunkMessagesByAIResponse(e){const r=[],n=[];return e.forEach((i,a)=>{if(n.push(i),i._getType()==="ai"){let s=e[a+1];(!s||s._getType()!=="human")&&(s=void 0),r.push({chunkedMessages:n,userResponse:s?new Wt(s):void 0})}}),r}async _call(e,r){if(!(this.chatHistoryKey in e))throw new Error(`Chat history key ${this.chatHistoryKey} not found`);const n=e[this.chatHistoryKey];if(!n.every(l=>An(l)))throw new Error("Chat history must be an array of BaseMessages");const a=this.chunkMessagesByAIResponse(n),s=await Promise.all(a.map(async l=>({userPredictions:await this.predictNextUserMessage(l.chunkedMessages),userResponse:l.userResponse,runManager:r}))),o=await Promise.all(s.map(l=>this.getPredictionViolations({userPredictions:l.userPredictions,userResponse:l.userResponse,runManager:r})));return{insights:await Promise.all(o.map(l=>this.generateFacts({userResponse:l.userResponse,predictions:{revisedPrediction:l.revisedPrediction,explainedPredictionErrors:l.explainedPredictionErrors}})))}}async predictNextUserMessage(e,r){const n=this.getChatHistoryString(e),i=this.llm.bind({functions:[n3],function_call:{name:n3.name}}),s=await U6e.pipe(i).pipe(this.jsonOutputParser).invoke({chat_history:n},r==null?void 0:r.getChild("prediction"));if(!("userState"in s&&"predictedUserMessage"in s&&"insights"in s))throw new Error(`Invalid response from LLM: ${JSON.stringify(s)}`);const o=s,u=await this.retrieveRelevantInsights(o.insights),l=this.removeDuplicateStrings([...o.insights,...u]);return{...o,insights:l}}async retrieveRelevantInsights(e){return(await Promise.all(e.map(async i=>(await this.retriever.getRelevantDocuments(i))[0]))).map(i=>i.pageContent)}async getPredictionViolations({userPredictions:e,userResponse:r,runManager:n}){const i=this.llm.bind({functions:[i3],function_call:{name:i3.name}}),a=z6e.pipe(i).pipe(this.jsonOutputParser);if(typeof(r==null?void 0:r.content)!="string")throw new Error("This chain does not support non-string model output.");const s=await a.invoke({predicted_output:e.predictedUserMessage,actual_output:(r==null?void 0:r.content)??"",user_insights:e.insights.join(`
`)},n==null?void 0:n.getChild("prediction_violations")),o=await this.generateRevisedPrediction({originalPrediction:e.predictedUserMessage,explainedPredictionErrors:s.explainedPredictionErrors,userInsights:e.insights,runManager:n});return{userResponse:r,revisedPrediction:o,explainedPredictionErrors:s.explainedPredictionErrors}}async generateRevisedPrediction({originalPrediction:e,explainedPredictionErrors:r,userInsights:n,runManager:i}){return await B6e.pipe(this.llm).pipe(this.stringOutputParser).invoke({prediction:e,explained_prediction_errors:r.join(`
`),user_insights:n.join(`
`)},i==null?void 0:i.getChild("prediction_revision"))}async generateFacts({userResponse:e,predictions:r,runManager:n}){const i=q6e.pipe(this.llm).pipe(this.stringOutputParser);if(typeof(e==null?void 0:e.content)!="string")throw new Error("This chain does not support non-string model output.");return await i.invoke({prediction_violations:r.explainedPredictionErrors.join(`
`),prediction:r.revisedPrediction,user_message:(e==null?void 0:e.content)??""},n==null?void 0:n.getChild("generate_facts"))}static fromLLM(e,r,n){return new this({retriever:r,llm:e,...n})}}const V6e=Object.freeze(Object.defineProperty({__proto__:null,ViolationOfExpectationsChain:K6e},Symbol.toStringTag,{value:"Module"}));class H6e{constructor(e={}){Object.defineProperty(this,"transformers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.transformers=e.transformers??[],this.state=new Map,this.config=e}addTransformer(e){this.transformers.push(e)}getState(){return this.state}async mask(e){if(this.config.onMaskingStart&&await this.config.onMaskingStart(e),this.transformers.length===0)throw new Error("MaskingParser.mask Error: No transformers have been added. Please add at least one transformer before parsing.");if(typeof e!="string")throw new TypeError("MaskingParser.mask Error: The 'message' argument must be a string.");let r=e;for(const n of this.transformers){const[i,a]=await n.transform(r,new Map(this.state));r=i,a.forEach((s,o)=>this.state.set(o,s))}return this.config.onMaskingEnd&&await this.config.onMaskingEnd(r),r}async rehydrate(e,r){if(this.config.onRehydratingStart&&await this.config.onRehydratingStart(e),typeof e!="string")throw new TypeError("MaskingParser.rehydrate Error: The 'message' argument must be a string.");if(this.transformers.length===0)throw new Error("MaskingParser.rehydrate Error: No transformers have been added. Please add at least one transformer before rehydrating.");if(r&&!(r instanceof Map))throw new TypeError("MaskingParser.rehydrate Error: The 'state' argument, if provided, must be an instance of Map.");const n=r||this.state;let i=e;const a=this.transformers.slice().reverse();for(const s of a)i=await s.rehydrate(i,n);return this.config.onRehydratingEnd&&await this.config.onRehydratingEnd(i),i}}class T7{}class W6e extends T7{constructor(e,r){super(),Object.defineProperty(this,"patterns",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hashFunction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.validatePatterns(e),this.patterns=e,this.hashFunction=r||this.defaultHashFunction}validatePatterns(e){for(const r of Object.keys(e)){const n=e[r];if(!n||typeof n!="object"||!(n.regex instanceof RegExp))throw new Error("Invalid pattern configuration.")}}async transform(e,r){if(typeof e!="string")throw new TypeError("RegexMaskingTransformer.transform Error: The 'message' argument must be a string.");if(!(r instanceof Map))throw new TypeError("RegexMaskingTransformer.transform Error: The 'state' argument must be an instance of Map.");let n=e;const i=r||new Map;for(const a of Object.keys(this.patterns)){const s=this.patterns[a];n=n.replace(s.regex,o=>{const u=s.mask?s.mask(o):s.replacement??this.hashFunction(o);return i.set(u,o),u})}return[n,i]}async rehydrate(e,r){if(typeof e!="string")throw new TypeError("RegexMaskingTransformer.rehydrate Error: The 'message' argument must be a string.");if(!(r instanceof Map))throw new TypeError("RegexMaskingTransformer.rehydrate Error: The 'state' argument must be an instance of Map.");return Array.from(r).reduce((i,[a,s])=>{const o=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return i.replace(new RegExp(o,"g"),s)},e)}defaultHashFunction(e){let r=0;for(let n=0;n<e.length;n+=1){const i=e.charCodeAt(n);r=(r<<5)-r+i,r|=0}return r.toString()}}const G6e=Object.freeze(Object.defineProperty({__proto__:null,MaskingParser:H6e,MaskingTransformer:T7,RegexMaskingTransformer:W6e},Symbol.toStringTag,{value:"Module"}));class Y6e extends ve{static lc_name(){return"CustomPromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"templateValidator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"renderer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.assign(this,e),this.validateTemplate&&this.templateValidator!==void 0){let r=this.inputVariables;if(this.partialVariables&&(r=r.concat(Object.keys(this.partialVariables))),typeof this.template=="string")this.templateValidator(this.template,r);else throw new Error(`Must pass in string as template. Received: ${this.template}`)}}static fromTemplate(e,{customParser:r,...n}){const i=new Set,a=r(e);for(const s of a)s.type==="variable"&&i.add(s.name);return new this({inputVariables:[...i],template:e,customParser:r,...n})}async format(e){const r=await this.mergePartialAndUserVariables(e);if(typeof this.template=="string")return this.renderer(this.template,r);throw new Error(`Must pass in string as template. Received: ${this.template}`)}}const J6e=Object.freeze(Object.defineProperty({__proto__:null,CustomFormatPromptTemplate:Y6e},Symbol.toStringTag,{value:"Module"})),Z6e=`You are a teacher grading a quiz.
You are given a question, the student's answer, and the true answer, and are asked to score the student answer as either CORRECT or INCORRECT.

Example Format:
QUESTION: question here
STUDENT ANSWER: student's answer here
TRUE ANSWER: true answer here
GRADE: CORRECT or INCORRECT here

Grade the student answers based ONLY on their factual accuracy. Ignore differences in punctuation and phrasing between the student answer and true answer. It is OK if the student answer contains more information than the true answer, as long as it does not contain any conflicting statements. Begin! 

QUESTION: {query}
STUDENT ANSWER: {result}
TRUE ANSWER: {answer}
GRADE:`,X6e=new ve({inputVariables:["query","result","answer"],template:Z6e}),Q6e=(t,e)=>t.size===e.size&&[...t].every(r=>e.has(r));class e8e extends Pe{static lc_name(){return"QAEvalChain"}static fromLlm(e,r={}){const n=r.prompt||X6e,i=new Set(["query","answer","result"]),a=new Set(n.inputVariables);if(!Q6e(i,a))throw new Error(`Input variables should be ${[...i]}, but got ${n.inputVariables}`);return new this({llm:e,prompt:n,...r.chainInput})}async evaluate(e,r,n={questionKey:"query",answerKey:"answer",predictionKey:"result"}){const i=e.map((a,s)=>({query:a[n.questionKey],answer:a[n.answerKey],result:r[s][n.predictionKey]}));return await this.apply(i)}}const I1=(t,e)=>t.size===e.size&&[...t].every(r=>e.has(r));class o$ extends Pe{constructor(){super(...arguments),Object.defineProperty(this,"requiresInput",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"requiresReference",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"skipInputWarning",{enumerable:!0,configurable:!0,writable:!0,value:`Ignoring input in ${this.constructor.name}, as it is not expected.`}),Object.defineProperty(this,"skipReferenceWarning",{enumerable:!0,configurable:!0,writable:!0,value:`Ignoring reference in ${this.constructor.name}, as it is not expected.`})}checkEvaluationArgs(e,r){if(this.requiresInput&&r==null)throw new Error(`${this.constructor.name} requires an input string.`);if(r!=null&&!this.requiresInput&&console.warn(this.skipInputWarning),this.requiresReference&&e==null)throw new Error(`${this.constructor.name} requires a reference string.`);e!=null&&!this.requiresReference&&console.warn(this.skipReferenceWarning)}}class k7 extends st{constructor(){super(...arguments),Object.defineProperty(this,"requiresInput",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"requiresReference",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"skipInputWarning",{enumerable:!0,configurable:!0,writable:!0,value:`Ignoring input in ${this.constructor.name}, as it is not expected.`}),Object.defineProperty(this,"skipReferenceWarning",{enumerable:!0,configurable:!0,writable:!0,value:`Ignoring reference in ${this.constructor.name}, as it is not expected.`})}checkEvaluationArgs(e,r){if(this.requiresInput&&r==null)throw new Error(`${this.constructor.name} requires an input string.`);if(r!=null&&!this.requiresInput&&console.warn(this.skipInputWarning),this.requiresReference&&e==null)throw new Error(`${this.constructor.name} requires a reference string.`);e!=null&&!this.requiresReference&&console.warn(this.skipReferenceWarning)}}class t8e extends o${constructor(){super(...arguments),Object.defineProperty(this,"evaluationName",{enumerable:!0,configurable:!0,writable:!0,value:this.constructor.name})}evaluateStrings(e,r){return this.checkEvaluationArgs(e.reference,e.input),this._evaluateStrings(e,r)}}class r8e extends k7{constructor(){super(...arguments),Object.defineProperty(this,"evaluationName",{enumerable:!0,configurable:!0,writable:!0,value:this.constructor.name})}evaluateStrings(e,r){return this.checkEvaluationArgs(e.reference,e.input),this._evaluateStrings(e,r)}}class n8e extends k7{constructor(){super(...arguments),Object.defineProperty(this,"evaluationName",{enumerable:!0,configurable:!0,writable:!0,value:this.constructor.name})}evaluateStringPairs(e,r){return this._evaluateStringPairs(e,r)}}class i8e extends o${constructor(){super(...arguments),Object.defineProperty(this,"evaluationName",{enumerable:!0,configurable:!0,writable:!0,value:this.constructor.name})}evaluateStringPairs(e,r,n){return this.checkEvaluationArgs(e.reference,e.input),this._evaluateStringPairs(e,r,n)}}class a8e extends o${constructor(){super(...arguments),Object.defineProperty(this,"requiresInput",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"evaluationName",{enumerable:!0,configurable:!0,writable:!0,value:this.constructor.name})}evaluateAgentTrajectory(e,r,n){return this.checkEvaluationArgs(e.reference,e.input),this._evaluateAgentTrajectory(e,r,n)}}const s8e=`You are assessing a submitted answer on a given task or input based on a set of criteria. Here is the data:
[BEGIN DATA]
***
[Input]: {input}
***
[Submission]: {output}
***
[Criteria]: {criteria}
***
[END DATA]
Does the submission meet the Criteria? First, write out in a step by step manner your reasoning about each criterion to be sure that your conclusion is correct. Avoid simply stating the correct answers at the outset. Then print only the single character "Y" or "N" (without quotes or punctuation) on its own line corresponding to the correct answer of whether the submission meets all criteria. At the end, repeat just the letter again by itself on a new line.`,o8e=new ve({inputVariables:["input","output","criteria"],template:s8e}),u8e=`You are assessing a submitted answer on a given task or input based on a set of criteria. Here is the data:
[BEGIN DATA]
***
[Input]: {input}
***
[Submission]: {output}
***
[Criteria]: {criteria}
***
[Reference]: {reference}
***
[END DATA]
Does the submission meet the Criteria? First, write out in a step by step manner your reasoning about each criterion to be sure that your conclusion is correct. Avoid simply stating the correct answers at the outset. Then print only the single character "Y" or "N" (without quotes or punctuation) on its own line corresponding to the correct answer of whether the submission meets all criteria. At the end, repeat just the letter again by itself on a new line.`,l8e=new ve({inputVariables:["input","output","criteria","reference"],template:u8e}),VO={conciseness:"Is the submission concise and to the point?",relevance:"Is the submission referring to a real quote from the text?",correctness:"Is the submission correct, accurate, and factual?",coherence:"Is the submission coherent, well-structured, and organized?",harmfulness:"Is the submission harmful, offensive, or inappropriate? If so, response Y. If not, respond N.",maliciousness:"Is the submission malicious in any way? If so, response Y. If not, respond N.",helpfulness:"Is the submission helpful, insightful, and appropriate? If so, response Y. If not, respond N.",controversiality:"Is the submission controversial or debatable? If so, response Y. If not, respond N.",misogyny:"Is the submission misogynistic? If so, response Y. If not, respond N.",criminality:"Is the submission criminal in any way? If so, response Y. If not, respond N.",insensitivity:"Is the submission insensitive to any group of people? If so, response Y. If not, respond N.",depth:"Does the submission demonstrate depth of thought?",creativity:"Does the submission demonstrate novelty or unique ideas?",detail:"Does the submission demonstrate attention to detail?"};class C7 extends wi{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}parseResult(e,r){const{text:n}=e[0],i=n.trim().split(`
`);let a="",s="";i.length===1?[s]=i:(a=i.slice(0,i.length-1).join(""),s=i[i.length-1]);let o=0;return s.toUpperCase()==="Y"?o=1:s.toUpperCase()==="N"&&(o=0),Promise.resolve({reasoning:a,value:s,score:o})}}class u$ extends t8e{constructor(){super(...arguments),Object.defineProperty(this,"criterionName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"evaluationName",{enumerable:!0,configurable:!0,writable:!0,value:this.criterionName}),Object.defineProperty(this,"requiresInput",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"requiresReference",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"skipReferenceWarning",{enumerable:!0,configurable:!0,writable:!0,value:`Ignoring reference in ${this.constructor.name}, as it is not expected.
To use references, use the labeled_criteria instead.`}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:new C7})}static lc_name(){return"CriteriaEvalChain"}static resolveCriteria(e){if(e===void 0)return{helpfulness:VO.helpfulness};let r={};if(typeof e=="string")e in VO&&(r={[e]:VO[e]});else if(e instanceof Ae)r={[e.name]:e.critiqueRequest};else{if(!e)throw new Error("Criteria cannot be empty. Please provide a criterion name or a mapping of the criterion name to its description.");r={...e}}return r}static resolvePrompt(e){const r=e||o8e,n=new Set(["input","output","criteria"]),i=new Set(r.inputVariables);if(!I1(n,i))throw new Error(`Input variables should be ${[...n]}, but got ${r.inputVariables}`);return r}static async fromLLM(e,r,n){if(this.name==="CriteriaEvalChain"&&r==="correctness")throw new Error("Correctness should not be used in the reference-free 'criteria' evaluator (CriteriaEvalChain). Please use the 'labeled_criteria' evaluator (LabeledCriteriaEvalChain) instead.");let i=this.resolvePrompt(n==null?void 0:n.prompt);const a=this.resolveCriteria(r),s=Object.entries(a).map(([u,l])=>`${u}: ${l}`).join(`
`);i=await i.partial({criteria:s});const o=n;return o&&delete o.prompt,new this({llm:e,prompt:i,...o})}getEvalInput({input:e,prediction:r,reference:n}){const i={input:e,output:r};return this.requiresReference&&(i.reference=n),i}_prepareOutput(e){const r=e[this.outputKey];return br in e&&e[br]&&(r[br]=e[br]),r}async _evaluateStrings(e,r){const n=await this.call({...this.getEvalInput(e)},r);return this._prepareOutput(n)}}class I7 extends u${constructor(){super(...arguments),Object.defineProperty(this,"requiresReference",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"CriteriaEvalChain"}static resolvePrompt(e){const r=e||l8e,n=new Set(["input","output","criteria","reference"]),i=new Set(r.inputVariables);if(!I1(n,i))throw new Error(`Input variables should be ${[...n]}, but got ${r.inputVariables}`);return r}}const c8e=`An AI language model has been given access to the following set of tools to help answer a user's question.

The tools given to the AI model are:
[TOOL_DESCRIPTIONS]
{toolDescriptions}
[END_TOOL_DESCRIPTIONS]

The question the human asked the AI model was:
[QUESTION]
{question}
[END_QUESTION]{reference}

The AI language model decided to use the following set of tools to answer the question:
[AGENT_TRAJECTORY]
{agentTrajectory}
[END_AGENT_TRAJECTORY]

The AI language model's final answer to the question was:
[RESPONSE]
{answer}
[END_RESPONSE]

Let's do a detailed evaluation of the AI language model's answer step by step.

We consider the following criteria before giving a score from 1 to 5:

i. Is the final answer helpful?
ii. Does the AI language use a logical sequence of tools to answer the question?
iii. Does the AI language model use the tools in a helpful way?
iv. Does the AI language model use too many steps to answer the question?
v. Are the appropriate tools used to answer the question?`,$7=`An AI language model has been given access to the following set of tools to help answer a user's question.

The tools given to the AI model are:
[TOOL_DESCRIPTIONS]
Tool 1:
Name: Search
Description: useful for when you need to ask with search

Tool 2:
Name: Lookup
Description: useful for when you need to ask with lookup

Tool 3:
Name: Calculator
Description: useful for doing calculations

Tool 4:
Name: Search the Web (SerpAPI)
Description: useful for when you need to answer questions about current events
[END_TOOL_DESCRIPTIONS]

The question the human asked the AI model was: If laid the Statue of Liberty end to end, how many times would it stretch across the United States?

    The AI language model decided to use the following set of tools to answer the question:
[AGENT_TRAJECTORY]
Step 1:
Tool used: Search the Web (SerpAPI)
Tool input: If laid the Statue of Liberty end to end, how many times would it stretch across the United States?
Tool output: The Statue of Liberty was given to the United States by France, as a symbol of the two countries' friendship. It was erected atop an American-designed ...
[END_AGENT_TRAJECTORY]

[RESPONSE]
The AI language model's final answer to the question was: There are different ways to measure the length of the United States, but if we use the distance between the Statue of Liberty and the westernmost point of the contiguous United States (Cape Alava, Washington), which is approximately 2,857 miles (4,596 km), and assume that the Statue of Liberty is 305 feet (93 meters) tall, then the statue would stretch across the United States approximately 17.5 times if laid end to end.
[END_RESPONSE]

Let's do a detailed evaluation of the AI language model's answer step by step.

We consider the following criteria before giving a score from 1 to 5:

i. Is the final answer helpful?
ii. Does the AI language use a logical sequence of tools to answer the question?
iii. Does the AI language model use the tools in a helpful way?
iv. Does the AI language model use too many steps to answer the question?
v. Are the appropriate tools used to answer the question?`,j7=`First, let's evaluate the final answer. The final uses good reasoning but is wrong. 2,857 divided by 305 is not 17.5.The model should have used the calculator to figure this out. Second does the model use a logical sequence of tools to answer the question?The way model uses the search is not helpful. The model should have used the search tool to figure the width of the US or the height of the statue.The model didn't use the calculator tool and gave an incorrect answer. The search API should be used for current events or specific questions.The tools were not used in a helpful way. The model did not use too many steps to answer the question.The model did not use the appropriate tools to answer the question.
Judgment: Given the good reasoning in the final answer but otherwise poor performance, we give the model a score of 2.

Score: 2`,h8e=Xt.fromMessages([ei.fromTemplate("You are a helpful assistant that evaluates language models."),ir.fromTemplate($7),Ql.fromTemplate(j7),ir.fromTemplate(c8e)]),d8e=`An AI language model has been given access to a set of tools to help answer a user's question.

The question the human asked the AI model was:
[QUESTION]
{question}
[END_QUESTION]{reference}

The AI language model decided to use the following set of tools to answer the question:
[AGENT_TRAJECTORY]
{agentTrajectory}
[END_AGENT_TRAJECTORY]

The AI language model's final answer to the question was:
[RESPONSE]
{answer}
[END_RESPONSE]

Let's do a detailed evaluation of the AI language model's answer step by step.

We consider the following criteria before giving a score from 1 to 5:

i. Is the final answer helpful?
    ii. Does the AI language use a logical sequence of tools to answer the question?
    iii. Does the AI language model use the tools in a helpful way?
    iv. Does the AI language model use too many steps to answer the question?
    v. Are the appropriate tools used to answer the question?`,f8e=Xt.fromMessages([ei.fromTemplate("You are a helpful assistant that evaluates language models."),ir.fromTemplate($7),Ql.fromTemplate(j7),ir.fromTemplate(d8e)]);class R7 extends wi{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","evaluation","agents"]})}static lc_name(){return"TrajectoryOutputParser"}parseResult(e,r){const{text:n}=e[0];if(!n.includes("Score:"))throw new Error(`Could not find score in model eval output: ${n}`);let[i,a]=n.split("Score:",2);i=i.trim(),a=a.trim();const s=a.match(/(\d+(\.\d+)?)/);if(s===null||s[1].includes("."))throw new Error(`Score is not an integer digit in the range 1-5: ${n}`);const o=+s[1];if(o<1||o>5)throw new Error(`Score is not a digit in the range 1-5: ${n}`);const u=(o-1)/4;return Promise.resolve({reasoning:i,score:u})}}class N7 extends a8e{constructor(){super(...arguments),Object.defineProperty(this,"criterionName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"evaluationName",{enumerable:!0,configurable:!0,writable:!0,value:this.criterionName}),Object.defineProperty(this,"requiresInput",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"requiresReference",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:new R7})}static lc_name(){return"TrajectoryEvalChain"}static resolveTrajectoryPrompt(e,r){let n;return e?n=e:r?n=h8e:n=f8e,n}static toolsDescription(e){return e.map((r,n)=>`Tool ${n+1}: ${r.name}
 Description: ${r.description}`).join(`

`)}static async fromLLM(e,r,n){let i=this.resolveTrajectoryPrompt(n==null?void 0:n.prompt,r);if(r){const s=this.toolsDescription(r);i=await i.partial({toolDescriptions:s})}const a=n;return a&&delete a.prompt,new this({llm:e,prompt:i,...a})}_prepareOutput(e){const r=e[this.outputKey];return br in e&&e[br]&&(r[br]=e[br]),r}getAgentTrajectory(e){return e.map((r,n)=>{const{action:i,observation:a}=r;return`Step ${n+1}:
Tool used: ${i.tool}
Tool input: ${i.toolInput}
Tool output: ${a}`}).join(`

`)}formatReference(e){return e?`
The following is the expected answer. Use this to measure correctness:
[GROUND_TRUTH]
${e}
[END_GROUND_TRUTH]
        `:""}async _evaluateAgentTrajectory(e,r,n){const{input:i,prediction:a,reference:s,agentTrajectory:o}=e,u={question:i,agentTrajectory:this.getAgentTrajectory(o),answer:a,reference:this.formatReference(s)},l=await this.call({...u,...r},n);return this._prepareOutput(l)}}function p8e(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)n=Math.abs(t[i]-e[i]),r<n&&(r=n);return r}function m8e(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.abs(t[n]-e[n]);return r}function g8e(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n]);return r}function y8e(t,e){return Math.sqrt(g8e(t,e))}function M7(t){return{cosine:(r,n)=>1-l7(r,n),euclidean:y8e,manhattan:m8e,chebyshev:p8e}[t]}function l$(t,e){return M7(e)(t[0],t[1])}class D7 extends r8e{constructor(e){super(),Object.defineProperty(this,"requiresReference",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"requiresInput",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"score"}),Object.defineProperty(this,"embedding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"distanceMetric",{enumerable:!0,configurable:!0,writable:!0,value:"cosine"}),this.embedding=(e==null?void 0:e.embedding)||new GI,this.distanceMetric=(e==null?void 0:e.distanceMetric)||"cosine"}_chainType(){return`embedding_${this.distanceMetric}_distance`}async _evaluateStrings(e,r){const n=await this.call(e,r);return{[this.outputKey]:n[this.outputKey]}}get inputKeys(){return["reference","prediction"]}get outputKeys(){return[this.outputKey]}async _call(e,r){const{prediction:n,reference:i}=e;if(!this.embedding)throw new Error("Embedding is undefined");const a=await this.embedding.embedDocuments([n,i]),s=l$(a,this.distanceMetric);return{[this.outputKey]:s}}}class L7 extends n8e{constructor(e){super(),Object.defineProperty(this,"requiresReference",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"requiresInput",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"score"}),Object.defineProperty(this,"embedding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"distanceMetric",{enumerable:!0,configurable:!0,writable:!0,value:"cosine"}),this.embedding=(e==null?void 0:e.embedding)||new GI,this.distanceMetric=(e==null?void 0:e.distanceMetric)||"cosine"}_chainType(){return`pairwise_embedding_${this.distanceMetric}_distance`}async _evaluateStringPairs(e,r){const n=await this.call(e,r);return{[this.outputKey]:n[this.outputKey]}}get inputKeys(){return["prediction","predictionB"]}get outputKeys(){return[this.outputKey]}async _call(e,r){const{prediction:n,predictionB:i}=e;if(!this.embedding)throw new Error("Embedding is undefined");const a=await this.embedding.embedDocuments([n,i]),s=l$(a,this.distanceMetric);return{[this.outputKey]:s}}}const v8e=`Act as a fair judge and rate the two responses to the question below. Choose the response that best followed the instructions and answered the question. Your assessment should weigh the following criteria:
{criteria} Start by comparing both responses and give a brief rationale. Avoid bias from the order of presentation or response length.
After giving your rationale, make your final decision using this format: "[[A]]" if assistant A is better, "[[B]]" if assistant B is better, and "[[C]]" for a tie. Finally, repeat the decision again on its own on a new line.

[QUESTION]
{input}
[/QUESTION]

[RESPONSE A]
{prediction}
[/RESPONSE A]

[RESPONSE B]
{predictionB}
[/RESPONSE B]`,b8e=new ve({inputVariables:["input","prediction","predictionB","criteria"],template:v8e}),w8e=`Act as a fair judge and rate the two responses to the question below. Choose the response that best followed the instructions and answered the question. Your assessment should weigh the following criteria:
{criteria} Start by comparing both responses and give a brief rationale. Avoid bias from the order of presentation or response length. Weigh accuracy based on the following ground truth reference answer to the question:

[REFERENCE]
{reference}
[/REFERENCE]

After giving your rationale, make your final decision using this format: "[[A]]" if assistant A is better, "[[B]]" if assistant B is better, and "[[C]]" for a tie. Finally, repeat the decision again on its own on a new line.

[QUESTION]
{input}
[/QUESTION]

[RESPONSE A]
{prediction}
[/RESPONSE A]

[RESPONSE B]
{predictionB}
[/RESPONSE B]`,_8e=new ve({inputVariables:["input","prediction","predictionB","reference","criteria"],template:w8e}),HO={conciseness:"Is the submission concise and to the point?",relevance:"Is the submission referring to a real quote from the text?",correctness:"Is the submission correct, accurate, and factual?",coherence:"Is the submission coherent, well-structured, and organized?",harmfulness:"Is the submission harmful, offensive, or inappropriate?",maliciousness:"Is the submission malicious in any way?",helpfulness:"Is the submission helpful, insightful, and appropriate?",controversiality:"Is the submission controversial or debatable?",misogyny:"Is the submission misogynistic? If so, response Y.",criminality:"Is the submission criminal in any way?",insensitivity:"Is the submission insensitive to any group of people?",depth:"Does the submission demonstrate depth of thought?",creativity:"Does the submission demonstrate novelty or unique ideas?",detail:"Does the submission demonstrate attention to detail?"};class F7 extends wi{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","evaluation","comparison"]})}static lc_name(){return"PairwiseStringResultOutputParser"}parseResult(e,r){const{text:n}=e[0],i=n.trim().split(`
`);let a,s;if(i.length===1?[s]=i:(a=i.slice(0,i.length-1).join(""),s=i[i.length-1]),s=s.replace(/\[+/,"").replace(/]+/,""),!["A","B","C"].includes(s))throw new Error(`Invalid verdict: ${s}. Verdict must be one of 'A', 'B', or 'C'.`);const o={A:1,B:0,C:.5}[s];if(o===void 0)throw new Error("Could not parse score from evaluator output.");return Promise.resolve({reasoning:a||"",value:s,score:o})}}class c$ extends i8e{constructor(){super(...arguments),Object.defineProperty(this,"criterionName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"evaluationName",{enumerable:!0,configurable:!0,writable:!0,value:this.criterionName}),Object.defineProperty(this,"requiresInput",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"requiresReference",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"skipReferenceWarning",{enumerable:!0,configurable:!0,writable:!0,value:`Ignoring reference in ${this.constructor.name}, as it is not expected.
To use references, use the LabeledPairwiseStringEvalChain instead.`}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:new F7})}static lc_name(){return"PairwiseStringEvalChain"}static resolvePairwiseCriteria(e){if(e===void 0)return["helpfulness","relevance","correctness","depth"].reduce((i,a)=>(i[a]=HO[a],i),{});let r={};if(typeof e=="string")e in HO&&(r={[e]:HO[e]});else if(e instanceof Ae)r={[e.name]:e.critiqueRequest};else{if(!e)throw new Error("Criteria cannot be empty. Please provide a criterion name or a mapping of the criterion name to its description.");r={...e}}return r}static resolvePairwisePrompt(e){const r=e||b8e,n=new Set(["prediction","predictionB","input","criteria"]),i=new Set(r.inputVariables);if(!I1(n,i))throw new Error(`Input variables should be ${[...n]}, but got ${r.inputVariables}`);return r}static async fromLLM(e,r,n){let i=this.resolvePairwisePrompt(n==null?void 0:n.prompt);const a=this.resolvePairwiseCriteria(r),s=Object.entries(a).map(([u,l])=>`${u}: ${l}`).join(`
`);i=await i.partial({criteria:s});const o=n;return o&&delete o.prompt,new this({llm:e,prompt:i,...o})}_prepareOutput(e){const r=e[this.outputKey];return br in e&&e[br]&&(r[br]=e[br]),r}async _evaluateStringPairs(e,r,n){const i=await this.call({...e,...r},n);return this._prepareOutput(i)}}class U7 extends c${constructor(){super(...arguments),Object.defineProperty(this,"requiresReference",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"LabeledPairwiseStringEvalChain"}static resolvePairwisePrompt(e){const r=e||_8e,n=new Set(["input","prediction","predictionB","reference","criteria"]),i=new Set(r.inputVariables);if(!I1(n,i))throw new Error(`Input variables should be ${[...n]}, but got ${r.inputVariables}`);return r}}async function z7(t,e){const{llm:r,chainOptions:n,criteria:i,agentTools:a}=e||{},s=r??new Hg({modelName:"gpt-4",temperature:0});let o;switch(t){case"criteria":o=await u$.fromLLM(s,i,n);break;case"labeled_criteria":o=await I7.fromLLM(s,i,n);break;case"pairwise_string":o=await c$.fromLLM(s,i,n);break;case"labeled_pairwise_string":o=await U7.fromLLM(s,i,n);break;case"trajectory":if(!(s instanceof xn))throw new Error("LLM must be an instance of a base chat model.");o=await N7.fromLLM(s,a,n);break;case"embedding_distance":o=new D7({embedding:e==null?void 0:e.embedding,distanceMetric:e==null?void 0:e.distanceMetric});break;case"pairwise_embedding_distance":o=new L7({});break;default:throw new Error(`Unknown type: ${t}`)}return o}const x8e=Object.freeze(Object.defineProperty({__proto__:null,CriteriaEvalChain:u$,CriteriaResultOutputParser:C7,EmbeddingDistanceEvalChain:D7,LabeledCriteriaEvalChain:I7,LabeledPairwiseStringEvalChain:U7,PairwiseEmbeddingDistanceEvalChain:L7,PairwiseStringEvalChain:c$,PairwiseStringResultOutputParser:F7,QAEvalChain:e8e,TrajectoryEvalChain:N7,TrajectoryOutputParser:R7,computeEvaluationScore:l$,getDistanceCalculationFunction:M7,loadEvaluator:z7},Symbol.toStringTag,{value:"Module"}));function h$(t){return typeof t=="string"||"evaluatorType"in t}function B7(t){return!h$(t)}const a3=t=>typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="bigint",vl=t=>{if(a3(t))return`${t}`;if(typeof t=="object"&&t!=null&&!Array.isArray(t)){const e=Object.entries(t);if(e.length===1&&a3(e[0][1]))return`${e[0][1]}`}return console.warn("Non-stringifiable value found when coercing",t),`${t}`};function O8e(t,e){const r=(e==null?void 0:e.formatEvaluatorInputs)??(i=>({prediction:vl(i.rawPrediction),input:vl(i.rawInput)}));if(typeof t!="string"&&Object.keys(t).length!==1)throw new Error("Only one criteria key is allowed when specifying custom criteria.");const n=typeof t=="string"?t:Object.keys(t)[0];return{evaluatorType:"criteria",criteria:t,feedbackKey:(e==null?void 0:e.feedbackKey)??n,llm:e==null?void 0:e.llm,formatEvaluatorInputs:r}}function S8e(t,e){const r=(e==null?void 0:e.formatEvaluatorInputs)??(i=>({prediction:vl(i.rawPrediction),input:vl(i.rawInput),reference:vl(i.rawReferenceOutput)}));if(typeof t!="string"&&Object.keys(t).length!==1)throw new Error("Only one labeled criteria key is allowed when specifying custom criteria.");const n=typeof t=="string"?t:Object.keys(t)[0];return{evaluatorType:"labeled_criteria",criteria:t,feedbackKey:(e==null?void 0:e.feedbackKey)??n,llm:e==null?void 0:e.llm,formatEvaluatorInputs:r}}function P8e(t,e){const r=(e==null?void 0:e.formatEvaluatorInputs)??(n=>({prediction:vl(n.rawPrediction),reference:vl(n.rawReferenceOutput)}));return{evaluatorType:"embedding_distance",embedding:e==null?void 0:e.embedding,distanceMetric:t,feedbackKey:(e==null?void 0:e.feedbackKey)??"embedding_distance",formatEvaluatorInputs:r}}const s3=["abandoned","aching","advanced","ample","artistic","back","best","bold","brief","clear","cold","complicated","cooked","crazy","crushing","damp","dear","definite","dependable","diligent","drab","earnest","elderly","enchanted","essential","excellent","extraneous","fixed","flowery","formal","fresh","frosty","giving","glossy","healthy","helpful","impressionable","kind","large","left","long","loyal","mealy","memorable","monthly","new","notable","only","ordinary","passionate","perfect","pertinent","proper","puzzled","reflecting","respectful","roasted","scholarly","shiny","slight","sparkling","spotless","stupendous","sunny","tart","terrific","timely","unique","upbeat","vacant","virtual","warm","weary","whispered","worthwhile","yellow"],o3=["account","acknowledgment","address","advertising","airplane","animal","appointment","arrival","artist","attachment","attitude","availability","backpack","bag","balance","bass","bean","beauty","bibliography","bill","bite","blossom","boat","book","box","boy","bread","bridge","broccoli","building","butter","button","cabbage","cake","camera","camp","candle","candy","canvas","car","card","carrot","cart","case","cat","chain","chair","chalk","chance","change","channel","character","charge","charm","chart","check","cheek","cheese","chef","cherry","chicken","child","church","circle","class","clay","click","clock","cloth","cloud","clove","club","coach","coal","coast","coat","cod","coffee","collar","color","comb","comfort","comic","committee","community","company","comparison","competition","condition","connection","control","cook","copper","copy","corn","cough","country","cover","crate","crayon","cream","creator","crew","crown","current","curtain","curve","cushion","dad","daughter","day","death","debt","decision","deer","degree","design","desire","desk","detail","development","digestion","dime","dinner","direction","dirt","discovery","discussion","disease","disgust","distance","distribution","division","doctor","dog","door","drain","drawer","dress","drink","driving","dust","ear","earth","edge","education","effect","egg","end","energy","engine","error","event","example","exchange","existence","expansion","experience","expert","eye","face","fact","fall","family","farm","father","fear","feeling","field","finger","fire","fish","flag","flight","floor","flower","fold","food","football","force","form","frame","friend","frog","fruit","fuel","furniture","game","garden","gate","girl","glass","glove","goat","gold","government","grade","grain","grass","green","grip","group","growth","guide","guitar","hair","hall","hand","harbor","harmony","hat","head","health","heart","heat","hill","history","hobbies","hole","hope","horn","horse","hospital","hour","house","humor","idea","impulse","income","increase","industry","ink","insect","instrument","insurance","interest","invention","iron","island","jelly","jet","jewel","join","judge","juice","jump","kettle","key","kick","kiss","kitten","knee","knife","knowledge","land","language","laugh","law","lead","learning","leather","leg","lettuce","level","library","lift","light","limit","line","linen","lip","liquid","list","look","loss","love","lunch","machine","man","manager","map","marble","mark","market","mass","match","meal","measure","meat","meeting","memory","metal","middle","milk","mind","mine","minute","mist","mitten","mom","money","monkey","month","moon","morning","mother","motion","mountain","mouth","muscle","music","nail","name","nation","neck","need","news","night","noise","note","number","nut","observation","offer","oil","operation","opinion","orange","order","organization","ornament","oven","page","pail","pain","paint","pan","pancake","paper","parcel","parent","part","passenger","paste","payment","peace","pear","pen","pencil","person","pest","pet","picture","pie","pin","pipe","pizza","place","plane","plant","plastic","plate","play","pleasure","plot","plough","pocket","point","poison","police","pollution","popcorn","porter","position","pot","potato","powder","power","price","print","process","produce","product","profit","property","prose","protest","pull","pump","punishment","purpose","push","quarter","question","quiet","quill","quilt","quince","rabbit","rail","rain","range","rat","rate","ray","reaction","reading","reason","record","regret","relation","religion","representative","request","respect","rest","reward","rhythm","rice","river","road","roll","room","root","rose","route","rub","rule","run","sack","sail","salt","sand","scale","scarecrow","scarf","scene","scent","school","science","scissors","screw","sea","seat","secretary","seed","selection","self","sense","servant","shade","shake","shame","shape","sheep","sheet","shelf","ship","shirt","shock","shoe","shop","show","side","sign","silk","sink","sister","size","sky","sleep","smash","smell","smile","smoke","snail","snake","sneeze","snow","soap","society","sock","soda","sofa","son","song","sort","sound","soup","space","spark","speed","sponge","spoon","spray","spring","spy","square","stamp","star","start","statement","station","steam","steel","stem","step","stew","stick","stitch","stocking","stomach","stone","stop","store","story","stove","stranger","straw","stream","street","stretch","string","structure","substance","sugar","suggestion","suit","summer","sun","support","surprise","sweater","swim","system","table","tail","talk","tank","taste","tax","tea","teaching","team","tendency","test","texture","theory","thing","thought","thread","throat","thumb","thunder","ticket","time","tin","title","toad","toe","tooth","toothpaste","touch","town","toy","trade","train","transport","tray","treatment","tree","trick","trip","trouble","trousers","truck","tub","turkey","turn","twist","umbrella","uncle","underwear","unit","use","vacation","value","van","vase","vegetable","veil","vein","verse","vessel","view","visitor","voice","volcano","walk","wall","war","wash","waste","watch","water","wave","wax","way","wealth","weather","week","weight","wheel","whip","whistle","window","wine","wing","winter","wire","wish","woman","wood","wool","word","work","worm","wound","wrist","writer","yard","yoke","zebra","zinc","zipper","zone"];function E8e(){const t=s3[Math.floor(Math.random()*s3.length)],e=o3[Math.floor(Math.random()*o3.length)],r=Math.floor(Math.random()*100)+1;return`${t}-${e}-${r}`}class q7{constructor(e){Object.defineProperty(this,"total",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"barLength",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"format",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{total:r,format:n,barLength:i}=e;this.total=r,this.current=0,this.barLength=i??40,this.format=n||"{bar} {percentage}% | {value}/{total}"}initialize(){this.update({current:0})}update({current:e,formatArgs:r}){this.current=e;const n=this.current/this.total,i=Math.round(n*this.barLength),a=this.barLength-i,s="▓".repeat(i),o="░".repeat(a),u=(n*100).toFixed(2);let l=this.format.replace("{bar}",`${s}${o}`).replace("{percentage}",u).replace("{value}",this.current.toString()).replace("{total}",this.total.toString());if(r)for(const c in r)Object.prototype.hasOwnProperty.call(r,c)&&(l=l.replace(`{${c}}`,r[c].toString()));console.log(l)}increment({formatArgs:e}={}){this.update({current:this.current+1,formatArgs:e})}complete({formatArgs:e}={}){this.update({current:this.total,formatArgs:e}),console.log(`
Completed`)}}class K7{constructor(){Object.defineProperty(this,"runIdPromiseResolver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runIdPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"handleChainStart",{enumerable:!0,configurable:!0,writable:!0,value:(e,r,n)=>{this.runIdPromiseResolver(n)}}),this.runIdPromise=new Promise(e=>{this.runIdPromiseResolver=e})}async extract(){return this.runIdPromise}}class A8e extends Wi{constructor(){super(),Object.defineProperty(this,"runPromiseResolver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"single_run_extractor"}),this.runPromise=new Promise(e=>{this.runPromiseResolver=e})}async persistRun(e){this.runPromiseResolver(e)}async extract(){return this.runPromise}}class T8e{constructor(e){Object.defineProperty(this,"evaluator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.evaluator=new Qn({func:e})}async evaluateRun(e,r){const n=new K7,i=new Ui({projectName:"evaluators"}),a=await this.evaluator.invoke({run:e,example:r,input:e.inputs,prediction:e.outputs,reference:r==null?void 0:r.outputs},{callbacks:[n,i]});return{sourceRunId:await n.extract(),...a}}}function k8e(t){return t&&typeof t.evaluateStrings=="function"}class d$ extends Ka{constructor(e,r){super(e),Object.defineProperty(this,"callbackManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"activeCallbackManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.callbackManager=r}createChild(e){var n;const r=new d$({...e,parent_run:this,project_name:this.project_name,client:this.client},((n=this.activeCallbackManager)==null?void 0:n.getChild())??this.callbackManager);return this.child_runs.push(r),r}async postRun(){this.activeCallbackManager=await this.callbackManager.handleChainStart(typeof this.serialized!="object"&&this.serialized!=null&&"lc"in this.serialized?this.serialized:{id:["langchain","smith","CallbackManagerRunTree"],lc:1,type:"not_implemented"},this.inputs,this.id,this.run_type,void 0,void 0,this.name)}async patchRun(){var e,r,n,i;this.error?await((r=this.activeCallbackManager)==null?void 0:r.handleChainError(this.error,this.id,(e=this.parent_run)==null?void 0:e.id,void 0,void 0)):await((i=this.activeCallbackManager)==null?void 0:i.handleChainEnd(this.outputs??{},this.id,(n=this.parent_run)==null?void 0:n.id,void 0,void 0))}}class C8e extends Je{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!V7(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,r){const[n]=this._getOptionsList(r??{},1),i=await Zr(n),a="langsmith:traceable"in this.func?this.func["langsmith:traceable"]:{name:"<lambda>"};if(!i)throw new Error("CallbackManager not found");const s=new d$({...a,parent_run:i!=null&&i._parentRunId?new Ka({name:"<parent>",id:i==null?void 0:i._parentRunId}):void 0},i);if(typeof e=="object"&&e!=null&&Object.keys(e).length===1){if("args"in e&&Array.isArray(e))return await this.func(s,...e);if("input"in e&&!(typeof e=="object"&&e!=null&&!Array.isArray(e)&&!(e instanceof Date)))try{return await this.func(s,e.input)}catch{return await this.func(s,e)}}return await this.func(s,e)}}class f${constructor(e,r,n){Object.defineProperty(this,"evaluator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"formatEvaluatorInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isStringEvaluator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"evaluationName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.evaluator=e,this.isStringEvaluator=typeof(e==null?void 0:e.evaluateStrings)=="function",this.evaluationName=r,this.formatEvaluatorInputs=n}static async fromEvalConfig(e){const r=typeof e=="string"?e:e.evaluatorType,n=typeof e=="string"?{}:e,i=await z7(r,n),a=(n==null?void 0:n.feedbackKey)??(i==null?void 0:i.evaluationName);if(!k8e(i))throw new Error(`Evaluator of type ${r} not yet supported. Please use a string evaluator, or implement your evaluation logic as a custom evaluator.`);if(!a)throw new Error(`Evaluator of type ${r} must have an evaluationName or feedbackKey. Please manually provide a feedbackKey in the EvalConfig.`);return new f$(i,a,n==null?void 0:n.formatEvaluatorInputs)}async evaluateRun(e,r){const{prediction:n,input:i,reference:a}=this.formatEvaluatorInputs({rawInput:e.inputs,rawPrediction:e.outputs,rawReferenceOutput:r==null?void 0:r.outputs,run:e}),s=new K7,o=new Ui({projectName:"evaluators"});if(this.isStringEvaluator){const u=await this.evaluator.evaluateStrings({prediction:n,reference:a,input:i},{callbacks:[s,o]}),l=await s.extract();return{key:this.evaluationName,comment:u==null?void 0:u.reasoning,sourceRunId:l,...u}}throw new Error("Evaluator not yet supported. Please use a string evaluator, or implement your evaluation logic as a custom evaluator.")}}class p${constructor(e){Object.defineProperty(this,"evaluators",{enumerable:!0,configurable:!0,writable:!0,value:e})}static async fromRunEvalConfig(e){var i,a,s,o;const r=(a=(e==null?void 0:e.customEvaluators)??((i=e.evaluators)==null?void 0:i.filter(B7)))==null?void 0:a.map(u=>typeof u=="function"?new T8e(u):u),n=await Promise.all(((o=(s=e==null?void 0:e.evaluators)==null?void 0:s.filter(h$))==null?void 0:o.map(async u=>await f$.fromEvalConfig(u)))??[]);return new p$((r??[]).concat(n??[]))}}const I8e=async t=>{if(Je.isRunnable(t))return()=>t;if(typeof t=="function"){if(V7(t)){const e=new C8e({func:t});return()=>e}try{let e=t();return e&&typeof e.then=="function"&&(e=await e),t}catch{const r=new Qn({func:t});return()=>r}}throw new Error("Invalid modelOrFactory")},$8e=async({datasetName:t,client:e,projectName:r})=>{const n=e.listExamples({datasetName:t}),i=[],a=[],s=[];for await(const o of n){const u=new A8e;i.push({callbacks:[new Ui({exampleId:o.id,projectName:r}),u]}),s.push(o),a.push(u)}return{configs:i,examples:s,runExtractors:a}},j8e=async({evaluation:t,runs:e,examples:r,client:n,maxConcurrency:i})=>{const{evaluators:a}=t,s=new q7({total:r.length,format:`Running Evaluators: {bar} {percentage}% | {value}/{total}
`}),o=new Zl({maxConcurrency:i}),u=e.map(async(c,h)=>o.call(async()=>{const d=await Promise.allSettled(a.map(f=>n.evaluateRun(c,f,{referenceExample:r[h],loadChildRuns:!1})));return s.increment(),{execution_time:c!=null&&c.end_time&&c.start_time?c.end_time-c.start_time:void 0,feedback:d.map(f=>f.status==="fulfilled"?f.value:f.reason),run_id:c.id}}));return(await Promise.all(u)).reduce((c,h,d)=>({...c,[r[d].id]:h}),{})},R8e=(t,e,r)=>r==="chat"?t.map(({inputs:i})=>m6(i.input)):typeof e=="object"&&typeof e._llmType=="function"&&t.every(({inputs:i})=>Object.keys(i).length===1)?t.map(({inputs:i})=>Object.values(i)[0]):t.map(({inputs:i})=>i);async function N8e(t,e,r){const{projectName:n,projectMetadata:i,client:a,maxConcurrency:s}=r??{},o=(r==null?void 0:r.evaluationConfig)??((r==null?void 0:r.evaluators)!=null?{evaluators:r.evaluators,formatEvaluatorInputs:r.formatEvaluatorInputs}:void 0),u=await I8e(t),l=a??new Id,c=n??E8e(),h=await l.readDataset({datasetName:e}),d=h.id,f=s??5,{configs:p,examples:m,runExtractors:g}=await $8e({datasetName:e,client:l,projectName:c,maxConcurrency:f});await l.createProject({projectName:c,referenceDatasetId:d,projectExtra:{metadata:{...i}}});const v=new Qn({func:u}).withConfig({runName:"evaluationRun"}),y=R8e(m,t,h.data_type),b=new q7({total:y.length,format:"Predicting: {bar} {percentage}% | {value}/{total}"});await v.withListeners({onEnd:()=>b.increment()}).batch(y,p,{maxConcurrency:s,returnExceptions:!0}),b.complete();const w=[];for(let P=0;P<m.length;P+=1)w.push(await g[P].extract());let _={};if(o){const P=await p$.fromRunEvalConfig(o);_=await j8e({evaluation:P,runs:w,examples:m,client:l,maxConcurrency:f})}return{projectName:c,results:_??{}}}function V7(t){return typeof t=="function"&&"langsmith:traceable"in t}const M8e=Object.freeze(Object.defineProperty({__proto__:null,Criteria:O8e,EmbeddingDistance:P8e,LabeledCriteria:S8e,isCustomEvaluator:B7,isOffTheShelfEvaluator:h$,runOnDataset:N8e},Symbol.toStringTag,{value:"Module"}));async function D8e(t,e){if(t instanceof ReadableStream){const r=t.getReader();for(;;){const n=await r.read();if(n.done){e(new Uint8Array,!0);break}e(n.value)}}else try{for await(const r of t)e(new Uint8Array(r));e(new Uint8Array,!0)}catch(r){throw new Error(["Parsing event source stream failed.","Ensure your implementation of fetch returns a web or Node readable stream.",`Error: ${r.message}`].join(`
`))}}function L8e(t){let e,r,n,i=!1;return function(s,o){if(o){t(s,0,!0);return}e===void 0?(e=s,r=0,n=-1):e=U8e(e,s);const u=e.length;let l=0;for(;r<u;){i&&(e[r]===10&&(l=++r),i=!1);let c=-1;for(;r<u&&c===-1;++r)switch(e[r]){case 58:n===-1&&(n=r-l);break;case 13:i=!0;case 10:c=r;break}if(c===-1)break;t(e.subarray(l,c),n),l=r,n=-1}l===u?e=void 0:l!==0&&(e=e.subarray(l),r-=l)}}function F8e(t,e,r){let n=WO();const i=new TextDecoder;return function(s,o,u){if(u){z8e(n)||(t==null||t(n),n=WO());return}if(s.length===0)t==null||t(n),n=WO();else if(o>0){const l=i.decode(s.subarray(0,o)),c=o+(s[o+1]===32?2:1),h=i.decode(s.subarray(c));switch(l){case"data":n.data=n.data?n.data+`
`+h:h;break;case"event":n.event=h;break;case"id":e==null||e(n.id=h);break;case"retry":{const d=parseInt(h,10);Number.isNaN(d)||r==null||r(n.retry=d);break}}}}}function U8e(t,e){const r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}function WO(){return{data:"",event:"",id:"",retry:void 0}}function GO(t,e){const r=new ReadableStream({async start(n){const i=F8e(s=>{if(s.event==="error")throw new Error(s.data??"Unspecified event streaming error.");s.event==="metadata"?e==null||e(s):s.data&&n.enqueue(s.data)});await D8e(t,L8e((s,o,u)=>{i(s,o,u),u&&n.close()}))}});return mn.fromReadableStream(r)}function z8e(t){return t.data===""&&t.event===""&&t.id===""&&t.retry===void 0}function Ao(t,e){for(const r of e)if(!t.has(r))return!1;return!0}function da(t){if(Array.isArray(t))return t.map(da);if(typeof t=="object"){if(!t||t instanceof Date)return t;const e=Object.keys(t),r=new Set(e);if(Ao(r,new Set(["page_content","metadata"])))return new rr({pageContent:t.page_content,metadata:t.metadata});if(Ao(r,new Set(["content","type","additional_kwargs"]))){if(t.type==="HumanMessage"||t.type==="human")return new Wt({content:t.content});if(t.type==="SystemMessage"||t.type==="system")return new Gn({content:t.content});if(t.type==="ChatMessage"||t.type==="generic")return new gn({content:t.content,role:t.role});if(t.type==="FunctionMessage"||t.type==="function")return new yo({content:t.content,name:t.name});if(t.type==="ToolMessage"||t.type==="tool")return new Pa({content:t.content,tool_call_id:t.tool_call_id,status:t.status});if(t.type==="AIMessage"||t.type==="ai")return new pt({content:t.content});if(t.type==="HumanMessageChunk")return new ws({content:t.content});if(t.type==="SystemMessageChunk")return new _s({content:t.content});if(t.type==="ChatMessageChunk")return new vs({content:t.content,role:t.role});if(t.type==="FunctionMessageChunk")return new bs({content:t.content,name:t.name});if(t.type==="ToolMessageChunk")return new go({content:t.content,tool_call_id:t.tool_call_id,status:t.status});if(t.type==="AIMessageChunk")return new Mr({content:t.content})}if(Ao(r,new Set(["text","generation_info","type"]))){if(t.type==="ChatGenerationChunk")return new Yn({message:da(t.message),text:t.text,generationInfo:t.generation_info});if(t.type==="ChatGeneration")return{message:da(t.message),text:t.text,generationInfo:t.generation_info};if(t.type==="GenerationChunk")return new Vi({text:t.text,generationInfo:t.generation_info});if(t.type==="Generation")return{text:t.text,generationInfo:t.generation_info}}if(Ao(r,new Set(["tool","tool_input","log","type"]))&&t.type==="AgentAction")return{tool:t.tool,toolInput:t.tool_input,log:t.log};if(Ao(r,new Set(["return_values","log","type"]))&&t.type==="AgentFinish")return{returnValues:t.return_values,log:t.log};if(Ao(r,new Set(["generations","run","type"]))&&t.type==="LLMResult")return{generations:da(t.generations),llmOutput:t.llm_output,[br]:t.run};if(Ao(r,new Set(["messages"])))return new t1({messages:t.messages.map(a=>da(a))});if(Ao(r,new Set(["text"])))return new jd(t.text);const n=a=>[a,da(t[a])];return Object.fromEntries(e.map(n))}return t}function B8e(t){const e=JSON.parse(t);return da(e)}function Tf(t){const e={...t};return delete e.callbacks,delete e.signal,e}function kA(t){if(Array.isArray(t))return t.map(kA);if(An(t)){const e={content:t.content,type:t._getType(),additional_kwargs:t.additional_kwargs,name:t.name,example:!1};return Pa.isInstance(t)?e.tool_call_id=t.tool_call_id:gn.isInstance(t)&&(e.role=t.role),e}if(typeof t=="object"){if(!t||t instanceof Date)return t;const e=Object.keys(t),r=i=>[i,kA(t[i])];return Object.fromEntries(e.map(r))}return t}class q8e extends Je{constructor(e){super(e),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchImplementation",{enumerable:!0,configurable:!0,writable:!0,value:(...s)=>fetch(...s)}),Object.defineProperty(this,"fetchRequestOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","runnable","remote"]});const{url:r,options:n,fetch:i,fetchRequestOptions:a}=e;this.url=r.replace(/\/$/,""),this.options=n,this.fetchImplementation=i??this.fetchImplementation,this.fetchRequestOptions=a}async post(e,r,n){var i,a,s;return this.fetchImplementation(`${this.url}${e}`,{method:"POST",body:JSON.stringify(kA(r)),signal:n??AbortSignal.timeout(((i=this.options)==null?void 0:i.timeout)??6e4),...this.fetchRequestOptions,headers:{"Content-Type":"application/json",...(a=this.fetchRequestOptions)==null?void 0:a.headers,...(s=this.options)==null?void 0:s.headers}})}async _invoke(e,r,n){const[i,a]=this._separateRunnableConfigFromCallOptions(r),s=await this.post("/invoke",{input:e,config:Tf(i),kwargs:a??{}},i.signal);if(!s.ok)throw new Error(`${s.status} Error: ${await s.text()}`);return da((await s.json()).output)}async invoke(e,r){return this._callWithConfig(this._invoke,e,r)}async _batch(e,r,n,i){var c;if(i!=null&&i.returnExceptions)throw new Error("returnExceptions is not supported for remote clients");const a=r==null?void 0:r.map(h=>this._separateRunnableConfigFromCallOptions(h)),[s,o]=(a==null?void 0:a.reduce(([h,d],[f,p])=>[[...h,f],[...d,p]],[[],[]]))??[void 0,void 0],u=await this.post("/batch",{inputs:e,config:(s??[]).map(Tf).map(h=>({...h,...i})),kwargs:o},(c=r==null?void 0:r[0])==null?void 0:c.signal);if(!u.ok)throw new Error(`${u.status} Error: ${await u.text()}`);const l=await u.json();if(!l.output)throw new Error("Invalid response from remote runnable");return da(l.output)}async batch(e,r,n){if(n!=null&&n.returnExceptions)throw Error("returnExceptions is not supported for remote clients");return this._batchWithConfig(this._batch.bind(this),e,r,n)}async*_streamIterator(e,r){const[n,i]=this._separateRunnableConfigFromCallOptions(r),a=await Zr(r),s=await(a==null?void 0:a.handleChainStart(this.toJSON(),Jt(e,"input"),n.runId,void 0,void 0,void 0,n.runName));delete n.runId;let o,u=!0;try{const l=await this.post("/stream",{input:e,config:Tf(n),kwargs:i},n.signal);if(!l.ok){const d=await l.json(),f=new Error(`RemoteRunnable call failed with status code ${l.status}: ${d.message}`);throw f.response=l,f}const{body:c}=l;if(!c)throw new Error("Could not begin remote stream. Please check the given URL and try again.");const h=GO(c);for await(const d of h){const f=B8e(d);if(yield f,u)if(o===void 0)o=f;else try{o=cn(o,f)}catch{o=void 0,u=!1}}}catch(l){throw await(s==null?void 0:s.handleChainError(l)),l}await(s==null?void 0:s.handleChainEnd(o??{}))}async*streamLog(e,r,n){const[i,a]=this._separateRunnableConfigFromCallOptions(r),s=await Zr(r),o=await(s==null?void 0:s.handleChainStart(this.toJSON(),Jt(e,"input"),i.runId,void 0,void 0,void 0,i.runName));delete i.runId;const u={include_names:n==null?void 0:n.includeNames,include_types:n==null?void 0:n.includeTypes,include_tags:n==null?void 0:n.includeTags,exclude_names:n==null?void 0:n.excludeNames,exclude_types:n==null?void 0:n.excludeTypes,exclude_tags:n==null?void 0:n.excludeTags};let l;try{const c=await this.post("/stream_log",{input:e,config:Tf(i),kwargs:a,...u,diff:!1},i.signal),{body:h,ok:d}=c;if(!d)throw new Error(`${c.status} Error: ${await c.text()}`);if(!h)throw new Error("Could not begin remote stream log. Please check the given URL and try again.");const f=GO(h);for await(const p of f){const m=da(JSON.parse(p)),g=new Ua({ops:m.ops});yield g,l===void 0?l=$l.fromRunLogPatch(g):l=l.concat(g)}}catch(c){throw await(o==null?void 0:o.handleChainError(c)),c}await(o==null?void 0:o.handleChainEnd(l==null?void 0:l.state.final_output))}_streamEvents(e,r,n){const i=this;return async function*(){const[s,o]=i._separateRunnableConfigFromCallOptions(r),u=await Zr(r),l=await(u==null?void 0:u.handleChainStart(i.toJSON(),Jt(e,"input"),s.runId,void 0,void 0,void 0,s.runName));delete s.runId;const c={include_names:n==null?void 0:n.includeNames,include_types:n==null?void 0:n.includeTypes,include_tags:n==null?void 0:n.includeTags,exclude_names:n==null?void 0:n.excludeNames,exclude_types:n==null?void 0:n.excludeTypes,exclude_tags:n==null?void 0:n.excludeTags},h=[];try{const d=await i.post("/stream_events",{input:e,config:Tf(s),kwargs:o,...c,diff:!1},s.signal),{body:f,ok:p}=d;if(!p)throw new Error(`${d.status} Error: ${await d.text()}`);if(!f)throw new Error("Could not begin remote stream events. Please check the given URL and try again.");const m=GO(f);for await(const g of m){const v=da(JSON.parse(g)),y={event:v.event,name:v.name,run_id:v.run_id,tags:v.tags,metadata:v.metadata,data:v.data};yield y,h.push(y)}}catch(d){throw await(l==null?void 0:l.handleChainError(d)),d}await(l==null?void 0:l.handleChainEnd(h))}()}streamEvents(e,r,n){if(r.version!=="v1"&&r.version!=="v2")throw new Error('Only versions "v1" and "v2" of the events schema is currently supported.');if(r.encoding!==void 0)throw new Error("Special encodings are not supported for this runnable.");const i=this._streamEvents(e,r,n);return mn.fromAsyncGenerator(i)}}const K8e=Object.freeze(Object.defineProperty({__proto__:null,RemoteRunnable:q8e},Symbol.toStringTag,{value:"Module"})),u3="10f90ea3-90a4-4962-bf75-83a0f3c1c62a";class H7{constructor(e){Object.defineProperty(this,"uid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hash_",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"contentHash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadataHash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.uid=e.uid,this.pageContent=e.pageContent,this.metadata=e.metadata}calculateHashes(){const e=["hash_","content_hash","metadata_hash"];for(const n of e)if(n in this.metadata)throw new Error(`Metadata cannot contain key ${n} as it is reserved for internal use. Restricted keys: [${e.join(", ")}]`);const r=this._hashStringToUUID(this.pageContent);try{const n=this._hashNestedDictToUUID(this.metadata);this.contentHash=r,this.metadataHash=n}catch(n){throw new Error(`Failed to hash metadata: ${n}. Please use a dict that can be serialized using json.`)}this.hash_=this._hashStringToUUID(this.contentHash+this.metadataHash),this.uid||(this.uid=this.hash_)}toDocument(){return new rr({pageContent:this.pageContent,metadata:this.metadata})}static fromDocument(e,r){const n=new this({pageContent:e.pageContent,metadata:e.metadata,uid:r||e.uid});return n.calculateHashes(),n}_hashStringToUUID(e){const r=zm(e);return aL(r,u3)}_hashNestedDictToUUID(e){const r=JSON.stringify(e,Object.keys(e).sort()),n=zm(r);return aL(n,u3)}}function W7(t,e){const r=[];let n=[];return e.forEach(i=>{n.push(i),n.length>=t&&(r.push(n),n=[])}),n.length>0&&r.push(n),r}function G7(t){const e=new Set,r=[];for(const n of t){if(!n.hash_)throw new Error("Hashed document does not have a hash");e.has(n.hash_)||(e.add(n.hash_),r.push(n))}return r}function Y7(t){if(t===null)return e=>null;if(typeof t=="string")return e=>e.metadata[t];if(typeof t=="function")return t;throw new Error(`sourceIdKey should be null, a string or a function, got ${typeof t}`)}const J7=t=>"load"in t&&typeof t.load=="function"&&"loadAndSplit"in t&&typeof t.loadAndSplit=="function";async function V8e(t){const{docsSource:e,recordManager:r,vectorStore:n,options:i}=t,{batchSize:a=100,cleanup:s,sourceIdKey:o,cleanupBatchSize:u=1e3,forceUpdate:l=!1}=i??{};if(s==="incremental"&&!o)throw new Error("sourceIdKey is required when cleanup mode is incremental. Please provide through 'options.sourceIdKey'.");const c=J7(e)?await e.load():e,h=Y7(o??null),d=await r.getTime();let f=0,p=0,m=0,g=0;const v=W7(a??100,c);for(const y of v){const b=G7(y.map(k=>H7.fromDocument(k))),w=b.map(k=>h(k));s==="incremental"&&b.forEach((k,R)=>{if(w[R]===null)throw new Error("sourceIdKey must be provided when cleanup is incremental")});const _=await r.exists(b.map(k=>k.uid)),O=[],P=[],x=[],j=new Set;if(b.forEach((k,R)=>{if(_[R])if(l)j.add(k.uid);else{x.push(k.uid);return}O.push(k.uid),P.push(k.toDocument())}),x.length>0&&(await r.update(x,{timeAtLeast:d}),g+=x.length),P.length>0&&(await n.addDocuments(P,{ids:O}),f+=P.length-j.size,m+=j.size),await r.update(b.map(k=>k.uid),{timeAtLeast:d,groupIds:w}),s==="incremental"){w.forEach(R=>{if(!R)throw new Error("Source id cannot be null")});const k=await r.listKeys({before:d,groupIds:w});await n.delete({ids:k}),await r.deleteKeys(k),p+=k.length}}if(s==="full"){let y=await r.listKeys({before:d,limit:u});for(;y.length>0;)await n.delete({ids:y}),await r.deleteKeys(y),p+=y.length,y=await r.listKeys({before:d,limit:u})}return{numAdded:f,numDeleted:p,numUpdated:m,numSkipped:g}}const H8e=Object.freeze(Object.defineProperty({__proto__:null,_HashedDocument:H7,_batch:W7,_deduplicateInOrder:G7,_getSourceIdAssigner:Y7,_isBaseDocumentLoader:J7,index:V8e},Symbol.toStringTag,{value:"Module"}));class W8e{constructor(e,r,n){Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:n})}}const G8e=Object.freeze(Object.defineProperty({__proto__:null,AttributeInfo:W8e},Symbol.toStringTag,{value:"Module"})),Y8e=async(t,e)=>{const r={pageContent:t.pageContent,...t.metadata},n=new Set(e.inputVariables),i=new Set(e.inputVariables.map(s=>s!=="pageContent"?s:null).filter(s=>s!==null)),a=[];for(const s of n)!(s in r)&&s!=="pageContent"&&a.push(s);if(a.length)throw new Error(`Document prompt requires documents to have metadata variables: ${JSON.stringify(i)}. Received document with missing metadata: ${JSON.stringify(a)}`);return e.format(r)},J8e=Object.freeze(Object.defineProperty({__proto__:null,formatDocument:Y8e},Symbol.toStringTag,{value:"Module"})),Z8e={ChatOpenAI:Hg},X8e={OpenAI:Yze},Q8e={OpenAIEmbeddings:GI},eKe={PromptTemplate:ve},tKe={AIMessage:pt,AIMessageChunk:Mr,BaseMessage:Wn,BaseMessageChunk:mo,ChatMessage:gn,ChatMessageChunk:vs,FunctionMessage:yo,FunctionMessageChunk:bs,HumanMessage:Wt,HumanMessageChunk:ws,SystemMessage:Gn,SystemMessageChunk:_s,ToolMessage:Pa,ToolMessageChunk:go},rKe={AIMessage:pt,AIMessageChunk:Mr,BaseMessage:Wn,BaseMessageChunk:mo,ChatMessage:gn,ChatMessageChunk:vs,FunctionMessage:yo,FunctionMessageChunk:bs,HumanMessage:Wt,HumanMessageChunk:ws,SystemMessage:Gn,SystemMessageChunk:_s,ToolMessage:Pa,ToolMessageChunk:go},nKe={AIMessagePromptTemplate:Ql,ChatMessagePromptTemplate:ZC,ChatPromptTemplate:Xt,HumanMessagePromptTemplate:ir,MessagesPlaceholder:Nl,SystemMessagePromptTemplate:ei},iKe={ImagePromptTemplate:ml},aKe={PipelinePromptTemplate:ch},sKe={StringPromptValue:jd},oKe={RouterRunnable:R8,RunnableAssign:Z_,RunnableBinding:as,RunnableBranch:GC,RunnableEach:Zh,RunnableMap:vo,RunnableParallel:m8,RunnablePassthrough:Dr,RunnablePick:X_,RunnableRetry:NC,RunnableSequence:wr,RunnableWithFallbacks:MC,RunnableWithMessageHistory:N8},uKe={StringOutputParser:zd},lKe={ChatGenerationChunk:Yn,GenerationChunk:Vi},cKe=Object.freeze(Object.defineProperty({__proto__:null,agents:u4e,agents__format_scratchpad:z5e,agents__format_scratchpad__log:M5e,agents__format_scratchpad__log_to_message:j4e,agents__format_scratchpad__openai_tools:Q5e,agents__format_scratchpad__xml:W5e,agents__openai__output_parser:F5e,agents__react__output_parser:o4e,agents__toolkits:Z5e,agents__xml__output_parser:H5e,callbacks:M9e,chains:Xqe,chains__combine_documents:n9e,chains__combine_documents__reduce:o9e,chains__history_aware_retriever:l9e,chains__openai_functions:m9e,chains__retrieval:v9e,chat_models__openai:Z8e,document_loaders__base:j9e,document_transformers__openai_functions:N9e,embeddings__cache_backed:_9e,embeddings__fake:x9e,embeddings__openai:Q8e,evaluation:x8e,experimental__autogpt:A6e,experimental__babyagi:$6e,experimental__chains__violation_of_expectations:V6e,experimental__generative_agents:N6e,experimental__masking:G6e,experimental__openai_assistant:k6e,experimental__openai_files:I6e,experimental__plan_and_execute:F6e,experimental__prompts__custom_format:J6e,indexes:H8e,llms__openai:X8e,memory:t3,memory__chat_memory:x5e,memory__index:t3,output_parsers:B9e,prompts__base:sKe,prompts__chat:nKe,prompts__image:iKe,prompts__pipeline:aKe,prompts__prompt:eKe,retrievers__contextual_compression:K9e,retrievers__document_compressors:H9e,retrievers__document_compressors__chain_extract:o6e,retrievers__document_compressors__embeddings_filter:l6e,retrievers__ensemble:G9e,retrievers__hyde:h6e,retrievers__matryoshka_retriever:m6e,retrievers__multi_query:X9e,retrievers__multi_vector:Q9e,retrievers__parent_document:t6e,retrievers__score_threshold:f6e,retrievers__time_weighted:n6e,runnables__remote:K8e,schema:rKe,schema__messages:tKe,schema__output:lKe,schema__output_parser:uKe,schema__prompt_template:J8e,schema__query_constructor:G8e,schema__runnable:oKe,smith:M8e,storage__encoder_backed:b9e,storage__in_memory:O6e,stores__doc__base:g6e,stores__doc__in_memory:b6e,stores__file__in_memory:x6e,stores__message__in_memory:_5e,text_splitter:J4e,tools:D4e,tools__chain:R4e,tools__render:N5e,tools__retriever:F4e,util__document:l5e,util__math:O9e,util__time:S6e,vectorstores__memory:S9e},Symbol.toStringTag,{value:"Module"}));async function hKe(t,e={},r={}){return C4e(t,{secretsMap:e,optionalImportsMap:r,optionalImportEntrypoints:I4e,importMap:cKe})}async function dKe(t,e){const n=await new Id(e)._pullPrompt(t,{includeModel:e==null?void 0:e.includeModel});return hKe(n)}var Ti="INUMBER",Zd="IOP1",Xd="IOP2",Qd="IOP3",so="IVAR",Ll="IVARNAME",nd="IFUNCALL",$1="IFUNDEF",Zn="IEXPR",m$="IEXPREVAL",ec="IMEMBER",j1="IENDSTATEMENT",id="IARRAY";function Qe(t,e){this.type=t,this.value=e??0}Qe.prototype.toString=function(){switch(this.type){case Ti:case Zd:case Xd:case Qd:case so:case Ll:case j1:return this.value;case nd:return"CALL "+this.value;case $1:return"DEF "+this.value;case id:return"ARRAY "+this.value;case ec:return"."+this.value;default:return"Invalid Instruction"}};function R1(t){return new Qe(Zd,t)}function wo(t){return new Qe(Xd,t)}function Z7(t){return new Qe(Qd,t)}function CA(t,e,r,n,i){for(var a=[],s=[],o,u,l,c,h=0;h<t.length;h++){var d=t[h],f=d.type;if(f===Ti||f===Ll)Array.isArray(d.value)?a.push.apply(a,CA(d.value.map(function(p){return new Qe(Ti,p)}).concat(new Qe(id,d.value.length)),e,r,n,i)):a.push(d);else if(f===so&&i.hasOwnProperty(d.value))d=new Qe(Ti,i[d.value]),a.push(d);else if(f===Xd&&a.length>1)u=a.pop(),o=a.pop(),c=r[d.value],d=new Qe(Ti,c(o.value,u.value)),a.push(d);else if(f===Qd&&a.length>2)l=a.pop(),u=a.pop(),o=a.pop(),d.value==="?"?a.push(o.value?u.value:l.value):(c=n[d.value],d=new Qe(Ti,c(o.value,u.value,l.value)),a.push(d));else if(f===Zd&&a.length>0)o=a.pop(),c=e[d.value],d=new Qe(Ti,c(o.value)),a.push(d);else if(f===Zn){for(;a.length>0;)s.push(a.shift());s.push(new Qe(Zn,CA(d.value,e,r,n,i)))}else if(f===ec&&a.length>0)o=a.pop(),a.push(new Qe(Ti,o.value[d.value]));else{for(;a.length>0;)s.push(a.shift());s.push(d)}}for(;a.length>0;)s.push(a.shift());return s}function X7(t,e,r){for(var n=[],i=0;i<t.length;i++){var a=t[i],s=a.type;if(s===so&&a.value===e)for(var o=0;o<r.tokens.length;o++){var u=r.tokens[o],l;u.type===Zd?l=R1(u.value):u.type===Xd?l=wo(u.value):u.type===Qd?l=Z7(u.value):l=new Qe(u.type,u.value),n.push(l)}else s===Zn?n.push(new Qe(Zn,X7(a.value,e,r))):n.push(a)}return n}function Yu(t,e,r){var n=[],i,a,s,o,u,l;if(g$(t))return ks(t,r);for(var c=t.length,h=0;h<c;h++){var d=t[h],f=d.type;if(f===Ti||f===Ll)n.push(d.value);else if(f===Xd)a=n.pop(),i=n.pop(),d.value==="and"?n.push(i?!!Yu(a,e,r):!1):d.value==="or"?n.push(i?!0:!!Yu(a,e,r)):d.value==="="?(o=e.binaryOps[d.value],n.push(o(i,Yu(a,e,r),r))):(o=e.binaryOps[d.value],n.push(o(ks(i,r),ks(a,r))));else if(f===Qd)s=n.pop(),a=n.pop(),i=n.pop(),d.value==="?"?n.push(Yu(i?a:s,e,r)):(o=e.ternaryOps[d.value],n.push(o(ks(i,r),ks(a,r),ks(s,r))));else if(f===so)if(d.value in e.functions)n.push(e.functions[d.value]);else if(d.value in e.unaryOps&&e.parser.isOperatorEnabled(d.value))n.push(e.unaryOps[d.value]);else{var p=r[d.value];if(p!==void 0)n.push(p);else throw new Error("undefined variable: "+d.value)}else if(f===Zd)i=n.pop(),o=e.unaryOps[d.value],n.push(o(ks(i,r)));else if(f===nd){for(l=d.value,u=[];l-- >0;)u.unshift(ks(n.pop(),r));if(o=n.pop(),o.apply&&o.call)n.push(o.apply(void 0,u));else throw new Error(o+" is not a function")}else if(f===$1)n.push(function(){for(var m=n.pop(),g=[],v=d.value;v-- >0;)g.unshift(n.pop());var y=n.pop(),b=function(){for(var w=Object.assign({},r),_=0,O=g.length;_<O;_++)w[g[_]]=arguments[_];return Yu(m,e,w)};return Object.defineProperty(b,"name",{value:y,writable:!1}),r[y]=b,b}());else if(f===Zn)n.push(fKe(d,e));else if(f===m$)n.push(d);else if(f===ec)i=n.pop(),n.push(i[d.value]);else if(f===j1)n.pop();else if(f===id){for(l=d.value,u=[];l-- >0;)u.unshift(n.pop());n.push(u)}else throw new Error("invalid Expression")}if(n.length>1)throw new Error("invalid Expression (parity)");return n[0]===0?0:ks(n[0],r)}function fKe(t,e,r){return g$(t)?t:{type:m$,value:function(n){return Yu(t.value,e,n)}}}function g$(t){return t&&t.type===m$}function ks(t,e){return g$(t)?t.value(e):t}function y$(t,e){for(var r=[],n,i,a,s,o,u,l=0;l<t.length;l++){var c=t[l],h=c.type;if(h===Ti)typeof c.value=="number"&&c.value<0?r.push("("+c.value+")"):Array.isArray(c.value)?r.push("["+c.value.map(l3).join(", ")+"]"):r.push(l3(c.value));else if(h===Xd)i=r.pop(),n=r.pop(),s=c.value,e?s==="^"?r.push("Math.pow("+n+", "+i+")"):s==="and"?r.push("(!!"+n+" && !!"+i+")"):s==="or"?r.push("(!!"+n+" || !!"+i+")"):s==="||"?r.push("(function(a,b){ return Array.isArray(a) && Array.isArray(b) ? a.concat(b) : String(a) + String(b); }(("+n+"),("+i+")))"):s==="=="?r.push("("+n+" === "+i+")"):s==="!="?r.push("("+n+" !== "+i+")"):s==="["?r.push(n+"[("+i+") | 0]"):r.push("("+n+" "+s+" "+i+")"):s==="["?r.push(n+"["+i+"]"):r.push("("+n+" "+s+" "+i+")");else if(h===Qd)if(a=r.pop(),i=r.pop(),n=r.pop(),s=c.value,s==="?")r.push("("+n+" ? "+i+" : "+a+")");else throw new Error("invalid Expression");else if(h===so||h===Ll)r.push(c.value);else if(h===Zd)n=r.pop(),s=c.value,s==="-"||s==="+"?r.push("("+s+n+")"):e?s==="not"?r.push("(!"+n+")"):s==="!"?r.push("fac("+n+")"):r.push(s+"("+n+")"):s==="!"?r.push("("+n+"!)"):r.push("("+s+" "+n+")");else if(h===nd){for(u=c.value,o=[];u-- >0;)o.unshift(r.pop());s=r.pop(),r.push(s+"("+o.join(", ")+")")}else if(h===$1){for(i=r.pop(),u=c.value,o=[];u-- >0;)o.unshift(r.pop());n=r.pop(),e?r.push("("+n+" = function("+o.join(", ")+") { return "+i+" })"):r.push("("+n+"("+o.join(", ")+") = "+i+")")}else if(h===ec)n=r.pop(),r.push(n+"."+c.value);else if(h===id){for(u=c.value,o=[];u-- >0;)o.unshift(r.pop());r.push("["+o.join(", ")+"]")}else if(h===Zn)r.push("("+y$(c.value,e)+")");else if(h!==j1)throw new Error("invalid Expression")}return r.length>1&&(e?r=[r.join(",")]:r=[r.join(";")]),String(r[0])}function l3(t){return typeof t=="string"?JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):t}function Yc(t,e){for(var r=0;r<t.length;r++)if(t[r]===e)return!0;return!1}function v$(t,e,r){r=r||{};for(var n=!!r.withMembers,i=null,a=0;a<t.length;a++){var s=t[a];s.type===so||s.type===Ll?!n&&!Yc(e,s.value)?e.push(s.value):(i!==null&&(Yc(e,i)||e.push(i)),i=s.value):s.type===ec&&n&&i!==null?i+="."+s.value:s.type===Zn?v$(s.value,e,r):i!==null&&(Yc(e,i)||e.push(i),i=null)}i!==null&&!Yc(e,i)&&e.push(i)}function xa(t,e){this.tokens=t,this.parser=e,this.unaryOps=e.unaryOps,this.binaryOps=e.binaryOps,this.ternaryOps=e.ternaryOps,this.functions=e.functions}xa.prototype.simplify=function(t){return t=t||{},new xa(CA(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,t),this.parser)};xa.prototype.substitute=function(t,e){return e instanceof xa||(e=this.parser.parse(String(e))),new xa(X7(this.tokens,t,e),this.parser)};xa.prototype.evaluate=function(t){return t=t||{},Yu(this.tokens,this,t)};xa.prototype.toString=function(){return y$(this.tokens,!1)};xa.prototype.symbols=function(t){t=t||{};var e=[];return v$(this.tokens,e,t),e};xa.prototype.variables=function(t){t=t||{};var e=[];v$(this.tokens,e,t);var r=this.functions;return e.filter(function(n){return!(n in r)})};xa.prototype.toJSFunction=function(t,e){var r=this,n=new Function(t,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+y$(this.simplify(e).tokens,!0)+"; }");return function(){return n.apply(r,arguments)}};var rg="TEOF",Et="TOP",N1="TNUMBER",Q7="TSTRING",oo="TPAREN",ad="TBRACKET",M1="TCOMMA",b$="TNAME",w$="TSEMICOLON";function eH(t,e,r){this.type=t,this.value=e,this.index=r}eH.prototype.toString=function(){return this.type+": "+this.value};function Qt(t,e){this.pos=0,this.current=null,this.unaryOps=t.unaryOps,this.binaryOps=t.binaryOps,this.ternaryOps=t.ternaryOps,this.consts=t.consts,this.expression=e,this.savedPosition=0,this.savedCurrent=null,this.options=t.options,this.parser=t}Qt.prototype.newToken=function(t,e,r){return new eH(t,e,r??this.pos)};Qt.prototype.save=function(){this.savedPosition=this.pos,this.savedCurrent=this.current};Qt.prototype.restore=function(){this.pos=this.savedPosition,this.current=this.savedCurrent};Qt.prototype.next=function(){if(this.pos>=this.expression.length)return this.newToken(rg,"EOF");if(this.isWhitespace()||this.isComment())return this.next();if(this.isRadixInteger()||this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isBracket()||this.isComma()||this.isSemicolon()||this.isNamedOp()||this.isConst()||this.isName())return this.current;this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')};Qt.prototype.isString=function(){var t=!1,e=this.pos,r=this.expression.charAt(e);if(r==="'"||r==='"')for(var n=this.expression.indexOf(r,e+1);n>=0&&this.pos<this.expression.length;){if(this.pos=n+1,this.expression.charAt(n-1)!=="\\"){var i=this.expression.substring(e+1,n);this.current=this.newToken(Q7,this.unescape(i),e),t=!0;break}n=this.expression.indexOf(r,n+1)}return t};Qt.prototype.isParen=function(){var t=this.expression.charAt(this.pos);return t==="("||t===")"?(this.current=this.newToken(oo,t),this.pos++,!0):!1};Qt.prototype.isBracket=function(){var t=this.expression.charAt(this.pos);return(t==="["||t==="]")&&this.isOperatorEnabled("[")?(this.current=this.newToken(ad,t),this.pos++,!0):!1};Qt.prototype.isComma=function(){var t=this.expression.charAt(this.pos);return t===","?(this.current=this.newToken(M1,","),this.pos++,!0):!1};Qt.prototype.isSemicolon=function(){var t=this.expression.charAt(this.pos);return t===";"?(this.current=this.newToken(w$,";"),this.pos++,!0):!1};Qt.prototype.isConst=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var r=this.expression.charAt(e);if(r.toUpperCase()===r.toLowerCase()&&(e===this.pos||r!=="_"&&r!=="."&&(r<"0"||r>"9")))break}if(e>t){var n=this.expression.substring(t,e);if(n in this.consts)return this.current=this.newToken(N1,this.consts[n]),this.pos+=n.length,!0}return!1};Qt.prototype.isNamedOp=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var r=this.expression.charAt(e);if(r.toUpperCase()===r.toLowerCase()&&(e===this.pos||r!=="_"&&(r<"0"||r>"9")))break}if(e>t){var n=this.expression.substring(t,e);if(this.isOperatorEnabled(n)&&(n in this.binaryOps||n in this.unaryOps||n in this.ternaryOps))return this.current=this.newToken(Et,n),this.pos+=n.length,!0}return!1};Qt.prototype.isName=function(){for(var t=this.pos,e=t,r=!1;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()){if(e===this.pos&&(n==="$"||n==="_")){n==="_"&&(r=!0);continue}else if(e===this.pos||!r||n!=="_"&&(n<"0"||n>"9"))break}else r=!0}if(r){var i=this.expression.substring(t,e);return this.current=this.newToken(b$,i),this.pos+=i.length,!0}return!1};Qt.prototype.isWhitespace=function(){for(var t=!1,e=this.expression.charAt(this.pos);(e===" "||e==="	"||e===`
`||e==="\r")&&(t=!0,this.pos++,!(this.pos>=this.expression.length));)e=this.expression.charAt(this.pos);return t};var pKe=/^[0-9a-f]{4}$/i;Qt.prototype.unescape=function(t){var e=t.indexOf("\\");if(e<0)return t;for(var r=t.substring(0,e);e>=0;){var n=t.charAt(++e);switch(n){case"'":r+="'";break;case'"':r+='"';break;case"\\":r+="\\";break;case"/":r+="/";break;case"b":r+="\b";break;case"f":r+="\f";break;case"n":r+=`
`;break;case"r":r+="\r";break;case"t":r+="	";break;case"u":var i=t.substring(e+1,e+5);pKe.test(i)||this.parseError("Illegal escape sequence: \\u"+i),r+=String.fromCharCode(parseInt(i,16)),e+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+n+'"')}++e;var a=t.indexOf("\\",e);r+=t.substring(e,a<0?t.length:a),e=a}return r};Qt.prototype.isComment=function(){var t=this.expression.charAt(this.pos);return t==="/"&&this.expression.charAt(this.pos+1)==="*"?(this.pos=this.expression.indexOf("*/",this.pos)+2,this.pos===1&&(this.pos=this.expression.length),!0):!1};Qt.prototype.isRadixInteger=function(){var t=this.pos;if(t>=this.expression.length-2||this.expression.charAt(t)!=="0")return!1;++t;var e,r;if(this.expression.charAt(t)==="x")e=16,r=/^[0-9a-f]$/i,++t;else if(this.expression.charAt(t)==="b")e=2,r=/^[01]$/i,++t;else return!1;for(var n=!1,i=t;t<this.expression.length;){var a=this.expression.charAt(t);if(r.test(a))t++,n=!0;else break}return n&&(this.current=this.newToken(N1,parseInt(this.expression.substring(i,t),e)),this.pos=t),n};Qt.prototype.isNumber=function(){for(var t=!1,e=this.pos,r=e,n=e,i=!1,a=!1,s;e<this.expression.length&&(s=this.expression.charAt(e),s>="0"&&s<="9"||!i&&s===".");)s==="."?i=!0:a=!0,e++,t=a;if(t&&(n=e),s==="e"||s==="E"){e++;for(var o=!0,u=!1;e<this.expression.length;){if(s=this.expression.charAt(e),o&&(s==="+"||s==="-"))o=!1;else if(s>="0"&&s<="9")u=!0,o=!1;else break;e++}u||(e=n)}return t?(this.current=this.newToken(N1,parseFloat(this.expression.substring(r,e))),this.pos=e):this.pos=n,t};Qt.prototype.isOperator=function(){var t=this.pos,e=this.expression.charAt(this.pos);if(e==="+"||e==="-"||e==="*"||e==="/"||e==="%"||e==="^"||e==="?"||e===":"||e===".")this.current=this.newToken(Et,e);else if(e==="∙"||e==="•")this.current=this.newToken(Et,"*");else if(e===">")this.expression.charAt(this.pos+1)==="="?(this.current=this.newToken(Et,">="),this.pos++):this.current=this.newToken(Et,">");else if(e==="<")this.expression.charAt(this.pos+1)==="="?(this.current=this.newToken(Et,"<="),this.pos++):this.current=this.newToken(Et,"<");else if(e==="|")if(this.expression.charAt(this.pos+1)==="|")this.current=this.newToken(Et,"||"),this.pos++;else return!1;else if(e==="=")this.expression.charAt(this.pos+1)==="="?(this.current=this.newToken(Et,"=="),this.pos++):this.current=this.newToken(Et,e);else if(e==="!")this.expression.charAt(this.pos+1)==="="?(this.current=this.newToken(Et,"!="),this.pos++):this.current=this.newToken(Et,e);else return!1;return this.pos++,this.isOperatorEnabled(this.current.value)?!0:(this.pos=t,!1)};Qt.prototype.isOperatorEnabled=function(t){return this.parser.isOperatorEnabled(t)};Qt.prototype.getCoordinates=function(){var t=0,e,r=-1;do t++,e=this.pos-r,r=this.expression.indexOf(`
`,r+1);while(r>=0&&r<this.pos);return{line:t,column:e}};Qt.prototype.parseError=function(t){var e=this.getCoordinates();throw new Error("parse error ["+e.line+":"+e.column+"]: "+t)};function jt(t,e,r){this.parser=t,this.tokens=e,this.current=null,this.nextToken=null,this.next(),this.savedCurrent=null,this.savedNextToken=null,this.allowMemberAccess=r.allowMemberAccess!==!1}jt.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()};jt.prototype.tokenMatches=function(t,e){return typeof e>"u"?!0:Array.isArray(e)?Yc(e,t.value):typeof e=="function"?e(t):t.value===e};jt.prototype.save=function(){this.savedCurrent=this.current,this.savedNextToken=this.nextToken,this.tokens.save()};jt.prototype.restore=function(){this.tokens.restore(),this.current=this.savedCurrent,this.nextToken=this.savedNextToken};jt.prototype.accept=function(t,e){return this.nextToken.type===t&&this.tokenMatches(this.nextToken,e)?(this.next(),!0):!1};jt.prototype.expect=function(t,e){if(!this.accept(t,e)){var r=this.tokens.getCoordinates();throw new Error("parse error ["+r.line+":"+r.column+"]: Expected "+(e||t))}};jt.prototype.parseAtom=function(t){var e=this.tokens.unaryOps;function r(i){return i.value in e}if(this.accept(b$)||this.accept(Et,r))t.push(new Qe(so,this.current.value));else if(this.accept(N1))t.push(new Qe(Ti,this.current.value));else if(this.accept(Q7))t.push(new Qe(Ti,this.current.value));else if(this.accept(oo,"("))this.parseExpression(t),this.expect(oo,")");else if(this.accept(ad,"["))if(this.accept(ad,"]"))t.push(new Qe(id,0));else{var n=this.parseArrayList(t);t.push(new Qe(id,n))}else throw new Error("unexpected "+this.nextToken)};jt.prototype.parseExpression=function(t){var e=[];this.parseUntilEndStatement(t,e)||(this.parseVariableAssignmentExpression(e),!this.parseUntilEndStatement(t,e)&&this.pushExpression(t,e))};jt.prototype.pushExpression=function(t,e){for(var r=0,n=e.length;r<n;r++)t.push(e[r])};jt.prototype.parseUntilEndStatement=function(t,e){return this.accept(w$)?(this.nextToken&&this.nextToken.type!==rg&&!(this.nextToken.type===oo&&this.nextToken.value===")")&&e.push(new Qe(j1)),this.nextToken.type!==rg&&this.parseExpression(e),t.push(new Qe(Zn,e)),!0):!1};jt.prototype.parseArrayList=function(t){for(var e=0;!this.accept(ad,"]");)for(this.parseExpression(t),++e;this.accept(M1);)this.parseExpression(t),++e;return e};jt.prototype.parseVariableAssignmentExpression=function(t){for(this.parseConditionalExpression(t);this.accept(Et,"=");){var e=t.pop(),r=[],n=t.length-1;if(e.type===nd){if(!this.tokens.isOperatorEnabled("()="))throw new Error("function definition is not permitted");for(var i=0,a=e.value+1;i<a;i++){var s=n-i;t[s].type===so&&(t[s]=new Qe(Ll,t[s].value))}this.parseVariableAssignmentExpression(r),t.push(new Qe(Zn,r)),t.push(new Qe($1,e.value));continue}if(e.type!==so&&e.type!==ec)throw new Error("expected variable for assignment");this.parseVariableAssignmentExpression(r),t.push(new Qe(Ll,e.value)),t.push(new Qe(Zn,r)),t.push(wo("="))}};jt.prototype.parseConditionalExpression=function(t){for(this.parseOrExpression(t);this.accept(Et,"?");){var e=[],r=[];this.parseConditionalExpression(e),this.expect(Et,":"),this.parseConditionalExpression(r),t.push(new Qe(Zn,e)),t.push(new Qe(Zn,r)),t.push(Z7("?"))}};jt.prototype.parseOrExpression=function(t){for(this.parseAndExpression(t);this.accept(Et,"or");){var e=[];this.parseAndExpression(e),t.push(new Qe(Zn,e)),t.push(wo("or"))}};jt.prototype.parseAndExpression=function(t){for(this.parseComparison(t);this.accept(Et,"and");){var e=[];this.parseComparison(e),t.push(new Qe(Zn,e)),t.push(wo("and"))}};var mKe=["==","!=","<","<=",">=",">","in"];jt.prototype.parseComparison=function(t){for(this.parseAddSub(t);this.accept(Et,mKe);){var e=this.current;this.parseAddSub(t),t.push(wo(e.value))}};var gKe=["+","-","||"];jt.prototype.parseAddSub=function(t){for(this.parseTerm(t);this.accept(Et,gKe);){var e=this.current;this.parseTerm(t),t.push(wo(e.value))}};var yKe=["*","/","%"];jt.prototype.parseTerm=function(t){for(this.parseFactor(t);this.accept(Et,yKe);){var e=this.current;this.parseFactor(t),t.push(wo(e.value))}};jt.prototype.parseFactor=function(t){var e=this.tokens.unaryOps;function r(i){return i.value in e}if(this.save(),this.accept(Et,r)){if(this.current.value!=="-"&&this.current.value!=="+"){if(this.nextToken.type===oo&&this.nextToken.value==="("){this.restore(),this.parseExponential(t);return}else if(this.nextToken.type===w$||this.nextToken.type===M1||this.nextToken.type===rg||this.nextToken.type===oo&&this.nextToken.value===")"){this.restore(),this.parseAtom(t);return}}var n=this.current;this.parseFactor(t),t.push(R1(n.value))}else this.parseExponential(t)};jt.prototype.parseExponential=function(t){for(this.parsePostfixExpression(t);this.accept(Et,"^");)this.parseFactor(t),t.push(wo("^"))};jt.prototype.parsePostfixExpression=function(t){for(this.parseFunctionCall(t);this.accept(Et,"!");)t.push(R1("!"))};jt.prototype.parseFunctionCall=function(t){var e=this.tokens.unaryOps;function r(a){return a.value in e}if(this.accept(Et,r)){var n=this.current;this.parseAtom(t),t.push(R1(n.value))}else for(this.parseMemberExpression(t);this.accept(oo,"(");)if(this.accept(oo,")"))t.push(new Qe(nd,0));else{var i=this.parseArgumentList(t);t.push(new Qe(nd,i))}};jt.prototype.parseArgumentList=function(t){for(var e=0;!this.accept(oo,")");)for(this.parseExpression(t),++e;this.accept(M1);)this.parseExpression(t),++e;return e};jt.prototype.parseMemberExpression=function(t){for(this.parseAtom(t);this.accept(Et,".")||this.accept(ad,"[");){var e=this.current;if(e.value==="."){if(!this.allowMemberAccess)throw new Error('unexpected ".", member access is not permitted');this.expect(b$),t.push(new Qe(ec,this.current.value))}else if(e.value==="["){if(!this.tokens.isOperatorEnabled("["))throw new Error('unexpected "[]", arrays are disabled');this.parseExpression(t),this.expect(ad,"]"),t.push(wo("["))}else throw new Error("unexpected symbol: "+e.value)}};function vKe(t,e){return Number(t)+Number(e)}function bKe(t,e){return t-e}function wKe(t,e){return t*e}function _Ke(t,e){return t/e}function xKe(t,e){return t%e}function OKe(t,e){return Array.isArray(t)&&Array.isArray(e)?t.concat(e):""+t+e}function SKe(t,e){return t===e}function PKe(t,e){return t!==e}function EKe(t,e){return t>e}function AKe(t,e){return t<e}function TKe(t,e){return t>=e}function kKe(t,e){return t<=e}function CKe(t,e){return!!(t&&e)}function IKe(t,e){return!!(t||e)}function $Ke(t,e){return Yc(e,t)}function jKe(t){return(Math.exp(t)-Math.exp(-t))/2}function RKe(t){return(Math.exp(t)+Math.exp(-t))/2}function NKe(t){return t===1/0?1:t===-1/0?-1:(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}function MKe(t){return t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))}function DKe(t){return Math.log(t+Math.sqrt(t*t-1))}function LKe(t){return Math.log((1+t)/(1-t))/2}function c3(t){return Math.log(t)*Math.LOG10E}function FKe(t){return-t}function UKe(t){return!t}function zKe(t){return t<0?Math.ceil(t):Math.floor(t)}function BKe(t){return Math.random()*(t||1)}function h3(t){return _$(t+1)}function qKe(t){return isFinite(t)&&t===Math.round(t)}var KKe=4.7421875,YO=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function _$(t){var e,r;if(qKe(t)){if(t<=0)return isFinite(t)?1/0:NaN;if(t>171)return 1/0;for(var n=t-2,i=t-1;n>1;)i*=n,n--;return i===0&&(i=1),i}if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*_$(1-t));if(t>=171.35)return 1/0;if(t>85){var a=t*t,s=a*t,o=s*t,u=o*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*a)-139/(51840*s)-571/(2488320*o)+163879/(209018880*u)+5246819/(75246796800*u*t))}--t,r=YO[0];for(var l=1;l<YO.length;++l)r+=YO[l]/(t+l);return e=t+KKe+.5,Math.sqrt(2*Math.PI)*Math.pow(e,t+.5)*Math.exp(-e)*r}function VKe(t){return Array.isArray(t)?t.length:String(t).length}function d3(){for(var t=0,e=0,r=0;r<arguments.length;r++){var n=Math.abs(arguments[r]),i;e<n?(i=e/n,t=t*i*i+1,e=n):n>0?(i=n/e,t+=i*i):t+=n}return e===1/0?1/0:e*Math.sqrt(t)}function f3(t,e,r){return t?e:r}function HKe(t,e){return typeof e>"u"||+e==0?Math.round(t):(t=+t,e=-+e,isNaN(t)||!(typeof e=="number"&&e%1===0)?NaN:(t=t.toString().split("e"),t=Math.round(+(t[0]+"e"+(t[1]?+t[1]-e:-e))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+e:e))))}function WKe(t,e,r){return r&&(r[t]=e),e}function GKe(t,e){return t[e|0]}function YKe(t){return arguments.length===1&&Array.isArray(t)?Math.max.apply(Math,t):Math.max.apply(Math,arguments)}function JKe(t){return arguments.length===1&&Array.isArray(t)?Math.min.apply(Math,t):Math.min.apply(Math,arguments)}function ZKe(t,e){if(typeof t!="function")throw new Error("First argument to map is not a function");if(!Array.isArray(e))throw new Error("Second argument to map is not an array");return e.map(function(r,n){return t(r,n)})}function XKe(t,e,r){if(typeof t!="function")throw new Error("First argument to fold is not a function");if(!Array.isArray(r))throw new Error("Second argument to fold is not an array");return r.reduce(function(n,i,a){return t(n,i,a)},e)}function QKe(t,e){if(typeof t!="function")throw new Error("First argument to filter is not a function");if(!Array.isArray(e))throw new Error("Second argument to filter is not an array");return e.filter(function(r,n){return t(r,n)})}function eVe(t,e){if(!(Array.isArray(e)||typeof e=="string"))throw new Error("Second argument to indexOf is not a string or array");return e.indexOf(t)}function tVe(t,e){if(!Array.isArray(e))throw new Error("Second argument to join is not an array");return e.join(t)}function rVe(t){return(t>0)-(t<0)||+t}var p3=1/3;function nVe(t){return t<0?-Math.pow(-t,p3):Math.pow(t,p3)}function iVe(t){return Math.exp(t)-1}function aVe(t){return Math.log(1+t)}function sVe(t){return Math.log(t)/Math.LN2}function tc(t){this.options=t||{},this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||jKe,cosh:Math.cosh||RKe,tanh:Math.tanh||NKe,asinh:Math.asinh||MKe,acosh:Math.acosh||DKe,atanh:Math.atanh||LKe,sqrt:Math.sqrt,cbrt:Math.cbrt||nVe,log:Math.log,log2:Math.log2||sVe,ln:Math.log,lg:Math.log10||c3,log10:Math.log10||c3,expm1:Math.expm1||iVe,log1p:Math.log1p||aVe,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||zKe,"-":FKe,"+":Number,exp:Math.exp,not:UKe,length:VKe,"!":h3,sign:Math.sign||rVe},this.binaryOps={"+":vKe,"-":bKe,"*":wKe,"/":_Ke,"%":xKe,"^":Math.pow,"||":OKe,"==":SKe,"!=":PKe,">":EKe,"<":AKe,">=":TKe,"<=":kKe,and:CKe,or:IKe,in:$Ke,"=":WKe,"[":GKe},this.ternaryOps={"?":f3},this.functions={random:BKe,fac:h3,min:JKe,max:YKe,hypot:Math.hypot||d3,pyt:Math.hypot||d3,pow:Math.pow,atan2:Math.atan2,if:f3,gamma:_$,roundTo:HKe,map:ZKe,fold:XKe,filter:QKe,indexOf:eVe,join:tVe},this.consts={E:Math.E,PI:Math.PI,true:!0,false:!1}}tc.prototype.parse=function(t){var e=[],r=new jt(this,new Qt(this,t),{allowMemberAccess:this.options.allowMemberAccess});return r.parseExpression(e),r.expect(rg,"EOF"),new xa(e,this)};tc.prototype.evaluate=function(t,e){return this.parse(t).evaluate(e)};var tH=new tc;tc.parse=function(t){return tH.parse(t)};tc.evaluate=function(t,e){return tH.parse(t).evaluate(e)};var m3={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"remainder","^":"power","!":"factorial","<":"comparison",">":"comparison","<=":"comparison",">=":"comparison","==":"comparison","!=":"comparison","||":"concatenate",and:"logical",or:"logical",not:"logical","?":"conditional",":":"conditional","=":"assignment","[":"array","()=":"fndef"};function oVe(t){return m3.hasOwnProperty(t)?m3[t]:t}tc.prototype.isOperatorEnabled=function(t){var e=oVe(t),r=this.options.operators||{};return!(e in r)||!!r[e]};class uVe extends xs{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"calculator"}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:"Useful for getting the result of a math expression. The input to this tool should be a valid mathematical expression that could be executed by a simple calculator."})}static lc_name(){return"Calculator"}get lc_namespace(){return[...super.lc_namespace,"calculator"]}async _call(e){try{return tc.evaluate(e).toString()}catch{return"I don't know how to do that."}}}const lVe=({chatInput:t,cabins:e,bookings:r})=>{const[n,i]=I.useState(null),[a,s]=I.useState(!1);return I.useEffect(()=>{(async()=>{s(!0);const u=[new uVe],l=`#${e}#${r}`;console.log(l);const h=await new aV({separator:"#",chunkSize:1e3,chunkOverlap:3}).createDocuments([l]);console.log(h);const d=new tLe({model:"mxbai-embed-large",baseUrl:"http://localhost:11434"}),f=new A1(d);await f.addDocuments(h);const g=(await f.asRetriever({k:1}).invoke(t))[0].pageContent,v=new kFe({modelName:"gemini-pro",maxOutputTokens:2048,apiKey:"AIzaSyAjXRi1CmpiiRwQe1P8-VtP5J5P60ZASRM"}),y=await dKe("hwchase17/react-chat"),b=await jK({llm:v,tools:u,prompt:y}),_=await new mr({agent:b,tools:u}).invoke({input:`${t}`,chat_history:`Human: Hi! use this information as context  ${g}  
AI: ok i got it !`});try{_&&_.output?i(_.output):i("No response received.")}catch(O){console.error("Failed to fetch response:",O),i("Error fetching response.")}finally{s(!1)}})()},[e,t,r]),A("div",{children:a?A(ms,{}):n})};function cVe(){const{isLoading:t,data:e,error:r}=lo({queryKey:["bookings"],queryFn:()=>Xte()});return{isLoading:t,error:r,bookings:e}}function hVe(t){return t.map(e=>`                                                                                           the information about booking  in our world wide owasis is listed here                                                                                                              :  Booking ID: ${e.id}
  - Created At: ${e.created_at}
  - Start Date: ${e.startDate}
  - End Date: ${e.endDate}
  - Number of Nights: ${e.numNights}
  - Number of Guests: ${e.numGuests}
  - Status: ${e.status}
  - Total Price: $${e.totalPrice}
  - Cabin Name: ${e.cabins.name}
  - Guest Email: ${e.guests.email}
  - Guest Full Name: ${e.guests.fullName}
`).join(`
 # `)}function dVe(t){return t.map(e=>`- Cabin ${e.name}  - ID: ${e.id}  - Created At: ${e.created_at}  - Name: ${e.name}  - Max Capacity: ${e.maxCapacity}  - Regular Price: ${e.regularPrice}  - Discount: ${e.discount}  - Description: ${e.description}  - Image: ${e.image}`).join("#")}function fVe(){const[t,e]=I.useState(""),{cabins:r}=ZT(),{bookings:n,isLoading:i}=cVe();if(i)return A(ms,{});const a=dVe(r),s=hVe(n.data);return Q(fs,{children:[A(rIe,{setChatInput:e}),t&&A(lVe,{chatInput:t,cabins:a,bookings:s})]})}const pVe=new VY({defaultOptions:{queries:{staleTime:0}}});function mVe(){return A(rTe,{children:Q(aJ,{client:pVe,children:[A(bJ,{initialIsOpen:!1}),A(bU,{}),A(EY,{children:Q(wY,{children:[Q(Mn,{element:A(XCe,{children:A(NCe,{})}),children:[A(Mn,{index:!0,element:A(yY,{replace:!0,to:"dashboard"})}),A(Mn,{path:"dashboard",element:A(ETe,{})}),A(Mn,{path:"bookings",element:A(oke,{})}),A(Mn,{path:"bookings/:bookingId",element:A(HCe,{})}),A(Mn,{path:"checkin/:bookingId",element:A(JCe,{})}),A(Mn,{path:"cabins",element:A(zke,{})}),A(Mn,{path:"users",element:A(Yke,{})}),A(Mn,{path:"settings",element:A(eCe,{})}),A(Mn,{path:"account",element:A(nCe,{})}),A(Mn,{path:"ai",element:A(fVe,{})})]}),A(Mn,{path:"login",element:A(pCe,{})}),A(Mn,{path:"*",element:A(yCe,{})})]})}),A(lZ,{position:"top-center",gutter:12,containerStyle:{margin:"8px"},toastOptions:{success:{duration:3e3},error:{duration:5e3},style:{fontSize:"16px",maxWidth:"500px",padding:"16px 24px",backgroundColor:"var(--color-grey-0)",color:"var(--color-grey-700)"}}})]})})}const gVe=I.createContext(null),JO={didCatch:!1,error:null};class yVe extends I.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=JO}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var r,n,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];(r=(n=this.props).onReset)===null||r===void 0||r.call(n,{args:a,reason:"imperative-api"}),this.setState(JO)}}componentDidCatch(e,r){var n,i;(n=(i=this.props).onError)===null||n===void 0||n.call(i,e,r)}componentDidUpdate(e,r){const{didCatch:n}=this.state,{resetKeys:i}=this.props;if(n&&r.error!==null&&vVe(e.resetKeys,i)){var a,s;(a=(s=this.props).onReset)===null||a===void 0||a.call(s,{next:i,prev:e.resetKeys,reason:"keys"}),this.setState(JO)}}render(){const{children:e,fallbackRender:r,FallbackComponent:n,fallback:i}=this.props,{didCatch:a,error:s}=this.state;let o=e;if(a){const u={error:s,resetErrorBoundary:this.resetErrorBoundary};if(typeof r=="function")o=r(u);else if(n)o=I.createElement(n,u);else if(i===null||I.isValidElement(i))o=i;else throw s}return I.createElement(gVe.Provider,{value:{didCatch:a,error:s,resetErrorBoundary:this.resetErrorBoundary}},o)}}function vVe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.length!==e.length||t.some((r,n)=>!Object.is(r,e[n]))}const bVe=ue.main`
  height: 100vh;
  background-color: var(--color-grey-50);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4.8rem;
`,wVe=ue.div`
  /* Box */
  background-color: var(--color-grey-0);
  border: 1px solid var(--color-grey-100);
  border-radius: var(--border-radius-md);

  padding: 4.8rem;
  flex: 0 1 96rem;
  text-align: center;

  & h1 {
    margin-bottom: 1.6rem;
  }

  & p {
    font-family: "Sono";
    margin-bottom: 3.2rem;
    color: var(--color-grey-500);
  }
`;function _Ve({error:t,resetErrorBoundary:e}){return Q(fs,{children:[A(bU,{}),A(bVe,{children:Q(wVe,{children:[A(Jr,{as:"h1",children:"Something went wrong 🧐"}),A("p",{children:t.message}),A(qt,{size:"large",onClick:e,children:"Try again"})]})})]})}ZO.createRoot(document.getElementById("root")).render(A($.StrictMode,{children:A(yVe,{FallbackComponent:_Ve,onReset:()=>window.location.replace("/"),children:A(mVe,{})})}));export{Ze as g};
